{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/img/avatar.png","path":"img/avatar.png","modified":0,"renderable":0},{"_id":"themes/yilia/source/main.0cf68a.css","path":"main.0cf68a.css","modified":0,"renderable":1},{"_id":"themes/yilia/source/slider.e37972.js","path":"slider.e37972.js","modified":0,"renderable":1},{"_id":"source/img/AliPay.jpeg","path":"img/AliPay.jpeg","modified":0,"renderable":0},{"_id":"source/img/Wechat.jpeg","path":"img/Wechat.jpeg","modified":0,"renderable":0},{"_id":"themes/yilia/source/main.0cf68a.js","path":"main.0cf68a.js","modified":0,"renderable":1},{"_id":"themes/yilia/source/mobile.992cbe.js","path":"mobile.992cbe.js","modified":0,"renderable":1},{"_id":"source/img/android/android-studio-file-templates-add-show.jpg","path":"img/android/android-studio-file-templates-add-show.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-live-templates-add-show.jpg","path":"img/android/android-studio-live-templates-add-show.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-live-templates-toast.jpg","path":"img/android/android-studio-live-templates-toast.jpg","modified":0,"renderable":0},{"_id":"source/img/css/background-origin.png","path":"img/css/background-origin.png","modified":0,"renderable":0},{"_id":"source/img/hole/hole-gradle-dists.jpg","path":"img/hole/hole-gradle-dists.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/connectinterceptor01.jpg","path":"img/okhttp/connectinterceptor01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/dispatcher01.jpg","path":"img/okhttp/dispatcher01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/dispatcher02.jpg","path":"img/okhttp/dispatcher02.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/dispatcher02.png","path":"img/okhttp/dispatcher02.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/http1xstream.jpg","path":"img/okhttp/http1xstream.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/okhttpclient01.jpg","path":"img/okhttp/okhttpclient01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/platform01.jpg","path":"img/okhttp/platform01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/platform01.png","path":"img/okhttp/platform01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realcall01.jpg","path":"img/okhttp/realcall01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/realcall03.jpg","path":"img/okhttp/realcall03.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/streamallocation01.jpg","path":"img/okhttp/streamallocation01.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_new_os_info.jpg","path":"img/study/bwh_kiwi_new_os_info.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_location.jpg","path":"img/study/bwh_order_location.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_pay.jpg","path":"img/study/bwh_order_pay.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_ss_client.jpg","path":"img/study/bwh_ss_client.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_ss_complete.jpg","path":"img/study/bwh_ss_complete.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/ios01.jp2","path":"img/swift/ios01.jp2","modified":0,"renderable":0},{"_id":"source/img/swift/swift-sin.png","path":"img/swift/swift-sin.png","modified":0,"renderable":0},{"_id":"themes/yilia/source/fonts/default-skin.b257fa.svg","path":"fonts/default-skin.b257fa.svg","modified":0,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.16acc2.ttf","path":"fonts/iconfont.16acc2.ttf","modified":0,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.45d7ee.svg","path":"fonts/iconfont.45d7ee.svg","modified":0,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.8c627f.woff","path":"fonts/iconfont.8c627f.woff","modified":0,"renderable":1},{"_id":"themes/yilia/source/fonts/iconfont.b322fa.eot","path":"fonts/iconfont.b322fa.eot","modified":0,"renderable":1},{"_id":"themes/yilia/source/fonts/tooltip.4004ff.svg","path":"fonts/tooltip.4004ff.svg","modified":0,"renderable":1},{"_id":"themes/yilia/source/img/default-skin.png","path":"img/default-skin.png","modified":0,"renderable":1},{"_id":"themes/yilia/source/img/preloader.gif","path":"img/preloader.gif","modified":0,"renderable":1},{"_id":"themes/yilia/source/img/scrollbar_arrow.png","path":"img/scrollbar_arrow.png","modified":0,"renderable":1},{"_id":"source/img/android/android-studio-file-tempates-add-complete.jpg","path":"img/android/android-studio-file-tempates-add-complete.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-file-templates-show.jpg","path":"img/android/android-studio-file-templates-show.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-live-templates-add-complete.jpg","path":"img/android/android-studio-live-templates-add-complete.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-live-templates-add-detail.jpg","path":"img/android/android-studio-live-templates-add-detail.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-live-templates-add.jpg","path":"img/android/android-studio-live-templates-add.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-live-templates.jpg","path":"img/android/android-studio-live-templates.jpg","modified":0,"renderable":0},{"_id":"source/img/android/android-stuido-file-templates.jpg","path":"img/android/android-stuido-file-templates.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_americano.jpg","path":"img/life/coffee_americano.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_cappuccino.jpg","path":"img/life/coffee_cappuccino.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_espresso.jpg","path":"img/life/coffee_espresso.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_espresso_con_panna.jpg","path":"img/life/coffee_espresso_con_panna.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_macha.jpg","path":"img/life/coffee_macha.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/callserverinterceptor01.jpg","path":"img/okhttp/callserverinterceptor01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/connectinterceptor01.png","path":"img/okhttp/connectinterceptor01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/okhttpclient01.png","path":"img/okhttp/okhttpclient01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realcall02.jpg","path":"img/okhttp/realcall02.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/realconnection01.jpg","path":"img/okhttp/realconnection01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/realconnection02.jpg","path":"img/okhttp/realconnection02.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/realinterceptorchain01.jpg","path":"img/okhttp/realinterceptorchain01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/responsebody01.jpg","path":"img/okhttp/responsebody01.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/streamallocation02.jpg","path":"img/okhttp/streamallocation02.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_home.jpg","path":"img/study/bwh_home.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_home_client_area_top.jpg","path":"img/study/bwh_home_client_area_top.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_home_client_ares.jpg","path":"img/study/bwh_home_client_ares.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_home_services.jpg","path":"img/study/bwh_home_services.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_home_services_detail.jpg","path":"img/study/bwh_home_services_detail.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_host.jpg","path":"img/study/bwh_host.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_all.jpg","path":"img/study/bwh_kiwi_all.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_main.jpg","path":"img/study/bwh_kiwi_main.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_main_new.jpg","path":"img/study/bwh_kiwi_main_new.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_new_os.jpg","path":"img/study/bwh_kiwi_new_os.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_ss.jpg","path":"img/study/bwh_kiwi_ss.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_ss_install.jpg","path":"img/study/bwh_kiwi_ss_install.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_complete.jpg","path":"img/study/bwh_order_complete.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_cycle.jpg","path":"img/study/bwh_order_cycle.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_cycle_more.jpg","path":"img/study/bwh_order_cycle_more.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_detail.jpg","path":"img/study/bwh_order_detail.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_detail_pc.jpg","path":"img/study/bwh_order_detail_pc.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_order_pay_complete.jpg","path":"img/study/bwh_order_pay_complete.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_service_detail.jpg","path":"img/study/bwh_service_detail.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_service_info.jpg","path":"img/study/bwh_service_info.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_ss_mac_os.jpg","path":"img/study/bwh_ss_mac_os.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_ss_windows.jpg","path":"img/study/bwh_ss_windows.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/ios02.jpg","path":"img/swift/ios02.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/ios01.jpg","path":"img/swift/ios01.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/ios03.jpg","path":"img/swift/ios03.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/ios04.jpg","path":"img/swift/ios04.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/swift-playground.png","path":"img/swift/swift-playground.png","modified":0,"renderable":0},{"_id":"source/img/android/android-studio-file-templates-add.jpg","path":"img/android/android-studio-file-templates-add.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_all.jpg","path":"img/life/coffee_all.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_latte.jpg","path":"img/life/coffee_latte.jpg","modified":0,"renderable":0},{"_id":"source/img/life/coffee_macchiato.jpg","path":"img/life/coffee_macchiato.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/http1xstream.png","path":"img/okhttp/http1xstream.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realcall03.png","path":"img/okhttp/realcall03.png","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_ss_completed.jpg","path":"img/study/bwh_kiwi_ss_completed.jpg","modified":0,"renderable":0},{"_id":"source/img/study/bwh_kiwi_ss_info.jpg","path":"img/study/bwh_kiwi_ss_info.jpg","modified":0,"renderable":0},{"_id":"source/img/swift/ios05.jpg","path":"img/swift/ios05.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/dispatcher01.png","path":"img/okhttp/dispatcher01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realcall01.png","path":"img/okhttp/realcall01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/streamallocation01.png","path":"img/okhttp/streamallocation01.png","modified":0,"renderable":0},{"_id":"source/img/study/command/bwh_kiwivm_command.jpg","path":"img/study/command/bwh_kiwivm_command.jpg","modified":0,"renderable":0},{"_id":"source/img/study/command/termius_connect.jpg","path":"img/study/command/termius_connect.jpg","modified":0,"renderable":0},{"_id":"source/img/study/jenkins/centenos_jenkins_first.jpg","path":"img/study/jenkins/centenos_jenkins_first.jpg","modified":0,"renderable":0},{"_id":"source/img/study/jenkins/jenkins_install_plugin_first.jpg","path":"img/study/jenkins/jenkins_install_plugin_first.jpg","modified":0,"renderable":0},{"_id":"source/img/study/jenkins/jenkins_install_complete.jpg","path":"img/study/jenkins/jenkins_install_complete.jpg","modified":0,"renderable":0},{"_id":"source/img/study/jenkins/jenkins_install_setting.jpg","path":"img/study/jenkins/jenkins_install_setting.jpg","modified":0,"renderable":0},{"_id":"source/img/okhttp/realcall02.png","path":"img/okhttp/realcall02.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realconnection02.png","path":"img/okhttp/realconnection02.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realinterceptorchain01.png","path":"img/okhttp/realinterceptorchain01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/responsebody01.png","path":"img/okhttp/responsebody01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/callserverinterceptor01.png","path":"img/okhttp/callserverinterceptor01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/realconnection01.png","path":"img/okhttp/realconnection01.png","modified":0,"renderable":0},{"_id":"source/img/okhttp/streamallocation02.png","path":"img/okhttp/streamallocation02.png","modified":0,"renderable":0},{"_id":"source/img/android/android-ui-rv.gif","path":"img/android/android-ui-rv.gif","modified":0,"renderable":0}],"Cache":[{"_id":"themes/yilia/README.md","hash":"1bf755806af9d8874bd22e1abbdaaa24328ef4dc","modified":1516958338000},{"_id":"themes/yilia/_config.yml","hash":"e9359e167fe392876ddcc9fbdf577feda48ea1d2","modified":1526821465750},{"_id":"themes/yilia/package.json","hash":"367cb9579d35968a942c243ab248a5f5ebfaf462","modified":1516958338000},{"_id":"themes/yilia/webpack.config.js","hash":"05ba46a4ae744272f5312e684928910dccad3755","modified":1516958338000},{"_id":"source/_posts/.DS_Store","hash":"5eb684d920df19383701f550be7a4804989d54af","modified":1517476965726},{"_id":"source/_posts/about.md","hash":"5fedeeb4ffaf439a14e7b5fa8ff92035575360cd","modified":1517391337812},{"_id":"source/_posts/git-md.md","hash":"134bd0a0fc1313709e36f83679a4c1b2588da819","modified":1517391337816},{"_id":"source/_posts/hello-world.md","hash":"ca96e48b017e4cae9646b9a55203e0959eb20c44","modified":1517391337816},{"_id":"source/_posts/macOS-android-path.md","hash":"4284415b12c9255f0377ff5f08d0071ac094ae5c","modified":1517461142518},{"_id":"source/img/avatar.png","hash":"bf7ee6f6f9f85c9f788a1e07d47422b151cfe093","modified":1517391337822},{"_id":"themes/yilia/languages/default.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1516958338000},{"_id":"themes/yilia/languages/fr.yml","hash":"84ab164b37c6abf625473e9a0c18f6f815dd5fd9","modified":1516958338000},{"_id":"themes/yilia/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1516958338000},{"_id":"themes/yilia/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1516958338000},{"_id":"themes/yilia/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1516958338000},{"_id":"themes/yilia/languages/zh-CN.yml","hash":"ca40697097ab0b3672a80b455d3f4081292d1eed","modified":1516958338000},{"_id":"themes/yilia/languages/zh-tw.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1516958338000},{"_id":"themes/yilia/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1516958338000},{"_id":"themes/yilia/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1516958338000},{"_id":"themes/yilia/layout/index.ejs","hash":"a35dc900203f9d8dd863ea4c1722198d6d457ec8","modified":1516958338000},{"_id":"themes/yilia/layout/layout.ejs","hash":"0a332bdbd3b86c231d690614687f5b97186b85d5","modified":1516958338000},{"_id":"themes/yilia/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1516958338000},{"_id":"themes/yilia/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1516958338000},{"_id":"themes/yilia/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1516958338000},{"_id":"themes/yilia/source/main.0cf68a.css","hash":"ddf6e2c6b953c2c59a3c271e6070010a4cc81cf9","modified":1516958338000},{"_id":"themes/yilia/source/slider.e37972.js","hash":"6dec4e220c89049037eebc44404abd8455d22ad7","modified":1516958338000},{"_id":"themes/yilia/source-src/css.ejs","hash":"94dbdb02ca11849e415d54fb28546a598f2cffb1","modified":1516958338000},{"_id":"themes/yilia/source-src/script.ejs","hash":"c21381e1317db7bb157f1d182b8c088cb7cba411","modified":1516958338000},{"_id":"source/img/AliPay.jpeg","hash":"5dbe2d7575cffc7723952613be3ac2077d2aa30b","modified":1517391337821},{"_id":"source/img/Wechat.jpeg","hash":"d4a51681d99f12329357f39f3f674d10553990f9","modified":1517391337822},{"_id":"themes/yilia/layout/_partial/toc.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1516958338000},{"_id":"themes/yilia/source/main.0cf68a.js","hash":"993fadeb5f6d296e9d997a49ee20dc97333ceab7","modified":1516958338000},{"_id":"themes/yilia/source/mobile.992cbe.js","hash":"01b35e71e37aa2849664eb5daf26daede2278398","modified":1516958338000},{"_id":"source/_posts/Swift/swift-basic.md","hash":"f36631abb8ab4afb4e237d310df753a26db4aa4a","modified":1526821465678},{"_id":"source/_posts/Swift/swift-life-cycle.md","hash":"5568ed2189520bfe0816b0a1f365e3e523f7d82c","modified":1526821465679},{"_id":"source/_posts/Swift/swift-record.md","hash":"c3d02d3e879113bc35ad4a89d63a80bdb869a167","modified":1526821465679},{"_id":"source/_posts/Swift/swift-skill.md","hash":"20466de4bc399e6c96a6b0fd2e67b8adb8ffa730","modified":1526821465679},{"_id":"source/_posts/android/android-animation.md","hash":"5412d5a345053227e14804f9ff74c03e1af1c71e","modified":1526821465680},{"_id":"source/_posts/android/android-config-activity.md","hash":"ab730c494852e1b19c63ce698917e6755d4fff55","modified":1517391337812},{"_id":"source/_posts/android/android-config-am.md","hash":"8f51083275ef0d5e4b916cf77538d76232e26c60","modified":1517391337812},{"_id":"source/_posts/android/android-context.md","hash":"74021a73b75a957dd9aa219c34a2e6fad8eb7884","modified":1526821465680},{"_id":"source/_posts/android/android-customer-annotations.md","hash":"be195a127c1f7a51384ae919e2d712c0c72e7e03","modified":1526821465680},{"_id":"source/_posts/android/android-guides.md","hash":"97573cb5b4c40ee6380ed440b96d6efde41384a4","modified":1517391337813},{"_id":"source/_posts/android/android-okhttp-source.md","hash":"67b63897b4f0adb0a43f094baff6748cb2a486a7","modified":1517391337813},{"_id":"source/_posts/android/android-okhttp.md","hash":"074d0287100335b9e6dda3bb937a1af5b62135b1","modified":1517391337813},{"_id":"source/_posts/android/android-shape.md","hash":"952467fb57ec74cc6aee10a90818de025d82d702","modified":1517391337813},{"_id":"source/_posts/android/android-tips.md","hash":"dea3d4c4a4effe6a725e781447c4f857b3355a0f","modified":1526821465681},{"_id":"source/_posts/android/android-studio-templates.md","hash":"f7a969e403c4c3d4172afafc02819e4f2df515cd","modified":1526821465681},{"_id":"source/_posts/android/android-ui-rv.md","hash":"0f76a1f0c8fb8ef489699e8421d7dedc928fb9c4","modified":1526821465681},{"_id":"source/_posts/android/android-view-textview.md","hash":"e65c5f97250b84e119ed416c7cf18cdab8652f2f","modified":1526821465682},{"_id":"source/_posts/android/android-vr.md","hash":"7c8d24b703f48788732e7634c8808164e16c878a","modified":1517391337813},{"_id":"source/_posts/android/kotlin-annotations.md","hash":"096130828be31d4edec207a6493ac4b4d488c293","modified":1526821465682},{"_id":"source/_posts/android/kotlin-class.md","hash":"82b1dfd47d4bd69937c7100c8dfe013dd37f610c","modified":1526821465682},{"_id":"source/_posts/android/kotlin-collections.md","hash":"5b80e824fe9096871601f228168e6ceb22c29ceb","modified":1526821465682},{"_id":"source/_posts/android/kotlin-delegation.md","hash":"60ece3e077060d6204d1cc6e81d41afbe059a041","modified":1526821465682},{"_id":"source/_posts/android/kotlin-extensions.md","hash":"14ac5466bd5fd8345bdce585e123eeb95652b18a","modified":1526821465683},{"_id":"source/_posts/android/kotlin-operator.md","hash":"77f4cfed8d570f2ccf8a9653c73489aa3ef708fe","modified":1526821465683},{"_id":"source/_posts/android/kotlin-ranges.md","hash":"f1b7ac2dc87bf25f7a2ff7e2704d42121d36bc33","modified":1526821465683},{"_id":"source/_posts/android/kotlin-reflection.md","hash":"08e79090b96140cc087c059936626eeda0b868db","modified":1526821465683},{"_id":"source/_posts/android/kotlin-tips.md","hash":"ab87df43548d890776221d0cb0768780a900cd3b","modified":1526821465683},{"_id":"source/_posts/blogs/android-blogs.md","hash":"0d52358c0bca7377039548ebf6eecf235ec203a7","modified":1526821465684},{"_id":"source/_posts/blogs/blogs.md","hash":"7bb935a0d8ae953eeab37c3023636644d28016da","modified":1526821465685},{"_id":"source/_posts/blogs/js-blogs.md","hash":"466684dfe8467955642a396810a34d10cb74dc6e","modified":1517391337814},{"_id":"source/_posts/blogs/program-blog.md","hash":"d02f0b3ad7f753267eaf279a304124692345c1bf","modified":1526821465685},{"_id":"source/_posts/fe/css-background.md","hash":"9078401cda1be535961549ff98858086ad741c62","modified":1517391337814},{"_id":"source/_posts/fe/css-border.md","hash":"6ef493d10630be3d5365c18a10a6fa5f4d0d3f85","modified":1517391337815},{"_id":"source/_posts/fe/react-native-flex.md","hash":"33561c2488d64b0ba9d619db18a7102489ab338f","modified":1517391337815},{"_id":"source/_posts/fe/react-native-text.md","hash":"506e7ced0d97a37b1145f504baa4aaffff114395","modified":1517391337815},{"_id":"source/_posts/fe/react-native-view.md","hash":"e2088d080b5fb3123524cc53152e8a4c14bc2a2a","modified":1517391337815},{"_id":"source/_posts/fe/regular-expression.md","hash":"cc6987a78ffebe2f09524ef9823ef2c0d668a0eb","modified":1517391337815},{"_id":"source/_posts/flutter/flutter-started.md","hash":"0e287ba0edc45b91f22a86d66bde69f22a70402c","modified":1526821465685},{"_id":"source/_posts/hole/hexo-error.md","hash":"f38f004888fe506f8cbc6dcb7788ea0ed4ee52e2","modified":1517403856295},{"_id":"source/_posts/hole/android-gradle.md","hash":"499eb63173e1af83241d5cb026132326a49447af","modified":1526821465685},{"_id":"source/_posts/hole/hole-android-js-wxpay.md","hash":"e80543b81aa1d39cc39145528e77d43f1152a1d5","modified":1517391337816},{"_id":"source/_posts/hole/jenkins-android.md","hash":"e028f485d3423465dd63d9fad31025597a0d9b31","modified":1517391337816},{"_id":"source/_posts/ios/ios-stanford.md","hash":"b3aca798705be531a4694490238b440cd18f3b18","modified":1517391337817},{"_id":"source/_posts/java/java-annotation-runtime.md","hash":"5159aadb3205114f64d7fcd31b826d1180952cdd","modified":1526821465685},{"_id":"source/_posts/java/java-annotation-class.md","hash":"69f5aa4cd09c078a6fb4eda3323fff9e39d50352","modified":1526821465685},{"_id":"source/_posts/java/java-annotations-processor.md","hash":"27657f084bd95fe07b43ee18b34488da2eab703f","modified":1526821465686},{"_id":"source/_posts/java/java-annotations-source.md","hash":"ed000e891788252d6fa56700ca8515279e51b979","modified":1526821465686},{"_id":"source/_posts/java/java-annotations.md","hash":"3a08a67e8918ec865ed1a5524ba58ddc66fe919c","modified":1526821465686},{"_id":"source/_posts/java/java-reflection.md","hash":"c2e593d89bc05e0f170d914455e3df93cd59a1a6","modified":1526821465686},{"_id":"source/_posts/java/java8-lambda.md","hash":"37263bfdf1389747c033940ae027548666264789","modified":1517391337818},{"_id":"source/_posts/java/java8-stream.md","hash":"afa7c3e4c9d72bc5e38cc0b5cd4ca2a701161d60","modified":1517391337818},{"_id":"source/_posts/life/life-coffee.md","hash":"479e832629fa4ed7439d8bb46b2ce0301be6cfe3","modified":1526821465686},{"_id":"source/_posts/life/life-flag-2018.md","hash":"cd7d063e7d1a7ff32a0bf2351866d0d285092672","modified":1529591287231},{"_id":"source/_posts/life/life.md","hash":"5f858b675e0e56d3d60fc450fb0e48c86d62f029","modified":1526821465687},{"_id":"source/_posts/poetry/poetry-english.md","hash":"6724c5bc8d36a442a08f99a055acd6e7e08b5860","modified":1526821465687},{"_id":"source/_posts/poetry/poetry-heart.md","hash":"0cfe4710421245415b7b2deedede0d89428783ec","modified":1526821465687},{"_id":"source/_posts/poetry/poetry-love.md","hash":"84169bf5ab9ee7b7442dc0a6b24645f6ee5a8b1c","modified":1526821465687},{"_id":"source/_posts/poetry/poetry-zen.md","hash":"c5a8f113be56761919b4aff6ccd7afaa36fe8dae","modified":1526821465688},{"_id":"source/_posts/refactor/refactor-demo.md","hash":"929bf293e788557cab6fdcdce8451f5af744505c","modified":1517391337819},{"_id":"source/_posts/refactor/refactor.md","hash":"e70227c9f4deb76974d41c8293e321df1710a038","modified":1517391337819},{"_id":"source/_posts/smile/smile-global.md","hash":"de495ff2d239fb9b2b0d8ee8778837a86be4dbf6","modified":1526821465688},{"_id":"source/_posts/smile/smile-programmer.md","hash":"920168a4ed77148e4b345dec9a9c5b85eb8043d9","modified":1526821465688},{"_id":"source/_posts/study/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1526821464427},{"_id":"source/_posts/study/Centenos.md","hash":"d41f7c5b6a4416c852ddeec8eeed6c88dee68916","modified":1526821465688},{"_id":"source/_posts/study/Linux.md","hash":"dfccefebd51fa8636ce5e284c2542976338a489d","modified":1517391337820},{"_id":"source/_posts/study/hexo.md","hash":"d6229e2825b10b3bed5f9c00b5e5408d2a94d0f3","modified":1526821465688},{"_id":"source/_posts/study/mac-os-tips.md","hash":"54d0a0cd6d791f4476a0640686ec284195a784f3","modified":1526821465688},{"_id":"source/_posts/study/study-bwh-ss.md","hash":"56dd57f8d01c44b2d419d5763e796fd6857f6609","modified":1526821465689},{"_id":"source/_posts/study/study-bwh-ssr.md","hash":"50467480375e551a2353db6f491d0d0ababd69e6","modified":1526821465689},{"_id":"source/_posts/study/study-bwh.md","hash":"21d0c591462250f14b6f85769c4334344937e30a","modified":1526821465689},{"_id":"source/_posts/study/study-centos-gitlab.md","hash":"a9ebc7505971a55686accba686f4c3a72ce4937e","modified":1517479473484},{"_id":"source/_posts/study/study-centos-jenkins.md","hash":"163a63bf8273640c02861c97a0ec071a05a8dff6","modified":1526821465689},{"_id":"source/_posts/study/study-centos-owncloud.md","hash":"3e0a0fbed750254358767a772b7f954bbd5ee5b5","modified":1526821465689},{"_id":"source/_posts/study/study-centos-ssh.md","hash":"14f58dd6c5b9f52f9626281fa4ac4e309426db9f","modified":1526821465690},{"_id":"source/_posts/study/study-ubuntu-bbr.md","hash":"64ce63048c63bc477141b9ff826d8bd8f96e2be2","modified":1526821465690},{"_id":"source/_posts/study/study-ubuntu-nextcloud.md","hash":"cb1813b2bc8f845782fdd40cc7cef429753e25ab","modified":1526821465690},{"_id":"source/img/android/android-studio-file-templates-add-show.jpg","hash":"84e4205256a29128d8fa6028a750e0f22bc28eef","modified":1526821465692},{"_id":"source/img/android/android-studio-live-templates-add-show.jpg","hash":"faf5388ca5f10d1bb0660dcbb7555ab37e5e57fa","modified":1526821465698},{"_id":"source/img/android/android-studio-live-templates-toast.jpg","hash":"ae5a14fb892bae2c9756e3fe0cb77a70d0803102","modified":1526821465699},{"_id":"source/img/css/background-origin.png","hash":"5c43393b96f914b7f26935ebe82c2eaa447f486e","modified":1517391337822},{"_id":"source/img/hole/hole-gradle-dists.jpg","hash":"a508824a033d9e84fe03ab08de4fc6fe1ab663a2","modified":1526821465735},{"_id":"source/img/okhttp/connectinterceptor01.jpg","hash":"f335514fb056006d028652e621b77014b1ec630c","modified":1517391337826},{"_id":"source/img/okhttp/dispatcher01.jpg","hash":"6291f27f8666577f4ff248d578c289f57637e24c","modified":1517391337827},{"_id":"source/img/okhttp/dispatcher02.jpg","hash":"70d4a075e52b06090fe9dcaca6bc7195a8ebca8d","modified":1517391337829},{"_id":"source/img/okhttp/dispatcher02.png","hash":"de8050568c44292208816b039338381959c56985","modified":1517391337830},{"_id":"source/img/okhttp/http1xstream.jpg","hash":"1c873ed20778a4f6c0d4efb5ff23a91991badeef","modified":1517391337830},{"_id":"source/img/okhttp/okhttpclient01.jpg","hash":"5786510e637b34afebe8591492bedbf5abb48604","modified":1517391337832},{"_id":"source/img/okhttp/platform01.jpg","hash":"1ea945d7a75bcb43e3074f801448686a82ccf901","modified":1517391337833},{"_id":"source/img/okhttp/platform01.png","hash":"1992019dbb6c165b216e0dcba95914cb28e7ac06","modified":1517391337833},{"_id":"source/img/okhttp/realcall01.jpg","hash":"b11b1d9460a19964a6612b925eb2839237bfb694","modified":1517391337834},{"_id":"source/img/okhttp/realcall03.jpg","hash":"3bd8d80a4fc2f01ba6a43fdc20dcd4937abf8ba0","modified":1517391337837},{"_id":"source/img/okhttp/streamallocation01.jpg","hash":"cc3563c358ec99356ab6e115f781fcfb9fbe48a9","modified":1517391337849},{"_id":"source/img/study/bwh_kiwi_new_os_info.jpg","hash":"7aba2f5aee9715b0e92f5bcf502aad14feaf4abe","modified":1517391337859},{"_id":"source/img/study/bwh_order_location.jpg","hash":"3610dfcdd03d1ca938c41417c8d7300a1f8f4f04","modified":1517391337864},{"_id":"source/img/study/bwh_order_pay.jpg","hash":"2bbeaedd8426dcb5a62759c8cf6f8d129322085a","modified":1517391337864},{"_id":"source/img/study/bwh_ss_client.jpg","hash":"8055a17779ea5654cdd1ea6cbab6a6abfea80a30","modified":1517391337867},{"_id":"source/img/study/bwh_ss_complete.jpg","hash":"2fa205b565d9ed16d881ea23bc4381df8d6dc205","modified":1517391337867},{"_id":"source/img/swift/ios01.jp2","hash":"007ab27bca42afcf491f1af09aaa85fa05dcf5e5","modified":1517391337873},{"_id":"source/img/swift/swift-sin.png","hash":"7d77224eff300552a1cfd825187cca63f96545c9","modified":1517391337879},{"_id":"themes/yilia/layout/_partial/after-footer.ejs","hash":"b86b248720ad415ec1b5fee53fb583776c776f83","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/archive-post.ejs","hash":"1f7d4819b7f67602c4a1b99871808d2160b60978","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/archive.ejs","hash":"a6e94061ac55b9eb55275f87b608d62f6ea35659","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/article.ejs","hash":"630c6ec866d056657d3d91e34b4c64eb993c0654","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/aside.ejs","hash":"8edbd7993b9b061611a193533a664e2e85eae748","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/baidu-analytics.ejs","hash":"f0e6e88f9f7eb08b8fe51449a8a3016273507924","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/css.ejs","hash":"236f8a377b2e4e35754319c3029bcd4a4115431d","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/footer.ejs","hash":"f2994e0acd1d606ebf4680afc4fa652e148ccf4e","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/head.ejs","hash":"64f092186b5a744aa1603ce22bb1d44a34446add","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/header.ejs","hash":"6387a93dad7c3d778eb91e3821852fbf6813880c","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/left-col.ejs","hash":"183d7ca4ba8e7c80694ffdc8cf39957092238346","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/mathjax.ejs","hash":"151a1ef2173ba7b6789d349f0f8da89616cc1394","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/mobile-nav.ejs","hash":"7fbbfabf5e29525b24ada14613c21a26789132b4","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/tools.ejs","hash":"c41341b9618e591538e1136a2d1637587c1bbd90","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/viewer.ejs","hash":"e495790b2abe2290875817e42bd505bc611d3e26","modified":1516958338000},{"_id":"themes/yilia/source/fonts/default-skin.b257fa.svg","hash":"2ac727c9e092331d35cce95af209ccfac6d4c7c7","modified":1516958338000},{"_id":"themes/yilia/source/fonts/iconfont.16acc2.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1516958338000},{"_id":"themes/yilia/source/fonts/iconfont.45d7ee.svg","hash":"f9304e5714d20861be7d8f4d36687e88e86b9e1b","modified":1516958338000},{"_id":"themes/yilia/source/fonts/iconfont.8c627f.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1516958338000},{"_id":"themes/yilia/source/fonts/iconfont.b322fa.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1516958338000},{"_id":"themes/yilia/source/fonts/tooltip.4004ff.svg","hash":"397fe4b1093bf9b62457dac48aa15dac06b54a3c","modified":1516958338000},{"_id":"themes/yilia/source/img/default-skin.png","hash":"ed95a8e40a2c3478c5915376acb8e5f33677f24d","modified":1516958338000},{"_id":"themes/yilia/source/img/preloader.gif","hash":"6342367c93c82da1b9c620e97c84a389cc43d96d","modified":1516958338000},{"_id":"themes/yilia/source/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1516958338000},{"_id":"themes/yilia/source-src/css/_core.scss","hash":"24f347a2412abbf58318369152504da9538f8d3b","modified":1516958338000},{"_id":"themes/yilia/source-src/css/_function.scss","hash":"93a50dd19a93485712da1f8d0a1672482dd1eabc","modified":1516958338000},{"_id":"themes/yilia/source-src/css/archive.scss","hash":"7d27e22ac898e8fafec14549e940c73cbea1fba8","modified":1516958338000},{"_id":"themes/yilia/source-src/css/article-inner.scss","hash":"d79f2d35a06de83a2a226ca790b7a0a34789c115","modified":1516958338000},{"_id":"themes/yilia/source-src/css/article-main.scss","hash":"3fad68bd74260326f83090b0974dd80707e7bac7","modified":1516958338000},{"_id":"themes/yilia/source-src/css/article-nav.scss","hash":"43e507f2a48504079afd9471353337e23ca47470","modified":1516958338000},{"_id":"themes/yilia/source-src/css/article.scss","hash":"0f6d61af99ed4db87f8589db1feaea7747b55963","modified":1516958338000},{"_id":"themes/yilia/source-src/css/aside.scss","hash":"578a67464dd0f542197f7fcee158c991db058563","modified":1516958338000},{"_id":"themes/yilia/source-src/css/comment.scss","hash":"cafe3834017a3bf47420f37543725025225a2c89","modified":1516958338000},{"_id":"themes/yilia/source-src/css/fonts.scss","hash":"97b8fba41c914145710b90091f400b845879577f","modified":1516958338000},{"_id":"themes/yilia/source-src/css/footer.scss","hash":"7c995410b25baaf61dfc5e148e22ca60330abcd3","modified":1516958338000},{"_id":"themes/yilia/source-src/css/global.scss","hash":"b4cb4f45a55d4250cd9056f76dab2a3c0dabcec4","modified":1516958338000},{"_id":"themes/yilia/source-src/css/grid.scss","hash":"849a29fcd7150214fcf7b9715fa5dc71d1f9b896","modified":1516958338000},{"_id":"themes/yilia/source-src/css/highlight.scss","hash":"3719994c2c9393813cc1d42b657205c368a329cb","modified":1516958338000},{"_id":"themes/yilia/source-src/css/left.scss","hash":"0d30c0e7cdb831c3881a017006c782f2214ac195","modified":1516958338000},{"_id":"themes/yilia/source-src/css/main.scss","hash":"2f86a014af93583caba78a563d9549826bf28294","modified":1516958338000},{"_id":"themes/yilia/source-src/css/mobile-slider.scss","hash":"f053c609d84df0dd9eee1d11ddf0c19163a456be","modified":1516958338000},{"_id":"themes/yilia/source-src/css/mobile.scss","hash":"ace041d72f95b419f6a5e443191703c2b62007f4","modified":1516958338000},{"_id":"themes/yilia/source-src/css/page.scss","hash":"bf206bb7f7d0967bc8b7fdf01b7ffc99aff9ba88","modified":1516958338000},{"_id":"themes/yilia/source-src/css/reward.scss","hash":"80a4fcf9171d4a33235da96ac8a2b7dcabc45dfb","modified":1516958338000},{"_id":"themes/yilia/source-src/css/scroll.scss","hash":"9c8dfd1c76854ef063494ca76fac6360b391ed6d","modified":1516958338000},{"_id":"themes/yilia/source-src/css/share.scss","hash":"150c6425f6582e7ec78a873256ce49c9930e8805","modified":1516958338000},{"_id":"themes/yilia/source-src/css/social.scss","hash":"724162ccf3977e70a45d189abfaa20b6e2fba87b","modified":1516958338000},{"_id":"themes/yilia/source-src/css/tags-cloud.scss","hash":"c8aa84fca93862d3caae77c552873b8610f33327","modified":1516958338000},{"_id":"themes/yilia/source-src/css/tags.scss","hash":"ac67a3c7097849206244db9b0ba91daaba017ef5","modified":1516958338000},{"_id":"themes/yilia/source-src/css/tools.scss","hash":"1b1aa0908e58cf942b28e3881d07c5573c4129e1","modified":1516958338000},{"_id":"themes/yilia/source-src/css/tooltip.scss","hash":"53d5a554bc2f38e9bb3d26400a47767013c05216","modified":1516958338000},{"_id":"themes/yilia/source-src/js/Q.js","hash":"d011af172064b6c6e0c7051d8f9879373ddac113","modified":1516958338000},{"_id":"themes/yilia/source-src/js/anm.js","hash":"4a4c5d82b09a3063f91a434388e6aa064fd7fd98","modified":1516958338000},{"_id":"themes/yilia/source-src/js/aside.js","hash":"754f771264548a6c5a8ad842908e59ae4e7ed099","modified":1516958338000},{"_id":"themes/yilia/source-src/js/browser.js","hash":"04095b38cfd4316a23f8eb14b1ffaf95f78a4260","modified":1516958338000},{"_id":"themes/yilia/source-src/js/fix.js","hash":"d6782d53c992e712af39c84e804eccaf38830b94","modified":1516958338000},{"_id":"themes/yilia/source-src/js/main.js","hash":"3894e60827c817319e43c9ff3ed045fc3d7336ce","modified":1516958338000},{"_id":"themes/yilia/source-src/js/mobile.js","hash":"4d823b039fd296d24a454eae5a798b93c44560cb","modified":1516958338000},{"_id":"themes/yilia/source-src/js/report.js","hash":"4f1d9a18a936ce40b037f636a39127dd19175b6e","modified":1516958338000},{"_id":"themes/yilia/source-src/js/share.js","hash":"b090f82cf80cba7da764753906d9e2cc2acdf30d","modified":1516958338000},{"_id":"themes/yilia/source-src/js/slider.js","hash":"e846bcc5aac9c68b93f7b8de353df54d8d29f666","modified":1516958338000},{"_id":"themes/yilia/source-src/js/util.js","hash":"8456e9d6b19532742582c99b2fb9d09e146e1c58","modified":1516958338000},{"_id":"themes/yilia/source-src/js/viewer.js","hash":"2577deb6a9fe4f5436360b2ce9afcc7f9a7f0116","modified":1516958338000},{"_id":"source/img/android/android-studio-file-tempates-add-complete.jpg","hash":"dd3591f90aaefef0e480f8b6b3343da9620d2b0d","modified":1526821465692},{"_id":"source/img/android/android-studio-file-templates-show.jpg","hash":"825a58089317752e563aab6430b2c1b2421ef9ab","modified":1526821465695},{"_id":"source/img/android/android-studio-live-templates-add-complete.jpg","hash":"5435c2b05f0caeb05f144522385e4c178dd642f7","modified":1526821465695},{"_id":"source/img/android/android-studio-live-templates-add-detail.jpg","hash":"f4ee36b569c9a60c208c4a44ce0e137410f1976a","modified":1526821465698},{"_id":"source/img/android/android-studio-live-templates-add.jpg","hash":"fa7be75e43cb29c02098572fe123a7b28dd96351","modified":1526821465699},{"_id":"source/img/android/android-studio-live-templates.jpg","hash":"06d702c5f99c6455e8d350ad0eb1066519ee8af5","modified":1526821465700},{"_id":"source/img/android/android-stuido-file-templates.jpg","hash":"02133f6f8c4ed5095e6b336e4190efad5a861b8b","modified":1526821465701},{"_id":"source/img/life/coffee_americano.jpg","hash":"5cf32933fe0582585ffc30bfa475367730b05ace","modified":1526821465739},{"_id":"source/img/life/coffee_cappuccino.jpg","hash":"873ff7cdca13708af45fb3210b179b22c9c48f09","modified":1526821465740},{"_id":"source/img/life/coffee_espresso.jpg","hash":"89bd412ab49ebb71fd1f9214c19c006c3b38f866","modified":1526821465742},{"_id":"source/img/life/coffee_espresso_con_panna.jpg","hash":"a46cf7ca93a30023f386609dec23e1bd23970cc7","modified":1526821465744},{"_id":"source/img/life/coffee_macha.jpg","hash":"a1a37e966846363e590ee67b4de84d438811e6e0","modified":1526821465749},{"_id":"source/img/okhttp/callserverinterceptor01.jpg","hash":"c246d272c0208807935457d3125f83ca8613232b","modified":1517391337823},{"_id":"source/img/okhttp/connectinterceptor01.png","hash":"aca6bb68d6f188cf697c90558a97cdcc7e259aef","modified":1517391337826},{"_id":"source/img/okhttp/okhttpclient01.png","hash":"12ed2e62c750014ebfe0dba4d22f7d6b56de4c38","modified":1517391337832},{"_id":"source/img/okhttp/realcall02.jpg","hash":"e1ceef143c374ba93b5554a09694b1c45232b2c6","modified":1517391337835},{"_id":"source/img/okhttp/realconnection01.jpg","hash":"116e40a48b46d6fe8670f300d749f3b4244b91a0","modified":1517391337839},{"_id":"source/img/okhttp/realconnection02.jpg","hash":"8aa8b5cdc99dcf7c7c0c91a0ebd29068d082d256","modified":1517391337842},{"_id":"source/img/okhttp/realinterceptorchain01.jpg","hash":"520441630ed481d48361507b5844f2aae7578fe1","modified":1517391337844},{"_id":"source/img/okhttp/responsebody01.jpg","hash":"a34e8e5cfdc9bf95d33d3d15c8f7ff1abf04f82c","modified":1517391337847},{"_id":"source/img/okhttp/streamallocation02.jpg","hash":"15bc92deec95c949c2d868f8056eda901275d5b0","modified":1517391337851},{"_id":"source/img/study/bwh_home.jpg","hash":"51cffe9c9685e817e78fcd0698ba90ae5668f125","modified":1517391337853},{"_id":"source/img/study/bwh_home_client_area_top.jpg","hash":"f663f922acd26a70f0af57f4e0ce10160219a444","modified":1517391337854},{"_id":"source/img/study/bwh_home_client_ares.jpg","hash":"8e3d742491af01ce71ad327a360dc8d9db7e32f9","modified":1517391337854},{"_id":"source/img/study/bwh_home_services.jpg","hash":"f957fd1f14fed5ab34cda9a89509172f3f98ea55","modified":1517391337855},{"_id":"source/img/study/bwh_home_services_detail.jpg","hash":"1bc513558289f267a6907669089818811eaf48ce","modified":1517391337855},{"_id":"source/img/study/bwh_host.jpg","hash":"b579f820ccda3fcd2ccd6d4c582dca34343e10fa","modified":1517391337856},{"_id":"source/img/study/bwh_kiwi_all.jpg","hash":"8ea6373e39eea619d7cf817ab94821ce0a9ea932","modified":1517391337856},{"_id":"source/img/study/bwh_kiwi_main.jpg","hash":"25ddd8b63c9a62adeadcacfda17c2d738d27f015","modified":1517391337857},{"_id":"source/img/study/bwh_kiwi_main_new.jpg","hash":"36d0224350ce8c7780f6428d3dd5b2cb339693d4","modified":1517391337857},{"_id":"source/img/study/bwh_kiwi_new_os.jpg","hash":"f2c31714e20ed6760fa31e09981c242f9206b9f5","modified":1517391337858},{"_id":"source/img/study/bwh_kiwi_ss.jpg","hash":"215b060216bc5c1a408a9e249b55f2970eb1bc14","modified":1517391337859},{"_id":"source/img/study/bwh_kiwi_ss_install.jpg","hash":"a1e36cd0285b9ca99c3138f9761d36d3797c4a28","modified":1517391337861},{"_id":"source/img/study/bwh_order_complete.jpg","hash":"8404e253d78a67c042fb4cc96745506cf6075aef","modified":1517391337862},{"_id":"source/img/study/bwh_order_cycle.jpg","hash":"ca383bbaf276aa06b269983614baf2cd794c42b2","modified":1517391337862},{"_id":"source/img/study/bwh_order_cycle_more.jpg","hash":"90496fcbcb5899c6837c396fff230a8f112aa5b6","modified":1517391337862},{"_id":"source/img/study/bwh_order_detail.jpg","hash":"0a9019b25504efca6c4da3546f6c73088a5bea29","modified":1517391337863},{"_id":"source/img/study/bwh_order_detail_pc.jpg","hash":"897102bc6964308045357999811e205d6a0af345","modified":1517391337863},{"_id":"source/img/study/bwh_order_pay_complete.jpg","hash":"f7466dececd964f78a4e5f79632946f511e146a4","modified":1517391337865},{"_id":"source/img/study/bwh_service_detail.jpg","hash":"2c6fa688b5ded62a89d5dd18e18d54e9c9de361e","modified":1517391337865},{"_id":"source/img/study/bwh_service_info.jpg","hash":"2569f5faa1e777f5b268a37a52892931295c68aa","modified":1517391337866},{"_id":"source/img/study/bwh_ss_mac_os.jpg","hash":"d7240ad29c6417ac2b2f2ce51dbd890eb7ce6ccc","modified":1517391337868},{"_id":"source/img/study/bwh_ss_windows.jpg","hash":"fd77de9dc44c5469b879ff36423af330f94b1018","modified":1517391337869},{"_id":"source/img/swift/ios02.jpg","hash":"4130fad707d4a29eb2e4e85427ab0c6c86eb46c3","modified":1517391337875},{"_id":"source/img/swift/ios01.jpg","hash":"36e9c27f9a2adbd626f8e2c8046553cba219e18b","modified":1517391337874},{"_id":"source/img/swift/ios03.jpg","hash":"d0c0cade9c51ad15e3d9a46203be6baae8dc4667","modified":1517391337876},{"_id":"source/img/swift/ios04.jpg","hash":"279a5f7cf9d2af32f06fd892612e04c635d2ec4e","modified":1517391337877},{"_id":"source/img/swift/swift-playground.png","hash":"51bf1501eb27de68559f14a293f0d7273166de95","modified":1517391337879},{"_id":"themes/yilia/layout/_partial/script.ejs","hash":"4cb685f07e89dd5175c2a576e73a1a957aec5637","modified":1516958338000},{"_id":"source/img/android/android-studio-file-templates-add.jpg","hash":"4b3c337247dd5cf6159a3d051de862a8e72ddef4","modified":1526821465694},{"_id":"source/img/life/coffee_all.jpg","hash":"7b498cd8b354bd7125d452a148d9c591e591a475","modified":1526821465738},{"_id":"source/img/life/coffee_latte.jpg","hash":"ea844b301469b75259a2691a8bfed8dc0c786603","modified":1526821465746},{"_id":"source/img/life/coffee_macchiato.jpg","hash":"3133d44e27a853b81592ee7e24abbc10f7ddacc4","modified":1526821465748},{"_id":"source/img/okhttp/http1xstream.png","hash":"60287e9c7a3ba895e70894270d1cae1c92bf5dd6","modified":1517391337831},{"_id":"source/img/okhttp/realcall03.png","hash":"df86d3f53cabe41b33070cbe01a213d5ec08695a","modified":1517391337838},{"_id":"source/img/study/bwh_kiwi_ss_completed.jpg","hash":"98322b8919827aa9d7adf2627c2428b1f6b65a4e","modified":1517391337860},{"_id":"source/img/study/bwh_kiwi_ss_info.jpg","hash":"d6a12ad5b6b9618023bb1a53dda7307f9e5a48b3","modified":1517391337861},{"_id":"source/img/swift/ios05.jpg","hash":"706d3c48b5d1d7e8b362fbbea5a48e757f98f4e9","modified":1517391337878},{"_id":"themes/yilia/layout/_partial/post/category.ejs","hash":"0809a4829aabeb4e911a3ed04ec28db4df7dfe3f","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/changyan.ejs","hash":"5f99b55980da64a723a8e14d5a7daba0d6504647","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/date.ejs","hash":"ef71c4081e866a494367575c59610e7e6339ece0","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/duoshuo.ejs","hash":"e8399025ed3b980aedb821c92855889f5f12fd5b","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/gitment.ejs","hash":"e68bbac9ffb1ad27b56837c9abad6ed6bb7daa0c","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/nav.ejs","hash":"1036c8e4e1a7bc935ba173744da735a0d6ed09cd","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/share.ejs","hash":"5dccfbe165b23a101f1333cc65ed8efbd197453c","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/tag.ejs","hash":"2e783e68755abb852760eb0e627a3fbb50a05a55","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1516958338000},{"_id":"themes/yilia/layout/_partial/post/wangyiyun.ejs","hash":"ea41c462168d9697caef9485862e9cac718a12c1","modified":1516958338000},{"_id":"themes/yilia/source-src/css/core/_animation.scss","hash":"63a37f26276f9207405afe0f2d65339ce295bbaf","modified":1516958338000},{"_id":"themes/yilia/source-src/css/core/_media-queries.scss","hash":"491ab3378d5c11005ba65c607608bb36b368a9d5","modified":1516958338000},{"_id":"themes/yilia/source-src/css/core/_mixin.scss","hash":"3bba5c77bad5981eac859fe05c9561d580ba7fa9","modified":1516958338000},{"_id":"themes/yilia/source-src/css/core/_reset.scss","hash":"fab871fa93bd542e76a71a56428f2994a4aaf443","modified":1516958338000},{"_id":"themes/yilia/source-src/css/core/_variables.scss","hash":"fb511c505d1309249f21dc577d4ad2bad99a764f","modified":1516958338000},{"_id":"themes/yilia/source-src/css/fonts/iconfont.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1516958338000},{"_id":"themes/yilia/source-src/css/fonts/iconfont.svg","hash":"f9304e5714d20861be7d8f4d36687e88e86b9e1b","modified":1516958338000},{"_id":"themes/yilia/source-src/css/fonts/iconfont.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1516958338000},{"_id":"themes/yilia/source-src/css/fonts/iconfont.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1516958338000},{"_id":"themes/yilia/source-src/css/img/checkered-pattern.png","hash":"049262fa0886989d750637b264bed34ab51c23c8","modified":1516958338000},{"_id":"themes/yilia/source-src/css/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1516958338000},{"_id":"themes/yilia/source-src/css/img/tooltip.svg","hash":"397fe4b1093bf9b62457dac48aa15dac06b54a3c","modified":1516958338000},{"_id":"source/img/okhttp/dispatcher01.png","hash":"df05338891ca71520221c6e59d39433de63a66be","modified":1517391337829},{"_id":"source/img/okhttp/realcall01.png","hash":"fb060edbb560c4ee860e5cd7269780c0fe92124e","modified":1517391337835},{"_id":"source/img/okhttp/streamallocation01.png","hash":"84877023749d024938e07f5552be91a1dee3130d","modified":1517391337850},{"_id":"source/img/study/command/bwh_kiwivm_command.jpg","hash":"c043eded88b5bf45a5d6176b5ad2247434786fc0","modified":1517391337869},{"_id":"source/img/study/command/termius_connect.jpg","hash":"3ee3a3df1b1e867176de7fcbb5bff53d9cdd85ea","modified":1517391337870},{"_id":"source/img/study/jenkins/centenos_jenkins_first.jpg","hash":"5df30946bff364687242cba76365bcdd5332f006","modified":1517391337871},{"_id":"source/img/study/jenkins/jenkins_install_plugin_first.jpg","hash":"6fc8663d8a50a680636e584ec858c7299b470e61","modified":1517391337872},{"_id":"source/img/study/jenkins/jenkins_install_complete.jpg","hash":"1f20a36ebf5f02f9992ff9f2a5f6d83ee988f86a","modified":1517391337871},{"_id":"source/img/study/jenkins/jenkins_install_setting.jpg","hash":"c17320d603b1b3bd76739768ff60434fbafc9794","modified":1517391337872},{"_id":"source/img/okhttp/realcall02.png","hash":"1219c2af91ba0a50a0a913ed7f5d5b521ae4146c","modified":1517391337837},{"_id":"source/img/okhttp/realconnection02.png","hash":"eeed8c4bd1398b02ed73929ff4f9fe430febf15b","modified":1517391337844},{"_id":"source/img/okhttp/realinterceptorchain01.png","hash":"af50327d33614287738fc874cd149a5fd298a2c2","modified":1517391337846},{"_id":"source/img/okhttp/responsebody01.png","hash":"eea70d7688782ee62b0a21866548a09e38526dda","modified":1517391337848},{"_id":"source/img/okhttp/callserverinterceptor01.png","hash":"1bcdd27bcd57abaa2e1fa4118492784a2b1c00c2","modified":1517391337825},{"_id":"source/img/okhttp/realconnection01.png","hash":"f7dcfcdeb9a0d18dc88230172728dec23c0b1eb9","modified":1517391337841},{"_id":"source/img/okhttp/streamallocation02.png","hash":"a54be015fd8d3beff372e9adbd376935190e7898","modified":1517391337853},{"_id":"source/img/android/android-ui-rv.gif","hash":"5c3355163db5b1a9600ed86cf8c585b1fbee1d54","modified":1526821465733},{"_id":"public/content.json","hash":"55ca54a5a04f6dbc2d85389fb0b64a0a743427d2","modified":1529591302534},{"_id":"public/2018/05/11/smile/smile-programmer/index.html","hash":"4f76f886b4bc3b8520a4d3f2612be7a5a4fcbd4f","modified":1529591303288},{"_id":"public/2018/05/11/poetry/poetry-zen/index.html","hash":"8ba5751946230c846c2b9ab5c2acc257733db4c7","modified":1529591303288},{"_id":"public/2018/05/11/smile/smile-global/index.html","hash":"738e4eac93f0711f406fb7f1871bf3d8b138d1d1","modified":1529591303288},{"_id":"public/2018/05/11/poetry/poetry-heart/index.html","hash":"e18a0a18dc8219ea3f27ecffb8ecfec41975eb0e","modified":1529591303288},{"_id":"public/2018/05/11/poetry/poetry-love/index.html","hash":"6d70221611816f80ac3983f3970c31d0714c9a66","modified":1529591303288},{"_id":"public/2018/05/11/poetry/poetry-english/index.html","hash":"960dcf21bf805be9603dad77f37e1e64b695fef5","modified":1529591303288},{"_id":"public/2018/04/27/java/java-reflection/index.html","hash":"f0ccabdc4c7f4c123bd00c10d5fe269297b775e5","modified":1529591303288},{"_id":"public/2018/04/13/java/java-annotation-class/index.html","hash":"309596b81cbe215f3ed5cb49e5d1ce6111de80f5","modified":1529591303288},{"_id":"public/2018/04/18/java/java-annotations-processor/index.html","hash":"e75068a981e4ea1326aab8b5a268e3a74cd7d1a0","modified":1529591303288},{"_id":"public/2018/04/13/java/java-annotation-runtime/index.html","hash":"634b8c366e11fc7220d3cb66617aafed06d70cce","modified":1529591303288},{"_id":"public/2018/04/13/java/java-annotations-source/index.html","hash":"4c9d2a8e2a891f9b13022e6e02270d8509d7b43a","modified":1529591303289},{"_id":"public/2018/04/12/java/java-annotations/index.html","hash":"07d1ed0556c3ad8dacc4de2c0bf0bff46047e05b","modified":1529591303289},{"_id":"public/2018/04/11/android/android-customer-annotations/index.html","hash":"cb6da5593d7c486fc54a5121ec051bee80628490","modified":1529591303289},{"_id":"public/2018/04/10/life/life-coffee/index.html","hash":"24d21220c636be90538437628cd2dc6411a3ac6f","modified":1529591303289},{"_id":"public/2018/04/10/android/android-view-textview/index.html","hash":"cb8914f82e217cd89e3b174b5ab2d25812c4ae13","modified":1529591303289},{"_id":"public/2018/03/30/blogs/program-blog/index.html","hash":"9a402f836449cdc27b1f56b45f1d9eb6ac22e1a8","modified":1529591303289},{"_id":"public/2018/03/30/study/study-ubuntu-bbr/index.html","hash":"1a3c73087a78612ed20c0a147b89c36ee3e1c895","modified":1529591303289},{"_id":"public/2018/03/23/study/study-ubuntu-nextcloud/index.html","hash":"3f7d89e479a45ec538393fff94f9583547913883","modified":1529591303290},{"_id":"public/2018/03/19/android/kotlin-tips/index.html","hash":"d5d64e706cc5b5d1145b204ef7d1f59ff11f0aa5","modified":1529591303290},{"_id":"public/2018/03/14/android/kotlin-collections/index.html","hash":"a4334be6e85d3ac440fc9d6880046e6f499a55cb","modified":1529591303290},{"_id":"public/2018/03/13/android/kotlin-extensions/index.html","hash":"fb31a444932f2a6a4a653794b7f3c98207e18fb9","modified":1529591303290},{"_id":"public/2018/03/12/android/kotlin-annotations/index.html","hash":"60b368d6c6e72dea1247c77c80c8785046a3f564","modified":1529591303290},{"_id":"public/2018/03/12/android/kotlin-reflection/index.html","hash":"b4b7d4ff6b8f7d1a162755406e3cf7d5393f9575","modified":1529591303290},{"_id":"public/2018/03/09/flutter/flutter-started/index.html","hash":"2ed237c965137adb650529140aeb39d1fc364f63","modified":1529591303290},{"_id":"public/2018/03/09/android/kotlin-delegation/index.html","hash":"d366f149d6449a5669177b55dd36a7a8c0d3b9bb","modified":1529591303290},{"_id":"public/2018/03/08/android/kotlin-ranges/index.html","hash":"9e953fc93d1ef2663cb96dd933686a98c562f9d7","modified":1529591303291},{"_id":"public/2018/03/06/android/android-ui-rv/index.html","hash":"f0587ba88ec224704a85243e9a7b4ee8fdea7026","modified":1529591303291},{"_id":"public/2018/03/05/android/android-studio-templates/index.html","hash":"65406976257d0fbe816419e515896cf5a93f2d9e","modified":1529591303291},{"_id":"public/2018/03/02/android/kotlin-operator/index.html","hash":"0735b3b9be99383a977a90c67fa226e422d0c2c3","modified":1529591303291},{"_id":"public/2018/03/02/android/kotlin-class/index.html","hash":"fa8c8e89934c4ed810e6ed1e07d59c6c46c72078","modified":1529591303291},{"_id":"public/2018/02/26/life/life-flag-2018/index.html","hash":"dd7289ec6e38d703d18378aa073cf74a721605e4","modified":1529591303291},{"_id":"public/2018/02/26/study/study-bwh-ssr/index.html","hash":"83fa252f58ffbe4a18391774a691d971b3fb41ea","modified":1529591303291},{"_id":"public/2018/02/07/study/study-centos-owncloud/index.html","hash":"1f7be0ef39b93cebb9c1e50b248a61850df5e75d","modified":1529591303291},{"_id":"public/2018/02/07/hole/android-gradle/index.html","hash":"ea346fbb01698a24090d343dc7a1f6657b5c3675","modified":1529591303292},{"_id":"public/2018/02/01/study/study-centos-gitlab/index.html","hash":"27d62d85ebe554f075ee80a7710cbd9963320868","modified":1529591303292},{"_id":"public/2018/02/01/macOS-android-path/index.html","hash":"1062ec980576f7c43a7dc04eb7c4daee4a3b8ba6","modified":1529591303292},{"_id":"public/2018/01/31/hello-world/index.html","hash":"1e110ae78263edc81b19e2dc2cd0f1371e0b8762","modified":1529591303292},{"_id":"public/2018/01/30/hole/hole-android-js-wxpay/index.html","hash":"d7a7dbf3d60a5bd4ab2b35faf0f71b678f811667","modified":1529591303292},{"_id":"public/2018/01/30/study/study-centos-ssh/index.html","hash":"0bd9ef8f3dd9a4b3e0c5d270ed528275117a3d67","modified":1529591303292},{"_id":"public/2018/01/30/hole/hexo-error/index.html","hash":"b388a84fc6bf28914c0fc54e2b9d7fe8655fdb75","modified":1529591303292},{"_id":"public/2018/01/29/study/study-centos-jenkins/index.html","hash":"5bcdfdf22c97ab8226abb4ba532e1facbad2f45a","modified":1529591303292},{"_id":"public/2018/01/26/study/study-bwh-ss/index.html","hash":"ae11ad62dacb64caafd2f20cef458c5473341a6c","modified":1529591303293},{"_id":"public/2018/01/25/study/Centenos/index.html","hash":"d03a19ae19c946504911cffa5a6733c8fff6736a","modified":1529591303293},{"_id":"public/2018/01/25/study/Linux/index.html","hash":"7b2ebbf4c73bf3b0f99a6f0b6a80a3b4ef8bbe47","modified":1529591303293},{"_id":"public/2018/01/25/study/study-bwh/index.html","hash":"661fadb53d3b480f3fbbfe526c6b485e6116c940","modified":1529591303293},{"_id":"public/2017/07/12/fe/css-background/index.html","hash":"1bd43b2bbc9614e26d36aab5e457d3d7530830fe","modified":1529591303293},{"_id":"public/2017/07/11/fe/css-border/index.html","hash":"4343b020adaae4ed9dd86038c85c20c26da4b4e1","modified":1529591303293},{"_id":"public/2017/07/07/hole/jenkins-android/index.html","hash":"b3a1d477635317d7eea8c104a8b68fafe7024724","modified":1529591303293},{"_id":"public/2017/05/09/git-md/index.html","hash":"40f74a202dbb99145405a0dfda33bfa42264b9e5","modified":1529591303293},{"_id":"public/2017/05/03/life/life/index.html","hash":"d8e5778148430765ece8113b00f461e4943999cd","modified":1529591303294},{"_id":"public/2017/05/03/android/android-vr/index.html","hash":"5fa0868b5dad20a3bfbd2451d58fca18631b7bef","modified":1529591303294},{"_id":"public/2017/03/21/refactor/refactor-demo/index.html","hash":"48f0a25b5a11ecfa506d890022127b528c3d51b2","modified":1529591303294},{"_id":"public/2017/03/10/android/android-okhttp-source/index.html","hash":"aaedbd525537e9d111cec7228a21bea1d1b82041","modified":1529591303294},{"_id":"public/2017/02/23/android/android-config-activity/index.html","hash":"832a25f95041f34a6ac12ed6592705e53348161a","modified":1529591303294},{"_id":"public/2017/02/22/android/android-config-am/index.html","hash":"973807d80767a849646008b7c58de026cbfd28c8","modified":1529591303294},{"_id":"public/2017/02/13/android/android-guides/index.html","hash":"2667dba651eb915e4b60f639811fa79ed6043ec4","modified":1529591303294},{"_id":"public/2017/02/10/study/mac-os-tips/index.html","hash":"044047cc9b2dd81cada0c5aee17c7aa94299f8a4","modified":1529591303295},{"_id":"public/2017/02/09/refactor/refactor/index.html","hash":"c45aade11520c0acbf35ae46fcf2f8cf6f8544be","modified":1529591303295},{"_id":"public/2017/02/06/android/android-okhttp/index.html","hash":"ad9433a550d592556204b9e682d2f27146c692d8","modified":1529591303295},{"_id":"public/2017/01/10/blogs/js-blogs/index.html","hash":"ad7ac26691f793dd45543ea95124ce768967878f","modified":1529591303295},{"_id":"public/2017/01/10/blogs/android-blogs/index.html","hash":"d50002b926b42c009053dcfe3b4169b08b8421bc","modified":1529591303295},{"_id":"public/2017/01/10/blogs/blogs/index.html","hash":"666743c49295a8c50aa04bd365549b196960d011","modified":1529591303295},{"_id":"public/2016/08/29/fe/react-native-flex/index.html","hash":"609e440393904faacb7e75d80f997e90d602f32b","modified":1529591303295},{"_id":"public/2016/08/22/fe/react-native-text/index.html","hash":"db099dd0b7337b57c2aaeb20e86d27d6314da222","modified":1529591303295},{"_id":"public/2016/08/22/fe/react-native-view/index.html","hash":"ffca5a38e2bfc47526c9961327d0507a429029c9","modified":1529591303296},{"_id":"public/2016/08/22/study/hexo/index.html","hash":"29dffac21a4e44a1e1bdb97b89f1caa82635cf73","modified":1529591303296},{"_id":"public/2016/06/30/Swift/swift-life-cycle/index.html","hash":"00a9de058de591c2c74da73187d768f3b6604939","modified":1529591303296},{"_id":"public/2016/06/22/ios/ios-stanford/index.html","hash":"9fbbc9c46f7b8d6ad8ea3dce21ba2adf20894654","modified":1529591303296},{"_id":"public/2016/06/22/Swift/swift-record/index.html","hash":"e1077c82d1e1929a8cc003bc85baaf7de3dfae65","modified":1529591303296},{"_id":"public/2016/05/31/android/android-tips/index.html","hash":"f4dce595a15e086638c0da3d8210ea18c85042c8","modified":1529591303296},{"_id":"public/2016/05/23/fe/regular-expression/index.html","hash":"c3d9fce3dfd4754874a2a489fdd9cec224967313","modified":1529591303296},{"_id":"public/2016/05/22/Swift/swift-skill/index.html","hash":"0b3ea3852994781580836494eff2101058a44b50","modified":1529591303296},{"_id":"public/2016/05/21/android/android-context/index.html","hash":"94790ba548cacd1ead2860568143e47deaec0f94","modified":1529591303297},{"_id":"public/2016/05/21/Swift/swift-basic/index.html","hash":"37e54df4ac3f3bdb82d19c5b296d55a1440814c6","modified":1529591303297},{"_id":"public/2016/05/19/java/java8-stream/index.html","hash":"f70c8c71c4f1290700789e45b2b5c67d450551e5","modified":1529591303297},{"_id":"public/2016/05/19/java/java8-lambda/index.html","hash":"c1f5c33c3310588ad6dfc823c327c13db947189e","modified":1529591303297},{"_id":"public/2016/05/19/android/android-animation/index.html","hash":"a31082d0753debafca6826c890f86d6097a9e961","modified":1529591303297},{"_id":"public/2016/05/18/about/index.html","hash":"0a7bced8faeea010c2cf889d64cbc67bc48ef8d6","modified":1529591303297},{"_id":"public/2016/05/18/android/android-shape/index.html","hash":"0bd025e52bf8aa376f0d76e0ca68d2d1df99418a","modified":1529591303297},{"_id":"public/archives/index.html","hash":"1709ada615a3686b6bb53214ebe1b25afa053336","modified":1529591303298},{"_id":"public/archives/page/2/index.html","hash":"a5da6422fbb36eb5444fb16be089492f169132f2","modified":1529591303298},{"_id":"public/archives/page/3/index.html","hash":"ba9c69135288f3c80e04ddf039f5f6c0d6956287","modified":1529591303298},{"_id":"public/archives/page/4/index.html","hash":"4a74e08585aa9452d733ce0ba872f701ba967c52","modified":1529591303298},{"_id":"public/archives/page/5/index.html","hash":"37aa663dfb9bd8a732f8e437cc6bdc52b6e9b4a7","modified":1529591303298},{"_id":"public/archives/page/6/index.html","hash":"534fa596acbb04bab6f72526123f787441fe8a63","modified":1529591303298},{"_id":"public/archives/page/7/index.html","hash":"7b6bb99a22a3d148a29b0a9656fc47c051299e31","modified":1529591303298},{"_id":"public/archives/page/8/index.html","hash":"78b1433abf8c10608f77ec86f3ba6ca8c7f7f928","modified":1529591303298},{"_id":"public/archives/2016/index.html","hash":"c99fc472972f5b90fdb11c6e8ca6ceffa2b11794","modified":1529591303299},{"_id":"public/archives/2016/page/2/index.html","hash":"b866edd4ee22691206e5ea08d0b3b87e6f47f0fa","modified":1529591303299},{"_id":"public/archives/2016/05/index.html","hash":"90abf22f59920be5bff46ab6b6b366b26f45b1b1","modified":1529591303299},{"_id":"public/archives/2016/06/index.html","hash":"742a06cf7e760dd0191f2880e6cf40f035cfbda7","modified":1529591303299},{"_id":"public/archives/2016/08/index.html","hash":"2026d2748c0312689dd3f22f58e595fad0d4ec91","modified":1529591303299},{"_id":"public/archives/2017/index.html","hash":"a3e0089f0b9f839fcde2dbd1598d44c50e918896","modified":1529591303299},{"_id":"public/archives/2017/page/2/index.html","hash":"1bbe990efa284df26c24087a78f4c22165bbf9c6","modified":1529591303299},{"_id":"public/archives/2017/01/index.html","hash":"527cefd6b6d89a3970eceb063b9e3577c82fa6f1","modified":1529591303299},{"_id":"public/archives/2017/02/index.html","hash":"9086b5be17bad99aed8552081ec0a319c52dab13","modified":1529591303300},{"_id":"public/archives/2017/03/index.html","hash":"404577db9eb1e13e9de8c936026e6acebca78b7d","modified":1529591303300},{"_id":"public/archives/2017/05/index.html","hash":"d56e4fb83d6da9828a3ddbed93b02a20bc7b4ede","modified":1529591303300},{"_id":"public/archives/2017/07/index.html","hash":"0ad0b7458012178cf06d8275d473544b37cf6272","modified":1529591303300},{"_id":"public/archives/2018/index.html","hash":"a4083501aa21ea2203e1ea0585c674c22d8dc868","modified":1529591303300},{"_id":"public/archives/2018/page/2/index.html","hash":"51a78be259dd40a9548918739cb29985ea78b954","modified":1529591303300},{"_id":"public/archives/2018/page/3/index.html","hash":"59b6e1e0d4f9158689e1b71e2ede4681061142a6","modified":1529591303300},{"_id":"public/archives/2018/page/4/index.html","hash":"217d76344f61ef800c88e755d35f36698a8641ca","modified":1529591303300},{"_id":"public/archives/2018/page/5/index.html","hash":"f448e0e5cefd4ca7c45d2246786ed807ff149a9f","modified":1529591303301},{"_id":"public/archives/2018/01/index.html","hash":"b0936e1c67299212b4d76f966000949f168e0ed3","modified":1529591303301},{"_id":"public/archives/2018/02/index.html","hash":"be6193ff8035b464f6bd27f7dfb911ad553e809a","modified":1529591303301},{"_id":"public/archives/2018/03/index.html","hash":"c9c036ae4dbf067a035e2f8619db12c8639e7d7d","modified":1529591303301},{"_id":"public/archives/2018/03/page/2/index.html","hash":"76ba5c24b2aa31b33358769b5dff331b233e7010","modified":1529591303301},{"_id":"public/archives/2018/04/index.html","hash":"df07eff6438f9e5b13b266ece66e0cab5febfde1","modified":1529591303301},{"_id":"public/archives/2018/05/index.html","hash":"5d8c689becbd7254f94af46157f9eca7d33b7107","modified":1529591303301},{"_id":"public/index.html","hash":"99958ef479adc591de05574d3899e273670e686a","modified":1529591303301},{"_id":"public/page/2/index.html","hash":"a3de553622eafb9894d7ccd5eef716600d57f253","modified":1529591303302},{"_id":"public/page/3/index.html","hash":"151cc98757f7bc17db915f59cd7f1aed40ed92f1","modified":1529591303302},{"_id":"public/page/4/index.html","hash":"653a57c485a3b79067e02fd3a9829165a4f67c43","modified":1529591303302},{"_id":"public/page/5/index.html","hash":"3d920bfcca4afbb7facb9dd2a567c351740c7945","modified":1529591303302},{"_id":"public/page/6/index.html","hash":"4962c48cae65c65ed55639093b65e675ed3aeb16","modified":1529591303302},{"_id":"public/page/7/index.html","hash":"1d6592e57a26ceeeb393eec9b98ce8be01c43197","modified":1529591303302},{"_id":"public/page/8/index.html","hash":"37697188d3f4d7d2d2660056cd340176dc15c129","modified":1529591303302},{"_id":"public/tags/me/index.html","hash":"16c7cccd08eeb5daed734766578d3e71e4ef3b2e","modified":1529591303303},{"_id":"public/tags/study/index.html","hash":"10d3e5478f64cc9cf6285effc387c3e119108135","modified":1529591303303},{"_id":"public/tags/study/page/2/index.html","hash":"40df6f32c1ddcb8463a881c32777d0dde656accb","modified":1529591303303},{"_id":"public/tags/ios/index.html","hash":"6ecba82ddfaca2ce7b61787d535739bc7b7de9e5","modified":1529591303303},{"_id":"public/tags/android/index.html","hash":"51aeb410762b8f7a3e83bb4fde108304e1969def","modified":1529591303303},{"_id":"public/tags/android/page/2/index.html","hash":"f0297155f359463d5ef4366ce8cc7b49f06f837b","modified":1529591303303},{"_id":"public/tags/kotlin/index.html","hash":"8937fb0550275f2ba71f2056915f5822201908af","modified":1529591303303},{"_id":"public/tags/blog/index.html","hash":"6bbc7a2039152d201a8bf3e11e6ca6350d6c3d3d","modified":1529591303303},{"_id":"public/tags/fe/index.html","hash":"6d38fa4ab9ec29dcde90c5b28b585737b77e4881","modified":1529591303303},{"_id":"public/tags/hole/index.html","hash":"0eca6e2de6e4668ea1506cfdd12ab7269850966f","modified":1529591303304},{"_id":"public/tags/stanford/index.html","hash":"18af0c8e846817546648ce67847b31a5a2ef0e84","modified":1529591303304},{"_id":"public/tags/java/index.html","hash":"1b8c66e6246947d250701f36fea9d56488f92ad4","modified":1529591303304},{"_id":"public/tags/Annotation/index.html","hash":"4172f2b59bde22959e254c6bfb2527d0efccc04b","modified":1529591303304},{"_id":"public/tags/lambda/index.html","hash":"9efcbdcca05bc1217cd92fc0e92b93e0a77ca46c","modified":1529591303304},{"_id":"public/tags/stream/index.html","hash":"1f2ae59ddac86cd27af461b959ecd47c133e2c2b","modified":1529591303304},{"_id":"public/tags/life/index.html","hash":"90ffcb358d6d881e72c25da2a5eb7e8453fc1203","modified":1529591303304},{"_id":"public/tags/poetry/index.html","hash":"96dd380f8450ca223f7c43fe56df8e1a8d2c592e","modified":1529591303304},{"_id":"public/tags/read/index.html","hash":"3e1195a788ecbf2c47fe4d56d1c5f33acb52c4d4","modified":1529591303305},{"_id":"public/tags/smile/index.html","hash":"1d9b7f56d80c66bfcbcf9ecd7e6e64c967f1c80c","modified":1529591303305},{"_id":"public/img/avatar.png","hash":"bf7ee6f6f9f85c9f788a1e07d47422b151cfe093","modified":1529591303316},{"_id":"public/img/android/android-studio-file-templates-add-show.jpg","hash":"84e4205256a29128d8fa6028a750e0f22bc28eef","modified":1529591303316},{"_id":"public/img/android/android-studio-live-templates-add-show.jpg","hash":"faf5388ca5f10d1bb0660dcbb7555ab37e5e57fa","modified":1529591303316},{"_id":"public/img/android/android-studio-live-templates-toast.jpg","hash":"ae5a14fb892bae2c9756e3fe0cb77a70d0803102","modified":1529591303316},{"_id":"public/img/css/background-origin.png","hash":"5c43393b96f914b7f26935ebe82c2eaa447f486e","modified":1529591303316},{"_id":"public/img/okhttp/dispatcher01.jpg","hash":"6291f27f8666577f4ff248d578c289f57637e24c","modified":1529591303316},{"_id":"public/img/okhttp/dispatcher02.jpg","hash":"70d4a075e52b06090fe9dcaca6bc7195a8ebca8d","modified":1529591303316},{"_id":"public/img/hole/hole-gradle-dists.jpg","hash":"a508824a033d9e84fe03ab08de4fc6fe1ab663a2","modified":1529591303316},{"_id":"public/img/okhttp/connectinterceptor01.jpg","hash":"f335514fb056006d028652e621b77014b1ec630c","modified":1529591303316},{"_id":"public/img/okhttp/dispatcher02.png","hash":"de8050568c44292208816b039338381959c56985","modified":1529591303316},{"_id":"public/img/okhttp/http1xstream.jpg","hash":"1c873ed20778a4f6c0d4efb5ff23a91991badeef","modified":1529591303316},{"_id":"public/img/okhttp/okhttpclient01.jpg","hash":"5786510e637b34afebe8591492bedbf5abb48604","modified":1529591303316},{"_id":"public/img/okhttp/platform01.jpg","hash":"1ea945d7a75bcb43e3074f801448686a82ccf901","modified":1529591303316},{"_id":"public/img/okhttp/platform01.png","hash":"1992019dbb6c165b216e0dcba95914cb28e7ac06","modified":1529591303316},{"_id":"public/img/okhttp/realcall01.jpg","hash":"b11b1d9460a19964a6612b925eb2839237bfb694","modified":1529591303316},{"_id":"public/img/okhttp/realcall03.jpg","hash":"3bd8d80a4fc2f01ba6a43fdc20dcd4937abf8ba0","modified":1529591303316},{"_id":"public/img/okhttp/streamallocation01.jpg","hash":"cc3563c358ec99356ab6e115f781fcfb9fbe48a9","modified":1529591303317},{"_id":"public/img/study/bwh_kiwi_new_os_info.jpg","hash":"7aba2f5aee9715b0e92f5bcf502aad14feaf4abe","modified":1529591303317},{"_id":"public/img/study/bwh_order_pay.jpg","hash":"2bbeaedd8426dcb5a62759c8cf6f8d129322085a","modified":1529591303317},{"_id":"public/img/study/bwh_order_location.jpg","hash":"3610dfcdd03d1ca938c41417c8d7300a1f8f4f04","modified":1529591303317},{"_id":"public/img/study/bwh_ss_client.jpg","hash":"8055a17779ea5654cdd1ea6cbab6a6abfea80a30","modified":1529591303317},{"_id":"public/img/study/bwh_ss_complete.jpg","hash":"2fa205b565d9ed16d881ea23bc4381df8d6dc205","modified":1529591303317},{"_id":"public/img/swift/ios01.jp2","hash":"007ab27bca42afcf491f1af09aaa85fa05dcf5e5","modified":1529591303317},{"_id":"public/fonts/default-skin.b257fa.svg","hash":"2ac727c9e092331d35cce95af209ccfac6d4c7c7","modified":1529591303317},{"_id":"public/img/swift/swift-sin.png","hash":"7d77224eff300552a1cfd825187cca63f96545c9","modified":1529591303317},{"_id":"public/fonts/iconfont.16acc2.ttf","hash":"f342ac8bf4d937f42a7d6a0032ad267ab47eb7f2","modified":1529591303317},{"_id":"public/fonts/iconfont.45d7ee.svg","hash":"f9304e5714d20861be7d8f4d36687e88e86b9e1b","modified":1529591303317},{"_id":"public/fonts/iconfont.8c627f.woff","hash":"aa9672cb097f7fd73ae5a03bcd3d9d726935bc0a","modified":1529591303317},{"_id":"public/fonts/iconfont.b322fa.eot","hash":"bc8c5e88f4994a852041b4d83f126d9c4d419b4a","modified":1529591303317},{"_id":"public/fonts/tooltip.4004ff.svg","hash":"397fe4b1093bf9b62457dac48aa15dac06b54a3c","modified":1529591303317},{"_id":"public/img/default-skin.png","hash":"ed95a8e40a2c3478c5915376acb8e5f33677f24d","modified":1529591303317},{"_id":"public/img/preloader.gif","hash":"6342367c93c82da1b9c620e97c84a389cc43d96d","modified":1529591303317},{"_id":"public/img/scrollbar_arrow.png","hash":"d64a33c4ddfbdb89deeb6f4e3d36eb84dc4777c0","modified":1529591303317},{"_id":"public/img/AliPay.jpeg","hash":"5dbe2d7575cffc7723952613be3ac2077d2aa30b","modified":1529591303327},{"_id":"public/img/Wechat.jpeg","hash":"d4a51681d99f12329357f39f3f674d10553990f9","modified":1529591303327},{"_id":"public/img/android/android-studio-file-tempates-add-complete.jpg","hash":"dd3591f90aaefef0e480f8b6b3343da9620d2b0d","modified":1529591303328},{"_id":"public/img/android/android-studio-file-templates-show.jpg","hash":"825a58089317752e563aab6430b2c1b2421ef9ab","modified":1529591303328},{"_id":"public/img/android/android-studio-live-templates-add-complete.jpg","hash":"5435c2b05f0caeb05f144522385e4c178dd642f7","modified":1529591303328},{"_id":"public/img/android/android-studio-live-templates-add-detail.jpg","hash":"f4ee36b569c9a60c208c4a44ce0e137410f1976a","modified":1529591303328},{"_id":"public/img/android/android-studio-live-templates-add.jpg","hash":"fa7be75e43cb29c02098572fe123a7b28dd96351","modified":1529591303328},{"_id":"public/img/android/android-studio-live-templates.jpg","hash":"06d702c5f99c6455e8d350ad0eb1066519ee8af5","modified":1529591303328},{"_id":"public/img/android/android-stuido-file-templates.jpg","hash":"02133f6f8c4ed5095e6b336e4190efad5a861b8b","modified":1529591303328},{"_id":"public/img/life/coffee_cappuccino.jpg","hash":"873ff7cdca13708af45fb3210b179b22c9c48f09","modified":1529591303329},{"_id":"public/img/life/coffee_espresso.jpg","hash":"89bd412ab49ebb71fd1f9214c19c006c3b38f866","modified":1529591303329},{"_id":"public/img/life/coffee_americano.jpg","hash":"5cf32933fe0582585ffc30bfa475367730b05ace","modified":1529591303329},{"_id":"public/img/life/coffee_espresso_con_panna.jpg","hash":"a46cf7ca93a30023f386609dec23e1bd23970cc7","modified":1529591303329},{"_id":"public/img/life/coffee_macha.jpg","hash":"a1a37e966846363e590ee67b4de84d438811e6e0","modified":1529591303329},{"_id":"public/img/okhttp/callserverinterceptor01.jpg","hash":"c246d272c0208807935457d3125f83ca8613232b","modified":1529591303329},{"_id":"public/img/okhttp/connectinterceptor01.png","hash":"aca6bb68d6f188cf697c90558a97cdcc7e259aef","modified":1529591303329},{"_id":"public/img/okhttp/okhttpclient01.png","hash":"12ed2e62c750014ebfe0dba4d22f7d6b56de4c38","modified":1529591303329},{"_id":"public/img/okhttp/realcall02.jpg","hash":"e1ceef143c374ba93b5554a09694b1c45232b2c6","modified":1529591303329},{"_id":"public/img/okhttp/realconnection01.jpg","hash":"116e40a48b46d6fe8670f300d749f3b4244b91a0","modified":1529591303330},{"_id":"public/img/okhttp/realconnection02.jpg","hash":"8aa8b5cdc99dcf7c7c0c91a0ebd29068d082d256","modified":1529591303330},{"_id":"public/img/okhttp/realinterceptorchain01.jpg","hash":"520441630ed481d48361507b5844f2aae7578fe1","modified":1529591303330},{"_id":"public/img/okhttp/streamallocation02.jpg","hash":"15bc92deec95c949c2d868f8056eda901275d5b0","modified":1529591303330},{"_id":"public/img/okhttp/responsebody01.jpg","hash":"a34e8e5cfdc9bf95d33d3d15c8f7ff1abf04f82c","modified":1529591303330},{"_id":"public/img/study/bwh_home.jpg","hash":"51cffe9c9685e817e78fcd0698ba90ae5668f125","modified":1529591303330},{"_id":"public/img/study/bwh_home_client_ares.jpg","hash":"8e3d742491af01ce71ad327a360dc8d9db7e32f9","modified":1529591303330},{"_id":"public/img/study/bwh_home_client_area_top.jpg","hash":"f663f922acd26a70f0af57f4e0ce10160219a444","modified":1529591303330},{"_id":"public/img/study/bwh_home_services.jpg","hash":"f957fd1f14fed5ab34cda9a89509172f3f98ea55","modified":1529591303330},{"_id":"public/img/study/bwh_home_services_detail.jpg","hash":"1bc513558289f267a6907669089818811eaf48ce","modified":1529591303330},{"_id":"public/img/study/bwh_host.jpg","hash":"b579f820ccda3fcd2ccd6d4c582dca34343e10fa","modified":1529591303330},{"_id":"public/img/study/bwh_kiwi_main.jpg","hash":"25ddd8b63c9a62adeadcacfda17c2d738d27f015","modified":1529591303331},{"_id":"public/img/study/bwh_kiwi_all.jpg","hash":"8ea6373e39eea619d7cf817ab94821ce0a9ea932","modified":1529591303331},{"_id":"public/img/study/bwh_kiwi_main_new.jpg","hash":"36d0224350ce8c7780f6428d3dd5b2cb339693d4","modified":1529591303331},{"_id":"public/img/study/bwh_kiwi_new_os.jpg","hash":"f2c31714e20ed6760fa31e09981c242f9206b9f5","modified":1529591303331},{"_id":"public/img/study/bwh_kiwi_ss.jpg","hash":"215b060216bc5c1a408a9e249b55f2970eb1bc14","modified":1529591303331},{"_id":"public/img/study/bwh_kiwi_ss_install.jpg","hash":"a1e36cd0285b9ca99c3138f9761d36d3797c4a28","modified":1529591303331},{"_id":"public/img/study/bwh_order_complete.jpg","hash":"8404e253d78a67c042fb4cc96745506cf6075aef","modified":1529591303331},{"_id":"public/img/study/bwh_order_cycle.jpg","hash":"ca383bbaf276aa06b269983614baf2cd794c42b2","modified":1529591303331},{"_id":"public/img/study/bwh_order_cycle_more.jpg","hash":"90496fcbcb5899c6837c396fff230a8f112aa5b6","modified":1529591303331},{"_id":"public/img/study/bwh_order_detail.jpg","hash":"0a9019b25504efca6c4da3546f6c73088a5bea29","modified":1529591303331},{"_id":"public/img/study/bwh_order_detail_pc.jpg","hash":"897102bc6964308045357999811e205d6a0af345","modified":1529591303332},{"_id":"public/img/study/bwh_order_pay_complete.jpg","hash":"f7466dececd964f78a4e5f79632946f511e146a4","modified":1529591303332},{"_id":"public/img/study/bwh_service_detail.jpg","hash":"2c6fa688b5ded62a89d5dd18e18d54e9c9de361e","modified":1529591303332},{"_id":"public/img/study/bwh_service_info.jpg","hash":"2569f5faa1e777f5b268a37a52892931295c68aa","modified":1529591303332},{"_id":"public/img/study/bwh_ss_mac_os.jpg","hash":"d7240ad29c6417ac2b2f2ce51dbd890eb7ce6ccc","modified":1529591303332},{"_id":"public/img/study/bwh_ss_windows.jpg","hash":"fd77de9dc44c5469b879ff36423af330f94b1018","modified":1529591303332},{"_id":"public/img/swift/ios01.jpg","hash":"36e9c27f9a2adbd626f8e2c8046553cba219e18b","modified":1529591303332},{"_id":"public/img/swift/ios02.jpg","hash":"4130fad707d4a29eb2e4e85427ab0c6c86eb46c3","modified":1529591303332},{"_id":"public/img/swift/ios03.jpg","hash":"d0c0cade9c51ad15e3d9a46203be6baae8dc4667","modified":1529591303332},{"_id":"public/img/swift/ios04.jpg","hash":"279a5f7cf9d2af32f06fd892612e04c635d2ec4e","modified":1529591303332},{"_id":"public/img/swift/swift-playground.png","hash":"51bf1501eb27de68559f14a293f0d7273166de95","modified":1529591303332},{"_id":"public/img/study/command/bwh_kiwivm_command.jpg","hash":"c043eded88b5bf45a5d6176b5ad2247434786fc0","modified":1529591303333},{"_id":"public/img/study/command/termius_connect.jpg","hash":"3ee3a3df1b1e867176de7fcbb5bff53d9cdd85ea","modified":1529591303333},{"_id":"public/img/study/jenkins/centenos_jenkins_first.jpg","hash":"5df30946bff364687242cba76365bcdd5332f006","modified":1529591303333},{"_id":"public/img/study/jenkins/jenkins_install_plugin_first.jpg","hash":"6fc8663d8a50a680636e584ec858c7299b470e61","modified":1529591303333},{"_id":"public/img/study/jenkins/jenkins_install_complete.jpg","hash":"1f20a36ebf5f02f9992ff9f2a5f6d83ee988f86a","modified":1529591303333},{"_id":"public/img/study/jenkins/jenkins_install_setting.jpg","hash":"c17320d603b1b3bd76739768ff60434fbafc9794","modified":1529591303333},{"_id":"public/main.0cf68a.css","hash":"ddf6e2c6b953c2c59a3c271e6070010a4cc81cf9","modified":1529591303340},{"_id":"public/slider.e37972.js","hash":"6dec4e220c89049037eebc44404abd8455d22ad7","modified":1529591303340},{"_id":"public/main.0cf68a.js","hash":"993fadeb5f6d296e9d997a49ee20dc97333ceab7","modified":1529591303340},{"_id":"public/mobile.992cbe.js","hash":"01b35e71e37aa2849664eb5daf26daede2278398","modified":1529591303340},{"_id":"public/img/android/android-studio-file-templates-add.jpg","hash":"4b3c337247dd5cf6159a3d051de862a8e72ddef4","modified":1529591303340},{"_id":"public/img/life/coffee_all.jpg","hash":"7b498cd8b354bd7125d452a148d9c591e591a475","modified":1529591303340},{"_id":"public/img/life/coffee_latte.jpg","hash":"ea844b301469b75259a2691a8bfed8dc0c786603","modified":1529591303340},{"_id":"public/img/life/coffee_macchiato.jpg","hash":"3133d44e27a853b81592ee7e24abbc10f7ddacc4","modified":1529591303340},{"_id":"public/img/okhttp/http1xstream.png","hash":"60287e9c7a3ba895e70894270d1cae1c92bf5dd6","modified":1529591303341},{"_id":"public/img/okhttp/realcall03.png","hash":"df86d3f53cabe41b33070cbe01a213d5ec08695a","modified":1529591303341},{"_id":"public/img/study/bwh_kiwi_ss_completed.jpg","hash":"98322b8919827aa9d7adf2627c2428b1f6b65a4e","modified":1529591303341},{"_id":"public/img/study/bwh_kiwi_ss_info.jpg","hash":"d6a12ad5b6b9618023bb1a53dda7307f9e5a48b3","modified":1529591303341},{"_id":"public/img/swift/ios05.jpg","hash":"706d3c48b5d1d7e8b362fbbea5a48e757f98f4e9","modified":1529591303341},{"_id":"public/img/okhttp/dispatcher01.png","hash":"df05338891ca71520221c6e59d39433de63a66be","modified":1529591303349},{"_id":"public/img/okhttp/realcall01.png","hash":"fb060edbb560c4ee860e5cd7269780c0fe92124e","modified":1529591303349},{"_id":"public/img/okhttp/streamallocation01.png","hash":"84877023749d024938e07f5552be91a1dee3130d","modified":1529591303349},{"_id":"public/img/okhttp/realconnection02.png","hash":"eeed8c4bd1398b02ed73929ff4f9fe430febf15b","modified":1529591303356},{"_id":"public/img/okhttp/realcall02.png","hash":"1219c2af91ba0a50a0a913ed7f5d5b521ae4146c","modified":1529591303356},{"_id":"public/img/okhttp/realinterceptorchain01.png","hash":"af50327d33614287738fc874cd149a5fd298a2c2","modified":1529591303356},{"_id":"public/img/okhttp/responsebody01.png","hash":"eea70d7688782ee62b0a21866548a09e38526dda","modified":1529591303356},{"_id":"public/img/okhttp/realconnection01.png","hash":"f7dcfcdeb9a0d18dc88230172728dec23c0b1eb9","modified":1529591303360},{"_id":"public/img/okhttp/callserverinterceptor01.png","hash":"1bcdd27bcd57abaa2e1fa4118492784a2b1c00c2","modified":1529591303360},{"_id":"public/img/okhttp/streamallocation02.png","hash":"a54be015fd8d3beff372e9adbd376935190e7898","modified":1529591303360},{"_id":"public/img/android/android-ui-rv.gif","hash":"5c3355163db5b1a9600ed86cf8c585b1fbee1d54","modified":1529591303418}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"about","date":"2016-05-18T15:16:31.000Z","_content":"\n人会长大三次。\n\n第一次是在发现自己不是世界中心的时候。\n\n第二次是在发现即使再怎么努力，终究还是有些事令人无能为力的时候。\n\n第三次是在明知道有些事可能会无能为力。但还是会尽力争取的时候。","source":"_posts/about.md","raw":"---\ntitle: about\ndate: 2016-05-18 23:16:31\ntags: me\n---\n\n人会长大三次。\n\n第一次是在发现自己不是世界中心的时候。\n\n第二次是在发现即使再怎么努力，终究还是有些事令人无能为力的时候。\n\n第三次是在明知道有些事可能会无能为力。但还是会尽力争取的时候。","slug":"about","published":1,"updated":"2018-01-31T09:35:37.812Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61d10000izcbw7ftwodv","content":"<p>人会长大三次。</p>\n<p>第一次是在发现自己不是世界中心的时候。</p>\n<p>第二次是在发现即使再怎么努力，终究还是有些事令人无能为力的时候。</p>\n<p>第三次是在明知道有些事可能会无能为力。但还是会尽力争取的时候。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>人会长大三次。</p>\n<p>第一次是在发现自己不是世界中心的时候。</p>\n<p>第二次是在发现即使再怎么努力，终究还是有些事令人无能为力的时候。</p>\n<p>第三次是在明知道有些事可能会无能为力。但还是会尽力争取的时候。</p>\n"},{"title":"git.md","date":"2017-05-09T02:47:43.000Z","_content":"\n### git命令\n\n**查看分支**\n\n```java\n// 查看本地所有分支\ngit branch\n// 查看远程所有分支\ngit branch -r\n// 查看所有本地分支和远程分支\ngit branch -a\n```\n<!-- More -->\n\n**创建/切换分支**\n\n```java\n// 如果存在dev分支，则切换到该分支，否则新建分支\ngit checkout dev\n// 创建本地dev1分支,然后切换到dev1分支\ngit checkout -b dev1 => git branch dev1 git checkout dev1\n// 从远程分支dev创建本地分支dev1\ngit checkout -b dev1 origin/dev\n```\n\n**合并分支**\n\n```java\n// 合并dev1分支，这种模式下，删除分支后，会丢掉分支信息，可以用 --no-ff方法\ngit merge dev1\ngit merge --no-ff -m \"merge with no-ff\" dev1\n// 如果分支很多，这个分支历史可能就会变得很复杂了，可以使用 rebase，提交的历史会保持线性\ngit rebase dev1分支\n```\n\n**删除分支**\n\n```java\n// 删除分支，如果没有完成合并会有提示\ngit branch -d dev1\n// 强删除\ngit branch -D dev1\n  \n// 删除远程分支\ngit push origin --delete dev\nor\ngit push origin :dev\n```\n\n**提交分支**\n\n```java\n// 这里冒号可以提交到指定分支，上面命令，把提交本地 master 分支到远程的 dev 分支，远程没有dev这个分支，会创建。\ngit push origin master:dev\n// 本地master提交到远程主分支master\ngit push origin master => git push origin master:master\n```\n\n**跟踪远程分支**\n\n从远程分支 checkout 出来的本地分支，称为 跟踪分支 (tracking branch)。跟踪分支是一种和某个远程分支有直接联系的本地分支。在跟踪分支里输入 git pull/push，Git 会自行推断应该向哪个服务器的哪个分支更新/推送数据。\n\n```java\n// 建立追踪关系\ngit branch -u origin/dev master\nor\ngit branch --set-upstream-to origin/dev master\n// 查看所有分支跟踪关系\ngit branch -vv\n```\n\n**打Tag**\n\n```java\n// 打tag\ngit tag -a v1.0 -m 'msg'\n// 推送tag\ngit push origin v1.0\n```\n\ngit push origin <branch> 推送分支\n\ngit rebase <branch> 合并分支\n\ngit tag -a <tag> -m 'msg' 打tag\n\ngit push orign <tag>  推送tag\n\ngit branch --set-upstream-to=origin/4.6.0 4.6.0 关连分支","source":"_posts/git-md.md","raw":"---\ntitle: git.md\ndate: 2017-05-09 10:47:43\ntags:\n---\n\n### git命令\n\n**查看分支**\n\n```java\n// 查看本地所有分支\ngit branch\n// 查看远程所有分支\ngit branch -r\n// 查看所有本地分支和远程分支\ngit branch -a\n```\n<!-- More -->\n\n**创建/切换分支**\n\n```java\n// 如果存在dev分支，则切换到该分支，否则新建分支\ngit checkout dev\n// 创建本地dev1分支,然后切换到dev1分支\ngit checkout -b dev1 => git branch dev1 git checkout dev1\n// 从远程分支dev创建本地分支dev1\ngit checkout -b dev1 origin/dev\n```\n\n**合并分支**\n\n```java\n// 合并dev1分支，这种模式下，删除分支后，会丢掉分支信息，可以用 --no-ff方法\ngit merge dev1\ngit merge --no-ff -m \"merge with no-ff\" dev1\n// 如果分支很多，这个分支历史可能就会变得很复杂了，可以使用 rebase，提交的历史会保持线性\ngit rebase dev1分支\n```\n\n**删除分支**\n\n```java\n// 删除分支，如果没有完成合并会有提示\ngit branch -d dev1\n// 强删除\ngit branch -D dev1\n  \n// 删除远程分支\ngit push origin --delete dev\nor\ngit push origin :dev\n```\n\n**提交分支**\n\n```java\n// 这里冒号可以提交到指定分支，上面命令，把提交本地 master 分支到远程的 dev 分支，远程没有dev这个分支，会创建。\ngit push origin master:dev\n// 本地master提交到远程主分支master\ngit push origin master => git push origin master:master\n```\n\n**跟踪远程分支**\n\n从远程分支 checkout 出来的本地分支，称为 跟踪分支 (tracking branch)。跟踪分支是一种和某个远程分支有直接联系的本地分支。在跟踪分支里输入 git pull/push，Git 会自行推断应该向哪个服务器的哪个分支更新/推送数据。\n\n```java\n// 建立追踪关系\ngit branch -u origin/dev master\nor\ngit branch --set-upstream-to origin/dev master\n// 查看所有分支跟踪关系\ngit branch -vv\n```\n\n**打Tag**\n\n```java\n// 打tag\ngit tag -a v1.0 -m 'msg'\n// 推送tag\ngit push origin v1.0\n```\n\ngit push origin <branch> 推送分支\n\ngit rebase <branch> 合并分支\n\ngit tag -a <tag> -m 'msg' 打tag\n\ngit push orign <tag>  推送tag\n\ngit branch --set-upstream-to=origin/4.6.0 4.6.0 关连分支","slug":"git-md","published":1,"updated":"2018-01-31T09:35:37.816Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61d50001izcbx8bt3r2u","content":"<h3 id=\"git命令\"><a href=\"#git命令\" class=\"headerlink\" title=\"git命令\"></a>git命令</h3><p><strong>查看分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 查看本地所有分支</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"><span class=\"comment\">// 查看远程所有分支</span></span><br><span class=\"line\">git branch -r</span><br><span class=\"line\"><span class=\"comment\">// 查看所有本地分支和远程分支</span></span><br><span class=\"line\">git branch -a</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p><strong>创建/切换分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 如果存在dev分支，则切换到该分支，否则新建分支</span></span><br><span class=\"line\">git checkout dev</span><br><span class=\"line\"><span class=\"comment\">// 创建本地dev1分支,然后切换到dev1分支</span></span><br><span class=\"line\">git checkout -b dev1 =&gt; git branch dev1 git checkout dev1</span><br><span class=\"line\"><span class=\"comment\">// 从远程分支dev创建本地分支dev1</span></span><br><span class=\"line\">git checkout -b dev1 origin/dev</span><br></pre></td></tr></table></figure>\n<p><strong>合并分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 合并dev1分支，这种模式下，删除分支后，会丢掉分支信息，可以用 --no-ff方法</span></span><br><span class=\"line\">git merge dev1</span><br><span class=\"line\">git merge --no-ff -m <span class=\"string\">\"merge with no-ff\"</span> dev1</span><br><span class=\"line\"><span class=\"comment\">// 如果分支很多，这个分支历史可能就会变得很复杂了，可以使用 rebase，提交的历史会保持线性</span></span><br><span class=\"line\">git rebase dev1分支</span><br></pre></td></tr></table></figure>\n<p><strong>删除分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 删除分支，如果没有完成合并会有提示</span></span><br><span class=\"line\">git branch -d dev1</span><br><span class=\"line\"><span class=\"comment\">// 强删除</span></span><br><span class=\"line\">git branch -D dev1</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">// 删除远程分支</span></span><br><span class=\"line\">git push origin --delete dev</span><br><span class=\"line\">or</span><br><span class=\"line\">git push origin :dev</span><br></pre></td></tr></table></figure>\n<p><strong>提交分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 这里冒号可以提交到指定分支，上面命令，把提交本地 master 分支到远程的 dev 分支，远程没有dev这个分支，会创建。</span></span><br><span class=\"line\">git push origin master:dev</span><br><span class=\"line\"><span class=\"comment\">// 本地master提交到远程主分支master</span></span><br><span class=\"line\">git push origin master =&gt; git push origin master:master</span><br></pre></td></tr></table></figure>\n<p><strong>跟踪远程分支</strong></p>\n<p>从远程分支 checkout 出来的本地分支，称为 跟踪分支 (tracking branch)。跟踪分支是一种和某个远程分支有直接联系的本地分支。在跟踪分支里输入 git pull/push，Git 会自行推断应该向哪个服务器的哪个分支更新/推送数据。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 建立追踪关系</span></span><br><span class=\"line\">git branch -u origin/dev master</span><br><span class=\"line\">or</span><br><span class=\"line\">git branch --set-upstream-to origin/dev master</span><br><span class=\"line\"><span class=\"comment\">// 查看所有分支跟踪关系</span></span><br><span class=\"line\">git branch -vv</span><br></pre></td></tr></table></figure>\n<p><strong>打Tag</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 打tag</span></span><br><span class=\"line\">git tag -a v1.0 -m <span class=\"string\">'msg'</span></span><br><span class=\"line\"><span class=\"comment\">// 推送tag</span></span><br><span class=\"line\">git push origin v1.0</span><br></pre></td></tr></table></figure>\n<p>git push origin <branch> 推送分支</branch></p>\n<p>git rebase <branch> 合并分支</branch></p>\n<p>git tag -a <tag> -m ‘msg’ 打tag</tag></p>\n<p>git push orign <tag>  推送tag</tag></p>\n<p>git branch –set-upstream-to=origin/4.6.0 4.6.0 关连分支</p>\n","site":{"data":{}},"excerpt":"<h3 id=\"git命令\"><a href=\"#git命令\" class=\"headerlink\" title=\"git命令\"></a>git命令</h3><p><strong>查看分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 查看本地所有分支</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\"><span class=\"comment\">// 查看远程所有分支</span></span><br><span class=\"line\">git branch -r</span><br><span class=\"line\"><span class=\"comment\">// 查看所有本地分支和远程分支</span></span><br><span class=\"line\">git branch -a</span><br></pre></td></tr></table></figure>","more":"<p><strong>创建/切换分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 如果存在dev分支，则切换到该分支，否则新建分支</span></span><br><span class=\"line\">git checkout dev</span><br><span class=\"line\"><span class=\"comment\">// 创建本地dev1分支,然后切换到dev1分支</span></span><br><span class=\"line\">git checkout -b dev1 =&gt; git branch dev1 git checkout dev1</span><br><span class=\"line\"><span class=\"comment\">// 从远程分支dev创建本地分支dev1</span></span><br><span class=\"line\">git checkout -b dev1 origin/dev</span><br></pre></td></tr></table></figure>\n<p><strong>合并分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 合并dev1分支，这种模式下，删除分支后，会丢掉分支信息，可以用 --no-ff方法</span></span><br><span class=\"line\">git merge dev1</span><br><span class=\"line\">git merge --no-ff -m <span class=\"string\">\"merge with no-ff\"</span> dev1</span><br><span class=\"line\"><span class=\"comment\">// 如果分支很多，这个分支历史可能就会变得很复杂了，可以使用 rebase，提交的历史会保持线性</span></span><br><span class=\"line\">git rebase dev1分支</span><br></pre></td></tr></table></figure>\n<p><strong>删除分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 删除分支，如果没有完成合并会有提示</span></span><br><span class=\"line\">git branch -d dev1</span><br><span class=\"line\"><span class=\"comment\">// 强删除</span></span><br><span class=\"line\">git branch -D dev1</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">// 删除远程分支</span></span><br><span class=\"line\">git push origin --delete dev</span><br><span class=\"line\">or</span><br><span class=\"line\">git push origin :dev</span><br></pre></td></tr></table></figure>\n<p><strong>提交分支</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 这里冒号可以提交到指定分支，上面命令，把提交本地 master 分支到远程的 dev 分支，远程没有dev这个分支，会创建。</span></span><br><span class=\"line\">git push origin master:dev</span><br><span class=\"line\"><span class=\"comment\">// 本地master提交到远程主分支master</span></span><br><span class=\"line\">git push origin master =&gt; git push origin master:master</span><br></pre></td></tr></table></figure>\n<p><strong>跟踪远程分支</strong></p>\n<p>从远程分支 checkout 出来的本地分支，称为 跟踪分支 (tracking branch)。跟踪分支是一种和某个远程分支有直接联系的本地分支。在跟踪分支里输入 git pull/push，Git 会自行推断应该向哪个服务器的哪个分支更新/推送数据。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 建立追踪关系</span></span><br><span class=\"line\">git branch -u origin/dev master</span><br><span class=\"line\">or</span><br><span class=\"line\">git branch --set-upstream-to origin/dev master</span><br><span class=\"line\"><span class=\"comment\">// 查看所有分支跟踪关系</span></span><br><span class=\"line\">git branch -vv</span><br></pre></td></tr></table></figure>\n<p><strong>打Tag</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 打tag</span></span><br><span class=\"line\">git tag -a v1.0 -m <span class=\"string\">'msg'</span></span><br><span class=\"line\"><span class=\"comment\">// 推送tag</span></span><br><span class=\"line\">git push origin v1.0</span><br></pre></td></tr></table></figure>\n<p>git push origin <branch> 推送分支</branch></p>\n<p>git rebase <branch> 合并分支</branch></p>\n<p>git tag -a <tag> -m ‘msg’ 打tag</tag></p>\n<p>git push orign <tag>  推送tag</tag></p>\n<p>git branch –set-upstream-to=origin/4.6.0 4.6.0 关连分支</p>"},{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n<!-- More -->\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n<!-- More -->\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2018-01-31T09:35:37.816Z","updated":"2018-01-31T09:35:37.816Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61d80003izcbzboxbr4w","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.<br><a id=\"more\"></a></p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.<br>","more":"</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>"},{"title":"macOS配置android环境变量(adb等)","date":"2018-02-01T03:39:14.000Z","_content":"\n### 步骤\n\n1.把开终端(terminal)，不知道地方的，可以使用`Spotlight`搜索\n\n2.打开后输入以下命令进入根目录，命令如下\n  ```\ncd\n  ```\n\n3.更新`.bash_profile`文件，可以使用`ls -a`命令查看是否存在文件，不存在的话使用以下命令创建\n  ```\ntouch .bash_profile\n  ```\n\n4.打开`.bash_profile`文件，输入下面命令后，会弹出文本编辑 框\n\n  ```\nopen -e .bash_profile\n  ```\n\n5.编辑`.bash_profile`文件如下\n\n  ```python\nANDROID_HOME=/Users/apple/Library/Android/sdk\nexport PATH=$PATH:$ANDROID_HOME/tools\nexport PATH=$PATH:$ANDROID_HOME/platform-tools\n  ```\n\n>  其中的apple替换为你的用户名\n\n\n6.更新`.bash_profile`\n\n  ```\n  source .bash_profile\n  ```\n\n","source":"_posts/macOS-android-path.md","raw":"---\ntitle: macOS配置android环境变量(adb等)\ndate: 2018-02-01 11:39:14\ntags: study\n---\n\n### 步骤\n\n1.把开终端(terminal)，不知道地方的，可以使用`Spotlight`搜索\n\n2.打开后输入以下命令进入根目录，命令如下\n  ```\ncd\n  ```\n\n3.更新`.bash_profile`文件，可以使用`ls -a`命令查看是否存在文件，不存在的话使用以下命令创建\n  ```\ntouch .bash_profile\n  ```\n\n4.打开`.bash_profile`文件，输入下面命令后，会弹出文本编辑 框\n\n  ```\nopen -e .bash_profile\n  ```\n\n5.编辑`.bash_profile`文件如下\n\n  ```python\nANDROID_HOME=/Users/apple/Library/Android/sdk\nexport PATH=$PATH:$ANDROID_HOME/tools\nexport PATH=$PATH:$ANDROID_HOME/platform-tools\n  ```\n\n>  其中的apple替换为你的用户名\n\n\n6.更新`.bash_profile`\n\n  ```\n  source .bash_profile\n  ```\n\n","slug":"macOS-android-path","published":1,"updated":"2018-02-01T04:59:02.518Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61d90004izcb0t1837gc","content":"<h3 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h3><p>1.把开终端(terminal)，不知道地方的，可以使用<code>Spotlight</code>搜索</p>\n<p>2.打开后输入以下命令进入根目录，命令如下<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd</span><br></pre></td></tr></table></figure></p>\n<p>3.更新<code>.bash_profile</code>文件，可以使用<code>ls -a</code>命令查看是否存在文件，不存在的话使用以下命令创建<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">touch .bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>4.打开<code>.bash_profile</code>文件，输入下面命令后，会弹出文本编辑 框</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">open -e .bash_profile</span><br></pre></td></tr></table></figure>\n<p>5.编辑<code>.bash_profile</code>文件如下</p>\n  <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ANDROID_HOME=/Users/apple/Library/Android/sdk</span><br><span class=\"line\">export PATH=$PATH:$ANDROID_HOME/tools</span><br><span class=\"line\">export PATH=$PATH:$ANDROID_HOME/platform-tools</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p> 其中的apple替换为你的用户名</p>\n</blockquote>\n<p>6.更新<code>.bash_profile</code></p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source .bash_profile</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h3><p>1.把开终端(terminal)，不知道地方的，可以使用<code>Spotlight</code>搜索</p>\n<p>2.打开后输入以下命令进入根目录，命令如下<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd</span><br></pre></td></tr></table></figure></p>\n<p>3.更新<code>.bash_profile</code>文件，可以使用<code>ls -a</code>命令查看是否存在文件，不存在的话使用以下命令创建<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">touch .bash_profile</span><br></pre></td></tr></table></figure></p>\n<p>4.打开<code>.bash_profile</code>文件，输入下面命令后，会弹出文本编辑 框</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">open -e .bash_profile</span><br></pre></td></tr></table></figure>\n<p>5.编辑<code>.bash_profile</code>文件如下</p>\n  <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ANDROID_HOME=/Users/apple/Library/Android/sdk</span><br><span class=\"line\">export PATH=$PATH:$ANDROID_HOME/tools</span><br><span class=\"line\">export PATH=$PATH:$ANDROID_HOME/platform-tools</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p> 其中的apple替换为你的用户名</p>\n</blockquote>\n<p>6.更新<code>.bash_profile</code></p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">source .bash_profile</span><br></pre></td></tr></table></figure>\n"},{"title":"Swift初见","date":"2016-05-21T09:48:59.000Z","_content":"\n# 概述\n\n> 本文摘至：《The Swift Programming Language》\n\nSwift是一种新的编程语言，用于编写ios，OS X和watch OS应用程序。Swift结合了C和Objective-C的优点并且不受C兼容性的限制。Swift采用安全的编程模式并添加了很多新特性，这将使编程更简单，更灵活，也更有趣。Swift是基于成熟而且倍受喜爱的Cocoa和Cocoa Touch框架，它的降临将重新定义软件开发。\n\n> 使用Playground编写Swift，可以实现查看。打开Xcode，创建一个Playground文件(File --> New --> Playground)。\n>\n> Tips:  把鼠标放在Playground的右边区域，会有个小眼睛的图标和一个小白圈，点击有惊喜\n\n![swift-playground](/img/swift/swift-playground.png)\n\n<!-- More -->\n\n画正弦 ![swift-sin](/img/swift/swift-sin.png)\n\n```swift\nvar num: Double\nfor i in 1...100 {\n    num = sin(Double(i) / 10)\n}\n```\n\n## Swift 初见\n\n通常来说，编程语言教程中的第一个程序应该在屏幕上打印\"Hello, world\"。在Swift中，可以用一行代码实现。\n\n```swift\nprint(\"Hello, world!\")\n```\n\n> 不同于java等语言，swift并不需要在语句结尾强制加上一个分号`;`。如果一行写2个语句，需要加上分号`;`\n\n```swift\nlet explicitFloat: Float = 70; let explicitDouble: Double = 4\n```\n\n### 简单值\n\n使用`let`来声明常量，使用`var`来声明变量。一个常量的值，在编译的时候，并不需要有明确的值，但是你只能为它赋值一次。类似java的final修饰的变量\n\n```swift\nvar myVariable = 42\nmyVariable = 50\nlet myConstant = 42\n```\n\n> 你不用明确的声明类型，声明的同时赋值的话，编译器会自动推断类型。在上面的例子中，编译器推断出 `myVariable`是一个整数(integer)，因为它的初始值是整数。\n\n如果 初始值没有提供足够的信息(或者没有初始值)，那你需要在变量后面声明类型，用冒号分割。\n\n```swift\nlet implicitInteger = 70\nlet implicitDouble = 70.0\nlet explicitDouble: Double = 70\nlet explicitFloat: Float = 4\n```\n\n值永远不会被隐式转换成其他类型。如果你需要把一个值转换成其它类型，请显示转换。\n\n```swift\nlet label = \"The width is\"\nlet width = 94\nlet widthLabel = label + String(width)\n```\n\n有一种更简单的把值转换成字符串的方法：把值写到括号中，并且在括号之前写一个反斜杠。例如：\n\n```swift\nlet apples = 3\nlet oranges = 5\nlet appleSummary = \"I have \\(apples) apples.\"\nlet fruitSummary = \"I have \\(apples + oranges) pieces of fruit.\"\n```\n使用方括号`[]`来创建数组和字典，并使用下标或者键（key）来访问元素。最后一个元素后面允许有个逗号。\n\n```swift\nvar shoppingList = [\"Catfish\", \"water\", \"tulips\", \"blue paint\"]\nshoppingList[1] = \"bottle of water\"\nvar occupations = [\"Malcolm\": \"Captain\", \"Keylee\": \"Mechanic\",]\noccupations[\"Jayne\"] = \"Public Relations\"\n```\n\n要创建一个空数组或者字典，使用初始化语法。\n\n```swift\nlet emptyArray = [String]()\nlet emptyDictionary = [String: Float]()\n```\n\n如果类型信息可以被推断出来，你可以用`[]`和`[:]`来创建空数组和空字典 — 就像你声明变量或者给函数传参数的时候一样。\n\n```swift\nshoppingList = []\noccupations = [:]\n```\n\n### 控制流\n\n使用`if`和`switch`来进行条件操作，使用`for-in`、`for`、`while`和`repeat-while`来进行循环。包裹条件和循环变量括号可以省略，但是语句体的大括号是必须的。\n\n```swift\nlet individualScores = [75, 43, 103, 87, 12]\nvar teamScore = 0\nfor score in individualScores {\n    if score > 50 {\n        teamScore += 3\n    } else {\n        teamScore += 1\n    }\n}\nprint(teamScore) // 11\n```\n 在`if`语句中，条件必须是一个布尔表达式 — 这意味着像`if score { ... }`这样的代码将报错，而不会隐形的与 0 做对比。\n\n你可以一起使用`if`和`let`来处理缺失的情况。这些值可由可先值来代表。一个可选的值是一个具体的值或者是`nil`以表示值缺失。在类型后面加一个问号来标记这个变量的值是可选的。\n\n```swift\nvar optionalString: String? = \"Hello\"\nprint(optionalString == nil)\n\nvar optionalName: String? = \"John Appleseed\"\nvar greeting = \"Hello!\"\nif let name = optionalName {\n    greeting = \"Hello, \\(name)\"\n}\n```\n> `if  let name = optionalName `  这句的意思是：如果optionalName不是nil，就把值赋给 name，条件判断为 `true`，进入 if 语句块；如果optionalName为nil，条件会判断为 `false`，不进入 if  语句块\n\n`switch`支持任意类型的数据以及各种比较操作 — 不仅仅是整数以及测试相等。\n\n```swift\nlet vegetable = \"red pepper\"\nswitch vegetable {\n    case \"celery\":\n        print(\"Add some raisins and make ants on a log.\")\n    case \"cucumber\", \"watercress\":\n        print(\"That would make a good tea sandwich.\")\n    case let x where x.hasSuffix(\"pepper\"):\n        print(\"Is it a spicy \\(x)?\")\n    default:\n        print(\"Everything tastes good in soup.\")\n}\n// 打印 \"Is it a spicy red pepper?\"\n```\n\n> 不同于java ，swift的`case`语句不必加break。\n\n注意`let`在上述例子的等式中是如何使用的，它将匹配等式的值赋给常量`x`。`let x where x.hasSuffix(\"papper\")`这句话的意思是先把vegetable的值赋给`x`，如果赋值成功，再判断调用`hasSuffix`方法判断是否以`pepper`字符串结尾。\n\n运行`switch`中匹配到的子句之后，程序会退出switch语句，并不会继续向下运行，所以不需要在每个子句结尾写`break`。\n\n你可以使用`for-in`来遍历字典，需要两个变量来表示每个键值对。字典是一个无序的集合，所以他们的键和值以任意顺序迭代结束。\n\n下面的程序演示了找出最大值的操作：\n\n```swift\nlet interestingNumbers = [\n    \"Prime\": [2, 3, 5, 7, 11, 13],\n    \"Fibonacci\": [1, 1, 2, 3, 5, 8],\n    \"Square\": [1, 4, 9, 16, 25]]\nvar largest = 0\nfor (kind, numbers) in interestingNumbers {\n    for number in numbers {\n        if number > largest {\n            largest = number\n        }\n    }\n}\nprint(largest) // 25\n```\n\n使用`while`来重复运行一段代码直到不满足条件。循环条件也可以在结尾，保证能至少循环一次。\n\n```swift\nvar n = 2\nwhile n < 100 {\n    n = n * 2\n}\nprint(n) // 128\n\nvar m = 2\nrepeat {\n    m = m * 2\n} while m < 100\nprint(m) // 128\n```\n\n你可以在循环中使用`..<`来表示范围，也可以使用传统的写法，两者是等价的：\n\n```swift\nvar firstForLoop = 0\nfor i in 0..<4{\n    firstForLoop += i\n}\nprint(firstForLoop) // 6\n\nvar secondForLoop = 0\nfor var i = 0; i < 4; ++i {\n    secondForLoop += i\n}\nprint(secondForLoop) // 6\n```\n\n### 函数和闭包\n\n使用`func`来声明一个函数，使用名字和参数来调用函数。使用`->`来指定函数返回值的类型。\n\n```swift\nfunc greet(name: String, day: String) -> String {\n    return \"Hello \\(name), today is \\(day).\"\n}\ngreet(\"Bob\", day: \"Tuesday\")\n```\n\n使用元组来让一个函数返回多个值。该元组的元素可以用名称或数字来表示。\n\n```swift\nfunc calculateStatistics(scores: [Int]) -> (min: Int, max: Int, sum: Int) {\n    var min = scores[0]\n    var max = scores[0]\n    var sum = 0\n    for score in scores {\n        if score > max {\n            max = score\n        } else if score < min {\n            min = score\n        }\n        sum += score\n    }\n    return (min, max, sum)\n}\nlet statistics = calculateStatistics([5, 3, 100, 3, 9])\nprint(statistics.min)\nprint(statistics.max)\nprint(statistics.sum)\nprint(statistics.2)\n```\n\n函数可以带有可变个数的参数，这些参数的函数内表现为数组的形式：\n\n```swift\nfunc sumOf(numbers: Int...) -> Int {\n    var sum = 0\n    for number in numbers {\n        sum += number\n    }\n    return sum\n}\nsumOf()\nsumOf(42, 597, 12)\n```\n\n函数可以嵌套。被嵌套的函数可以访问外侧函数的变量，你可以使用嵌套函数来重构一个太长或者太复杂的函数 。\n\n```swift\nfunc returnFifteen() -> Int {\n    var y = 10\n    func add() {\n        y += 5\n    }\n    add()\n    return y\n}\nreturnFifteen()\n```\n\n函数是第一等类型，这意味着函数可以作为另一个函数的返回值。\n\n```swift\nfunc makeIncrementer() -> (Int -> Int) {\n    func addOne(number: Int) -> Int {\n        return 1 + number\n    }\n    return addOne\n}\nvar increment = makeIncrementer()\nincrement(7)\n```\n\n函数也可以当做参数传入另一个函数。\n\n```swift\nfunc hasAnyMatches(list: [Int], condition: Int -> Bool) -> Bool {\n    for item in list {\n        if condition(item) {\n            return true\n        }\n    }\n    return false\n}\nfunc lessThanTen(number: Int) -> Bool {\n    return number < 10\n}\nvar numbers = [20, 19, 7, 12]\nhasAnyMatches(numbers, condition: lessThanTen)\n```\n\n函数实际上是一种特殊的闭包：它是一段能之后被调取的代码。闭包中的代码能访问闭包所建作用域中能得到的变量和函数，即使闭包是在一个不同的作用域被执行的 — 你已经在嵌套函数例子中所看到。你可以使用`{}`来创建一个匿名闭包。使用`in`将参数和返回值类型声明与闭包函数体进行分离。\n\n```swift\nvar numbers = [20, 19, 7, 12]\nnumbers.map({\n    (number: Int) -> Int in\n    let result = 3 * number\n    return result\n})\n```\n\n有很多种创建更简洁的闭包的方法。如果一个闭包的类型已知，比如作为一个回调函数，你可以忽略参数的类型和返回值。单个语句闭包会把它语句的值当做结果返回。\n\n```swift\nlet mappedNumbers = numbers.map({ number in 3 * number })\nprint(mappedNumbers) // [60, 57, 21, 36]\n```\n\nswift内置了一组变量(`$0`、`$1`、`$2` …...)，上述代码还能更简单 \n\n```swift\nmappedNumbers = numbers.map({ $0 * 3 })\nprint(mappedNumbers)\n```\n\n你可以通过参数位置而不是参数名字引用 参数 — 这个方法在非常短的闭包中非常有用。当一个闭包作为最后一个参数传给一个函数的时候，它可以直接跟在括号后面。当一个闭包是传给函数的唯一参数，你可以完全忽略括号。\n\n```swift\nlet sortedNumbers = numbers.sort{ $0 > $1 }\nprint(sortedNumbers) // [20, 19, 12, 7]\n```\n\n### 对象和类\n\n使用`class`和类名来创建一个类。类中属性的声明和常量、变量声明一样，唯一的区别就是它们的上下文是类。同样，方法和函数声明也一样。\n\n```swift\nclass Shape {\n    var numberOfSides = 0\n    func simpleDescription() -> String {\n        return \"A shape with \\(numberOfSides) sides.\"\n    }\n}\n```\n\n要创建一个类的实例，在类名后面加上括号。使用点语法来访问实例的属性和方法。\n\n```swift\nvar shape = Shape()\nshape.numberOfSides = 7\nvar shapeDescription = shape.simpleDescription()\n```\n\n这个版本的`Shape`类缺少了一些重要的东西：一个构造函数来初始化类实例。使用`init`来创建一个构造器。\n\n```swift\nclass NamesShape {\n    var numberOfSides: Int = 0\n    var name: String\n    init (name: String) {\n        self.name = name\n    }\n    func simpleDescription() -> String {\n        return \"A shape with \\(numberOfSides) sides.\"\n    }\n}\n```\n\n注意`self`被用来区别实例变量。当你创建实例的时候，像传入函数参数一样给类传入构造器的参数。\n\n每个属性都需要赋值 — 无论是通过声明（就像`numberOfSides`）还是通过构造器（就像`name`）\n\n如果你需要在删除对象之前进行一些清理工作，使用`deinit`创建一个析构函数。\n\n子类的定义方法是在它们的类名后面加上父类的名字，用冒号分割。创建类的时候并不需要一个标准的根类，所以你可以忽略父类。\n\n子类如果要重写父类的方法的话，需要用`override`标记 — 如果没有添加`override`就重写父类的方法的话，编译器会报错。编译器同样会检测`override`标记的方法是否确实在父类中。\n\n```swift\nclass Square: NamesShape {\n    var sideLength: Double\n    init(sideLength: Double, name: String) {\n        self.sideLength = sideLength\n        super.init(name: name)\n        numberOfSides = 4\n    }\n\n    func area() -> Double {\n        return sideLength * sideLength\n    }\n    override func simpleDescription() -> String {\n        return \"A square with sides of length \\(sideLength).\"\n    }\n}\nlet test = Square(sideLength: 5.2, name: \"my test square\")\ntest.area() // 27.04\ntest.simpleDescription() // \"A square with sides of length 5.2\"\n```\n\n除了储存简单的属性之外，属性可以有 `getter`和`settter`。\n\n```swift\nclass EquilateralTriangle: NamesShape {\n    var sideLength: Double = 0.0\n    init(sideLength: Double, name: String) {\n        self.sideLength = sideLength\n        super.init(name: name)\n        numberOfSides = 4\n    }\n    var perimeter: Double {\n        get{\n            return 3.0 * sideLength\n        }\n        set {\n            sideLength = newValue / 3.0\n        }\n    }\n    override func simpleDescription() -> String {\n        return \"An equilateral triagle with sides of length \\(sideLength).\"\n    }\n}\nlet triangle = EquilateralTriangle(sideLength: 3.1, name: \"a triangle\")\nprint(triangle.perimeter) // 9.3\ntriangle.perimeter = 9.9\nprint(triangle.sideLength) // 3.3\n```\n\n在`perimeter`的`setter`中，新值的名字是`newValue`。你可以在`set`之后显示的设置一人名字。\n\n注意`EquilateralTriangle`类的构造器执行了三步：\n\n1. 设置子类声明的属性\n2. 调用父类的构造器\n3. 改变父类定义的属性值。其它的工作比如调用方法、getter和setter也可以在这个阶段完成。\n\n如果你不需要计算属性，但是仍然需要在设置一相新值之前或者之后运行代码，使用`willSet`和`didSet`。\n\n比如，下面的类确保三角形的边长总是和正方形的边长相同。\n\n```swift\nclass TriangleAndSquare {\n    var triangle: EquilateralTriangle {\n        willSet {\n            square.sideLength = newValue.sideLength\n        }\n    }\n    var square: Square {\n        willSet{\n            triangle.sideLength = newValue.sideLength\n        }\n    }\n    init(size: Double, name: String) {\n        square = Square(sideLength: size, name: name)\n        triangle = EquilateralTriangle(sideLength: size, name: name)\n    }\n}\nvar triangleAndSquare = TriangleAndSquare(size: 10, name: \"another test shape\")\nprint(triangleAndSquare.square.sideLength) // 10\nprint(triangleAndSquare.triangle.sideLength) // 10\ntriangleAndSquare.square = Square(sideLength: 50, name: \"larger square\")\nprint(triangleAndSquare.triangle.sideLength) // 50\n```\n\n处理变量的可选值时，你可以在操作（比如方法、属性和子脚本）之前加`?`。如果 `?`之前的值是`nil`，`?`后面的东西都会被忽略，并且整个表达式返回`nil`。否则，`?`之后的东西都会被运行。在这两种情况下，整个表达 式的值也是一个可选值。\n\n```swift\nlet optionalSquare: Square? = Square(sideLength: 2.5, name: \"optional square\")\nlet sideLength = optionalSquare?.sideLength\n```\n### 枚举和结构体\n\n使用`enum`来创建一个枚举。就像类的其他所有命名类型一样，枚举可以包含方法。\n\n```swift\nenum Rank: Int {\n    case Ace = 1\n    case Two, Three, Four, Five, Six, Seven, Eight, Nine, Ten\n    case Jack, Queen, King\n    func simpleDescription() -> String {\n        switch self {\n        case .Ace:\n            return \"ace\"\n        case .Jack:\n            return \"jack\"\n        case .Queen:\n            return \"queen\"\n        case .King:\n            return \"king\"\n        default:\n            return String(self.rawValue)\n        }\n    }\n}\nlet ace = Rank.Ace\nlet aceRawValue = ace.rawValue\n```\n\n在上面的例子中，枚举原始值的类型是`Int`，所以你只需要设置第一个原始值。剩下的原始值会按照顺序赋值。你也可以使用字符串或者浮点数作为枚举的原始值。使用`rawValue`属性来访问一个枚举成员的原始值。\n\n使用`init?(rawValue:) `初始化构造器在原始值和枚举值之间进行转换。\n\n```swift\nif let convertedRank = Rank(rawValue: 3) {\n    let threeDescription = convertedRank.simpleDescription()\n}\n```\n\n枚举的成员值是实际值，并不是原始值的另一种表达方法。实际上，以防原始值没有意义，你不需要设置。\n\n```swift\nenum Suit {\n    case Spades, Hearts, Diamonds, Clubs\n    func simpleDescription() -> String {\n        switch self {\n        case .Spades:\n            return \"spades\"\n        case .Hearts:\n            return \"hearts\"\n        case .Diamonds:\n            return \"diamonds\"\n        case .Clubs:\n            return \"clubs\"\n        }\n    }\n}\nlet hearts = Suit.Hearts\nlet heartsDescription = hearts.simpleDescription()\n```\n\n注意，有两种方式可以引用`Hearts`成员：给`hearts`常量赋值时，枚举成员`Suit.Hearts`需要用全名来引用，因为常量没有显式指定类型。在`switch`里，枚举成员使用缩写`.Hearts`来引用，因为`self`的值已经知道是一个`suit`。已知变量类型的情况下你可以使用缩写。\n\n使用`struct`来创建一个结构体。结构体和类有很多相同的地方，比如方法和构造器。它们之间最大的一个区别就是结构体是传值，类是传引用。\n\n```swift\nstruct Card {\n    var rank: Rank\n    var suit: Suit\n    func simpleDescription() -> String {\n        return \"The \\(rank.simpleDescription()) of \\(suit.simpleDescription())\"\n    }\n}\nlet threeOfSpades = Card(rank: .Three, suit: .Spades)\nlet threeOfSpadesDescription = threeOfSpades.simpleDescription()\n```\n\n一个枚举成员的实例可以有实例值。相同枚举成员的实例可以有不同的值。创建实例的时候传入值即可。实例值和原始值是不同的：枚举成员的原始值对于所有实例都是相同的，而且你是在定义枚举的时候设置原始值。\n\n例如，考虑从服务器获取日出和日落的时间。服务器会返回正常结果或者错误信息。\n\n```swift\nenum ServerResponse {\n    case Result(String, String)\n    case Error(String)\n}\nlet success = ServerResponse.Result(\"6:00 am\", \"8:09 pm\")\nlet failure = ServerResponse.Error(\"Out of cheese.\")\nswitch success {\ncase let .Result(sunrise, sunset):\n    let serverResponse = \"Sunrise is at \\(sunrise) and sunset is at \\(sunset).\"\ncase let .Error(error):\n    let serverResponse = \"Failure... \\(error)\"\n}\n```\n\n注意如何从`ServerResponse`中提取日升和日落时间并用得到的值用来和`switch`的情况做比较。\n\n### 协议和扩展\n\n使用`protocol`来声明一个协议。\n\n```swift\nprotocol ExampleProtocol {\n    var simpleDescription: String { get }\n    mutating func adjust()\n}\n```\n\n类、枚举和结构体都可以实现协议。\n\n```swift\nclass SimpleClass: ExampleProtocol {\n    var simpleDescription: String = \"A very simple class.\"\n    var anotherProperty: Int = 69105\n    func adjust() {\n        simpleDescription += \" Now 100% adjusted.\"\n    }\n}\nvar a = SimpleClass()\na.adjust()\nlet aDescription = a.simpleDescription\nstruct SimpleStructure: ExampleProtocol {\n    var simpleDescription: String = \"A simple structure\"\n    mutating func adjust() {\n        simpleDescription += \"(adjusted)\"\n    }\n}\nvar b = SimpleStructure()\nb.adjust()\nlet bDescription = b.simpleDescription\n```\n\n注意声明`SimpleStructure`时候`mutating`关键字用来标记一个会修改结构体的方法。`SimpleClass`的声明不需要标记任何方法，因为类中的方法通常可以修改类属性（类的性质）\n\n使用`extension`来为现有的类型添加功能，比如新的方法和计算属性。你可以使用扩展在别处修改定义，甚至是从外部库或者框架引入的一个类型，使得这个类型遵循某个协议。\n\n```swift\nextension Int: ExampleProtocol {\n    var simpleDescription: String {\n        return \"The number \\(self)\"\n    }\n    mutating func adjust() {\n        self += 42\n    }\n}\nprint(7.simpleDescription) // The number 7\n```\n\n你可以像使用其他命名类型一样使用协议名 — 例如，创建一个有不同类型但是都实现一个协议的对象集合。当你处理类型是协议的值时，协议外定义的方法不可用。\n\n```swift\nlet protocolValue: ExampleProtocol = a\nprint(protocolValue.simpleDescription) //A very simple class. Now 100% adjusted.\n```\n\n即使`protocolValue`变量运行时的类型是`simpleClass`，编译器会把它的类型当做`ExampleProtocol`。这表示你不能调用类在它实现的协议之外实现的方法或属性。\n\n### 泛型\n\n在尖括号里写一个名字来创建一个泛型函数或者类型。\n\n```swift\nfunc repeatItem<Item>(item: Item, numberOfTimes: Int) -> [Item] {\n    var result = [Item]()\n    for _ in 0..<numberOfTimes {\n        result.append(item)\n    }\n    return result\n}\nrepeatItem(\"knock\", numberOfTimes: 4) // [\"knock\", \"knock\", \"knock\", \"knock\"]\n```\n\n你也可以创建泛型函数 、方法、类、枚举和结构体。\n\n```swift\n// Reimplement the Swift standard library's optional type\nenum OptionalValue<Wrapped> {\n    case None\n    case Some(Wrapped)\n}\nvar possibleInteger: OptionalValue<Int> = .None\npossibleInteger = .Some(100)\n```\n\n在类型名后面的使用`where`来指定对类型的需求，比如，限定类型实现某一个协议，限定两个类型是相同的，或者限定某个类必须有一个特定的父类。\n\n```swift\nfunc anyCommonElements<T: SequenceType, U: SequenceType where T.Generator.Element: Equatable, T.Generator.Element == U.Generator.Element>(lhs: T, _ rhs: U) -> Bool {\n    for lhsItem in lhs {\n        for rhsItem in rhs {\n            if lhsItem == rhsItem {\n                return true\n            }\n        }\n    }\n    return false\n}\nanyCommonElements([1, 2, 3], [3])\n```\n\n`<T: Equatable>`和`<T where T: Equatable>`是等价的。","source":"_posts/Swift/swift-basic.md","raw":"---\ntitle: Swift初见\ndate: 2016-05-21 17:48:59\ntags: ios\n---\n\n# 概述\n\n> 本文摘至：《The Swift Programming Language》\n\nSwift是一种新的编程语言，用于编写ios，OS X和watch OS应用程序。Swift结合了C和Objective-C的优点并且不受C兼容性的限制。Swift采用安全的编程模式并添加了很多新特性，这将使编程更简单，更灵活，也更有趣。Swift是基于成熟而且倍受喜爱的Cocoa和Cocoa Touch框架，它的降临将重新定义软件开发。\n\n> 使用Playground编写Swift，可以实现查看。打开Xcode，创建一个Playground文件(File --> New --> Playground)。\n>\n> Tips:  把鼠标放在Playground的右边区域，会有个小眼睛的图标和一个小白圈，点击有惊喜\n\n![swift-playground](/img/swift/swift-playground.png)\n\n<!-- More -->\n\n画正弦 ![swift-sin](/img/swift/swift-sin.png)\n\n```swift\nvar num: Double\nfor i in 1...100 {\n    num = sin(Double(i) / 10)\n}\n```\n\n## Swift 初见\n\n通常来说，编程语言教程中的第一个程序应该在屏幕上打印\"Hello, world\"。在Swift中，可以用一行代码实现。\n\n```swift\nprint(\"Hello, world!\")\n```\n\n> 不同于java等语言，swift并不需要在语句结尾强制加上一个分号`;`。如果一行写2个语句，需要加上分号`;`\n\n```swift\nlet explicitFloat: Float = 70; let explicitDouble: Double = 4\n```\n\n### 简单值\n\n使用`let`来声明常量，使用`var`来声明变量。一个常量的值，在编译的时候，并不需要有明确的值，但是你只能为它赋值一次。类似java的final修饰的变量\n\n```swift\nvar myVariable = 42\nmyVariable = 50\nlet myConstant = 42\n```\n\n> 你不用明确的声明类型，声明的同时赋值的话，编译器会自动推断类型。在上面的例子中，编译器推断出 `myVariable`是一个整数(integer)，因为它的初始值是整数。\n\n如果 初始值没有提供足够的信息(或者没有初始值)，那你需要在变量后面声明类型，用冒号分割。\n\n```swift\nlet implicitInteger = 70\nlet implicitDouble = 70.0\nlet explicitDouble: Double = 70\nlet explicitFloat: Float = 4\n```\n\n值永远不会被隐式转换成其他类型。如果你需要把一个值转换成其它类型，请显示转换。\n\n```swift\nlet label = \"The width is\"\nlet width = 94\nlet widthLabel = label + String(width)\n```\n\n有一种更简单的把值转换成字符串的方法：把值写到括号中，并且在括号之前写一个反斜杠。例如：\n\n```swift\nlet apples = 3\nlet oranges = 5\nlet appleSummary = \"I have \\(apples) apples.\"\nlet fruitSummary = \"I have \\(apples + oranges) pieces of fruit.\"\n```\n使用方括号`[]`来创建数组和字典，并使用下标或者键（key）来访问元素。最后一个元素后面允许有个逗号。\n\n```swift\nvar shoppingList = [\"Catfish\", \"water\", \"tulips\", \"blue paint\"]\nshoppingList[1] = \"bottle of water\"\nvar occupations = [\"Malcolm\": \"Captain\", \"Keylee\": \"Mechanic\",]\noccupations[\"Jayne\"] = \"Public Relations\"\n```\n\n要创建一个空数组或者字典，使用初始化语法。\n\n```swift\nlet emptyArray = [String]()\nlet emptyDictionary = [String: Float]()\n```\n\n如果类型信息可以被推断出来，你可以用`[]`和`[:]`来创建空数组和空字典 — 就像你声明变量或者给函数传参数的时候一样。\n\n```swift\nshoppingList = []\noccupations = [:]\n```\n\n### 控制流\n\n使用`if`和`switch`来进行条件操作，使用`for-in`、`for`、`while`和`repeat-while`来进行循环。包裹条件和循环变量括号可以省略，但是语句体的大括号是必须的。\n\n```swift\nlet individualScores = [75, 43, 103, 87, 12]\nvar teamScore = 0\nfor score in individualScores {\n    if score > 50 {\n        teamScore += 3\n    } else {\n        teamScore += 1\n    }\n}\nprint(teamScore) // 11\n```\n 在`if`语句中，条件必须是一个布尔表达式 — 这意味着像`if score { ... }`这样的代码将报错，而不会隐形的与 0 做对比。\n\n你可以一起使用`if`和`let`来处理缺失的情况。这些值可由可先值来代表。一个可选的值是一个具体的值或者是`nil`以表示值缺失。在类型后面加一个问号来标记这个变量的值是可选的。\n\n```swift\nvar optionalString: String? = \"Hello\"\nprint(optionalString == nil)\n\nvar optionalName: String? = \"John Appleseed\"\nvar greeting = \"Hello!\"\nif let name = optionalName {\n    greeting = \"Hello, \\(name)\"\n}\n```\n> `if  let name = optionalName `  这句的意思是：如果optionalName不是nil，就把值赋给 name，条件判断为 `true`，进入 if 语句块；如果optionalName为nil，条件会判断为 `false`，不进入 if  语句块\n\n`switch`支持任意类型的数据以及各种比较操作 — 不仅仅是整数以及测试相等。\n\n```swift\nlet vegetable = \"red pepper\"\nswitch vegetable {\n    case \"celery\":\n        print(\"Add some raisins and make ants on a log.\")\n    case \"cucumber\", \"watercress\":\n        print(\"That would make a good tea sandwich.\")\n    case let x where x.hasSuffix(\"pepper\"):\n        print(\"Is it a spicy \\(x)?\")\n    default:\n        print(\"Everything tastes good in soup.\")\n}\n// 打印 \"Is it a spicy red pepper?\"\n```\n\n> 不同于java ，swift的`case`语句不必加break。\n\n注意`let`在上述例子的等式中是如何使用的，它将匹配等式的值赋给常量`x`。`let x where x.hasSuffix(\"papper\")`这句话的意思是先把vegetable的值赋给`x`，如果赋值成功，再判断调用`hasSuffix`方法判断是否以`pepper`字符串结尾。\n\n运行`switch`中匹配到的子句之后，程序会退出switch语句，并不会继续向下运行，所以不需要在每个子句结尾写`break`。\n\n你可以使用`for-in`来遍历字典，需要两个变量来表示每个键值对。字典是一个无序的集合，所以他们的键和值以任意顺序迭代结束。\n\n下面的程序演示了找出最大值的操作：\n\n```swift\nlet interestingNumbers = [\n    \"Prime\": [2, 3, 5, 7, 11, 13],\n    \"Fibonacci\": [1, 1, 2, 3, 5, 8],\n    \"Square\": [1, 4, 9, 16, 25]]\nvar largest = 0\nfor (kind, numbers) in interestingNumbers {\n    for number in numbers {\n        if number > largest {\n            largest = number\n        }\n    }\n}\nprint(largest) // 25\n```\n\n使用`while`来重复运行一段代码直到不满足条件。循环条件也可以在结尾，保证能至少循环一次。\n\n```swift\nvar n = 2\nwhile n < 100 {\n    n = n * 2\n}\nprint(n) // 128\n\nvar m = 2\nrepeat {\n    m = m * 2\n} while m < 100\nprint(m) // 128\n```\n\n你可以在循环中使用`..<`来表示范围，也可以使用传统的写法，两者是等价的：\n\n```swift\nvar firstForLoop = 0\nfor i in 0..<4{\n    firstForLoop += i\n}\nprint(firstForLoop) // 6\n\nvar secondForLoop = 0\nfor var i = 0; i < 4; ++i {\n    secondForLoop += i\n}\nprint(secondForLoop) // 6\n```\n\n### 函数和闭包\n\n使用`func`来声明一个函数，使用名字和参数来调用函数。使用`->`来指定函数返回值的类型。\n\n```swift\nfunc greet(name: String, day: String) -> String {\n    return \"Hello \\(name), today is \\(day).\"\n}\ngreet(\"Bob\", day: \"Tuesday\")\n```\n\n使用元组来让一个函数返回多个值。该元组的元素可以用名称或数字来表示。\n\n```swift\nfunc calculateStatistics(scores: [Int]) -> (min: Int, max: Int, sum: Int) {\n    var min = scores[0]\n    var max = scores[0]\n    var sum = 0\n    for score in scores {\n        if score > max {\n            max = score\n        } else if score < min {\n            min = score\n        }\n        sum += score\n    }\n    return (min, max, sum)\n}\nlet statistics = calculateStatistics([5, 3, 100, 3, 9])\nprint(statistics.min)\nprint(statistics.max)\nprint(statistics.sum)\nprint(statistics.2)\n```\n\n函数可以带有可变个数的参数，这些参数的函数内表现为数组的形式：\n\n```swift\nfunc sumOf(numbers: Int...) -> Int {\n    var sum = 0\n    for number in numbers {\n        sum += number\n    }\n    return sum\n}\nsumOf()\nsumOf(42, 597, 12)\n```\n\n函数可以嵌套。被嵌套的函数可以访问外侧函数的变量，你可以使用嵌套函数来重构一个太长或者太复杂的函数 。\n\n```swift\nfunc returnFifteen() -> Int {\n    var y = 10\n    func add() {\n        y += 5\n    }\n    add()\n    return y\n}\nreturnFifteen()\n```\n\n函数是第一等类型，这意味着函数可以作为另一个函数的返回值。\n\n```swift\nfunc makeIncrementer() -> (Int -> Int) {\n    func addOne(number: Int) -> Int {\n        return 1 + number\n    }\n    return addOne\n}\nvar increment = makeIncrementer()\nincrement(7)\n```\n\n函数也可以当做参数传入另一个函数。\n\n```swift\nfunc hasAnyMatches(list: [Int], condition: Int -> Bool) -> Bool {\n    for item in list {\n        if condition(item) {\n            return true\n        }\n    }\n    return false\n}\nfunc lessThanTen(number: Int) -> Bool {\n    return number < 10\n}\nvar numbers = [20, 19, 7, 12]\nhasAnyMatches(numbers, condition: lessThanTen)\n```\n\n函数实际上是一种特殊的闭包：它是一段能之后被调取的代码。闭包中的代码能访问闭包所建作用域中能得到的变量和函数，即使闭包是在一个不同的作用域被执行的 — 你已经在嵌套函数例子中所看到。你可以使用`{}`来创建一个匿名闭包。使用`in`将参数和返回值类型声明与闭包函数体进行分离。\n\n```swift\nvar numbers = [20, 19, 7, 12]\nnumbers.map({\n    (number: Int) -> Int in\n    let result = 3 * number\n    return result\n})\n```\n\n有很多种创建更简洁的闭包的方法。如果一个闭包的类型已知，比如作为一个回调函数，你可以忽略参数的类型和返回值。单个语句闭包会把它语句的值当做结果返回。\n\n```swift\nlet mappedNumbers = numbers.map({ number in 3 * number })\nprint(mappedNumbers) // [60, 57, 21, 36]\n```\n\nswift内置了一组变量(`$0`、`$1`、`$2` …...)，上述代码还能更简单 \n\n```swift\nmappedNumbers = numbers.map({ $0 * 3 })\nprint(mappedNumbers)\n```\n\n你可以通过参数位置而不是参数名字引用 参数 — 这个方法在非常短的闭包中非常有用。当一个闭包作为最后一个参数传给一个函数的时候，它可以直接跟在括号后面。当一个闭包是传给函数的唯一参数，你可以完全忽略括号。\n\n```swift\nlet sortedNumbers = numbers.sort{ $0 > $1 }\nprint(sortedNumbers) // [20, 19, 12, 7]\n```\n\n### 对象和类\n\n使用`class`和类名来创建一个类。类中属性的声明和常量、变量声明一样，唯一的区别就是它们的上下文是类。同样，方法和函数声明也一样。\n\n```swift\nclass Shape {\n    var numberOfSides = 0\n    func simpleDescription() -> String {\n        return \"A shape with \\(numberOfSides) sides.\"\n    }\n}\n```\n\n要创建一个类的实例，在类名后面加上括号。使用点语法来访问实例的属性和方法。\n\n```swift\nvar shape = Shape()\nshape.numberOfSides = 7\nvar shapeDescription = shape.simpleDescription()\n```\n\n这个版本的`Shape`类缺少了一些重要的东西：一个构造函数来初始化类实例。使用`init`来创建一个构造器。\n\n```swift\nclass NamesShape {\n    var numberOfSides: Int = 0\n    var name: String\n    init (name: String) {\n        self.name = name\n    }\n    func simpleDescription() -> String {\n        return \"A shape with \\(numberOfSides) sides.\"\n    }\n}\n```\n\n注意`self`被用来区别实例变量。当你创建实例的时候，像传入函数参数一样给类传入构造器的参数。\n\n每个属性都需要赋值 — 无论是通过声明（就像`numberOfSides`）还是通过构造器（就像`name`）\n\n如果你需要在删除对象之前进行一些清理工作，使用`deinit`创建一个析构函数。\n\n子类的定义方法是在它们的类名后面加上父类的名字，用冒号分割。创建类的时候并不需要一个标准的根类，所以你可以忽略父类。\n\n子类如果要重写父类的方法的话，需要用`override`标记 — 如果没有添加`override`就重写父类的方法的话，编译器会报错。编译器同样会检测`override`标记的方法是否确实在父类中。\n\n```swift\nclass Square: NamesShape {\n    var sideLength: Double\n    init(sideLength: Double, name: String) {\n        self.sideLength = sideLength\n        super.init(name: name)\n        numberOfSides = 4\n    }\n\n    func area() -> Double {\n        return sideLength * sideLength\n    }\n    override func simpleDescription() -> String {\n        return \"A square with sides of length \\(sideLength).\"\n    }\n}\nlet test = Square(sideLength: 5.2, name: \"my test square\")\ntest.area() // 27.04\ntest.simpleDescription() // \"A square with sides of length 5.2\"\n```\n\n除了储存简单的属性之外，属性可以有 `getter`和`settter`。\n\n```swift\nclass EquilateralTriangle: NamesShape {\n    var sideLength: Double = 0.0\n    init(sideLength: Double, name: String) {\n        self.sideLength = sideLength\n        super.init(name: name)\n        numberOfSides = 4\n    }\n    var perimeter: Double {\n        get{\n            return 3.0 * sideLength\n        }\n        set {\n            sideLength = newValue / 3.0\n        }\n    }\n    override func simpleDescription() -> String {\n        return \"An equilateral triagle with sides of length \\(sideLength).\"\n    }\n}\nlet triangle = EquilateralTriangle(sideLength: 3.1, name: \"a triangle\")\nprint(triangle.perimeter) // 9.3\ntriangle.perimeter = 9.9\nprint(triangle.sideLength) // 3.3\n```\n\n在`perimeter`的`setter`中，新值的名字是`newValue`。你可以在`set`之后显示的设置一人名字。\n\n注意`EquilateralTriangle`类的构造器执行了三步：\n\n1. 设置子类声明的属性\n2. 调用父类的构造器\n3. 改变父类定义的属性值。其它的工作比如调用方法、getter和setter也可以在这个阶段完成。\n\n如果你不需要计算属性，但是仍然需要在设置一相新值之前或者之后运行代码，使用`willSet`和`didSet`。\n\n比如，下面的类确保三角形的边长总是和正方形的边长相同。\n\n```swift\nclass TriangleAndSquare {\n    var triangle: EquilateralTriangle {\n        willSet {\n            square.sideLength = newValue.sideLength\n        }\n    }\n    var square: Square {\n        willSet{\n            triangle.sideLength = newValue.sideLength\n        }\n    }\n    init(size: Double, name: String) {\n        square = Square(sideLength: size, name: name)\n        triangle = EquilateralTriangle(sideLength: size, name: name)\n    }\n}\nvar triangleAndSquare = TriangleAndSquare(size: 10, name: \"another test shape\")\nprint(triangleAndSquare.square.sideLength) // 10\nprint(triangleAndSquare.triangle.sideLength) // 10\ntriangleAndSquare.square = Square(sideLength: 50, name: \"larger square\")\nprint(triangleAndSquare.triangle.sideLength) // 50\n```\n\n处理变量的可选值时，你可以在操作（比如方法、属性和子脚本）之前加`?`。如果 `?`之前的值是`nil`，`?`后面的东西都会被忽略，并且整个表达式返回`nil`。否则，`?`之后的东西都会被运行。在这两种情况下，整个表达 式的值也是一个可选值。\n\n```swift\nlet optionalSquare: Square? = Square(sideLength: 2.5, name: \"optional square\")\nlet sideLength = optionalSquare?.sideLength\n```\n### 枚举和结构体\n\n使用`enum`来创建一个枚举。就像类的其他所有命名类型一样，枚举可以包含方法。\n\n```swift\nenum Rank: Int {\n    case Ace = 1\n    case Two, Three, Four, Five, Six, Seven, Eight, Nine, Ten\n    case Jack, Queen, King\n    func simpleDescription() -> String {\n        switch self {\n        case .Ace:\n            return \"ace\"\n        case .Jack:\n            return \"jack\"\n        case .Queen:\n            return \"queen\"\n        case .King:\n            return \"king\"\n        default:\n            return String(self.rawValue)\n        }\n    }\n}\nlet ace = Rank.Ace\nlet aceRawValue = ace.rawValue\n```\n\n在上面的例子中，枚举原始值的类型是`Int`，所以你只需要设置第一个原始值。剩下的原始值会按照顺序赋值。你也可以使用字符串或者浮点数作为枚举的原始值。使用`rawValue`属性来访问一个枚举成员的原始值。\n\n使用`init?(rawValue:) `初始化构造器在原始值和枚举值之间进行转换。\n\n```swift\nif let convertedRank = Rank(rawValue: 3) {\n    let threeDescription = convertedRank.simpleDescription()\n}\n```\n\n枚举的成员值是实际值，并不是原始值的另一种表达方法。实际上，以防原始值没有意义，你不需要设置。\n\n```swift\nenum Suit {\n    case Spades, Hearts, Diamonds, Clubs\n    func simpleDescription() -> String {\n        switch self {\n        case .Spades:\n            return \"spades\"\n        case .Hearts:\n            return \"hearts\"\n        case .Diamonds:\n            return \"diamonds\"\n        case .Clubs:\n            return \"clubs\"\n        }\n    }\n}\nlet hearts = Suit.Hearts\nlet heartsDescription = hearts.simpleDescription()\n```\n\n注意，有两种方式可以引用`Hearts`成员：给`hearts`常量赋值时，枚举成员`Suit.Hearts`需要用全名来引用，因为常量没有显式指定类型。在`switch`里，枚举成员使用缩写`.Hearts`来引用，因为`self`的值已经知道是一个`suit`。已知变量类型的情况下你可以使用缩写。\n\n使用`struct`来创建一个结构体。结构体和类有很多相同的地方，比如方法和构造器。它们之间最大的一个区别就是结构体是传值，类是传引用。\n\n```swift\nstruct Card {\n    var rank: Rank\n    var suit: Suit\n    func simpleDescription() -> String {\n        return \"The \\(rank.simpleDescription()) of \\(suit.simpleDescription())\"\n    }\n}\nlet threeOfSpades = Card(rank: .Three, suit: .Spades)\nlet threeOfSpadesDescription = threeOfSpades.simpleDescription()\n```\n\n一个枚举成员的实例可以有实例值。相同枚举成员的实例可以有不同的值。创建实例的时候传入值即可。实例值和原始值是不同的：枚举成员的原始值对于所有实例都是相同的，而且你是在定义枚举的时候设置原始值。\n\n例如，考虑从服务器获取日出和日落的时间。服务器会返回正常结果或者错误信息。\n\n```swift\nenum ServerResponse {\n    case Result(String, String)\n    case Error(String)\n}\nlet success = ServerResponse.Result(\"6:00 am\", \"8:09 pm\")\nlet failure = ServerResponse.Error(\"Out of cheese.\")\nswitch success {\ncase let .Result(sunrise, sunset):\n    let serverResponse = \"Sunrise is at \\(sunrise) and sunset is at \\(sunset).\"\ncase let .Error(error):\n    let serverResponse = \"Failure... \\(error)\"\n}\n```\n\n注意如何从`ServerResponse`中提取日升和日落时间并用得到的值用来和`switch`的情况做比较。\n\n### 协议和扩展\n\n使用`protocol`来声明一个协议。\n\n```swift\nprotocol ExampleProtocol {\n    var simpleDescription: String { get }\n    mutating func adjust()\n}\n```\n\n类、枚举和结构体都可以实现协议。\n\n```swift\nclass SimpleClass: ExampleProtocol {\n    var simpleDescription: String = \"A very simple class.\"\n    var anotherProperty: Int = 69105\n    func adjust() {\n        simpleDescription += \" Now 100% adjusted.\"\n    }\n}\nvar a = SimpleClass()\na.adjust()\nlet aDescription = a.simpleDescription\nstruct SimpleStructure: ExampleProtocol {\n    var simpleDescription: String = \"A simple structure\"\n    mutating func adjust() {\n        simpleDescription += \"(adjusted)\"\n    }\n}\nvar b = SimpleStructure()\nb.adjust()\nlet bDescription = b.simpleDescription\n```\n\n注意声明`SimpleStructure`时候`mutating`关键字用来标记一个会修改结构体的方法。`SimpleClass`的声明不需要标记任何方法，因为类中的方法通常可以修改类属性（类的性质）\n\n使用`extension`来为现有的类型添加功能，比如新的方法和计算属性。你可以使用扩展在别处修改定义，甚至是从外部库或者框架引入的一个类型，使得这个类型遵循某个协议。\n\n```swift\nextension Int: ExampleProtocol {\n    var simpleDescription: String {\n        return \"The number \\(self)\"\n    }\n    mutating func adjust() {\n        self += 42\n    }\n}\nprint(7.simpleDescription) // The number 7\n```\n\n你可以像使用其他命名类型一样使用协议名 — 例如，创建一个有不同类型但是都实现一个协议的对象集合。当你处理类型是协议的值时，协议外定义的方法不可用。\n\n```swift\nlet protocolValue: ExampleProtocol = a\nprint(protocolValue.simpleDescription) //A very simple class. Now 100% adjusted.\n```\n\n即使`protocolValue`变量运行时的类型是`simpleClass`，编译器会把它的类型当做`ExampleProtocol`。这表示你不能调用类在它实现的协议之外实现的方法或属性。\n\n### 泛型\n\n在尖括号里写一个名字来创建一个泛型函数或者类型。\n\n```swift\nfunc repeatItem<Item>(item: Item, numberOfTimes: Int) -> [Item] {\n    var result = [Item]()\n    for _ in 0..<numberOfTimes {\n        result.append(item)\n    }\n    return result\n}\nrepeatItem(\"knock\", numberOfTimes: 4) // [\"knock\", \"knock\", \"knock\", \"knock\"]\n```\n\n你也可以创建泛型函数 、方法、类、枚举和结构体。\n\n```swift\n// Reimplement the Swift standard library's optional type\nenum OptionalValue<Wrapped> {\n    case None\n    case Some(Wrapped)\n}\nvar possibleInteger: OptionalValue<Int> = .None\npossibleInteger = .Some(100)\n```\n\n在类型名后面的使用`where`来指定对类型的需求，比如，限定类型实现某一个协议，限定两个类型是相同的，或者限定某个类必须有一个特定的父类。\n\n```swift\nfunc anyCommonElements<T: SequenceType, U: SequenceType where T.Generator.Element: Equatable, T.Generator.Element == U.Generator.Element>(lhs: T, _ rhs: U) -> Bool {\n    for lhsItem in lhs {\n        for rhsItem in rhs {\n            if lhsItem == rhsItem {\n                return true\n            }\n        }\n    }\n    return false\n}\nanyCommonElements([1, 2, 3], [3])\n```\n\n`<T: Equatable>`和`<T where T: Equatable>`是等价的。","slug":"Swift/swift-basic","published":1,"updated":"2018-05-20T13:04:25.678Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61e30008izcbiawgxbl0","content":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><blockquote>\n<p>本文摘至：《The Swift Programming Language》</p>\n</blockquote>\n<p>Swift是一种新的编程语言，用于编写ios，OS X和watch OS应用程序。Swift结合了C和Objective-C的优点并且不受C兼容性的限制。Swift采用安全的编程模式并添加了很多新特性，这将使编程更简单，更灵活，也更有趣。Swift是基于成熟而且倍受喜爱的Cocoa和Cocoa Touch框架，它的降临将重新定义软件开发。</p>\n<blockquote>\n<p>使用Playground编写Swift，可以实现查看。打开Xcode，创建一个Playground文件(File –&gt; New –&gt; Playground)。</p>\n<p>Tips:  把鼠标放在Playground的右边区域，会有个小眼睛的图标和一个小白圈，点击有惊喜</p>\n</blockquote>\n<p><img src=\"/img/swift/swift-playground.png\" alt=\"swift-playground\"></p>\n<a id=\"more\"></a>\n<p>画正弦 <img src=\"/img/swift/swift-sin.png\" alt=\"swift-sin\"></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> num: <span class=\"type\">Double</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">1</span>...<span class=\"number\">100</span> &#123;</span><br><span class=\"line\">    num = sin(<span class=\"type\">Double</span>(i) / <span class=\"number\">10</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Swift-初见\"><a href=\"#Swift-初见\" class=\"headerlink\" title=\"Swift 初见\"></a>Swift 初见</h2><p>通常来说，编程语言教程中的第一个程序应该在屏幕上打印”Hello, world”。在Swift中，可以用一行代码实现。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"Hello, world!\"</span>)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>不同于java等语言，swift并不需要在语句结尾强制加上一个分号<code>;</code>。如果一行写2个语句，需要加上分号<code>;</code></p>\n</blockquote>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> explicitFloat: <span class=\"type\">Float</span> = <span class=\"number\">70</span>; <span class=\"keyword\">let</span> explicitDouble: <span class=\"type\">Double</span> = <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"简单值\"><a href=\"#简单值\" class=\"headerlink\" title=\"简单值\"></a>简单值</h3><p>使用<code>let</code>来声明常量，使用<code>var</code>来声明变量。一个常量的值，在编译的时候，并不需要有明确的值，但是你只能为它赋值一次。类似java的final修饰的变量</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> myVariable = <span class=\"number\">42</span></span><br><span class=\"line\">myVariable = <span class=\"number\">50</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> myConstant = <span class=\"number\">42</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>你不用明确的声明类型，声明的同时赋值的话，编译器会自动推断类型。在上面的例子中，编译器推断出 <code>myVariable</code>是一个整数(integer)，因为它的初始值是整数。</p>\n</blockquote>\n<p>如果 初始值没有提供足够的信息(或者没有初始值)，那你需要在变量后面声明类型，用冒号分割。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> implicitInteger = <span class=\"number\">70</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> implicitDouble = <span class=\"number\">70.0</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> explicitDouble: <span class=\"type\">Double</span> = <span class=\"number\">70</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> explicitFloat: <span class=\"type\">Float</span> = <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n<p>值永远不会被隐式转换成其他类型。如果你需要把一个值转换成其它类型，请显示转换。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> label = <span class=\"string\">\"The width is\"</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> width = <span class=\"number\">94</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> widthLabel = label + <span class=\"type\">String</span>(width)</span><br></pre></td></tr></table></figure>\n<p>有一种更简单的把值转换成字符串的方法：把值写到括号中，并且在括号之前写一个反斜杠。例如：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> apples = <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> oranges = <span class=\"number\">5</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> appleSummary = <span class=\"string\">\"I have \\(apples) apples.\"</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> fruitSummary = <span class=\"string\">\"I have \\(apples + oranges) pieces of fruit.\"</span></span><br></pre></td></tr></table></figure>\n<p>使用方括号<code>[]</code>来创建数组和字典，并使用下标或者键（key）来访问元素。最后一个元素后面允许有个逗号。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> shoppingList = [<span class=\"string\">\"Catfish\"</span>, <span class=\"string\">\"water\"</span>, <span class=\"string\">\"tulips\"</span>, <span class=\"string\">\"blue paint\"</span>]</span><br><span class=\"line\">shoppingList[<span class=\"number\">1</span>] = <span class=\"string\">\"bottle of water\"</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> occupations = [<span class=\"string\">\"Malcolm\"</span>: <span class=\"string\">\"Captain\"</span>, <span class=\"string\">\"Keylee\"</span>: <span class=\"string\">\"Mechanic\"</span>,]</span><br><span class=\"line\">occupations[<span class=\"string\">\"Jayne\"</span>] = <span class=\"string\">\"Public Relations\"</span></span><br></pre></td></tr></table></figure>\n<p>要创建一个空数组或者字典，使用初始化语法。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> emptyArray = [<span class=\"type\">String</span>]()</span><br><span class=\"line\"><span class=\"keyword\">let</span> emptyDictionary = [<span class=\"type\">String</span>: <span class=\"type\">Float</span>]()</span><br></pre></td></tr></table></figure>\n<p>如果类型信息可以被推断出来，你可以用<code>[]</code>和<code>[:]</code>来创建空数组和空字典 — 就像你声明变量或者给函数传参数的时候一样。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shoppingList = []</span><br><span class=\"line\">occupations = [:]</span><br></pre></td></tr></table></figure>\n<h3 id=\"控制流\"><a href=\"#控制流\" class=\"headerlink\" title=\"控制流\"></a>控制流</h3><p>使用<code>if</code>和<code>switch</code>来进行条件操作，使用<code>for-in</code>、<code>for</code>、<code>while</code>和<code>repeat-while</code>来进行循环。包裹条件和循环变量括号可以省略，但是语句体的大括号是必须的。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> individualScores = [<span class=\"number\">75</span>, <span class=\"number\">43</span>, <span class=\"number\">103</span>, <span class=\"number\">87</span>, <span class=\"number\">12</span>]</span><br><span class=\"line\"><span class=\"keyword\">var</span> teamScore = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> score <span class=\"keyword\">in</span> individualScores &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> score &gt; <span class=\"number\">50</span> &#123;</span><br><span class=\"line\">        teamScore += <span class=\"number\">3</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        teamScore += <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(teamScore) <span class=\"comment\">// 11</span></span><br></pre></td></tr></table></figure>\n<p> 在<code>if</code>语句中，条件必须是一个布尔表达式 — 这意味着像<code>if score { ... }</code>这样的代码将报错，而不会隐形的与 0 做对比。</p>\n<p>你可以一起使用<code>if</code>和<code>let</code>来处理缺失的情况。这些值可由可先值来代表。一个可选的值是一个具体的值或者是<code>nil</code>以表示值缺失。在类型后面加一个问号来标记这个变量的值是可选的。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> optionalString: <span class=\"type\">String</span>? = <span class=\"string\">\"Hello\"</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(optionalString == <span class=\"literal\">nil</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> optionalName: <span class=\"type\">String</span>? = <span class=\"string\">\"John Appleseed\"</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> greeting = <span class=\"string\">\"Hello!\"</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> name = optionalName &#123;</span><br><span class=\"line\">    greeting = <span class=\"string\">\"Hello, \\(name)\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>if  let name = optionalName</code>  这句的意思是：如果optionalName不是nil，就把值赋给 name，条件判断为 <code>true</code>，进入 if 语句块；如果optionalName为nil，条件会判断为 <code>false</code>，不进入 if  语句块</p>\n</blockquote>\n<p><code>switch</code>支持任意类型的数据以及各种比较操作 — 不仅仅是整数以及测试相等。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> vegetable = <span class=\"string\">\"red pepper\"</span></span><br><span class=\"line\"><span class=\"keyword\">switch</span> vegetable &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">\"celery\"</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Add some raisins and make ants on a log.\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">\"cucumber\"</span>, <span class=\"string\">\"watercress\"</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"That would make a good tea sandwich.\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"keyword\">let</span> x <span class=\"keyword\">where</span> x.hasSuffix(<span class=\"string\">\"pepper\"</span>):</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Is it a spicy \\(x)?\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">default</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Everything tastes good in soup.\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 打印 \"Is it a spicy red pepper?\"</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>不同于java ，swift的<code>case</code>语句不必加break。</p>\n</blockquote>\n<p>注意<code>let</code>在上述例子的等式中是如何使用的，它将匹配等式的值赋给常量<code>x</code>。<code>let x where x.hasSuffix(&quot;papper&quot;)</code>这句话的意思是先把vegetable的值赋给<code>x</code>，如果赋值成功，再判断调用<code>hasSuffix</code>方法判断是否以<code>pepper</code>字符串结尾。</p>\n<p>运行<code>switch</code>中匹配到的子句之后，程序会退出switch语句，并不会继续向下运行，所以不需要在每个子句结尾写<code>break</code>。</p>\n<p>你可以使用<code>for-in</code>来遍历字典，需要两个变量来表示每个键值对。字典是一个无序的集合，所以他们的键和值以任意顺序迭代结束。</p>\n<p>下面的程序演示了找出最大值的操作：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> interestingNumbers = [</span><br><span class=\"line\">    <span class=\"string\">\"Prime\"</span>: [<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>],</span><br><span class=\"line\">    <span class=\"string\">\"Fibonacci\"</span>: [<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>],</span><br><span class=\"line\">    <span class=\"string\">\"Square\"</span>: [<span class=\"number\">1</span>, <span class=\"number\">4</span>, <span class=\"number\">9</span>, <span class=\"number\">16</span>, <span class=\"number\">25</span>]]</span><br><span class=\"line\"><span class=\"keyword\">var</span> largest = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (kind, numbers) <span class=\"keyword\">in</span> interestingNumbers &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> number <span class=\"keyword\">in</span> numbers &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> number &gt; largest &#123;</span><br><span class=\"line\">            largest = number</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(largest) <span class=\"comment\">// 25</span></span><br></pre></td></tr></table></figure>\n<p>使用<code>while</code>来重复运行一段代码直到不满足条件。循环条件也可以在结尾，保证能至少循环一次。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> n = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> n &lt; <span class=\"number\">100</span> &#123;</span><br><span class=\"line\">    n = n * <span class=\"number\">2</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(n) <span class=\"comment\">// 128</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> m = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">repeat</span> &#123;</span><br><span class=\"line\">    m = m * <span class=\"number\">2</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">while</span> m &lt; <span class=\"number\">100</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(m) <span class=\"comment\">// 128</span></span><br></pre></td></tr></table></figure>\n<p>你可以在循环中使用<code>..&lt;</code>来表示范围，也可以使用传统的写法，两者是等价的：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> firstForLoop = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;<span class=\"number\">4</span>&#123;</span><br><span class=\"line\">    firstForLoop += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(firstForLoop) <span class=\"comment\">// 6</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> secondForLoop = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; ++i &#123;</span><br><span class=\"line\">    secondForLoop += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(secondForLoop) <span class=\"comment\">// 6</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"函数和闭包\"><a href=\"#函数和闭包\" class=\"headerlink\" title=\"函数和闭包\"></a>函数和闭包</h3><p>使用<code>func</code>来声明一个函数，使用名字和参数来调用函数。使用<code>-&gt;</code>来指定函数返回值的类型。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">greet</span><span class=\"params\">(name: String, day: String)</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"Hello \\(name), today is \\(day).\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">greet(<span class=\"string\">\"Bob\"</span>, day: <span class=\"string\">\"Tuesday\"</span>)</span><br></pre></td></tr></table></figure>\n<p>使用元组来让一个函数返回多个值。该元组的元素可以用名称或数字来表示。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">calculateStatistics</span><span class=\"params\">(scores: [Int])</span></span> -&gt; (<span class=\"built_in\">min</span>: <span class=\"type\">Int</span>, <span class=\"built_in\">max</span>: <span class=\"type\">Int</span>, sum: <span class=\"type\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> <span class=\"built_in\">min</span> = scores[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">var</span> <span class=\"built_in\">max</span> = scores[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> score <span class=\"keyword\">in</span> scores &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> score &gt; <span class=\"built_in\">max</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">max</span> = score</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> score &lt; <span class=\"built_in\">min</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">min</span> = score</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        sum += score</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"built_in\">min</span>, <span class=\"built_in\">max</span>, sum)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> statistics = calculateStatistics([<span class=\"number\">5</span>, <span class=\"number\">3</span>, <span class=\"number\">100</span>, <span class=\"number\">3</span>, <span class=\"number\">9</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.<span class=\"built_in\">min</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.<span class=\"built_in\">max</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.sum)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.<span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n<p>函数可以带有可变个数的参数，这些参数的函数内表现为数组的形式：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">sumOf</span><span class=\"params\">(numbers: Int...)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> number <span class=\"keyword\">in</span> numbers &#123;</span><br><span class=\"line\">        sum += number</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">sumOf()</span><br><span class=\"line\">sumOf(<span class=\"number\">42</span>, <span class=\"number\">597</span>, <span class=\"number\">12</span>)</span><br></pre></td></tr></table></figure>\n<p>函数可以嵌套。被嵌套的函数可以访问外侧函数的变量，你可以使用嵌套函数来重构一个太长或者太复杂的函数 。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">returnFifteen</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> y = <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">add</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        y += <span class=\"number\">5</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    add()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> y</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">returnFifteen()</span><br></pre></td></tr></table></figure>\n<p>函数是第一等类型，这意味着函数可以作为另一个函数的返回值。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">makeIncrementer</span><span class=\"params\">()</span></span> -&gt; (<span class=\"type\">Int</span> -&gt; <span class=\"type\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">addOne</span><span class=\"params\">(number: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span> + number</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> addOne</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> increment = makeIncrementer()</span><br><span class=\"line\">increment(<span class=\"number\">7</span>)</span><br></pre></td></tr></table></figure>\n<p>函数也可以当做参数传入另一个函数。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">hasAnyMatches</span><span class=\"params\">(list: [Int], condition: Int -&gt; Bool)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> list &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> condition(item) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">lessThanTen</span><span class=\"params\">(number: Int)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> number &lt; <span class=\"number\">10</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> numbers = [<span class=\"number\">20</span>, <span class=\"number\">19</span>, <span class=\"number\">7</span>, <span class=\"number\">12</span>]</span><br><span class=\"line\">hasAnyMatches(numbers, condition: lessThanTen)</span><br></pre></td></tr></table></figure>\n<p>函数实际上是一种特殊的闭包：它是一段能之后被调取的代码。闭包中的代码能访问闭包所建作用域中能得到的变量和函数，即使闭包是在一个不同的作用域被执行的 — 你已经在嵌套函数例子中所看到。你可以使用<code>{}</code>来创建一个匿名闭包。使用<code>in</code>将参数和返回值类型声明与闭包函数体进行分离。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> numbers = [<span class=\"number\">20</span>, <span class=\"number\">19</span>, <span class=\"number\">7</span>, <span class=\"number\">12</span>]</span><br><span class=\"line\">numbers.<span class=\"built_in\">map</span>(&#123;</span><br><span class=\"line\">    (number: <span class=\"type\">Int</span>) -&gt; <span class=\"type\">Int</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> result = <span class=\"number\">3</span> * number</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>有很多种创建更简洁的闭包的方法。如果一个闭包的类型已知，比如作为一个回调函数，你可以忽略参数的类型和返回值。单个语句闭包会把它语句的值当做结果返回。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> mappedNumbers = numbers.<span class=\"built_in\">map</span>(&#123; number <span class=\"keyword\">in</span> <span class=\"number\">3</span> * number &#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mappedNumbers) <span class=\"comment\">// [60, 57, 21, 36]</span></span><br></pre></td></tr></table></figure>\n<p>swift内置了一组变量(<code>$0</code>、<code>$1</code>、<code>$2</code> ……)，上述代码还能更简单 </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mappedNumbers = numbers.<span class=\"built_in\">map</span>(&#123; $<span class=\"number\">0</span> * <span class=\"number\">3</span> &#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mappedNumbers)</span><br></pre></td></tr></table></figure>\n<p>你可以通过参数位置而不是参数名字引用 参数 — 这个方法在非常短的闭包中非常有用。当一个闭包作为最后一个参数传给一个函数的时候，它可以直接跟在括号后面。当一个闭包是传给函数的唯一参数，你可以完全忽略括号。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> sortedNumbers = numbers.<span class=\"built_in\">sort</span>&#123; $<span class=\"number\">0</span> &gt; $<span class=\"number\">1</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(sortedNumbers) <span class=\"comment\">// [20, 19, 12, 7]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"对象和类\"><a href=\"#对象和类\" class=\"headerlink\" title=\"对象和类\"></a>对象和类</h3><p>使用<code>class</code>和类名来创建一个类。类中属性的声明和常量、变量声明一样，唯一的区别就是它们的上下文是类。同样，方法和函数声明也一样。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> numberOfSides = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"A shape with \\(numberOfSides) sides.\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>要创建一个类的实例，在类名后面加上括号。使用点语法来访问实例的属性和方法。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> shape = <span class=\"type\">Shape</span>()</span><br><span class=\"line\">shape.numberOfSides = <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> shapeDescription = shape.simpleDescription()</span><br></pre></td></tr></table></figure>\n<p>这个版本的<code>Shape</code>类缺少了一些重要的东西：一个构造函数来初始化类实例。使用<code>init</code>来创建一个构造器。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NamesShape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> numberOfSides: <span class=\"type\">Int</span> = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">init</span> (name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.name = name</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"A shape with \\(numberOfSides) sides.\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注意<code>self</code>被用来区别实例变量。当你创建实例的时候，像传入函数参数一样给类传入构造器的参数。</p>\n<p>每个属性都需要赋值 — 无论是通过声明（就像<code>numberOfSides</code>）还是通过构造器（就像<code>name</code>）</p>\n<p>如果你需要在删除对象之前进行一些清理工作，使用<code>deinit</code>创建一个析构函数。</p>\n<p>子类的定义方法是在它们的类名后面加上父类的名字，用冒号分割。创建类的时候并不需要一个标准的根类，所以你可以忽略父类。</p>\n<p>子类如果要重写父类的方法的话，需要用<code>override</code>标记 — 如果没有添加<code>override</code>就重写父类的方法的话，编译器会报错。编译器同样会检测<code>override</code>标记的方法是否确实在父类中。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Square</span>: <span class=\"title\">NamesShape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sideLength: <span class=\"type\">Double</span></span><br><span class=\"line\">    <span class=\"keyword\">init</span>(sideLength: <span class=\"type\">Double</span>, name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.sideLength = sideLength</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>(name: name)</span><br><span class=\"line\">        numberOfSides = <span class=\"number\">4</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">area</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">Double</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sideLength * sideLength</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"A square with sides of length \\(sideLength).\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> test = <span class=\"type\">Square</span>(sideLength: <span class=\"number\">5.2</span>, name: <span class=\"string\">\"my test square\"</span>)</span><br><span class=\"line\">test.area() <span class=\"comment\">// 27.04</span></span><br><span class=\"line\">test.simpleDescription() <span class=\"comment\">// \"A square with sides of length 5.2\"</span></span><br></pre></td></tr></table></figure>\n<p>除了储存简单的属性之外，属性可以有 <code>getter</code>和<code>settter</code>。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">EquilateralTriangle</span>: <span class=\"title\">NamesShape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sideLength: <span class=\"type\">Double</span> = <span class=\"number\">0.0</span></span><br><span class=\"line\">    <span class=\"keyword\">init</span>(sideLength: <span class=\"type\">Double</span>, name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.sideLength = sideLength</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>(name: name)</span><br><span class=\"line\">        numberOfSides = <span class=\"number\">4</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> perimeter: <span class=\"type\">Double</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">3.0</span> * sideLength</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">set</span> &#123;</span><br><span class=\"line\">            sideLength = newValue / <span class=\"number\">3.0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"An equilateral triagle with sides of length \\(sideLength).\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> triangle = <span class=\"type\">EquilateralTriangle</span>(sideLength: <span class=\"number\">3.1</span>, name: <span class=\"string\">\"a triangle\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangle.perimeter) <span class=\"comment\">// 9.3</span></span><br><span class=\"line\">triangle.perimeter = <span class=\"number\">9.9</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangle.sideLength) <span class=\"comment\">// 3.3</span></span><br></pre></td></tr></table></figure>\n<p>在<code>perimeter</code>的<code>setter</code>中，新值的名字是<code>newValue</code>。你可以在<code>set</code>之后显示的设置一人名字。</p>\n<p>注意<code>EquilateralTriangle</code>类的构造器执行了三步：</p>\n<ol>\n<li>设置子类声明的属性</li>\n<li>调用父类的构造器</li>\n<li>改变父类定义的属性值。其它的工作比如调用方法、getter和setter也可以在这个阶段完成。</li>\n</ol>\n<p>如果你不需要计算属性，但是仍然需要在设置一相新值之前或者之后运行代码，使用<code>willSet</code>和<code>didSet</code>。</p>\n<p>比如，下面的类确保三角形的边长总是和正方形的边长相同。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TriangleAndSquare</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> triangle: <span class=\"type\">EquilateralTriangle</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">willSet</span> &#123;</span><br><span class=\"line\">            square.sideLength = newValue.sideLength</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> square: <span class=\"type\">Square</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">willSet</span>&#123;</span><br><span class=\"line\">            triangle.sideLength = newValue.sideLength</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">init</span>(size: <span class=\"type\">Double</span>, name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        square = <span class=\"type\">Square</span>(sideLength: size, name: name)</span><br><span class=\"line\">        triangle = <span class=\"type\">EquilateralTriangle</span>(sideLength: size, name: name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> triangleAndSquare = <span class=\"type\">TriangleAndSquare</span>(size: <span class=\"number\">10</span>, name: <span class=\"string\">\"another test shape\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangleAndSquare.square.sideLength) <span class=\"comment\">// 10</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangleAndSquare.triangle.sideLength) <span class=\"comment\">// 10</span></span><br><span class=\"line\">triangleAndSquare.square = <span class=\"type\">Square</span>(sideLength: <span class=\"number\">50</span>, name: <span class=\"string\">\"larger square\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangleAndSquare.triangle.sideLength) <span class=\"comment\">// 50</span></span><br></pre></td></tr></table></figure>\n<p>处理变量的可选值时，你可以在操作（比如方法、属性和子脚本）之前加<code>?</code>。如果 <code>?</code>之前的值是<code>nil</code>，<code>?</code>后面的东西都会被忽略，并且整个表达式返回<code>nil</code>。否则，<code>?</code>之后的东西都会被运行。在这两种情况下，整个表达 式的值也是一个可选值。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> optionalSquare: <span class=\"type\">Square</span>? = <span class=\"type\">Square</span>(sideLength: <span class=\"number\">2.5</span>, name: <span class=\"string\">\"optional square\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> sideLength = optionalSquare?.sideLength</span><br></pre></td></tr></table></figure>\n<h3 id=\"枚举和结构体\"><a href=\"#枚举和结构体\" class=\"headerlink\" title=\"枚举和结构体\"></a>枚举和结构体</h3><p>使用<code>enum</code>来创建一个枚举。就像类的其他所有命名类型一样，枚举可以包含方法。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">Rank</span>: <span class=\"title\">Int</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Ace</span> = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Two</span>, <span class=\"type\">Three</span>, <span class=\"type\">Four</span>, <span class=\"type\">Five</span>, <span class=\"type\">Six</span>, <span class=\"type\">Seven</span>, <span class=\"type\">Eight</span>, <span class=\"type\">Nine</span>, <span class=\"type\">Ten</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Jack</span>, <span class=\"type\">Queen</span>, <span class=\"type\">King</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> <span class=\"keyword\">self</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Ace</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"ace\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Jack</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"jack\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Queen</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"queen\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">King</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"king\"</span></span><br><span class=\"line\">        <span class=\"keyword\">default</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"type\">String</span>(<span class=\"keyword\">self</span>.rawValue)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> ace = <span class=\"type\">Rank</span>.<span class=\"type\">Ace</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> aceRawValue = ace.rawValue</span><br></pre></td></tr></table></figure>\n<p>在上面的例子中，枚举原始值的类型是<code>Int</code>，所以你只需要设置第一个原始值。剩下的原始值会按照顺序赋值。你也可以使用字符串或者浮点数作为枚举的原始值。使用<code>rawValue</code>属性来访问一个枚举成员的原始值。</p>\n<p>使用<code>init?(rawValue:)</code>初始化构造器在原始值和枚举值之间进行转换。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> convertedRank = <span class=\"type\">Rank</span>(rawValue: <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> threeDescription = convertedRank.simpleDescription()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>枚举的成员值是实际值，并不是原始值的另一种表达方法。实际上，以防原始值没有意义，你不需要设置。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">Suit</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Spades</span>, <span class=\"type\">Hearts</span>, <span class=\"type\">Diamonds</span>, <span class=\"type\">Clubs</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> <span class=\"keyword\">self</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Spades</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"spades\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Hearts</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"hearts\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Diamonds</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"diamonds\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Clubs</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"clubs\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> hearts = <span class=\"type\">Suit</span>.<span class=\"type\">Hearts</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> heartsDescription = hearts.simpleDescription()</span><br></pre></td></tr></table></figure>\n<p>注意，有两种方式可以引用<code>Hearts</code>成员：给<code>hearts</code>常量赋值时，枚举成员<code>Suit.Hearts</code>需要用全名来引用，因为常量没有显式指定类型。在<code>switch</code>里，枚举成员使用缩写<code>.Hearts</code>来引用，因为<code>self</code>的值已经知道是一个<code>suit</code>。已知变量类型的情况下你可以使用缩写。</p>\n<p>使用<code>struct</code>来创建一个结构体。结构体和类有很多相同的地方，比如方法和构造器。它们之间最大的一个区别就是结构体是传值，类是传引用。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Card</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> rank: <span class=\"type\">Rank</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> suit: <span class=\"type\">Suit</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"The \\(rank.simpleDescription()) of \\(suit.simpleDescription())\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> threeOfSpades = <span class=\"type\">Card</span>(rank: .<span class=\"type\">Three</span>, suit: .<span class=\"type\">Spades</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> threeOfSpadesDescription = threeOfSpades.simpleDescription()</span><br></pre></td></tr></table></figure>\n<p>一个枚举成员的实例可以有实例值。相同枚举成员的实例可以有不同的值。创建实例的时候传入值即可。实例值和原始值是不同的：枚举成员的原始值对于所有实例都是相同的，而且你是在定义枚举的时候设置原始值。</p>\n<p>例如，考虑从服务器获取日出和日落的时间。服务器会返回正常结果或者错误信息。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">ServerResponse</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Result</span>(<span class=\"type\">String</span>, <span class=\"type\">String</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Error</span>(<span class=\"type\">String</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> success = <span class=\"type\">ServerResponse</span>.<span class=\"type\">Result</span>(<span class=\"string\">\"6:00 am\"</span>, <span class=\"string\">\"8:09 pm\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> failure = <span class=\"type\">ServerResponse</span>.<span class=\"type\">Error</span>(<span class=\"string\">\"Out of cheese.\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">switch</span> success &#123;</span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"keyword\">let</span> .<span class=\"type\">Result</span>(sunrise, sunset):</span><br><span class=\"line\">    <span class=\"keyword\">let</span> serverResponse = <span class=\"string\">\"Sunrise is at \\(sunrise) and sunset is at \\(sunset).\"</span></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"keyword\">let</span> .<span class=\"type\">Error</span>(error):</span><br><span class=\"line\">    <span class=\"keyword\">let</span> serverResponse = <span class=\"string\">\"Failure... \\(error)\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注意如何从<code>ServerResponse</code>中提取日升和日落时间并用得到的值用来和<code>switch</code>的情况做比较。</p>\n<h3 id=\"协议和扩展\"><a href=\"#协议和扩展\" class=\"headerlink\" title=\"协议和扩展\"></a>协议和扩展</h3><p>使用<code>protocol</code>来声明一个协议。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">protocol</span> <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> &#123; <span class=\"keyword\">get</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">mutating</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>类、枚举和结构体都可以实现协议。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SimpleClass</span>: <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> = <span class=\"string\">\"A very simple class.\"</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> anotherProperty: <span class=\"type\">Int</span> = <span class=\"number\">69105</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        simpleDescription += <span class=\"string\">\" Now 100% adjusted.\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"type\">SimpleClass</span>()</span><br><span class=\"line\">a.adjust()</span><br><span class=\"line\"><span class=\"keyword\">let</span> aDescription = a.simpleDescription</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">SimpleStructure</span>: <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> = <span class=\"string\">\"A simple structure\"</span></span><br><span class=\"line\">    <span class=\"keyword\">mutating</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        simpleDescription += <span class=\"string\">\"(adjusted)\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> b = <span class=\"type\">SimpleStructure</span>()</span><br><span class=\"line\">b.adjust()</span><br><span class=\"line\"><span class=\"keyword\">let</span> bDescription = b.simpleDescription</span><br></pre></td></tr></table></figure>\n<p>注意声明<code>SimpleStructure</code>时候<code>mutating</code>关键字用来标记一个会修改结构体的方法。<code>SimpleClass</code>的声明不需要标记任何方法，因为类中的方法通常可以修改类属性（类的性质）</p>\n<p>使用<code>extension</code>来为现有的类型添加功能，比如新的方法和计算属性。你可以使用扩展在别处修改定义，甚至是从外部库或者框架引入的一个类型，使得这个类型遵循某个协议。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">Int</span>: <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"The number \\(self)\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">mutating</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span> += <span class=\"number\">42</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">7</span>.simpleDescription) <span class=\"comment\">// The number 7</span></span><br></pre></td></tr></table></figure>\n<p>你可以像使用其他命名类型一样使用协议名 — 例如，创建一个有不同类型但是都实现一个协议的对象集合。当你处理类型是协议的值时，协议外定义的方法不可用。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> protocolValue: <span class=\"type\">ExampleProtocol</span> = a</span><br><span class=\"line\"><span class=\"built_in\">print</span>(protocolValue.simpleDescription) <span class=\"comment\">//A very simple class. Now 100% adjusted.</span></span><br></pre></td></tr></table></figure>\n<p>即使<code>protocolValue</code>变量运行时的类型是<code>simpleClass</code>，编译器会把它的类型当做<code>ExampleProtocol</code>。这表示你不能调用类在它实现的协议之外实现的方法或属性。</p>\n<h3 id=\"泛型\"><a href=\"#泛型\" class=\"headerlink\" title=\"泛型\"></a>泛型</h3><p>在尖括号里写一个名字来创建一个泛型函数或者类型。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">repeatItem</span>&lt;Item&gt;<span class=\"params\">(item: Item, numberOfTimes: Int)</span></span> -&gt; [<span class=\"type\">Item</span>] &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> result = [<span class=\"type\">Item</span>]()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"number\">_</span> <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;numberOfTimes &#123;</span><br><span class=\"line\">        result.append(item)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">repeatItem(<span class=\"string\">\"knock\"</span>, numberOfTimes: <span class=\"number\">4</span>) <span class=\"comment\">// [\"knock\", \"knock\", \"knock\", \"knock\"]</span></span><br></pre></td></tr></table></figure>\n<p>你也可以创建泛型函数 、方法、类、枚举和结构体。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Reimplement the Swift standard library's optional type</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">OptionalValue</span>&lt;<span class=\"title\">Wrapped</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">None</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Some</span>(<span class=\"type\">Wrapped</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> possibleInteger: <span class=\"type\">OptionalValue</span>&lt;<span class=\"type\">Int</span>&gt; = .<span class=\"type\">None</span></span><br><span class=\"line\">possibleInteger = .<span class=\"type\">Some</span>(<span class=\"number\">100</span>)</span><br></pre></td></tr></table></figure>\n<p>在类型名后面的使用<code>where</code>来指定对类型的需求，比如，限定类型实现某一个协议，限定两个类型是相同的，或者限定某个类必须有一个特定的父类。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">anyCommonElements</span>&lt;T: SequenceType, U: SequenceType where T.Generator.Element: Equatable, T.Generator.Element == U.Generator.Element&gt;<span class=\"params\">(lhs: T, <span class=\"number\">_</span> rhs: U)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> lhsItem <span class=\"keyword\">in</span> lhs &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> rhsItem <span class=\"keyword\">in</span> rhs &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> lhsItem == rhsItem &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">anyCommonElements([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">3</span>])</span><br></pre></td></tr></table></figure>\n<p><code>&lt;T: Equatable&gt;</code>和<code>&lt;T where T: Equatable&gt;</code>是等价的。</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><blockquote>\n<p>本文摘至：《The Swift Programming Language》</p>\n</blockquote>\n<p>Swift是一种新的编程语言，用于编写ios，OS X和watch OS应用程序。Swift结合了C和Objective-C的优点并且不受C兼容性的限制。Swift采用安全的编程模式并添加了很多新特性，这将使编程更简单，更灵活，也更有趣。Swift是基于成熟而且倍受喜爱的Cocoa和Cocoa Touch框架，它的降临将重新定义软件开发。</p>\n<blockquote>\n<p>使用Playground编写Swift，可以实现查看。打开Xcode，创建一个Playground文件(File –&gt; New –&gt; Playground)。</p>\n<p>Tips:  把鼠标放在Playground的右边区域，会有个小眼睛的图标和一个小白圈，点击有惊喜</p>\n</blockquote>\n<p><img src=\"/img/swift/swift-playground.png\" alt=\"swift-playground\"></p>","more":"<p>画正弦 <img src=\"/img/swift/swift-sin.png\" alt=\"swift-sin\"></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> num: <span class=\"type\">Double</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">1</span>...<span class=\"number\">100</span> &#123;</span><br><span class=\"line\">    num = sin(<span class=\"type\">Double</span>(i) / <span class=\"number\">10</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Swift-初见\"><a href=\"#Swift-初见\" class=\"headerlink\" title=\"Swift 初见\"></a>Swift 初见</h2><p>通常来说，编程语言教程中的第一个程序应该在屏幕上打印”Hello, world”。在Swift中，可以用一行代码实现。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">\"Hello, world!\"</span>)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>不同于java等语言，swift并不需要在语句结尾强制加上一个分号<code>;</code>。如果一行写2个语句，需要加上分号<code>;</code></p>\n</blockquote>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> explicitFloat: <span class=\"type\">Float</span> = <span class=\"number\">70</span>; <span class=\"keyword\">let</span> explicitDouble: <span class=\"type\">Double</span> = <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"简单值\"><a href=\"#简单值\" class=\"headerlink\" title=\"简单值\"></a>简单值</h3><p>使用<code>let</code>来声明常量，使用<code>var</code>来声明变量。一个常量的值，在编译的时候，并不需要有明确的值，但是你只能为它赋值一次。类似java的final修饰的变量</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> myVariable = <span class=\"number\">42</span></span><br><span class=\"line\">myVariable = <span class=\"number\">50</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> myConstant = <span class=\"number\">42</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>你不用明确的声明类型，声明的同时赋值的话，编译器会自动推断类型。在上面的例子中，编译器推断出 <code>myVariable</code>是一个整数(integer)，因为它的初始值是整数。</p>\n</blockquote>\n<p>如果 初始值没有提供足够的信息(或者没有初始值)，那你需要在变量后面声明类型，用冒号分割。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> implicitInteger = <span class=\"number\">70</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> implicitDouble = <span class=\"number\">70.0</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> explicitDouble: <span class=\"type\">Double</span> = <span class=\"number\">70</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> explicitFloat: <span class=\"type\">Float</span> = <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n<p>值永远不会被隐式转换成其他类型。如果你需要把一个值转换成其它类型，请显示转换。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> label = <span class=\"string\">\"The width is\"</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> width = <span class=\"number\">94</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> widthLabel = label + <span class=\"type\">String</span>(width)</span><br></pre></td></tr></table></figure>\n<p>有一种更简单的把值转换成字符串的方法：把值写到括号中，并且在括号之前写一个反斜杠。例如：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> apples = <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> oranges = <span class=\"number\">5</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> appleSummary = <span class=\"string\">\"I have \\(apples) apples.\"</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> fruitSummary = <span class=\"string\">\"I have \\(apples + oranges) pieces of fruit.\"</span></span><br></pre></td></tr></table></figure>\n<p>使用方括号<code>[]</code>来创建数组和字典，并使用下标或者键（key）来访问元素。最后一个元素后面允许有个逗号。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> shoppingList = [<span class=\"string\">\"Catfish\"</span>, <span class=\"string\">\"water\"</span>, <span class=\"string\">\"tulips\"</span>, <span class=\"string\">\"blue paint\"</span>]</span><br><span class=\"line\">shoppingList[<span class=\"number\">1</span>] = <span class=\"string\">\"bottle of water\"</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> occupations = [<span class=\"string\">\"Malcolm\"</span>: <span class=\"string\">\"Captain\"</span>, <span class=\"string\">\"Keylee\"</span>: <span class=\"string\">\"Mechanic\"</span>,]</span><br><span class=\"line\">occupations[<span class=\"string\">\"Jayne\"</span>] = <span class=\"string\">\"Public Relations\"</span></span><br></pre></td></tr></table></figure>\n<p>要创建一个空数组或者字典，使用初始化语法。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> emptyArray = [<span class=\"type\">String</span>]()</span><br><span class=\"line\"><span class=\"keyword\">let</span> emptyDictionary = [<span class=\"type\">String</span>: <span class=\"type\">Float</span>]()</span><br></pre></td></tr></table></figure>\n<p>如果类型信息可以被推断出来，你可以用<code>[]</code>和<code>[:]</code>来创建空数组和空字典 — 就像你声明变量或者给函数传参数的时候一样。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shoppingList = []</span><br><span class=\"line\">occupations = [:]</span><br></pre></td></tr></table></figure>\n<h3 id=\"控制流\"><a href=\"#控制流\" class=\"headerlink\" title=\"控制流\"></a>控制流</h3><p>使用<code>if</code>和<code>switch</code>来进行条件操作，使用<code>for-in</code>、<code>for</code>、<code>while</code>和<code>repeat-while</code>来进行循环。包裹条件和循环变量括号可以省略，但是语句体的大括号是必须的。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> individualScores = [<span class=\"number\">75</span>, <span class=\"number\">43</span>, <span class=\"number\">103</span>, <span class=\"number\">87</span>, <span class=\"number\">12</span>]</span><br><span class=\"line\"><span class=\"keyword\">var</span> teamScore = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> score <span class=\"keyword\">in</span> individualScores &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> score &gt; <span class=\"number\">50</span> &#123;</span><br><span class=\"line\">        teamScore += <span class=\"number\">3</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        teamScore += <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(teamScore) <span class=\"comment\">// 11</span></span><br></pre></td></tr></table></figure>\n<p> 在<code>if</code>语句中，条件必须是一个布尔表达式 — 这意味着像<code>if score { ... }</code>这样的代码将报错，而不会隐形的与 0 做对比。</p>\n<p>你可以一起使用<code>if</code>和<code>let</code>来处理缺失的情况。这些值可由可先值来代表。一个可选的值是一个具体的值或者是<code>nil</code>以表示值缺失。在类型后面加一个问号来标记这个变量的值是可选的。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> optionalString: <span class=\"type\">String</span>? = <span class=\"string\">\"Hello\"</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(optionalString == <span class=\"literal\">nil</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> optionalName: <span class=\"type\">String</span>? = <span class=\"string\">\"John Appleseed\"</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> greeting = <span class=\"string\">\"Hello!\"</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> name = optionalName &#123;</span><br><span class=\"line\">    greeting = <span class=\"string\">\"Hello, \\(name)\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>if  let name = optionalName</code>  这句的意思是：如果optionalName不是nil，就把值赋给 name，条件判断为 <code>true</code>，进入 if 语句块；如果optionalName为nil，条件会判断为 <code>false</code>，不进入 if  语句块</p>\n</blockquote>\n<p><code>switch</code>支持任意类型的数据以及各种比较操作 — 不仅仅是整数以及测试相等。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> vegetable = <span class=\"string\">\"red pepper\"</span></span><br><span class=\"line\"><span class=\"keyword\">switch</span> vegetable &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">\"celery\"</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Add some raisins and make ants on a log.\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"string\">\"cucumber\"</span>, <span class=\"string\">\"watercress\"</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"That would make a good tea sandwich.\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"keyword\">let</span> x <span class=\"keyword\">where</span> x.hasSuffix(<span class=\"string\">\"pepper\"</span>):</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Is it a spicy \\(x)?\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">default</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Everything tastes good in soup.\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 打印 \"Is it a spicy red pepper?\"</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>不同于java ，swift的<code>case</code>语句不必加break。</p>\n</blockquote>\n<p>注意<code>let</code>在上述例子的等式中是如何使用的，它将匹配等式的值赋给常量<code>x</code>。<code>let x where x.hasSuffix(&quot;papper&quot;)</code>这句话的意思是先把vegetable的值赋给<code>x</code>，如果赋值成功，再判断调用<code>hasSuffix</code>方法判断是否以<code>pepper</code>字符串结尾。</p>\n<p>运行<code>switch</code>中匹配到的子句之后，程序会退出switch语句，并不会继续向下运行，所以不需要在每个子句结尾写<code>break</code>。</p>\n<p>你可以使用<code>for-in</code>来遍历字典，需要两个变量来表示每个键值对。字典是一个无序的集合，所以他们的键和值以任意顺序迭代结束。</p>\n<p>下面的程序演示了找出最大值的操作：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> interestingNumbers = [</span><br><span class=\"line\">    <span class=\"string\">\"Prime\"</span>: [<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">11</span>, <span class=\"number\">13</span>],</span><br><span class=\"line\">    <span class=\"string\">\"Fibonacci\"</span>: [<span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">8</span>],</span><br><span class=\"line\">    <span class=\"string\">\"Square\"</span>: [<span class=\"number\">1</span>, <span class=\"number\">4</span>, <span class=\"number\">9</span>, <span class=\"number\">16</span>, <span class=\"number\">25</span>]]</span><br><span class=\"line\"><span class=\"keyword\">var</span> largest = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (kind, numbers) <span class=\"keyword\">in</span> interestingNumbers &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> number <span class=\"keyword\">in</span> numbers &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> number &gt; largest &#123;</span><br><span class=\"line\">            largest = number</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(largest) <span class=\"comment\">// 25</span></span><br></pre></td></tr></table></figure>\n<p>使用<code>while</code>来重复运行一段代码直到不满足条件。循环条件也可以在结尾，保证能至少循环一次。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> n = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> n &lt; <span class=\"number\">100</span> &#123;</span><br><span class=\"line\">    n = n * <span class=\"number\">2</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(n) <span class=\"comment\">// 128</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> m = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">repeat</span> &#123;</span><br><span class=\"line\">    m = m * <span class=\"number\">2</span></span><br><span class=\"line\">&#125; <span class=\"keyword\">while</span> m &lt; <span class=\"number\">100</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(m) <span class=\"comment\">// 128</span></span><br></pre></td></tr></table></figure>\n<p>你可以在循环中使用<code>..&lt;</code>来表示范围，也可以使用传统的写法，两者是等价的：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> firstForLoop = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;<span class=\"number\">4</span>&#123;</span><br><span class=\"line\">    firstForLoop += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(firstForLoop) <span class=\"comment\">// 6</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> secondForLoop = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; ++i &#123;</span><br><span class=\"line\">    secondForLoop += i</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(secondForLoop) <span class=\"comment\">// 6</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"函数和闭包\"><a href=\"#函数和闭包\" class=\"headerlink\" title=\"函数和闭包\"></a>函数和闭包</h3><p>使用<code>func</code>来声明一个函数，使用名字和参数来调用函数。使用<code>-&gt;</code>来指定函数返回值的类型。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">greet</span><span class=\"params\">(name: String, day: String)</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"Hello \\(name), today is \\(day).\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">greet(<span class=\"string\">\"Bob\"</span>, day: <span class=\"string\">\"Tuesday\"</span>)</span><br></pre></td></tr></table></figure>\n<p>使用元组来让一个函数返回多个值。该元组的元素可以用名称或数字来表示。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">calculateStatistics</span><span class=\"params\">(scores: [Int])</span></span> -&gt; (<span class=\"built_in\">min</span>: <span class=\"type\">Int</span>, <span class=\"built_in\">max</span>: <span class=\"type\">Int</span>, sum: <span class=\"type\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> <span class=\"built_in\">min</span> = scores[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">var</span> <span class=\"built_in\">max</span> = scores[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> score <span class=\"keyword\">in</span> scores &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> score &gt; <span class=\"built_in\">max</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">max</span> = score</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> score &lt; <span class=\"built_in\">min</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">min</span> = score</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        sum += score</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"built_in\">min</span>, <span class=\"built_in\">max</span>, sum)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> statistics = calculateStatistics([<span class=\"number\">5</span>, <span class=\"number\">3</span>, <span class=\"number\">100</span>, <span class=\"number\">3</span>, <span class=\"number\">9</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.<span class=\"built_in\">min</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.<span class=\"built_in\">max</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.sum)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(statistics.<span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n<p>函数可以带有可变个数的参数，这些参数的函数内表现为数组的形式：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">sumOf</span><span class=\"params\">(numbers: Int...)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> number <span class=\"keyword\">in</span> numbers &#123;</span><br><span class=\"line\">        sum += number</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">sumOf()</span><br><span class=\"line\">sumOf(<span class=\"number\">42</span>, <span class=\"number\">597</span>, <span class=\"number\">12</span>)</span><br></pre></td></tr></table></figure>\n<p>函数可以嵌套。被嵌套的函数可以访问外侧函数的变量，你可以使用嵌套函数来重构一个太长或者太复杂的函数 。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">returnFifteen</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> y = <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">add</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        y += <span class=\"number\">5</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    add()</span><br><span class=\"line\">    <span class=\"keyword\">return</span> y</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">returnFifteen()</span><br></pre></td></tr></table></figure>\n<p>函数是第一等类型，这意味着函数可以作为另一个函数的返回值。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">makeIncrementer</span><span class=\"params\">()</span></span> -&gt; (<span class=\"type\">Int</span> -&gt; <span class=\"type\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">addOne</span><span class=\"params\">(number: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span> + number</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> addOne</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> increment = makeIncrementer()</span><br><span class=\"line\">increment(<span class=\"number\">7</span>)</span><br></pre></td></tr></table></figure>\n<p>函数也可以当做参数传入另一个函数。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">hasAnyMatches</span><span class=\"params\">(list: [Int], condition: Int -&gt; Bool)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> list &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> condition(item) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">lessThanTen</span><span class=\"params\">(number: Int)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> number &lt; <span class=\"number\">10</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> numbers = [<span class=\"number\">20</span>, <span class=\"number\">19</span>, <span class=\"number\">7</span>, <span class=\"number\">12</span>]</span><br><span class=\"line\">hasAnyMatches(numbers, condition: lessThanTen)</span><br></pre></td></tr></table></figure>\n<p>函数实际上是一种特殊的闭包：它是一段能之后被调取的代码。闭包中的代码能访问闭包所建作用域中能得到的变量和函数，即使闭包是在一个不同的作用域被执行的 — 你已经在嵌套函数例子中所看到。你可以使用<code>{}</code>来创建一个匿名闭包。使用<code>in</code>将参数和返回值类型声明与闭包函数体进行分离。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> numbers = [<span class=\"number\">20</span>, <span class=\"number\">19</span>, <span class=\"number\">7</span>, <span class=\"number\">12</span>]</span><br><span class=\"line\">numbers.<span class=\"built_in\">map</span>(&#123;</span><br><span class=\"line\">    (number: <span class=\"type\">Int</span>) -&gt; <span class=\"type\">Int</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> result = <span class=\"number\">3</span> * number</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>有很多种创建更简洁的闭包的方法。如果一个闭包的类型已知，比如作为一个回调函数，你可以忽略参数的类型和返回值。单个语句闭包会把它语句的值当做结果返回。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> mappedNumbers = numbers.<span class=\"built_in\">map</span>(&#123; number <span class=\"keyword\">in</span> <span class=\"number\">3</span> * number &#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mappedNumbers) <span class=\"comment\">// [60, 57, 21, 36]</span></span><br></pre></td></tr></table></figure>\n<p>swift内置了一组变量(<code>$0</code>、<code>$1</code>、<code>$2</code> ……)，上述代码还能更简单 </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mappedNumbers = numbers.<span class=\"built_in\">map</span>(&#123; $<span class=\"number\">0</span> * <span class=\"number\">3</span> &#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mappedNumbers)</span><br></pre></td></tr></table></figure>\n<p>你可以通过参数位置而不是参数名字引用 参数 — 这个方法在非常短的闭包中非常有用。当一个闭包作为最后一个参数传给一个函数的时候，它可以直接跟在括号后面。当一个闭包是传给函数的唯一参数，你可以完全忽略括号。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> sortedNumbers = numbers.<span class=\"built_in\">sort</span>&#123; $<span class=\"number\">0</span> &gt; $<span class=\"number\">1</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(sortedNumbers) <span class=\"comment\">// [20, 19, 12, 7]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"对象和类\"><a href=\"#对象和类\" class=\"headerlink\" title=\"对象和类\"></a>对象和类</h3><p>使用<code>class</code>和类名来创建一个类。类中属性的声明和常量、变量声明一样，唯一的区别就是它们的上下文是类。同样，方法和函数声明也一样。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> numberOfSides = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"A shape with \\(numberOfSides) sides.\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>要创建一个类的实例，在类名后面加上括号。使用点语法来访问实例的属性和方法。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> shape = <span class=\"type\">Shape</span>()</span><br><span class=\"line\">shape.numberOfSides = <span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> shapeDescription = shape.simpleDescription()</span><br></pre></td></tr></table></figure>\n<p>这个版本的<code>Shape</code>类缺少了一些重要的东西：一个构造函数来初始化类实例。使用<code>init</code>来创建一个构造器。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NamesShape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> numberOfSides: <span class=\"type\">Int</span> = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: <span class=\"type\">String</span></span><br><span class=\"line\">    <span class=\"keyword\">init</span> (name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.name = name</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"A shape with \\(numberOfSides) sides.\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注意<code>self</code>被用来区别实例变量。当你创建实例的时候，像传入函数参数一样给类传入构造器的参数。</p>\n<p>每个属性都需要赋值 — 无论是通过声明（就像<code>numberOfSides</code>）还是通过构造器（就像<code>name</code>）</p>\n<p>如果你需要在删除对象之前进行一些清理工作，使用<code>deinit</code>创建一个析构函数。</p>\n<p>子类的定义方法是在它们的类名后面加上父类的名字，用冒号分割。创建类的时候并不需要一个标准的根类，所以你可以忽略父类。</p>\n<p>子类如果要重写父类的方法的话，需要用<code>override</code>标记 — 如果没有添加<code>override</code>就重写父类的方法的话，编译器会报错。编译器同样会检测<code>override</code>标记的方法是否确实在父类中。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Square</span>: <span class=\"title\">NamesShape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sideLength: <span class=\"type\">Double</span></span><br><span class=\"line\">    <span class=\"keyword\">init</span>(sideLength: <span class=\"type\">Double</span>, name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.sideLength = sideLength</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>(name: name)</span><br><span class=\"line\">        numberOfSides = <span class=\"number\">4</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">area</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">Double</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sideLength * sideLength</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"A square with sides of length \\(sideLength).\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> test = <span class=\"type\">Square</span>(sideLength: <span class=\"number\">5.2</span>, name: <span class=\"string\">\"my test square\"</span>)</span><br><span class=\"line\">test.area() <span class=\"comment\">// 27.04</span></span><br><span class=\"line\">test.simpleDescription() <span class=\"comment\">// \"A square with sides of length 5.2\"</span></span><br></pre></td></tr></table></figure>\n<p>除了储存简单的属性之外，属性可以有 <code>getter</code>和<code>settter</code>。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">EquilateralTriangle</span>: <span class=\"title\">NamesShape</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sideLength: <span class=\"type\">Double</span> = <span class=\"number\">0.0</span></span><br><span class=\"line\">    <span class=\"keyword\">init</span>(sideLength: <span class=\"type\">Double</span>, name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.sideLength = sideLength</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>(name: name)</span><br><span class=\"line\">        numberOfSides = <span class=\"number\">4</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> perimeter: <span class=\"type\">Double</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">3.0</span> * sideLength</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">set</span> &#123;</span><br><span class=\"line\">            sideLength = newValue / <span class=\"number\">3.0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"An equilateral triagle with sides of length \\(sideLength).\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> triangle = <span class=\"type\">EquilateralTriangle</span>(sideLength: <span class=\"number\">3.1</span>, name: <span class=\"string\">\"a triangle\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangle.perimeter) <span class=\"comment\">// 9.3</span></span><br><span class=\"line\">triangle.perimeter = <span class=\"number\">9.9</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangle.sideLength) <span class=\"comment\">// 3.3</span></span><br></pre></td></tr></table></figure>\n<p>在<code>perimeter</code>的<code>setter</code>中，新值的名字是<code>newValue</code>。你可以在<code>set</code>之后显示的设置一人名字。</p>\n<p>注意<code>EquilateralTriangle</code>类的构造器执行了三步：</p>\n<ol>\n<li>设置子类声明的属性</li>\n<li>调用父类的构造器</li>\n<li>改变父类定义的属性值。其它的工作比如调用方法、getter和setter也可以在这个阶段完成。</li>\n</ol>\n<p>如果你不需要计算属性，但是仍然需要在设置一相新值之前或者之后运行代码，使用<code>willSet</code>和<code>didSet</code>。</p>\n<p>比如，下面的类确保三角形的边长总是和正方形的边长相同。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TriangleAndSquare</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> triangle: <span class=\"type\">EquilateralTriangle</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">willSet</span> &#123;</span><br><span class=\"line\">            square.sideLength = newValue.sideLength</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> square: <span class=\"type\">Square</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">willSet</span>&#123;</span><br><span class=\"line\">            triangle.sideLength = newValue.sideLength</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">init</span>(size: <span class=\"type\">Double</span>, name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        square = <span class=\"type\">Square</span>(sideLength: size, name: name)</span><br><span class=\"line\">        triangle = <span class=\"type\">EquilateralTriangle</span>(sideLength: size, name: name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> triangleAndSquare = <span class=\"type\">TriangleAndSquare</span>(size: <span class=\"number\">10</span>, name: <span class=\"string\">\"another test shape\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangleAndSquare.square.sideLength) <span class=\"comment\">// 10</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangleAndSquare.triangle.sideLength) <span class=\"comment\">// 10</span></span><br><span class=\"line\">triangleAndSquare.square = <span class=\"type\">Square</span>(sideLength: <span class=\"number\">50</span>, name: <span class=\"string\">\"larger square\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(triangleAndSquare.triangle.sideLength) <span class=\"comment\">// 50</span></span><br></pre></td></tr></table></figure>\n<p>处理变量的可选值时，你可以在操作（比如方法、属性和子脚本）之前加<code>?</code>。如果 <code>?</code>之前的值是<code>nil</code>，<code>?</code>后面的东西都会被忽略，并且整个表达式返回<code>nil</code>。否则，<code>?</code>之后的东西都会被运行。在这两种情况下，整个表达 式的值也是一个可选值。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> optionalSquare: <span class=\"type\">Square</span>? = <span class=\"type\">Square</span>(sideLength: <span class=\"number\">2.5</span>, name: <span class=\"string\">\"optional square\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> sideLength = optionalSquare?.sideLength</span><br></pre></td></tr></table></figure>\n<h3 id=\"枚举和结构体\"><a href=\"#枚举和结构体\" class=\"headerlink\" title=\"枚举和结构体\"></a>枚举和结构体</h3><p>使用<code>enum</code>来创建一个枚举。就像类的其他所有命名类型一样，枚举可以包含方法。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">Rank</span>: <span class=\"title\">Int</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Ace</span> = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Two</span>, <span class=\"type\">Three</span>, <span class=\"type\">Four</span>, <span class=\"type\">Five</span>, <span class=\"type\">Six</span>, <span class=\"type\">Seven</span>, <span class=\"type\">Eight</span>, <span class=\"type\">Nine</span>, <span class=\"type\">Ten</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Jack</span>, <span class=\"type\">Queen</span>, <span class=\"type\">King</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> <span class=\"keyword\">self</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Ace</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"ace\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Jack</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"jack\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Queen</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"queen\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">King</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"king\"</span></span><br><span class=\"line\">        <span class=\"keyword\">default</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"type\">String</span>(<span class=\"keyword\">self</span>.rawValue)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> ace = <span class=\"type\">Rank</span>.<span class=\"type\">Ace</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> aceRawValue = ace.rawValue</span><br></pre></td></tr></table></figure>\n<p>在上面的例子中，枚举原始值的类型是<code>Int</code>，所以你只需要设置第一个原始值。剩下的原始值会按照顺序赋值。你也可以使用字符串或者浮点数作为枚举的原始值。使用<code>rawValue</code>属性来访问一个枚举成员的原始值。</p>\n<p>使用<code>init?(rawValue:)</code>初始化构造器在原始值和枚举值之间进行转换。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> convertedRank = <span class=\"type\">Rank</span>(rawValue: <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> threeDescription = convertedRank.simpleDescription()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>枚举的成员值是实际值，并不是原始值的另一种表达方法。实际上，以防原始值没有意义，你不需要设置。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">Suit</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Spades</span>, <span class=\"type\">Hearts</span>, <span class=\"type\">Diamonds</span>, <span class=\"type\">Clubs</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> <span class=\"keyword\">self</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Spades</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"spades\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Hearts</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"hearts\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Diamonds</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"diamonds\"</span></span><br><span class=\"line\">        <span class=\"keyword\">case</span> .<span class=\"type\">Clubs</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"clubs\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> hearts = <span class=\"type\">Suit</span>.<span class=\"type\">Hearts</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> heartsDescription = hearts.simpleDescription()</span><br></pre></td></tr></table></figure>\n<p>注意，有两种方式可以引用<code>Hearts</code>成员：给<code>hearts</code>常量赋值时，枚举成员<code>Suit.Hearts</code>需要用全名来引用，因为常量没有显式指定类型。在<code>switch</code>里，枚举成员使用缩写<code>.Hearts</code>来引用，因为<code>self</code>的值已经知道是一个<code>suit</code>。已知变量类型的情况下你可以使用缩写。</p>\n<p>使用<code>struct</code>来创建一个结构体。结构体和类有很多相同的地方，比如方法和构造器。它们之间最大的一个区别就是结构体是传值，类是传引用。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Card</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> rank: <span class=\"type\">Rank</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> suit: <span class=\"type\">Suit</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">simpleDescription</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"The \\(rank.simpleDescription()) of \\(suit.simpleDescription())\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> threeOfSpades = <span class=\"type\">Card</span>(rank: .<span class=\"type\">Three</span>, suit: .<span class=\"type\">Spades</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> threeOfSpadesDescription = threeOfSpades.simpleDescription()</span><br></pre></td></tr></table></figure>\n<p>一个枚举成员的实例可以有实例值。相同枚举成员的实例可以有不同的值。创建实例的时候传入值即可。实例值和原始值是不同的：枚举成员的原始值对于所有实例都是相同的，而且你是在定义枚举的时候设置原始值。</p>\n<p>例如，考虑从服务器获取日出和日落的时间。服务器会返回正常结果或者错误信息。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">ServerResponse</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Result</span>(<span class=\"type\">String</span>, <span class=\"type\">String</span>)</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Error</span>(<span class=\"type\">String</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> success = <span class=\"type\">ServerResponse</span>.<span class=\"type\">Result</span>(<span class=\"string\">\"6:00 am\"</span>, <span class=\"string\">\"8:09 pm\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> failure = <span class=\"type\">ServerResponse</span>.<span class=\"type\">Error</span>(<span class=\"string\">\"Out of cheese.\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">switch</span> success &#123;</span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"keyword\">let</span> .<span class=\"type\">Result</span>(sunrise, sunset):</span><br><span class=\"line\">    <span class=\"keyword\">let</span> serverResponse = <span class=\"string\">\"Sunrise is at \\(sunrise) and sunset is at \\(sunset).\"</span></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"keyword\">let</span> .<span class=\"type\">Error</span>(error):</span><br><span class=\"line\">    <span class=\"keyword\">let</span> serverResponse = <span class=\"string\">\"Failure... \\(error)\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注意如何从<code>ServerResponse</code>中提取日升和日落时间并用得到的值用来和<code>switch</code>的情况做比较。</p>\n<h3 id=\"协议和扩展\"><a href=\"#协议和扩展\" class=\"headerlink\" title=\"协议和扩展\"></a>协议和扩展</h3><p>使用<code>protocol</code>来声明一个协议。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">protocol</span> <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> &#123; <span class=\"keyword\">get</span> &#125;</span><br><span class=\"line\">    <span class=\"keyword\">mutating</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>类、枚举和结构体都可以实现协议。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SimpleClass</span>: <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> = <span class=\"string\">\"A very simple class.\"</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> anotherProperty: <span class=\"type\">Int</span> = <span class=\"number\">69105</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        simpleDescription += <span class=\"string\">\" Now 100% adjusted.\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"type\">SimpleClass</span>()</span><br><span class=\"line\">a.adjust()</span><br><span class=\"line\"><span class=\"keyword\">let</span> aDescription = a.simpleDescription</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">SimpleStructure</span>: <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> = <span class=\"string\">\"A simple structure\"</span></span><br><span class=\"line\">    <span class=\"keyword\">mutating</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        simpleDescription += <span class=\"string\">\"(adjusted)\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> b = <span class=\"type\">SimpleStructure</span>()</span><br><span class=\"line\">b.adjust()</span><br><span class=\"line\"><span class=\"keyword\">let</span> bDescription = b.simpleDescription</span><br></pre></td></tr></table></figure>\n<p>注意声明<code>SimpleStructure</code>时候<code>mutating</code>关键字用来标记一个会修改结构体的方法。<code>SimpleClass</code>的声明不需要标记任何方法，因为类中的方法通常可以修改类属性（类的性质）</p>\n<p>使用<code>extension</code>来为现有的类型添加功能，比如新的方法和计算属性。你可以使用扩展在别处修改定义，甚至是从外部库或者框架引入的一个类型，使得这个类型遵循某个协议。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">Int</span>: <span class=\"title\">ExampleProtocol</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> simpleDescription: <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"The number \\(self)\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">mutating</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">adjust</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span> += <span class=\"number\">42</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">7</span>.simpleDescription) <span class=\"comment\">// The number 7</span></span><br></pre></td></tr></table></figure>\n<p>你可以像使用其他命名类型一样使用协议名 — 例如，创建一个有不同类型但是都实现一个协议的对象集合。当你处理类型是协议的值时，协议外定义的方法不可用。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> protocolValue: <span class=\"type\">ExampleProtocol</span> = a</span><br><span class=\"line\"><span class=\"built_in\">print</span>(protocolValue.simpleDescription) <span class=\"comment\">//A very simple class. Now 100% adjusted.</span></span><br></pre></td></tr></table></figure>\n<p>即使<code>protocolValue</code>变量运行时的类型是<code>simpleClass</code>，编译器会把它的类型当做<code>ExampleProtocol</code>。这表示你不能调用类在它实现的协议之外实现的方法或属性。</p>\n<h3 id=\"泛型\"><a href=\"#泛型\" class=\"headerlink\" title=\"泛型\"></a>泛型</h3><p>在尖括号里写一个名字来创建一个泛型函数或者类型。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">repeatItem</span>&lt;Item&gt;<span class=\"params\">(item: Item, numberOfTimes: Int)</span></span> -&gt; [<span class=\"type\">Item</span>] &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> result = [<span class=\"type\">Item</span>]()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"number\">_</span> <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;numberOfTimes &#123;</span><br><span class=\"line\">        result.append(item)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">repeatItem(<span class=\"string\">\"knock\"</span>, numberOfTimes: <span class=\"number\">4</span>) <span class=\"comment\">// [\"knock\", \"knock\", \"knock\", \"knock\"]</span></span><br></pre></td></tr></table></figure>\n<p>你也可以创建泛型函数 、方法、类、枚举和结构体。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Reimplement the Swift standard library's optional type</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">OptionalValue</span>&lt;<span class=\"title\">Wrapped</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">None</span></span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"type\">Some</span>(<span class=\"type\">Wrapped</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> possibleInteger: <span class=\"type\">OptionalValue</span>&lt;<span class=\"type\">Int</span>&gt; = .<span class=\"type\">None</span></span><br><span class=\"line\">possibleInteger = .<span class=\"type\">Some</span>(<span class=\"number\">100</span>)</span><br></pre></td></tr></table></figure>\n<p>在类型名后面的使用<code>where</code>来指定对类型的需求，比如，限定类型实现某一个协议，限定两个类型是相同的，或者限定某个类必须有一个特定的父类。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">anyCommonElements</span>&lt;T: SequenceType, U: SequenceType where T.Generator.Element: Equatable, T.Generator.Element == U.Generator.Element&gt;<span class=\"params\">(lhs: T, <span class=\"number\">_</span> rhs: U)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> lhsItem <span class=\"keyword\">in</span> lhs &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> rhsItem <span class=\"keyword\">in</span> rhs &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> lhsItem == rhsItem &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">anyCommonElements([<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>], [<span class=\"number\">3</span>])</span><br></pre></td></tr></table></figure>\n<p><code>&lt;T: Equatable&gt;</code>和<code>&lt;T where T: Equatable&gt;</code>是等价的。</p>"},{"title":"swift-record","date":"2016-06-22T07:03:30.000Z","_content":"\n### extension\n\n声明一个扩展使用关键字`extension`\n\n```swift\nextension SomeType{\n  //加到SomeType的新功能写到这里\n}\n```\n\n### indirect\n\n使用indirect来标识一个枚举是可以递归调用的\n\n### required\n\n在类的构造器前添加`required`修饰符表明所有该类的子类都必须实现该构造器，在子类重写父类的必要构造器时，必须在子类的构造器前也添加`required`修饰符，这是为了保证继承链上子类的构造器也是必要构造器。在重写父类的必要构造器时，不需要添加`override`修饰符\n\n### mutating\n\n一般情况下，值类型的属性不能在它的实例方法中被修改，`mutating`使得方法可以从方法内部改变它的属性；并且它做的任何改变在方法结束时还会保留在原始结构中。方法还可以给它隐含的`self`属性赋值一个全新的实例，这个新实例在方法结束后将替换原来的实例。要使用`mutating`方法，将关键字`mutating`放到方法的`func`关键字之前就可以了\n\n### unowned\n\n使用`unowned`标识无主引用\n\n### weak\n\n使用`weak`标识弱引用\n\n### 类型属性\n\n在结构体和枚举中可以使用`static`来修饰静态变量，在类中可以使用`static`和`class`来修饰，使用`class`修饰来允许子类重写父类的实现方法","source":"_posts/Swift/swift-record.md","raw":"---\ntitle: swift-record\ndate: 2016-06-22 15:03:30\ntags: ios\n---\n\n### extension\n\n声明一个扩展使用关键字`extension`\n\n```swift\nextension SomeType{\n  //加到SomeType的新功能写到这里\n}\n```\n\n### indirect\n\n使用indirect来标识一个枚举是可以递归调用的\n\n### required\n\n在类的构造器前添加`required`修饰符表明所有该类的子类都必须实现该构造器，在子类重写父类的必要构造器时，必须在子类的构造器前也添加`required`修饰符，这是为了保证继承链上子类的构造器也是必要构造器。在重写父类的必要构造器时，不需要添加`override`修饰符\n\n### mutating\n\n一般情况下，值类型的属性不能在它的实例方法中被修改，`mutating`使得方法可以从方法内部改变它的属性；并且它做的任何改变在方法结束时还会保留在原始结构中。方法还可以给它隐含的`self`属性赋值一个全新的实例，这个新实例在方法结束后将替换原来的实例。要使用`mutating`方法，将关键字`mutating`放到方法的`func`关键字之前就可以了\n\n### unowned\n\n使用`unowned`标识无主引用\n\n### weak\n\n使用`weak`标识弱引用\n\n### 类型属性\n\n在结构体和枚举中可以使用`static`来修饰静态变量，在类中可以使用`static`和`class`来修饰，使用`class`修饰来允许子类重写父类的实现方法","slug":"Swift/swift-record","published":1,"updated":"2018-05-20T13:04:25.679Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61e40009izcbxtslft9m","content":"<h3 id=\"extension\"><a href=\"#extension\" class=\"headerlink\" title=\"extension\"></a>extension</h3><p>声明一个扩展使用关键字<code>extension</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">SomeType</span></span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">//加到SomeType的新功能写到这里</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"indirect\"><a href=\"#indirect\" class=\"headerlink\" title=\"indirect\"></a>indirect</h3><p>使用indirect来标识一个枚举是可以递归调用的</p>\n<h3 id=\"required\"><a href=\"#required\" class=\"headerlink\" title=\"required\"></a>required</h3><p>在类的构造器前添加<code>required</code>修饰符表明所有该类的子类都必须实现该构造器，在子类重写父类的必要构造器时，必须在子类的构造器前也添加<code>required</code>修饰符，这是为了保证继承链上子类的构造器也是必要构造器。在重写父类的必要构造器时，不需要添加<code>override</code>修饰符</p>\n<h3 id=\"mutating\"><a href=\"#mutating\" class=\"headerlink\" title=\"mutating\"></a>mutating</h3><p>一般情况下，值类型的属性不能在它的实例方法中被修改，<code>mutating</code>使得方法可以从方法内部改变它的属性；并且它做的任何改变在方法结束时还会保留在原始结构中。方法还可以给它隐含的<code>self</code>属性赋值一个全新的实例，这个新实例在方法结束后将替换原来的实例。要使用<code>mutating</code>方法，将关键字<code>mutating</code>放到方法的<code>func</code>关键字之前就可以了</p>\n<h3 id=\"unowned\"><a href=\"#unowned\" class=\"headerlink\" title=\"unowned\"></a>unowned</h3><p>使用<code>unowned</code>标识无主引用</p>\n<h3 id=\"weak\"><a href=\"#weak\" class=\"headerlink\" title=\"weak\"></a>weak</h3><p>使用<code>weak</code>标识弱引用</p>\n<h3 id=\"类型属性\"><a href=\"#类型属性\" class=\"headerlink\" title=\"类型属性\"></a>类型属性</h3><p>在结构体和枚举中可以使用<code>static</code>来修饰静态变量，在类中可以使用<code>static</code>和<code>class</code>来修饰，使用<code>class</code>修饰来允许子类重写父类的实现方法</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"extension\"><a href=\"#extension\" class=\"headerlink\" title=\"extension\"></a>extension</h3><p>声明一个扩展使用关键字<code>extension</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">SomeType</span></span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">//加到SomeType的新功能写到这里</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"indirect\"><a href=\"#indirect\" class=\"headerlink\" title=\"indirect\"></a>indirect</h3><p>使用indirect来标识一个枚举是可以递归调用的</p>\n<h3 id=\"required\"><a href=\"#required\" class=\"headerlink\" title=\"required\"></a>required</h3><p>在类的构造器前添加<code>required</code>修饰符表明所有该类的子类都必须实现该构造器，在子类重写父类的必要构造器时，必须在子类的构造器前也添加<code>required</code>修饰符，这是为了保证继承链上子类的构造器也是必要构造器。在重写父类的必要构造器时，不需要添加<code>override</code>修饰符</p>\n<h3 id=\"mutating\"><a href=\"#mutating\" class=\"headerlink\" title=\"mutating\"></a>mutating</h3><p>一般情况下，值类型的属性不能在它的实例方法中被修改，<code>mutating</code>使得方法可以从方法内部改变它的属性；并且它做的任何改变在方法结束时还会保留在原始结构中。方法还可以给它隐含的<code>self</code>属性赋值一个全新的实例，这个新实例在方法结束后将替换原来的实例。要使用<code>mutating</code>方法，将关键字<code>mutating</code>放到方法的<code>func</code>关键字之前就可以了</p>\n<h3 id=\"unowned\"><a href=\"#unowned\" class=\"headerlink\" title=\"unowned\"></a>unowned</h3><p>使用<code>unowned</code>标识无主引用</p>\n<h3 id=\"weak\"><a href=\"#weak\" class=\"headerlink\" title=\"weak\"></a>weak</h3><p>使用<code>weak</code>标识弱引用</p>\n<h3 id=\"类型属性\"><a href=\"#类型属性\" class=\"headerlink\" title=\"类型属性\"></a>类型属性</h3><p>在结构体和枚举中可以使用<code>static</code>来修饰静态变量，在类中可以使用<code>static</code>和<code>class</code>来修饰，使用<code>class</code>修饰来允许子类重写父类的实现方法</p>\n"},{"title":"swift-life-cycle","date":"2016-06-30T09:08:15.000Z","_content":"\n### IOS生命周期\n\n|      |       IOS        | Android  |\n| ---- | :--------------: | :------: |\n|      |  viewWillAppear  | onCreate |\n|      |  viewDidAppear   | onResume |\n|      | viewWillDisapper | onPause  |\n|      |   viewDidApper   |  onStop  |\n\n","source":"_posts/Swift/swift-life-cycle.md","raw":"---\ntitle: swift-life-cycle\ndate: 2016-06-30 17:08:15\ntags: ios\n---\n\n### IOS生命周期\n\n|      |       IOS        | Android  |\n| ---- | :--------------: | :------: |\n|      |  viewWillAppear  | onCreate |\n|      |  viewDidAppear   | onResume |\n|      | viewWillDisapper | onPause  |\n|      |   viewDidApper   |  onStop  |\n\n","slug":"Swift/swift-life-cycle","published":1,"updated":"2018-05-20T13:04:25.679Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61e5000bizcbbc3783e3","content":"<h3 id=\"IOS生命周期\"><a href=\"#IOS生命周期\" class=\"headerlink\" title=\"IOS生命周期\"></a>IOS生命周期</h3><table>\n<thead>\n<tr>\n<th></th>\n<th style=\"text-align:center\">IOS</th>\n<th style=\"text-align:center\">Android</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewWillAppear</td>\n<td style=\"text-align:center\">onCreate</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewDidAppear</td>\n<td style=\"text-align:center\">onResume</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewWillDisapper</td>\n<td style=\"text-align:center\">onPause</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewDidApper</td>\n<td style=\"text-align:center\">onStop</td>\n</tr>\n</tbody>\n</table>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"IOS生命周期\"><a href=\"#IOS生命周期\" class=\"headerlink\" title=\"IOS生命周期\"></a>IOS生命周期</h3><table>\n<thead>\n<tr>\n<th></th>\n<th style=\"text-align:center\">IOS</th>\n<th style=\"text-align:center\">Android</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewWillAppear</td>\n<td style=\"text-align:center\">onCreate</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewDidAppear</td>\n<td style=\"text-align:center\">onResume</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewWillDisapper</td>\n<td style=\"text-align:center\">onPause</td>\n</tr>\n<tr>\n<td></td>\n<td style=\"text-align:center\">viewDidApper</td>\n<td style=\"text-align:center\">onStop</td>\n</tr>\n</tbody>\n</table>\n"},{"title":"10个惊艳的Swift单行代码","date":"2016-05-22T10:59:51.000Z","_content":"\n# 概述\n\n> 摘至：[10 Swift One Liners To Impress Your Friends](https://www.uraimo.com/2016/01/06/10-Swift-One-Liners-To-Impress-Your-Friends/)\n\n\n\n1. 数组中的每个元素乘以2\n\n   ```swift\n   (1...1024).map{ $0 * 2 }\n   ```\n\n2. 数组中的元素求和\n\n   ```swift\n   (1...1024).reduce(0, combine: +)\n   ```\n\n<!-- More -->\n\n1. 验证在字符串是否存在指定单词\n\n   使用filter\n\n   ```swift\n   let words = [\"Swift\",\"iOS\",\"cocoa\",\"OSX\",\"tvOS\"]\n   let tweet = \"This is an example tweet larking about Swift\"\n   let valid = !words.filter({tweet.containsString($0)}).isEmpty\n   print(valid) // true\n   // or\n   words.contains(tweet.containsString)\n   // or\n   tweet.characters.split(\" \").lazy.map(String.init).contains(Set(words).contains)\n   ```\n\n2. 读取文件\n\n   ```swift\n   let path = NSBundle.mainBundle().pathForResource(\"test\", ofType: \"txt\")\n   let lines = try? String(contentsOfFile: path!).characters.split{$0 == \"\\n\"}.map(String.init)\n   if let lines=lines {\n       lines[0] // O! for a Muse of fire, that would ascend\n       lines[1] // The brightest heaven of invention!\n       lines[2] // A kingdom for a stage, princes to act\n       lines[3] // And monarchs to behold the swelling scene.\n   }\n   ```\n\n3. 祝你生日快乐!\n\n   ```swift\n    let name = \"uraimo\"\n    (1...4).forEach{print(\"Happy Birthday \" + (($0 == 3) ? \"dear \\(name)\":\"to You\"))}\n   ```\n\n4. 过滤数组中的数字\n\n   ```swift\n    var part3 = [82, 58, 76, 49, 88, 90].reduce( ([],[]), combine: {\n        (a:([Int],[Int]),n:Int) -> ([Int],[Int]) in\n        (n<60) ? (a.0+[n],a.1) : (a.0,a.1+[n])\n    })\n    print(part3) // ([58, 49], [82, 76, 88, 90])\n   ```\n\n5. 获取并解析XML Web服务\n\n   ```swift\n    let xmlDoc = try? AEXMLDocument(xmlData: NSData(contentsOfURL: NSURL(string:\"https://www.ibiblio.org/xml/examples/shakespeare/hen_v.xml\")!)!)\n    if let xmlDoc=xmlDoc {\n        var prologue = xmlDoc.root.children[6][\"PROLOGUE\"][\"SPEECH\"]\n        prologue.children[1].stringValue // Now all the youth of England are on fire,\n        prologue.children[2].stringValue // And silken dalliance in the wardrobe lies:\n        prologue.children[3].stringValue // Now thrive the armourers, and honour's thought\n        prologue.children[4].stringValue // Reigns solely in the breast of every man:\n        prologue.children[5].stringValue // They sell the pasture now to buy the horse,\n    }\n   ```\n\n6. 在数组中查找最小（或最大）值\n\n   ```swift\n    //Find the minimum of an array of Ints\n    [10,-22,753,55,137,-1,-279,1034,77].sort().first\n    [10,-22,753,55,137,-1,-279,1034,77].reduce(Int.max, combine: min)\n    [10,-22,753,55,137,-1,-279,1034,77].minElement()\n    //Find the maximum of an array of Ints\n    [10,-22,753,55,137,-1,-279,1034,77].sort().last\n    [10,-22,753,55,137,-1,-279,1034,77].reduce(Int.min, combine: max)\n    [10,-22,753,55,137,-1,-279,1034,77].maxElement()\n   ```\n\n7. 并行处理\n\n   某些语言允许用一种简单和透明的方式启用数组对功能，例如map和flatMap的并行处理，以加  快顺序和独立操作的执行。\n\n   此功能Swift中还不可用，但可以使用GCD构建：http://moreindirection.blogspot.it/2015/07/gcd-and-parallel-collections-in-swift.html\n\n8. 埃拉托斯特尼筛法\n\n   埃拉托斯特尼筛法用于查找所有的素数直到给定的上限n。\n\n   从小于n的所有整数序列开始，算法删除所有整数的倍数，直到只剩下素数。并且为了加快执行速\t度，我们实际上并不需要检查每个整数的倍数，我们止步于n的平方根就可以了。\n\n   根据这一定义首次执行可能是这样的：\n\n   ```swift\n   var n = 50\n   var primes = Set(2...n)\n\n   (2...Int(sqrt(Double(n)))).forEach{primes.subtractInPlace((2*$0).stride(through:n, by:$0))}\n   primes.sort()\n   ```\n\n   我们使用外部范围来迭代我们要检查的整数，并且对于每一个整数我们使用 stride(through:Int by:Int)计算出数字的倍数的序列。那些序列然后从Set中减去，Set用所有从2到n的整数初始化。\n\n   但正如你所看到的，为了实际移除倍数，我们使用外部可变Set，导致了附带后果。\n\n   为了消除附带后果，正如我们通常应该做的那样，我们会先计算所有序列，用倍数的单一数组来\tflatMap它们，并从初始Set中删除这些整数。\n\n   ```swift\n   var sameprimes = Set(2...n)\n\n   sameprimes.subtractInPlace((2...Int(sqrt(Double(n))))\n   \t\t\t\t\t\t   .flatMap{ (2*$0).stride(through:n, by:$0)})\n   sameprimes.sort()\n   ```\n\n   方式更清洁，使用flatMap的一个很好的例子以生成扁平化的嵌套数组。\n\n9. 元组交换\n\n   ```swift\n   var a=1, b=2\n   (a, b) = (b, a)\n   print(a) // 2\n   print(b) // 1\n   ```\n\n","source":"_posts/Swift/swift-skill.md","raw":"---\ntitle: 10个惊艳的Swift单行代码\ndate: 2016-05-22 18:59:51\ntags: ios\n#top: true\n---\n\n# 概述\n\n> 摘至：[10 Swift One Liners To Impress Your Friends](https://www.uraimo.com/2016/01/06/10-Swift-One-Liners-To-Impress-Your-Friends/)\n\n\n\n1. 数组中的每个元素乘以2\n\n   ```swift\n   (1...1024).map{ $0 * 2 }\n   ```\n\n2. 数组中的元素求和\n\n   ```swift\n   (1...1024).reduce(0, combine: +)\n   ```\n\n<!-- More -->\n\n1. 验证在字符串是否存在指定单词\n\n   使用filter\n\n   ```swift\n   let words = [\"Swift\",\"iOS\",\"cocoa\",\"OSX\",\"tvOS\"]\n   let tweet = \"This is an example tweet larking about Swift\"\n   let valid = !words.filter({tweet.containsString($0)}).isEmpty\n   print(valid) // true\n   // or\n   words.contains(tweet.containsString)\n   // or\n   tweet.characters.split(\" \").lazy.map(String.init).contains(Set(words).contains)\n   ```\n\n2. 读取文件\n\n   ```swift\n   let path = NSBundle.mainBundle().pathForResource(\"test\", ofType: \"txt\")\n   let lines = try? String(contentsOfFile: path!).characters.split{$0 == \"\\n\"}.map(String.init)\n   if let lines=lines {\n       lines[0] // O! for a Muse of fire, that would ascend\n       lines[1] // The brightest heaven of invention!\n       lines[2] // A kingdom for a stage, princes to act\n       lines[3] // And monarchs to behold the swelling scene.\n   }\n   ```\n\n3. 祝你生日快乐!\n\n   ```swift\n    let name = \"uraimo\"\n    (1...4).forEach{print(\"Happy Birthday \" + (($0 == 3) ? \"dear \\(name)\":\"to You\"))}\n   ```\n\n4. 过滤数组中的数字\n\n   ```swift\n    var part3 = [82, 58, 76, 49, 88, 90].reduce( ([],[]), combine: {\n        (a:([Int],[Int]),n:Int) -> ([Int],[Int]) in\n        (n<60) ? (a.0+[n],a.1) : (a.0,a.1+[n])\n    })\n    print(part3) // ([58, 49], [82, 76, 88, 90])\n   ```\n\n5. 获取并解析XML Web服务\n\n   ```swift\n    let xmlDoc = try? AEXMLDocument(xmlData: NSData(contentsOfURL: NSURL(string:\"https://www.ibiblio.org/xml/examples/shakespeare/hen_v.xml\")!)!)\n    if let xmlDoc=xmlDoc {\n        var prologue = xmlDoc.root.children[6][\"PROLOGUE\"][\"SPEECH\"]\n        prologue.children[1].stringValue // Now all the youth of England are on fire,\n        prologue.children[2].stringValue // And silken dalliance in the wardrobe lies:\n        prologue.children[3].stringValue // Now thrive the armourers, and honour's thought\n        prologue.children[4].stringValue // Reigns solely in the breast of every man:\n        prologue.children[5].stringValue // They sell the pasture now to buy the horse,\n    }\n   ```\n\n6. 在数组中查找最小（或最大）值\n\n   ```swift\n    //Find the minimum of an array of Ints\n    [10,-22,753,55,137,-1,-279,1034,77].sort().first\n    [10,-22,753,55,137,-1,-279,1034,77].reduce(Int.max, combine: min)\n    [10,-22,753,55,137,-1,-279,1034,77].minElement()\n    //Find the maximum of an array of Ints\n    [10,-22,753,55,137,-1,-279,1034,77].sort().last\n    [10,-22,753,55,137,-1,-279,1034,77].reduce(Int.min, combine: max)\n    [10,-22,753,55,137,-1,-279,1034,77].maxElement()\n   ```\n\n7. 并行处理\n\n   某些语言允许用一种简单和透明的方式启用数组对功能，例如map和flatMap的并行处理，以加  快顺序和独立操作的执行。\n\n   此功能Swift中还不可用，但可以使用GCD构建：http://moreindirection.blogspot.it/2015/07/gcd-and-parallel-collections-in-swift.html\n\n8. 埃拉托斯特尼筛法\n\n   埃拉托斯特尼筛法用于查找所有的素数直到给定的上限n。\n\n   从小于n的所有整数序列开始，算法删除所有整数的倍数，直到只剩下素数。并且为了加快执行速\t度，我们实际上并不需要检查每个整数的倍数，我们止步于n的平方根就可以了。\n\n   根据这一定义首次执行可能是这样的：\n\n   ```swift\n   var n = 50\n   var primes = Set(2...n)\n\n   (2...Int(sqrt(Double(n)))).forEach{primes.subtractInPlace((2*$0).stride(through:n, by:$0))}\n   primes.sort()\n   ```\n\n   我们使用外部范围来迭代我们要检查的整数，并且对于每一个整数我们使用 stride(through:Int by:Int)计算出数字的倍数的序列。那些序列然后从Set中减去，Set用所有从2到n的整数初始化。\n\n   但正如你所看到的，为了实际移除倍数，我们使用外部可变Set，导致了附带后果。\n\n   为了消除附带后果，正如我们通常应该做的那样，我们会先计算所有序列，用倍数的单一数组来\tflatMap它们，并从初始Set中删除这些整数。\n\n   ```swift\n   var sameprimes = Set(2...n)\n\n   sameprimes.subtractInPlace((2...Int(sqrt(Double(n))))\n   \t\t\t\t\t\t   .flatMap{ (2*$0).stride(through:n, by:$0)})\n   sameprimes.sort()\n   ```\n\n   方式更清洁，使用flatMap的一个很好的例子以生成扁平化的嵌套数组。\n\n9. 元组交换\n\n   ```swift\n   var a=1, b=2\n   (a, b) = (b, a)\n   print(a) // 2\n   print(b) // 1\n   ```\n\n","slug":"Swift/swift-skill","published":1,"updated":"2018-05-20T13:04:25.679Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61e7000cizcb8hnysgb7","content":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><blockquote>\n<p>摘至：<a href=\"https://www.uraimo.com/2016/01/06/10-Swift-One-Liners-To-Impress-Your-Friends/\" target=\"_blank\" rel=\"noopener\">10 Swift One Liners To Impress Your Friends</a></p>\n</blockquote>\n<ol>\n<li><p>数组中的每个元素乘以2</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span>...<span class=\"number\">1024</span>).<span class=\"built_in\">map</span>&#123; $<span class=\"number\">0</span> * <span class=\"number\">2</span> &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>数组中的元素求和</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span>...<span class=\"number\">1024</span>).<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, combine: +)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<a id=\"more\"></a>\n<ol>\n<li><p>验证在字符串是否存在指定单词</p>\n<p>使用filter</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> words = [<span class=\"string\">\"Swift\"</span>,<span class=\"string\">\"iOS\"</span>,<span class=\"string\">\"cocoa\"</span>,<span class=\"string\">\"OSX\"</span>,<span class=\"string\">\"tvOS\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> tweet = <span class=\"string\">\"This is an example tweet larking about Swift\"</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> valid = !words.<span class=\"built_in\">filter</span>(&#123;tweet.containsString($<span class=\"number\">0</span>)&#125;).isEmpty</span><br><span class=\"line\"><span class=\"built_in\">print</span>(valid) <span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\">words.<span class=\"built_in\">contains</span>(tweet.containsString)</span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\">tweet.characters.<span class=\"built_in\">split</span>(<span class=\"string\">\" \"</span>).<span class=\"built_in\">lazy</span>.<span class=\"built_in\">map</span>(<span class=\"type\">String</span>.<span class=\"keyword\">init</span>).<span class=\"built_in\">contains</span>(<span class=\"type\">Set</span>(words).<span class=\"built_in\">contains</span>)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>读取文件</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">NSBundle</span>.mainBundle().pathForResource(<span class=\"string\">\"test\"</span>, ofType: <span class=\"string\">\"txt\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> lines = <span class=\"keyword\">try</span>? <span class=\"type\">String</span>(contentsOfFile: path!).characters.<span class=\"built_in\">split</span>&#123;$<span class=\"number\">0</span> == <span class=\"string\">\"\\n\"</span>&#125;.<span class=\"built_in\">map</span>(<span class=\"type\">String</span>.<span class=\"keyword\">init</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> lines=lines &#123;</span><br><span class=\"line\">    lines[<span class=\"number\">0</span>] <span class=\"comment\">// O! for a Muse of fire, that would ascend</span></span><br><span class=\"line\">    lines[<span class=\"number\">1</span>] <span class=\"comment\">// The brightest heaven of invention!</span></span><br><span class=\"line\">    lines[<span class=\"number\">2</span>] <span class=\"comment\">// A kingdom for a stage, princes to act</span></span><br><span class=\"line\">    lines[<span class=\"number\">3</span>] <span class=\"comment\">// And monarchs to behold the swelling scene.</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>祝你生日快乐!</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">\"uraimo\"</span></span><br><span class=\"line\">(<span class=\"number\">1</span>...<span class=\"number\">4</span>).forEach&#123;<span class=\"built_in\">print</span>(<span class=\"string\">\"Happy Birthday \"</span> + (($<span class=\"number\">0</span> == <span class=\"number\">3</span>) ? <span class=\"string\">\"dear \\(name)\"</span>:<span class=\"string\">\"to You\"</span>))&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>过滤数组中的数字</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> part3 = [<span class=\"number\">82</span>, <span class=\"number\">58</span>, <span class=\"number\">76</span>, <span class=\"number\">49</span>, <span class=\"number\">88</span>, <span class=\"number\">90</span>].<span class=\"built_in\">reduce</span>( ([],[]), combine: &#123;</span><br><span class=\"line\">    (a:([<span class=\"type\">Int</span>],[<span class=\"type\">Int</span>]),n:<span class=\"type\">Int</span>) -&gt; ([<span class=\"type\">Int</span>],[<span class=\"type\">Int</span>]) <span class=\"keyword\">in</span></span><br><span class=\"line\">    (n&lt;<span class=\"number\">60</span>) ? (a.<span class=\"number\">0</span>+[n],a.<span class=\"number\">1</span>) : (a.<span class=\"number\">0</span>,a.<span class=\"number\">1</span>+[n])</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(part3) <span class=\"comment\">// ([58, 49], [82, 76, 88, 90])</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>获取并解析XML Web服务</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> xmlDoc = <span class=\"keyword\">try</span>? <span class=\"type\">AEXMLDocument</span>(xmlData: <span class=\"type\">NSData</span>(contentsOfURL: <span class=\"type\">NSURL</span>(string:<span class=\"string\">\"https://www.ibiblio.org/xml/examples/shakespeare/hen_v.xml\"</span>)!)!)</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> xmlDoc=xmlDoc &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prologue = xmlDoc.root.children[<span class=\"number\">6</span>][<span class=\"string\">\"PROLOGUE\"</span>][<span class=\"string\">\"SPEECH\"</span>]</span><br><span class=\"line\">    prologue.children[<span class=\"number\">1</span>].stringValue <span class=\"comment\">// Now all the youth of England are on fire,</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">2</span>].stringValue <span class=\"comment\">// And silken dalliance in the wardrobe lies:</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">3</span>].stringValue <span class=\"comment\">// Now thrive the armourers, and honour's thought</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">4</span>].stringValue <span class=\"comment\">// Reigns solely in the breast of every man:</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">5</span>].stringValue <span class=\"comment\">// They sell the pasture now to buy the horse,</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在数组中查找最小（或最大）值</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Find the minimum of an array of Ints</span></span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">sort</span>().first</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">reduce</span>(<span class=\"type\">Int</span>.<span class=\"built_in\">max</span>, combine: <span class=\"built_in\">min</span>)</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">minElement</span>()</span><br><span class=\"line\"><span class=\"comment\">//Find the maximum of an array of Ints</span></span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">sort</span>().last</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">reduce</span>(<span class=\"type\">Int</span>.<span class=\"built_in\">min</span>, combine: <span class=\"built_in\">max</span>)</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">maxElement</span>()</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>并行处理</p>\n<p>某些语言允许用一种简单和透明的方式启用数组对功能，例如map和flatMap的并行处理，以加  快顺序和独立操作的执行。</p>\n<p>此功能Swift中还不可用，但可以使用GCD构建：<a href=\"http://moreindirection.blogspot.it/2015/07/gcd-and-parallel-collections-in-swift.html\" target=\"_blank\" rel=\"noopener\">http://moreindirection.blogspot.it/2015/07/gcd-and-parallel-collections-in-swift.html</a></p>\n</li>\n<li><p>埃拉托斯特尼筛法</p>\n<p>埃拉托斯特尼筛法用于查找所有的素数直到给定的上限n。</p>\n<p>从小于n的所有整数序列开始，算法删除所有整数的倍数，直到只剩下素数。并且为了加快执行速    度，我们实际上并不需要检查每个整数的倍数，我们止步于n的平方根就可以了。</p>\n<p>根据这一定义首次执行可能是这样的：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> n = <span class=\"number\">50</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> primes = <span class=\"type\">Set</span>(<span class=\"number\">2</span>...n)</span><br><span class=\"line\"></span><br><span class=\"line\">(<span class=\"number\">2</span>...<span class=\"type\">Int</span>(sqrt(<span class=\"type\">Double</span>(n)))).forEach&#123;primes.subtractInPlace((<span class=\"number\">2</span>*$<span class=\"number\">0</span>).<span class=\"built_in\">stride</span>(through:n, by:$<span class=\"number\">0</span>))&#125;</span><br><span class=\"line\">primes.<span class=\"built_in\">sort</span>()</span><br></pre></td></tr></table></figure>\n<p>我们使用外部范围来迭代我们要检查的整数，并且对于每一个整数我们使用 stride(through:Int by:Int)计算出数字的倍数的序列。那些序列然后从Set中减去，Set用所有从2到n的整数初始化。</p>\n<p>但正如你所看到的，为了实际移除倍数，我们使用外部可变Set，导致了附带后果。</p>\n<p>为了消除附带后果，正如我们通常应该做的那样，我们会先计算所有序列，用倍数的单一数组来    flatMap它们，并从初始Set中删除这些整数。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> sameprimes = <span class=\"type\">Set</span>(<span class=\"number\">2</span>...n)</span><br><span class=\"line\"></span><br><span class=\"line\">sameprimes.subtractInPlace((<span class=\"number\">2</span>...<span class=\"type\">Int</span>(sqrt(<span class=\"type\">Double</span>(n))))</span><br><span class=\"line\">\t\t\t\t\t\t   .flatMap&#123; (<span class=\"number\">2</span>*$<span class=\"number\">0</span>).<span class=\"built_in\">stride</span>(through:n, by:$<span class=\"number\">0</span>)&#125;)</span><br><span class=\"line\">sameprimes.<span class=\"built_in\">sort</span>()</span><br></pre></td></tr></table></figure>\n<p>方式更清洁，使用flatMap的一个很好的例子以生成扁平化的嵌套数组。</p>\n</li>\n<li><p>元组交换</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a=<span class=\"number\">1</span>, b=<span class=\"number\">2</span></span><br><span class=\"line\">(a, b) = (b, a)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(a) <span class=\"comment\">// 2</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(b) <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><blockquote>\n<p>摘至：<a href=\"https://www.uraimo.com/2016/01/06/10-Swift-One-Liners-To-Impress-Your-Friends/\" target=\"_blank\" rel=\"noopener\">10 Swift One Liners To Impress Your Friends</a></p>\n</blockquote>\n<ol>\n<li><p>数组中的每个元素乘以2</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span>...<span class=\"number\">1024</span>).<span class=\"built_in\">map</span>&#123; $<span class=\"number\">0</span> * <span class=\"number\">2</span> &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>数组中的元素求和</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1</span>...<span class=\"number\">1024</span>).<span class=\"built_in\">reduce</span>(<span class=\"number\">0</span>, combine: +)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>","more":"<ol>\n<li><p>验证在字符串是否存在指定单词</p>\n<p>使用filter</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> words = [<span class=\"string\">\"Swift\"</span>,<span class=\"string\">\"iOS\"</span>,<span class=\"string\">\"cocoa\"</span>,<span class=\"string\">\"OSX\"</span>,<span class=\"string\">\"tvOS\"</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> tweet = <span class=\"string\">\"This is an example tweet larking about Swift\"</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> valid = !words.<span class=\"built_in\">filter</span>(&#123;tweet.containsString($<span class=\"number\">0</span>)&#125;).isEmpty</span><br><span class=\"line\"><span class=\"built_in\">print</span>(valid) <span class=\"comment\">// true</span></span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\">words.<span class=\"built_in\">contains</span>(tweet.containsString)</span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\">tweet.characters.<span class=\"built_in\">split</span>(<span class=\"string\">\" \"</span>).<span class=\"built_in\">lazy</span>.<span class=\"built_in\">map</span>(<span class=\"type\">String</span>.<span class=\"keyword\">init</span>).<span class=\"built_in\">contains</span>(<span class=\"type\">Set</span>(words).<span class=\"built_in\">contains</span>)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>读取文件</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">NSBundle</span>.mainBundle().pathForResource(<span class=\"string\">\"test\"</span>, ofType: <span class=\"string\">\"txt\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> lines = <span class=\"keyword\">try</span>? <span class=\"type\">String</span>(contentsOfFile: path!).characters.<span class=\"built_in\">split</span>&#123;$<span class=\"number\">0</span> == <span class=\"string\">\"\\n\"</span>&#125;.<span class=\"built_in\">map</span>(<span class=\"type\">String</span>.<span class=\"keyword\">init</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> lines=lines &#123;</span><br><span class=\"line\">    lines[<span class=\"number\">0</span>] <span class=\"comment\">// O! for a Muse of fire, that would ascend</span></span><br><span class=\"line\">    lines[<span class=\"number\">1</span>] <span class=\"comment\">// The brightest heaven of invention!</span></span><br><span class=\"line\">    lines[<span class=\"number\">2</span>] <span class=\"comment\">// A kingdom for a stage, princes to act</span></span><br><span class=\"line\">    lines[<span class=\"number\">3</span>] <span class=\"comment\">// And monarchs to behold the swelling scene.</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>祝你生日快乐!</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> name = <span class=\"string\">\"uraimo\"</span></span><br><span class=\"line\">(<span class=\"number\">1</span>...<span class=\"number\">4</span>).forEach&#123;<span class=\"built_in\">print</span>(<span class=\"string\">\"Happy Birthday \"</span> + (($<span class=\"number\">0</span> == <span class=\"number\">3</span>) ? <span class=\"string\">\"dear \\(name)\"</span>:<span class=\"string\">\"to You\"</span>))&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>过滤数组中的数字</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> part3 = [<span class=\"number\">82</span>, <span class=\"number\">58</span>, <span class=\"number\">76</span>, <span class=\"number\">49</span>, <span class=\"number\">88</span>, <span class=\"number\">90</span>].<span class=\"built_in\">reduce</span>( ([],[]), combine: &#123;</span><br><span class=\"line\">    (a:([<span class=\"type\">Int</span>],[<span class=\"type\">Int</span>]),n:<span class=\"type\">Int</span>) -&gt; ([<span class=\"type\">Int</span>],[<span class=\"type\">Int</span>]) <span class=\"keyword\">in</span></span><br><span class=\"line\">    (n&lt;<span class=\"number\">60</span>) ? (a.<span class=\"number\">0</span>+[n],a.<span class=\"number\">1</span>) : (a.<span class=\"number\">0</span>,a.<span class=\"number\">1</span>+[n])</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(part3) <span class=\"comment\">// ([58, 49], [82, 76, 88, 90])</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>获取并解析XML Web服务</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> xmlDoc = <span class=\"keyword\">try</span>? <span class=\"type\">AEXMLDocument</span>(xmlData: <span class=\"type\">NSData</span>(contentsOfURL: <span class=\"type\">NSURL</span>(string:<span class=\"string\">\"https://www.ibiblio.org/xml/examples/shakespeare/hen_v.xml\"</span>)!)!)</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> xmlDoc=xmlDoc &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> prologue = xmlDoc.root.children[<span class=\"number\">6</span>][<span class=\"string\">\"PROLOGUE\"</span>][<span class=\"string\">\"SPEECH\"</span>]</span><br><span class=\"line\">    prologue.children[<span class=\"number\">1</span>].stringValue <span class=\"comment\">// Now all the youth of England are on fire,</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">2</span>].stringValue <span class=\"comment\">// And silken dalliance in the wardrobe lies:</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">3</span>].stringValue <span class=\"comment\">// Now thrive the armourers, and honour's thought</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">4</span>].stringValue <span class=\"comment\">// Reigns solely in the breast of every man:</span></span><br><span class=\"line\">    prologue.children[<span class=\"number\">5</span>].stringValue <span class=\"comment\">// They sell the pasture now to buy the horse,</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在数组中查找最小（或最大）值</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Find the minimum of an array of Ints</span></span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">sort</span>().first</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">reduce</span>(<span class=\"type\">Int</span>.<span class=\"built_in\">max</span>, combine: <span class=\"built_in\">min</span>)</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">minElement</span>()</span><br><span class=\"line\"><span class=\"comment\">//Find the maximum of an array of Ints</span></span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">sort</span>().last</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">reduce</span>(<span class=\"type\">Int</span>.<span class=\"built_in\">min</span>, combine: <span class=\"built_in\">max</span>)</span><br><span class=\"line\">[<span class=\"number\">10</span>,-<span class=\"number\">22</span>,<span class=\"number\">753</span>,<span class=\"number\">55</span>,<span class=\"number\">137</span>,-<span class=\"number\">1</span>,-<span class=\"number\">279</span>,<span class=\"number\">1034</span>,<span class=\"number\">77</span>].<span class=\"built_in\">maxElement</span>()</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>并行处理</p>\n<p>某些语言允许用一种简单和透明的方式启用数组对功能，例如map和flatMap的并行处理，以加  快顺序和独立操作的执行。</p>\n<p>此功能Swift中还不可用，但可以使用GCD构建：<a href=\"http://moreindirection.blogspot.it/2015/07/gcd-and-parallel-collections-in-swift.html\" target=\"_blank\" rel=\"noopener\">http://moreindirection.blogspot.it/2015/07/gcd-and-parallel-collections-in-swift.html</a></p>\n</li>\n<li><p>埃拉托斯特尼筛法</p>\n<p>埃拉托斯特尼筛法用于查找所有的素数直到给定的上限n。</p>\n<p>从小于n的所有整数序列开始，算法删除所有整数的倍数，直到只剩下素数。并且为了加快执行速    度，我们实际上并不需要检查每个整数的倍数，我们止步于n的平方根就可以了。</p>\n<p>根据这一定义首次执行可能是这样的：</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> n = <span class=\"number\">50</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> primes = <span class=\"type\">Set</span>(<span class=\"number\">2</span>...n)</span><br><span class=\"line\"></span><br><span class=\"line\">(<span class=\"number\">2</span>...<span class=\"type\">Int</span>(sqrt(<span class=\"type\">Double</span>(n)))).forEach&#123;primes.subtractInPlace((<span class=\"number\">2</span>*$<span class=\"number\">0</span>).<span class=\"built_in\">stride</span>(through:n, by:$<span class=\"number\">0</span>))&#125;</span><br><span class=\"line\">primes.<span class=\"built_in\">sort</span>()</span><br></pre></td></tr></table></figure>\n<p>我们使用外部范围来迭代我们要检查的整数，并且对于每一个整数我们使用 stride(through:Int by:Int)计算出数字的倍数的序列。那些序列然后从Set中减去，Set用所有从2到n的整数初始化。</p>\n<p>但正如你所看到的，为了实际移除倍数，我们使用外部可变Set，导致了附带后果。</p>\n<p>为了消除附带后果，正如我们通常应该做的那样，我们会先计算所有序列，用倍数的单一数组来    flatMap它们，并从初始Set中删除这些整数。</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> sameprimes = <span class=\"type\">Set</span>(<span class=\"number\">2</span>...n)</span><br><span class=\"line\"></span><br><span class=\"line\">sameprimes.subtractInPlace((<span class=\"number\">2</span>...<span class=\"type\">Int</span>(sqrt(<span class=\"type\">Double</span>(n))))</span><br><span class=\"line\">\t\t\t\t\t\t   .flatMap&#123; (<span class=\"number\">2</span>*$<span class=\"number\">0</span>).<span class=\"built_in\">stride</span>(through:n, by:$<span class=\"number\">0</span>)&#125;)</span><br><span class=\"line\">sameprimes.<span class=\"built_in\">sort</span>()</span><br></pre></td></tr></table></figure>\n<p>方式更清洁，使用flatMap的一个很好的例子以生成扁平化的嵌套数组。</p>\n</li>\n<li><p>元组交换</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a=<span class=\"number\">1</span>, b=<span class=\"number\">2</span></span><br><span class=\"line\">(a, b) = (b, a)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(a) <span class=\"comment\">// 2</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(b) <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>"},{"title":"Android动画描述","date":"2016-05-19T02:54:29.000Z","_content":"\n### 动画描述\n| XML配置     | Java 类             | 描述           | 动画类型       |\n| :-------- | :----------------- | ------------ | ---------- |\n| alph      | AlphaAnimation     | 渐变透明度动画效果    | 渐变动画       |\n| scale     | ScaleAnimation     | 渐变尺寸伸缩动画效果   | 伸缩动画       |\n| translate | TranslateAnimation | 画面转换位置移动动画效果 | 画面转换动画(位移) |\n| rotate    | RotateAnimation    | 画面转移旋转动画效果   | 画面旋转动画     |\n\n<!-- More -->\n\n### 插入器\n\n| 属性                                 | 描述    |\n| ---------------------------------- | ----- |\n| accelerate_decelerate_interpolator | 加速-减速 |\n| accelerate_interpolator            | 加速    |\n| decelerate_interpolator            | 减速    |\n\n### XML配置\n\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<set xmlns:android=\"http://schemas.android.com/apk/res/android\" >\n    <alpha //渐变\n        android:duration=\"1000\" //动画时长，单位毫秒\n        android:fromAlpha=\"0.0\" //动画起始时的透明度 0.0表示完全透明\n        android:toAlpha=\"1.0\" /> //动画结束时的透明度 1.0表示完全不透明\n          \n     <scale //伸缩\n        android:duration=\"1000\" //动画时长，单位毫秒\n        android:fillAfter=\"false\" //当设置为true,该动画转化在动画结束后被应用\n        android:fromXScale=\"0.0\" //动画起始时 X坐标上的伸缩尺寸 0表示收缩到没有\n        android:fromYScale=\"0.0\" //动画起始时 Y坐标上的伸缩尺寸 1表示正常无伸缩\n        android:interpolator=\"@android:anim/accelerate_decelerate_interpolator\" //插入器\n        android:pivotX=\"50%\" //动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置\n        android:pivotY=\"50%\" //动画相对于物件的Y坐标的开始位置\n        android:toXScale=\"1.4\" //动画起始时 X坐标上的伸缩尺寸 小于1表示收缩\n        android:toYScale=\"1.4\" /> //动画起始时 Y坐标上的伸缩尺寸 大于1表示放大\n          \n     <translate //位置转移\n        android:duration=\"2000\" //动画时长，单位毫秒\n        android:fromXDelta=\"30\" //动画开始时 X坐标的位置\n        android:fromYDelta=\"30\" //动画开始时 Y坐标的位置\n        android:toXDelta=\"-80\" //动画结束时 X坐标的位置\n        android:toYDelta=\"300\" /> //动画结束时 Y坐标的位置\n          \n      <rotate\n        android:duration=\"3000\" //动画时长，单位毫秒\n        android:fromDegrees=\"0\" //起始角度 \n        android:interpolator=\"@android:anim/accelerate_decelerate_interpolator\"//插入器\n        android:pivotX=\"50%\" //动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置\n        android:pivotY=\"50%\" //动画相对于物件的Y坐标的开始位置\n        android:toDegrees=\"+350\" /> //结束角度，可以大于360度\n</set>\n```","source":"_posts/android/android-animation.md","raw":"---\ntitle: Android动画描述\ndate: 2016-05-19 10:54:29\ntags: android\n---\n\n### 动画描述\n| XML配置     | Java 类             | 描述           | 动画类型       |\n| :-------- | :----------------- | ------------ | ---------- |\n| alph      | AlphaAnimation     | 渐变透明度动画效果    | 渐变动画       |\n| scale     | ScaleAnimation     | 渐变尺寸伸缩动画效果   | 伸缩动画       |\n| translate | TranslateAnimation | 画面转换位置移动动画效果 | 画面转换动画(位移) |\n| rotate    | RotateAnimation    | 画面转移旋转动画效果   | 画面旋转动画     |\n\n<!-- More -->\n\n### 插入器\n\n| 属性                                 | 描述    |\n| ---------------------------------- | ----- |\n| accelerate_decelerate_interpolator | 加速-减速 |\n| accelerate_interpolator            | 加速    |\n| decelerate_interpolator            | 减速    |\n\n### XML配置\n\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<set xmlns:android=\"http://schemas.android.com/apk/res/android\" >\n    <alpha //渐变\n        android:duration=\"1000\" //动画时长，单位毫秒\n        android:fromAlpha=\"0.0\" //动画起始时的透明度 0.0表示完全透明\n        android:toAlpha=\"1.0\" /> //动画结束时的透明度 1.0表示完全不透明\n          \n     <scale //伸缩\n        android:duration=\"1000\" //动画时长，单位毫秒\n        android:fillAfter=\"false\" //当设置为true,该动画转化在动画结束后被应用\n        android:fromXScale=\"0.0\" //动画起始时 X坐标上的伸缩尺寸 0表示收缩到没有\n        android:fromYScale=\"0.0\" //动画起始时 Y坐标上的伸缩尺寸 1表示正常无伸缩\n        android:interpolator=\"@android:anim/accelerate_decelerate_interpolator\" //插入器\n        android:pivotX=\"50%\" //动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置\n        android:pivotY=\"50%\" //动画相对于物件的Y坐标的开始位置\n        android:toXScale=\"1.4\" //动画起始时 X坐标上的伸缩尺寸 小于1表示收缩\n        android:toYScale=\"1.4\" /> //动画起始时 Y坐标上的伸缩尺寸 大于1表示放大\n          \n     <translate //位置转移\n        android:duration=\"2000\" //动画时长，单位毫秒\n        android:fromXDelta=\"30\" //动画开始时 X坐标的位置\n        android:fromYDelta=\"30\" //动画开始时 Y坐标的位置\n        android:toXDelta=\"-80\" //动画结束时 X坐标的位置\n        android:toYDelta=\"300\" /> //动画结束时 Y坐标的位置\n          \n      <rotate\n        android:duration=\"3000\" //动画时长，单位毫秒\n        android:fromDegrees=\"0\" //起始角度 \n        android:interpolator=\"@android:anim/accelerate_decelerate_interpolator\"//插入器\n        android:pivotX=\"50%\" //动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置\n        android:pivotY=\"50%\" //动画相对于物件的Y坐标的开始位置\n        android:toDegrees=\"+350\" /> //结束角度，可以大于360度\n</set>\n```","slug":"android/android-animation","published":1,"updated":"2018-05-20T13:04:25.680Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61e8000dizcbzvtqaw1u","content":"<h3 id=\"动画描述\"><a href=\"#动画描述\" class=\"headerlink\" title=\"动画描述\"></a>动画描述</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">XML配置</th>\n<th style=\"text-align:left\">Java 类</th>\n<th>描述</th>\n<th>动画类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">alph</td>\n<td style=\"text-align:left\">AlphaAnimation</td>\n<td>渐变透明度动画效果</td>\n<td>渐变动画</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">scale</td>\n<td style=\"text-align:left\">ScaleAnimation</td>\n<td>渐变尺寸伸缩动画效果</td>\n<td>伸缩动画</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">translate</td>\n<td style=\"text-align:left\">TranslateAnimation</td>\n<td>画面转换位置移动动画效果</td>\n<td>画面转换动画(位移)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">rotate</td>\n<td style=\"text-align:left\">RotateAnimation</td>\n<td>画面转移旋转动画效果</td>\n<td>画面旋转动画</td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a>\n<h3 id=\"插入器\"><a href=\"#插入器\" class=\"headerlink\" title=\"插入器\"></a>插入器</h3><table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>accelerate_decelerate_interpolator</td>\n<td>加速-减速</td>\n</tr>\n<tr>\n<td>accelerate_interpolator</td>\n<td>加速</td>\n</tr>\n<tr>\n<td>decelerate_interpolator</td>\n<td>减速</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"XML配置\"><a href=\"#XML配置\" class=\"headerlink\" title=\"XML配置\"></a>XML配置</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\">&lt;set xmlns:android=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span> &gt;</span><br><span class=\"line\">    &lt;alpha <span class=\"comment\">//渐变</span></span><br><span class=\"line\">        android:duration=<span class=\"string\">\"1000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fromAlpha=<span class=\"string\">\"0.0\"</span> <span class=\"comment\">//动画起始时的透明度 0.0表示完全透明</span></span><br><span class=\"line\">        android:toAlpha=<span class=\"string\">\"1.0\"</span> /&gt; <span class=\"comment\">//动画结束时的透明度 1.0表示完全不透明</span></span><br><span class=\"line\">          </span><br><span class=\"line\">     &lt;scale <span class=\"comment\">//伸缩</span></span><br><span class=\"line\">        android:duration=<span class=\"string\">\"1000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fillAfter=<span class=\"string\">\"false\"</span> <span class=\"comment\">//当设置为true,该动画转化在动画结束后被应用</span></span><br><span class=\"line\">        android:fromXScale=<span class=\"string\">\"0.0\"</span> <span class=\"comment\">//动画起始时 X坐标上的伸缩尺寸 0表示收缩到没有</span></span><br><span class=\"line\">        android:fromYScale=<span class=\"string\">\"0.0\"</span> <span class=\"comment\">//动画起始时 Y坐标上的伸缩尺寸 1表示正常无伸缩</span></span><br><span class=\"line\">        android:interpolator=<span class=\"string\">\"@android:anim/accelerate_decelerate_interpolator\"</span> <span class=\"comment\">//插入器</span></span><br><span class=\"line\">        android:pivotX=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置</span></span><br><span class=\"line\">        android:pivotY=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的Y坐标的开始位置</span></span><br><span class=\"line\">        android:toXScale=<span class=\"string\">\"1.4\"</span> <span class=\"comment\">//动画起始时 X坐标上的伸缩尺寸 小于1表示收缩</span></span><br><span class=\"line\">        android:toYScale=<span class=\"string\">\"1.4\"</span> /&gt; <span class=\"comment\">//动画起始时 Y坐标上的伸缩尺寸 大于1表示放大</span></span><br><span class=\"line\">          </span><br><span class=\"line\">     &lt;translate <span class=\"comment\">//位置转移</span></span><br><span class=\"line\">        android:duration=<span class=\"string\">\"2000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fromXDelta=<span class=\"string\">\"30\"</span> <span class=\"comment\">//动画开始时 X坐标的位置</span></span><br><span class=\"line\">        android:fromYDelta=<span class=\"string\">\"30\"</span> <span class=\"comment\">//动画开始时 Y坐标的位置</span></span><br><span class=\"line\">        android:toXDelta=<span class=\"string\">\"-80\"</span> <span class=\"comment\">//动画结束时 X坐标的位置</span></span><br><span class=\"line\">        android:toYDelta=<span class=\"string\">\"300\"</span> /&gt; <span class=\"comment\">//动画结束时 Y坐标的位置</span></span><br><span class=\"line\">          </span><br><span class=\"line\">      &lt;rotate</span><br><span class=\"line\">        android:duration=<span class=\"string\">\"3000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fromDegrees=<span class=\"string\">\"0\"</span> <span class=\"comment\">//起始角度 </span></span><br><span class=\"line\">        android:interpolator=<span class=\"string\">\"@android:anim/accelerate_decelerate_interpolator\"</span><span class=\"comment\">//插入器</span></span><br><span class=\"line\">        android:pivotX=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置</span></span><br><span class=\"line\">        android:pivotY=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的Y坐标的开始位置</span></span><br><span class=\"line\">        android:toDegrees=<span class=\"string\">\"+350\"</span> /&gt; <span class=\"comment\">//结束角度，可以大于360度</span></span><br><span class=\"line\">&lt;/set&gt;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h3 id=\"动画描述\"><a href=\"#动画描述\" class=\"headerlink\" title=\"动画描述\"></a>动画描述</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:left\">XML配置</th>\n<th style=\"text-align:left\">Java 类</th>\n<th>描述</th>\n<th>动画类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">alph</td>\n<td style=\"text-align:left\">AlphaAnimation</td>\n<td>渐变透明度动画效果</td>\n<td>渐变动画</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">scale</td>\n<td style=\"text-align:left\">ScaleAnimation</td>\n<td>渐变尺寸伸缩动画效果</td>\n<td>伸缩动画</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">translate</td>\n<td style=\"text-align:left\">TranslateAnimation</td>\n<td>画面转换位置移动动画效果</td>\n<td>画面转换动画(位移)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">rotate</td>\n<td style=\"text-align:left\">RotateAnimation</td>\n<td>画面转移旋转动画效果</td>\n<td>画面旋转动画</td>\n</tr>\n</tbody>\n</table>","more":"<h3 id=\"插入器\"><a href=\"#插入器\" class=\"headerlink\" title=\"插入器\"></a>插入器</h3><table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>accelerate_decelerate_interpolator</td>\n<td>加速-减速</td>\n</tr>\n<tr>\n<td>accelerate_interpolator</td>\n<td>加速</td>\n</tr>\n<tr>\n<td>decelerate_interpolator</td>\n<td>减速</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"XML配置\"><a href=\"#XML配置\" class=\"headerlink\" title=\"XML配置\"></a>XML配置</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\">&lt;set xmlns:android=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span> &gt;</span><br><span class=\"line\">    &lt;alpha <span class=\"comment\">//渐变</span></span><br><span class=\"line\">        android:duration=<span class=\"string\">\"1000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fromAlpha=<span class=\"string\">\"0.0\"</span> <span class=\"comment\">//动画起始时的透明度 0.0表示完全透明</span></span><br><span class=\"line\">        android:toAlpha=<span class=\"string\">\"1.0\"</span> /&gt; <span class=\"comment\">//动画结束时的透明度 1.0表示完全不透明</span></span><br><span class=\"line\">          </span><br><span class=\"line\">     &lt;scale <span class=\"comment\">//伸缩</span></span><br><span class=\"line\">        android:duration=<span class=\"string\">\"1000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fillAfter=<span class=\"string\">\"false\"</span> <span class=\"comment\">//当设置为true,该动画转化在动画结束后被应用</span></span><br><span class=\"line\">        android:fromXScale=<span class=\"string\">\"0.0\"</span> <span class=\"comment\">//动画起始时 X坐标上的伸缩尺寸 0表示收缩到没有</span></span><br><span class=\"line\">        android:fromYScale=<span class=\"string\">\"0.0\"</span> <span class=\"comment\">//动画起始时 Y坐标上的伸缩尺寸 1表示正常无伸缩</span></span><br><span class=\"line\">        android:interpolator=<span class=\"string\">\"@android:anim/accelerate_decelerate_interpolator\"</span> <span class=\"comment\">//插入器</span></span><br><span class=\"line\">        android:pivotX=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置</span></span><br><span class=\"line\">        android:pivotY=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的Y坐标的开始位置</span></span><br><span class=\"line\">        android:toXScale=<span class=\"string\">\"1.4\"</span> <span class=\"comment\">//动画起始时 X坐标上的伸缩尺寸 小于1表示收缩</span></span><br><span class=\"line\">        android:toYScale=<span class=\"string\">\"1.4\"</span> /&gt; <span class=\"comment\">//动画起始时 Y坐标上的伸缩尺寸 大于1表示放大</span></span><br><span class=\"line\">          </span><br><span class=\"line\">     &lt;translate <span class=\"comment\">//位置转移</span></span><br><span class=\"line\">        android:duration=<span class=\"string\">\"2000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fromXDelta=<span class=\"string\">\"30\"</span> <span class=\"comment\">//动画开始时 X坐标的位置</span></span><br><span class=\"line\">        android:fromYDelta=<span class=\"string\">\"30\"</span> <span class=\"comment\">//动画开始时 Y坐标的位置</span></span><br><span class=\"line\">        android:toXDelta=<span class=\"string\">\"-80\"</span> <span class=\"comment\">//动画结束时 X坐标的位置</span></span><br><span class=\"line\">        android:toYDelta=<span class=\"string\">\"300\"</span> /&gt; <span class=\"comment\">//动画结束时 Y坐标的位置</span></span><br><span class=\"line\">          </span><br><span class=\"line\">      &lt;rotate</span><br><span class=\"line\">        android:duration=<span class=\"string\">\"3000\"</span> <span class=\"comment\">//动画时长，单位毫秒</span></span><br><span class=\"line\">        android:fromDegrees=<span class=\"string\">\"0\"</span> <span class=\"comment\">//起始角度 </span></span><br><span class=\"line\">        android:interpolator=<span class=\"string\">\"@android:anim/accelerate_decelerate_interpolator\"</span><span class=\"comment\">//插入器</span></span><br><span class=\"line\">        android:pivotX=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的X坐标的开始位置,从0%~100%取值，50%为中点位置</span></span><br><span class=\"line\">        android:pivotY=<span class=\"string\">\"50%\"</span> <span class=\"comment\">//动画相对于物件的Y坐标的开始位置</span></span><br><span class=\"line\">        android:toDegrees=<span class=\"string\">\"+350\"</span> /&gt; <span class=\"comment\">//结束角度，可以大于360度</span></span><br><span class=\"line\">&lt;/set&gt;</span><br></pre></td></tr></table></figure>"},{"title":"Android配置文件详解-Activity","date":"2017-02-23T03:00:18.000Z","_content":"\n## Activity\n\n```java\n<activity android:allowEmbedded=[\"true\" | \"false\"]\n          android:allowTaskReparenting=[\"true\" | \"false\"]\n          android:alwaysRetainTaskState=[\"true\" | \"false\"]\n          android:alwaysRetainTaskState=[\"true\" | \"false\"]\n          android:autoRemoveFromRecents=[\"true\" | \"false\"]\n          android:banner=”drawable resource”\n          android:clearTaskOnLaunch=[\"true\" | \"false\"]\n          android:configChanges=[\"mcc\", \"mnc\", \"locale\",\n                                 \"touchscreen\", \"keyboard\", \"keyboardHidden\",\n                                 \"navigation\", \"screenLayout\", \"fontScale\",\n                                 \"uiMode\", \"orientation\",\"screenSize\",\n                                 \"smallestScreenSize\"]\n          android:documentLaunchMode=[\"intoExisting\" | \"always\" | \n“none” | “never”]\n          android:enabled=[\"true\" | \"false\"]\n          android:excludeFromRecents=[\"true\" | \"false\"]\n          android:exported=[\"true\" | \"false\"]\n          android:finishOnTaskLaunch=[\"true\" | \"false\"]\n          android:hardwareAccelerated=[\"true\" | \"false\"]\n          android:icon=\"drawable resource\"\n          android:label=\"string resource\"\n          android:launchMode=[\"standard\" | \"singleTop\" |\n                              \"singleTask\" | \"singleInstance\"]\n          android:maxRecents=\"integer\"\n          android:multiprocess=[\"true\" | \"false\"]\n          android:name=\"string\"\n          android:noHistory=[\"true\" | \"false\"]  \n          android:parentActivityName=\"string\"\n          android:permission=\"string\"\n          android:process=\"string\"\n          android:relinquishTaskIdentity=[\"true\" | \"false\"]\n          android:resizeableActivity=[\"true\" | \"false\"]\n          android:screenOrientation=[\"unspecified\" | \"behind\" | \"landscape\" |\n                                     \"portrait\" | \"reverseLandscape\" | \"sensorLandscape\" |\n                                     \"sensorPortrait\" | \"userLandscape\" | \"userPortrait\" |\n                                     \"sensor\" | \"fullSensor\" | \"nosensor\"]\n                                     \"user\" | \"fullUser\" | \"locked\"\n          android:stateNotNeeded=[\"true\" | \"false\"]\n          android:supportsPictureInPicture=[\"true\" | \"false\"]\n          android:taskAffinity=\"string\"\n          android:theme=\"resource or theme\"\n          android:uiOptions=[\"none\" | \"splitActionBarWhenNarrow\"]\n          android:windowSoftInputMode=[\"stateUnspecified\",\n                                       \"stateUnchanged\", \"stateHidden\",\n                                       \"stateAlwaysHidden\", \"stateVisible\",\n                                       \"stateAlwaysVisible\", \"adjustUnspecified\",\n                                       \"adjustResize\", \"adjustPan\"] >   \n</activity>\n```\n\n<!-- more -->\n\nandroid:allowEmbedded=[“true” | “false”]**\n这个标识一般为开发可穿戴设备时使用，表示该 Activity 可作为另一 Activity 的嵌入式子项启动。 它尤其适用于子项所在的容器（如 Display）为另一 Activity 所拥有的情况。 例如，用于 Wear 自定义通知的 Activity 必须声明此项，以便 Wear 在其上下文流中显示 Activity，后者位于另一进程中。该属性的默认值为 false。\n\n**android:allowTaskReparenting=[“true” | “false”]**\n这个标示和 Application 的标识意义一样，所以如果同时声明该标识，这个标识会覆盖 Application 的标识\n\n**android:alwaysRetainTaskState**\n这个标识用来指示系统是否始终保持 Activity 所在任务的状态 —“true”表示保持，“false”表示允许系统在特定情况下将任务重置到其初始状态。 默认值为“false”。该属性只对任务的根 Activity 有意义；对于所有其他 Activity，均忽略该属性。\n正常情况下，当用户从主屏幕重新选择某个任务时，系统会在特定情况下清除该任务（从根 Activity 之上的堆栈中移除所有 Activity）。 系统通常会在用户一段时间（如 30 分钟）内未访问任务时执行此操作。\n不过，如果该属性的值是“true”，则无论用户如何到达任务，将始终返回到最后状态的任务。 例如，在网络浏览器这类存在大量用户不愿失去的状态（如多个打开的标签）的应用中，该属性会很有用。\n\n**android:autoRemoveFromRecents=[\"true\" | \"false\"]**\n这个标识为 API21 版本添加，由具有该属性的 Activity 启动的任务是否一直保留在概览屏幕中，直至任务中的最后一个 Activity 完成为止。 若为 true，则自动从概览屏幕中移除任务。 它会替换调用方使用的 FLAG_ACTIVITY_RETAIN_IN_RECENTS。 它必须是布尔值“true”或“false”。\n\nandroid:banner=”drawable resource”\n这个和 application 里面的 banner 标识一样，也是用在 android TV 上的\n\n**android:clearTaskOnLaunch** \n这个标识用来指明当应用从主屏幕重新启动时是否都从中移除除根 Activity 之外的所有 Activity，true 表示始终将任务清除到只剩其根 Activity，false 表示不清除，默认值为 false。需要注意的是该属性只对启动新任务的 Activity（根 Activity）有意义；对于任务中的所有其他 Activity，均忽略该属性。当值为“false”时，可在某些情况下清除任务中的 Activity（参考结合 alwaysRetainTaskState 属性），但并非一律可以。如果该属性和 allowTaskReparenting 的值均为“true”，则如上所述，任何可以更改父项的 Activity 都将转移到与其有亲和关系的任务；其余 Activity 随即被移除。\n例如，假定有人从主屏幕启动了 Activity P，然后从那里转到 Activity Q。该用户接着按了主屏幕按钮，然后返回到 Activity P。正常情况下，用户将看到 Activity Q，因为那是其最后在 P 的任务中执行的 Activity。 不过，如果 P 将此标志设置为“true”，则当用户按下主屏幕将任务转入后台时，其上的所有 Activity（在本例中为 Q）都会被移除。 因此用户返回任务时只会看到 P。\n\n**android:configChanges**\n列出 Activity 将自行处理的配置更改。在运行时发生配置更改时，默认情况下会关闭 Activity 然后将其重新启动，但使用该属性声明配置将阻止 Activity 重新启动。 Activity 反而会保持运行状态，并且系统会调用其 onConfigurationChanged() 方法。以下为该属性的值，多个值使用“|”分隔 — 例如，“locale|navigation|orientation”：\n| **Value**            | **Description**                          |\n| -------------------- | ---------------------------------------- |\n| “mcc”                | IMSI 移动国家/地区代码 (MCC) 发生了变化 - 检测到了 SIM 并更新了 MCC。 |\n| “mnc”                | IMSI 移动网络代码 (MNC) 发生了变化 - 检测到了 SIM 并更新了 MNC。 |\n| locale”              | 语言区域发生了变化 — 用户为文本选择了新的显示语言。              |\n| “touchscreen”        | 触摸屏发生了变化。（这种情况通常永远不会发生。）                 |\n| “keyboard”           | 键盘类型发生了变化 — 例如，用户插入了一个外置键盘。              |\n| “keyboardHidden”     | 键盘无障碍功能发生了变化 — 例如，用户显示了硬件键盘。             |\n| “navigation”         | 导航类型（轨迹球/方向键）发生了变化。（这种情况通常永远不会发生。）       |\n| “screenLayout”       | 屏幕布局发生了变化 — 这可能是由激活了其他显示方式所致。            |\n| “fontScale”          | 字体缩放系数发生了变化 — 用户选择了新的全局字号。               |\n| “uiMode”             | 用户界面模式发生了变化 — 这可能是因用户将设备放入桌面/车载基座或夜间模式发生变化所致。 请参阅 [UiModeManager](https://developer.android.com/reference/android/app/UiModeManager.html)。 此项为 API 级别 8 中新增配置。 |\n| “orientation”        | 屏幕方向发生了变化 — 用户旋转了设备。 注：如果您的应用面向 API 级别 13 或更高级别（按照 minSdkVersion 和 targetSdkVersion 属性所声明的级别），则还应声明 “screenSize” 配置，因为当设备在横向与纵向之间切换时，该配置也会发生变化。 |\n| “screenSize”         | 当前可用屏幕尺寸发生了变化。它表示当前可用尺寸相对于当前纵横比的变化，因此会在用户在横向与纵向之间切换时发生变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |\n| “smallestScreenSize” | 物理屏幕尺寸发生了变化。它表示与方向无关的尺寸变化，因此只有在实际物理屏幕尺寸发生变化（如切换到外部显示器）时才会变化。对此配置的变更对应于smallestWidth 配置的变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |\n| “layoutDirection”    | 布局方向发生了变化。例如，从从左至右 (LTR) 更改为从右至左 (RTL)。 此项为 API 级别 17 中新增配置。 |\n所有这些配置变更都可能影响应用看到的资源值。 因此，调用 onConfigurationChanged() 时，通常有必要再次获取所有资源（包括视图布局、可绘制对象等），以正确处理变化。 \n　　我们平常接触到最多的就是屏幕的旋转，屏幕的旋转如果在没有特殊设置的情况下会销毁当前的 Activity 重新创建一个新的，为了避免创建新的，就可以在 AndroidMainfest.xml 中对指定 Activity 对应的 配置android:configChanges=”orientation”，这样，每次旋转方向时，只有 onConfigurationChanged 方法被调用，没有了销毁重建的过程。\n　　\n**android:documentLaunchMode=[“intoExisting” | “always” | “none” | “never”]**\n指定每次启动任务时应如何向其中添加新的 Activity 实例。 该属性允许用户让多个来自同一应用的文档出现在概览屏幕（recent app）中。该属性有四个值，会在用户使用该应用打开文档时产生以下效果：\n\n| **Value**      | **Description**                          |\n| -------------- | ---------------------------------------- |\n| “intoExisting” | Activity 会为文档重复使用现有任务。使用该值与不设置 [FLAG_ACTIVITY_MULTIPLE_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK) 标志、但设置 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT) 标志所产生的效果相同，如使用 [Intent 标志添加任务中](https://developer.android.com/guide/components/recents.html#flag-new-doc)所述。 |\n| “always”       | Activity 为文档创建新任务，即便文档已打开也是如此。 这与同时设置 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT) 和 [FLAG_ACTIVITY_MULTIPLE_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK) 标志的效果相同。 |\n| “none”         | 该 Activity 不会为 Activity 创建新任务。这是默认值，它只会在设置了 [FLAG_ACTIVITY_NEW_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK) 时创建新任务。 概览屏幕将按其默认方式对待此 Activity：为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。 |\n| “never”        | 即使 Intent 包含 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT)，该 Activity 也不会启动到新文档之中。 设置此值会替代 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT) 和 [FLAG_ACTIVITY_MULTIPLE_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK) 标志的行为（如果在 Activity 中设置了其中一个标志），并且概览屏幕将为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。 |\n> 注：对于除“none”和“never”以外的值，必须使用 launchMode=”standard” 定义 Activity。 如果未指定此属性，则使用 documentLaunchMode=”none”。\n\n**android:enabled=[“true” | “false”]**\n该属性用来标示系统是否可将 Activity 实例化 — “true” 表示可以，“false”表示不可以。 默认值为“true”。\n上面提到了 元素具有自己的 enabled 属性，该属性适用于所有应用组件，包括 Activity。 和 属性必须都是“true”（因为它们都默认使用该值），系统才能将 Activity 实例化。 如果任何一个属性是“false”，则无法进行实例化。\n\n**android:excludeFromRecents**\n该标识用来标示是否应将该 Activity 启动的任务排除在最近使用的应用列表（即概览屏幕）之外。 也就是说，当该 Activity 是新任务的根 Activity 时，此属性确定任务是否应出现在最近使用的应用列表中。 如果应将任务排除在列表之外，请设置“true”；如果应将其包括在内，则设置“false”。 默认值为“false”。\n\n**android:exported=[“true” | “false”]**\n该标识用来指明Activity 是否可由其他应用的组件启动 —“true”表示可以，“false”表示不可以。若为“false”，则 Activity 只能由同一应用的组件或使用同一用户 ID 的不同应用启动。\n需要注意的是该默认值取决于 Activity 是否包含 Intent 过滤器。没有任何过滤器意味着 Activity 只能通过指定其确切的类名称进行调用。 这意味着 Activity 专供应用内部使用（因为其他应用不知晓其类名称）。 因此，在这种情况下，默认值为“false”。另一方面，至少存在一个过滤器意味着 Activity 专供外部使用，因此默认值为“true”。\n该属性并非限制 Activity 对其他应用开放度的唯一手段。 您还可以利用权限来限制哪些外部实体可以调用 Activity。\n\n**android:finishOnTaskLaunch**\n该标识用来标示每当用户再次启动其任务（在主屏幕上选择任务）时，是否应关闭（完成）现有 Activity 实例 —“true”表示应关闭，“false”表示不应关闭。 默认值为“false”。如果该属性和 allowTaskReparenting 均为“true”，则优先使用该属性。 Activity 的亲和关系会被忽略。 系统不是更改 Activity 的父项，而是将其销毁。\n\n**android:hardwareAccelerated=[“true” | “false”]**\n该标识用来表明是否应为此 Activity 启用硬件加速渲染 —“true”表示应启用，“false”表示不应启用，默认值为“false”。和 application 的标识不一样的是，该标示只针对 Activity。\n从 Android 3.0 开始，为应用提供了硬件加速 OpenGL 渲染器，以改善许多常见 2D 图形运算的性能。 启用硬件加速渲染器时，Canvas、Paint、Xfermode、ColorFilter、Shader 和 Camera 中的大多数运算都会得到加速。这可以提高动画、滚动的流畅度和总体响应速度，即便是并不明确使用框架 OpenGL 库的应用也会受益。 由于启用硬件加速会增加资源消耗，因此您的应用将占用更多内存。 \n需要注意的是，并非所有 OpenGL 2D 运算都会得到加速。如果您启用硬件加速渲染器，请对应用进行测试，以确保其在利用渲染器时不会出错。\n\n**android:icon**\n一个表示 Activity 的图标。该图标会在需要在屏幕上表示 Activity 时显示给用户。 例如，代表启动任务的 Activity 的图标显示在启动器窗口中。该图标通常附带标签（请参阅 android:label 属性）。\n必须将该属性设置为对包含图像定义的可绘制资源的引用。 如果未设置该属性，则改为使用为应用整体指定的图标（请参阅 元素的 icon 属性），activity 的该属性会覆盖 application 的该属性。这个 Activity 的图标 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认图标（请参阅 元素的 icon 属性）。\n\n**android:label=”string resource”**\n一种可由用户读取的 Activity 标签。该标签会在必须将 Activity 呈现给用户时显示在屏幕上。 它通常与 Activity 图标一并显示。如果未设置该属性，则改为使用为应用整体设置的标签（请参阅 元素的 label 属性），activity 的该属性会覆盖 application 的该属性。\n这个 Activity 的标签 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认标签（请参阅 元素的 label 属性）。应将该标签设置为对字符串资源的引用，以便可以像用户界面中的其他字符串那样进行本地化。不过，为便于开发应用，也可将其设置为原始字符串。\n\n**android:launchMode(Activity加载模式)**\n在多Activity开发中，有可能是自己应用之间的Activity跳转，或者夹带其他应用的可复用Activity。可能会希望跳转到原来某个Activity实例，而不是产生大量重复的Activity。这需要为Activity配置特定的加载模式，而不是使用默认的加载模式\n\nActivity有四种加载模式：\n\n`standard`、`singleTop`、`singleTask`、`singleInstance`(其中前两个是一组、后两个是一组)，默认为`standard`\n\n`standard`：就是intent将发送给新的实例，所以每次跳转都会生成新的activity。\n\n`singleTop`：也是发送新的实例，但不同standard的一点是，在请求的Activity正好位于栈顶时(配置成singleTop的Activity)，不会构造新的实例\n\n`singleTask`：和后面的singleInstance都只创建一个实例，当intent到来，需要创建设置为singleTask的Activity的时候，系统会检查栈里面是否已经有该Activity的实例。如果有直接将intent发送给它。\n\n`singleInstance`：\n首先说明一下task这个概念，Task可以认为是一个栈，可放入多个Activity。比如启动一个应用，那么Android就创建了一个Task，然后启动这个应用的入口Activity，那在它的界面上调用其他的Activity也只是在这个task里面。那如果在多个task中共享一个Activity的话怎么办呢。举个例来说，如果开启一个导游服务类的应用程序，里面有个Activity是开启GOOGLE地图的，当按下home键退回到主菜单又启动GOOGLE地图的应用时，显示的就是刚才的地图，实际上是同一个Activity，实际上这就引入了singleInstance。singleInstance模式就是将该Activity单独放入一个栈中，这样这个栈中只有这一个Activity，不同应用的intent都由这个Activity接收和展示，这样就做到了共享。当然前提是这些应用都没有被销毁，所以刚才是按下的HOME键，如果按下了返回键，则无效\n\n**android:maxRecents=”integer”**\n该标识用来指明概览屏幕中位于此 Activity 根位置的任务数上限。 达到该条目数时，系统会从概览屏幕中移除最近最少使用的实例。 有效值为 1-50（低内存设备使用 25）；0 为无效值。 该值必须是整数，例如 50。默认值为 16。\n\n**android:multiprocess**\n该标识用来指明是否可以将 Activity 实例启动到启动该实例的组件进程内 —“true”表示可以，“false”表示不可以。默认值为“false”。\n正常情况下，新的 Activity 实例会启动到定义它的应用进程内，因此所有 Activity 实例都在同一进程内运行。 不过，如果该标志设置为“true”，Activity 实例便可在多个进程内运行，这样系统就能在任何使用实例的地方创建实例（前提是权限允许这样做），但是貌似使用的场景和案例不是很多。\n\n**android:name=”string”**\n该标识应该不用介绍了，用来指定 Activity 的类的名称，是 Activity 的子类。 该属性值应为完全限定类名称（例如，“com.example.project.DemoActivity”）。不过，为了简便起见，如果名称的第一个字符是句点（例如，“.DemoActivity”），则名称将追加到 元素中指定的软件包 com.example.project 名称之后。还有一个需要注意的是，应用一旦发布，即不应更改该名称（除非您设置了 android:exported=”false”），也就是说如果您的 Activity 有让其他应用使用到，那么最好不要修改名字，因为有可能其他应用是通过显式的方式指定的 Activity 名字，修改名字可能会造成其他应用无法正常使用甚至崩溃。\n该标识没有默认值。必须指定该名称。\n\n**android:noHistory**\n当用户离开 Activity 并且其在屏幕上不再可见时，是否应从 Activity 堆栈中将其移除并完成（调用其 finish() 方法）—“true”表示应将其完成，“false”表示不应将其完成。 默认值为“false”。“true”一值表示 Activity 不会留下历史轨迹。 它不会留在任务的 Activity 堆栈内，因此用户将无法返回 Activity。 所以有一点需要特别注意的是，在此情况下，如果从这个定义了 noHistory 的 Activity 启动另一个 Activity 来获取它的结果，系统永远不会调用 onActivityResult()，因为此时这个 Activity 已经关闭了。\n\n**android:parentActivityName=”string”**\nActivity 逻辑父项的类名称。此处的名称必须与为相应 元素的 android:name 属性指定的类名称一致。系统会读取该属性，以确定当用户按下操作栏中的“向上”按钮时应该启动哪一个 Activity。 系统还可以利用这些信息通过 TaskStackBuilder 合成 Activity 的返回栈\n关于向上导航的详细信息，可以看看  [Providing Up Navigation](https://developer.android.com/training/implementing-navigation/ancestral.html#NavigateUp)\n\n**android:permission=”string”**\n参见[android permission 1](http://blog.csdn.net/self_study/article/details/50074781)  和 [android permission 2](http://blog.csdn.net/self_study/article/details/50186435)\n\n**android:process=”string”**\n应在其中运行 Activity 的进程的名称。正常情况下，应用的所有组件都在为应用创建的默认进程名称内运行，您无需使用该属性。 但在必要时，您可以使用该属性替换默认进程名称，以便让应用组件散布到多个进程中。如果为该属性分配的名称以冒号（“:”）开头，则会在需要时创建应用专用的新进程，并且 Activity 会在该进程中运行。如果进程名称以小写字符开头，Activity 将在该名称的全局进程中运行，前提是它拥有相应的权限。这可以让不同应用中的组件共享一个进程，从而减少资源占用。\n上面提到的 Application 元素的 process 属性可为所有组件设置一个不同的默认进程名称。\n\n**android:relinquishTaskIdentity**\nActivity 是否将其任务标识符交给任务栈中在其之上的 Activity。 如果任务根 Activity 的该属性设置为“true”，则任务会用其内的下一个 Activity 的 Intent 替换基本 Intent。 如果下一个 Activity 的该属性也设置为“true”，则该 Activity 会将基本 Intent 给予其在同一任务中启动的任何 Activity。 系统继续为每个 Activity 执行此过程，直至遇到的某个 Activity 将该属性设置为“false”为止。 默认值为“false”。\n还有一个很有意思的功能是，如果该属性设置为“true”，则 Activity 还可利用 ActivityManager.TaskDescription 来更改概览屏幕中的标签、颜色和图标。\n\n**android:resizeableActivity=[“true” | “false”]**\n这个标识和 里面的作用一样，如果在 activity 里面定义的话则代表这个 activity 是否支持分屏模式。如果您将该属性设置为 true，则用户可以分屏和自由形状模式启动 Activity。 如果您将该属性设置为 false，Activity 将不支持多窗口模式。 如果该值为 false，且用户尝试在多窗口模式下启动 Activity，该 Activity 将全屏显示。\n该属性是在 API 级别 24 添加的，如果您的应用面向 API 级别 24 或更高级别，但未对该属性指定值，则该属性的值默认设为 true。\n\n**android:screenOrientation**\nActivity 在设备上的显示方向。如果 Activity 是在多窗口模式下运行，系统会忽略该属性。它的取值可以是如下：\n| **Value**          | **Description**                          |\n| ------------------ | ---------------------------------------- |\n| “unspecified”      | 默认值。由系统选择方向。在不同设备上，系统使用的政策以及基于政策在特定上下文所做的选择可能有所差异。 |\n| “behind”           | 与 Activity 栈中紧接着它的 Activity 的方向相同。       |\n| “landscape”        | 横向方向（显示的宽度大于高度）。                         |\n| “portrait”         | 纵向方向（显示的高度大于宽度）。                         |\n| “reverseLandscape” | 与正常横向方向相反的横向方向。API 级别 9 中的新增配置。          |\n| “reversePortrait”  | 与正常纵向方向相反的纵向方向。API 级别 9 中的新增配置。          |\n| “sensorLandscape”  | 横向方向，但根据设备传感器，可以是正常或反向的横向方向。API 级别 9 中的新增配置。 |\n| “sensorPortrait”   | 纵向方向，但根据设备传感器，可以是正常或反向的纵向方向。API 级别 9 中的新增配置。 |\n| “userLandscape”    | 横向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的横向方向。 如果用户锁定了基于传感器的旋转，其行为与 landscape 相同，否则，其行为与 sensorLandscape 相同。API 级别 18 中的新增配置。 |\n| “userPortrait”     | 纵向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的纵向方向。 如果用户锁定了基于传感器的旋转，其行为与 portrait 相同，否则，其行为与 sensorPortrait 相同。API 级别 18 中的新增配置。 |\n| “sensor”           | 方向由设备方向传感器决定。显示方向取决于用户如何手持设备，它会在用户旋转设备时发生变化。 但一些设备默认情况下不会旋转到所有四种可能的方向。要允许全部四种方向，请使用 “fullSensor”。 |\n| “fullSensor”       | 方向由 4 种方向中任一方向的设备方向传感器决定。这与 “sensor” 类似，不同的是它允许所有 4 种可能的屏幕方向，无论设备正常情况下采用什么方向（例如，一些设备正常情况下不使用反向纵向或反向横向，但它支持这些方向）。 API 级别 9 中的新增配置。 |\n| “nosensor”         | 决定方向时不考虑物理方向传感器。传感器会被忽略，因此显示不会随用户对设备的移动而旋转。 除了这个区别，系统在选择方向时使用的政策与“unspecified”设置相同。 |\n| “user”             | 用户当前的首选方向。                               |\n| “fullUser”         | 如果用户锁定了基于传感器的旋转，其行为与 user 相同，否则，其行为与 fullSensor 相同，允许所有 4 种可能的屏幕方向。 API 级别 18 中的新增配置。 |\n| “locked”           | 将方向锁定在其当前的任意旋转方向。API 级别 18 中的新增配置。       |\n> 注：如果您声明其中一个横向或纵向值，系统将其视为对 Activity 运行方向的硬性要求。 因此，您声明的值支持通过 Google Play 之类的服务进行过滤，这样就能将您的应用只提供给支持 Activity 所要求方向的设备。 例如，如果您声明了 “landscape”、”reverseLandscape” 或 “sensorLandscape”，则您的应用将只提供给支持横向方向的设备。 不过，您还应通过 元素明确声明，您的应用要求采用纵向或横向方向。 例如，。这纯粹是 Google Play（以及其他支持它的服务）提供的一种过滤行为，平台本身并不能控制当设备仅支持特定方向时您的应用能否安装\n\n**android:stateNotNeeded**\n该标识用来指明能否在不保存 Activity 状态的情况下将其终止并成功重新启动 —“true”表示可在不考虑其之前状态的情况下重新启动，“false”表示需要之前状态，默认值为“false”。一般情况下，为保存资源而暂时关闭 Activity 前，系统会调用 onSaveInstanceState() 方法，该方法将 Activity 的当前状态存储在一个 Bundle 对象中，然后在 Activity 重新启动时将其传递给 onCreate() 。如果该属性设置为 true，系统可能不会调用 onSaveInstanceState()，并且会向 onCreate() 传递 null 而不是 Bundle，这样就与它在 Activity 首次启动时完全一样。\n这个标识又一个特别有用的地方是，true 设置可确保 Activity 能够在未保留状态时重新启动。 例如，显示主屏幕的 Activity 可以使用该设置来确保其由于某种原因崩溃时不会被移除。\n\n**android:supportsPictureInPicture=[“true” | “false”]**\n指定 Activity 是否支持画中画显示，设置该属性的同时，需要将 android:resizeableActivity 标识设置为 true，要不然系统会忽略该属性，可以看到设置完该属性之后，android TV 就可以实现手机端一个悬浮 activity 的效果，类似于 youtube 。\n所以同样这个标识和 android:resizeableActivity 一样都是 API24 版本添加的。\n\n**android:taskAffinity=”string”**\n这个标识用来指明一个 Activity 的亲和性，使用方案可以看看我的博客：android深入解析Activity的launchMode启动模式，Intent Flag，taskAffinity。从概念上讲，具有相同亲和关系的 Activity 归属同一任务（从用户的角度来看，则是归属同一“应用”）。 任务的亲和关系由其根 Activity 的亲和关系确定。亲和关系确定两件事 - Activity 更改到的父项任务（请参阅上面提到的 allowTaskReparenting 属性）和通过 FLAG_ACTIVITY_NEW_TASK 标志启动 Activity 时将用来容纳它的任务。默认情况下，应用中的所有 Activity 都具有相同的亲和关系。您可以设置该属性来以不同方式组合它们，甚至可以将在不同应用中定义的 Activity 置于同一任务内。 要指定 Activity 与任何任务均无亲和关系，请将其设置为空字符串。如果未设置该属性，则 Activity 继承为应用设置的亲和关系（可以参考 元素的 taskAffinity 属性），应用默认亲和关系的名称是 元素设置的 packageName。\n\n**android:theme=”resource or theme”**\n这个标识用的应该很多了，用来定义一个 activity 的样式，为一个资源的引用，它会自动将 Activity 的上下文设置为使用该主题（请参阅 setTheme()），它还可以引发 Activity 启动前的“启动”动画（以更加符合 Activity 的实际外观）。如果未设置该属性，则 Activity 继承通过 application 元素的 theme 属性为应用整体设置的主题。 如果该属性也未设置，则使用默认系统主题。\n\n**android:uiOptions=[“none” | “splitActionBarWhenNarrow”]**\n这个标识主要是用来针对 action bar 的，它有两个值：\n\n| **Value**                  | **Description**                          |\n| -------------------------- | ---------------------------------------- |\n| “none”                     | 无附加 UI 选项。这是默认值。                         |\n| “splitActionBarWhenNarrow” | 当水平空间受限时（例如在手持设备上的纵向模式下时）在屏幕底部添加一个栏以显示应用栏（也称为操作栏）中的操作项）。 应用栏不是以少量操作项形式出现在屏幕顶部的应用栏中，而是分成了顶部导航区和底部操作项栏。 这可以确保操作项以及顶部的导航和标题元素都能获得合理的空间。 菜单项不会拆分到两个栏中，它们始终一起出现。 |\n\n**android:windowSoftInputMode**\nactivity主窗口与软键盘的交互模式，可以用来避免输入法面板遮挡问题，Android1.5后的一个新特性。\n这个属性能影响两件事情：\n- 当 Activity 成为用户注意的焦点时软键盘的状态 — 隐藏还是可见\n- 对 Activity 主窗口所做的调整 — 是否将其尺寸调小以为软键盘腾出空间，或者当窗口部分被软键盘遮挡时是否平移其内容以使当前焦点可见\n  各值的含义：\n- stateUnspecified：软键盘的状态并没有指定，系统将选择一个合适的状态或依赖于主题的设置\n- stateUnchanged：当这个activity出现时，软键盘将一直保持在上一个activity里的状态，无论是隐藏还是显示\n- stateHidden：用户选择activity时，软键盘总是被隐藏\n- stateAlwaysHidden：当用户选择 Activity 时 — 也就是说，当用户确实是向前导航到 Activity，而不是因离开另一 Activity 而返回时 — 隐藏软键盘。（当该Activity主窗口获取焦点时，软键盘也总是被隐藏的）\n- stateVisible：软键盘通常是可见的\n- stateAlwaysVisible：用户选择activity时，软键盘总是显示的状态\n- adjustUnspecified：默认设置，通常由系统自行决定是隐藏还是显示\n- adjustResize：该Activity总是调整屏幕的大小以便留出软键盘的空间\n- adjustPan：当前窗口的内容将自动移动以便当前焦点从不被键盘覆盖和用户能总是看到输入内容的部分\n> adjustResize 和 adjustPan 的区别就在于前者是调整 Activity 的窗口尺寸来达到适配的目的，而 adjustPan 仅仅只是将窗口平移，界面的一部分就会被软键盘覆盖住，就不会被挤到软键盘之上了。","source":"_posts/android/android-config-activity.md","raw":"---\ntitle: Android配置文件详解-Activity\ndate: 2017-02-23 11:00:18\ntags: android\n---\n\n## Activity\n\n```java\n<activity android:allowEmbedded=[\"true\" | \"false\"]\n          android:allowTaskReparenting=[\"true\" | \"false\"]\n          android:alwaysRetainTaskState=[\"true\" | \"false\"]\n          android:alwaysRetainTaskState=[\"true\" | \"false\"]\n          android:autoRemoveFromRecents=[\"true\" | \"false\"]\n          android:banner=”drawable resource”\n          android:clearTaskOnLaunch=[\"true\" | \"false\"]\n          android:configChanges=[\"mcc\", \"mnc\", \"locale\",\n                                 \"touchscreen\", \"keyboard\", \"keyboardHidden\",\n                                 \"navigation\", \"screenLayout\", \"fontScale\",\n                                 \"uiMode\", \"orientation\",\"screenSize\",\n                                 \"smallestScreenSize\"]\n          android:documentLaunchMode=[\"intoExisting\" | \"always\" | \n“none” | “never”]\n          android:enabled=[\"true\" | \"false\"]\n          android:excludeFromRecents=[\"true\" | \"false\"]\n          android:exported=[\"true\" | \"false\"]\n          android:finishOnTaskLaunch=[\"true\" | \"false\"]\n          android:hardwareAccelerated=[\"true\" | \"false\"]\n          android:icon=\"drawable resource\"\n          android:label=\"string resource\"\n          android:launchMode=[\"standard\" | \"singleTop\" |\n                              \"singleTask\" | \"singleInstance\"]\n          android:maxRecents=\"integer\"\n          android:multiprocess=[\"true\" | \"false\"]\n          android:name=\"string\"\n          android:noHistory=[\"true\" | \"false\"]  \n          android:parentActivityName=\"string\"\n          android:permission=\"string\"\n          android:process=\"string\"\n          android:relinquishTaskIdentity=[\"true\" | \"false\"]\n          android:resizeableActivity=[\"true\" | \"false\"]\n          android:screenOrientation=[\"unspecified\" | \"behind\" | \"landscape\" |\n                                     \"portrait\" | \"reverseLandscape\" | \"sensorLandscape\" |\n                                     \"sensorPortrait\" | \"userLandscape\" | \"userPortrait\" |\n                                     \"sensor\" | \"fullSensor\" | \"nosensor\"]\n                                     \"user\" | \"fullUser\" | \"locked\"\n          android:stateNotNeeded=[\"true\" | \"false\"]\n          android:supportsPictureInPicture=[\"true\" | \"false\"]\n          android:taskAffinity=\"string\"\n          android:theme=\"resource or theme\"\n          android:uiOptions=[\"none\" | \"splitActionBarWhenNarrow\"]\n          android:windowSoftInputMode=[\"stateUnspecified\",\n                                       \"stateUnchanged\", \"stateHidden\",\n                                       \"stateAlwaysHidden\", \"stateVisible\",\n                                       \"stateAlwaysVisible\", \"adjustUnspecified\",\n                                       \"adjustResize\", \"adjustPan\"] >   \n</activity>\n```\n\n<!-- more -->\n\nandroid:allowEmbedded=[“true” | “false”]**\n这个标识一般为开发可穿戴设备时使用，表示该 Activity 可作为另一 Activity 的嵌入式子项启动。 它尤其适用于子项所在的容器（如 Display）为另一 Activity 所拥有的情况。 例如，用于 Wear 自定义通知的 Activity 必须声明此项，以便 Wear 在其上下文流中显示 Activity，后者位于另一进程中。该属性的默认值为 false。\n\n**android:allowTaskReparenting=[“true” | “false”]**\n这个标示和 Application 的标识意义一样，所以如果同时声明该标识，这个标识会覆盖 Application 的标识\n\n**android:alwaysRetainTaskState**\n这个标识用来指示系统是否始终保持 Activity 所在任务的状态 —“true”表示保持，“false”表示允许系统在特定情况下将任务重置到其初始状态。 默认值为“false”。该属性只对任务的根 Activity 有意义；对于所有其他 Activity，均忽略该属性。\n正常情况下，当用户从主屏幕重新选择某个任务时，系统会在特定情况下清除该任务（从根 Activity 之上的堆栈中移除所有 Activity）。 系统通常会在用户一段时间（如 30 分钟）内未访问任务时执行此操作。\n不过，如果该属性的值是“true”，则无论用户如何到达任务，将始终返回到最后状态的任务。 例如，在网络浏览器这类存在大量用户不愿失去的状态（如多个打开的标签）的应用中，该属性会很有用。\n\n**android:autoRemoveFromRecents=[\"true\" | \"false\"]**\n这个标识为 API21 版本添加，由具有该属性的 Activity 启动的任务是否一直保留在概览屏幕中，直至任务中的最后一个 Activity 完成为止。 若为 true，则自动从概览屏幕中移除任务。 它会替换调用方使用的 FLAG_ACTIVITY_RETAIN_IN_RECENTS。 它必须是布尔值“true”或“false”。\n\nandroid:banner=”drawable resource”\n这个和 application 里面的 banner 标识一样，也是用在 android TV 上的\n\n**android:clearTaskOnLaunch** \n这个标识用来指明当应用从主屏幕重新启动时是否都从中移除除根 Activity 之外的所有 Activity，true 表示始终将任务清除到只剩其根 Activity，false 表示不清除，默认值为 false。需要注意的是该属性只对启动新任务的 Activity（根 Activity）有意义；对于任务中的所有其他 Activity，均忽略该属性。当值为“false”时，可在某些情况下清除任务中的 Activity（参考结合 alwaysRetainTaskState 属性），但并非一律可以。如果该属性和 allowTaskReparenting 的值均为“true”，则如上所述，任何可以更改父项的 Activity 都将转移到与其有亲和关系的任务；其余 Activity 随即被移除。\n例如，假定有人从主屏幕启动了 Activity P，然后从那里转到 Activity Q。该用户接着按了主屏幕按钮，然后返回到 Activity P。正常情况下，用户将看到 Activity Q，因为那是其最后在 P 的任务中执行的 Activity。 不过，如果 P 将此标志设置为“true”，则当用户按下主屏幕将任务转入后台时，其上的所有 Activity（在本例中为 Q）都会被移除。 因此用户返回任务时只会看到 P。\n\n**android:configChanges**\n列出 Activity 将自行处理的配置更改。在运行时发生配置更改时，默认情况下会关闭 Activity 然后将其重新启动，但使用该属性声明配置将阻止 Activity 重新启动。 Activity 反而会保持运行状态，并且系统会调用其 onConfigurationChanged() 方法。以下为该属性的值，多个值使用“|”分隔 — 例如，“locale|navigation|orientation”：\n| **Value**            | **Description**                          |\n| -------------------- | ---------------------------------------- |\n| “mcc”                | IMSI 移动国家/地区代码 (MCC) 发生了变化 - 检测到了 SIM 并更新了 MCC。 |\n| “mnc”                | IMSI 移动网络代码 (MNC) 发生了变化 - 检测到了 SIM 并更新了 MNC。 |\n| locale”              | 语言区域发生了变化 — 用户为文本选择了新的显示语言。              |\n| “touchscreen”        | 触摸屏发生了变化。（这种情况通常永远不会发生。）                 |\n| “keyboard”           | 键盘类型发生了变化 — 例如，用户插入了一个外置键盘。              |\n| “keyboardHidden”     | 键盘无障碍功能发生了变化 — 例如，用户显示了硬件键盘。             |\n| “navigation”         | 导航类型（轨迹球/方向键）发生了变化。（这种情况通常永远不会发生。）       |\n| “screenLayout”       | 屏幕布局发生了变化 — 这可能是由激活了其他显示方式所致。            |\n| “fontScale”          | 字体缩放系数发生了变化 — 用户选择了新的全局字号。               |\n| “uiMode”             | 用户界面模式发生了变化 — 这可能是因用户将设备放入桌面/车载基座或夜间模式发生变化所致。 请参阅 [UiModeManager](https://developer.android.com/reference/android/app/UiModeManager.html)。 此项为 API 级别 8 中新增配置。 |\n| “orientation”        | 屏幕方向发生了变化 — 用户旋转了设备。 注：如果您的应用面向 API 级别 13 或更高级别（按照 minSdkVersion 和 targetSdkVersion 属性所声明的级别），则还应声明 “screenSize” 配置，因为当设备在横向与纵向之间切换时，该配置也会发生变化。 |\n| “screenSize”         | 当前可用屏幕尺寸发生了变化。它表示当前可用尺寸相对于当前纵横比的变化，因此会在用户在横向与纵向之间切换时发生变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |\n| “smallestScreenSize” | 物理屏幕尺寸发生了变化。它表示与方向无关的尺寸变化，因此只有在实际物理屏幕尺寸发生变化（如切换到外部显示器）时才会变化。对此配置的变更对应于smallestWidth 配置的变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |\n| “layoutDirection”    | 布局方向发生了变化。例如，从从左至右 (LTR) 更改为从右至左 (RTL)。 此项为 API 级别 17 中新增配置。 |\n所有这些配置变更都可能影响应用看到的资源值。 因此，调用 onConfigurationChanged() 时，通常有必要再次获取所有资源（包括视图布局、可绘制对象等），以正确处理变化。 \n　　我们平常接触到最多的就是屏幕的旋转，屏幕的旋转如果在没有特殊设置的情况下会销毁当前的 Activity 重新创建一个新的，为了避免创建新的，就可以在 AndroidMainfest.xml 中对指定 Activity 对应的 配置android:configChanges=”orientation”，这样，每次旋转方向时，只有 onConfigurationChanged 方法被调用，没有了销毁重建的过程。\n　　\n**android:documentLaunchMode=[“intoExisting” | “always” | “none” | “never”]**\n指定每次启动任务时应如何向其中添加新的 Activity 实例。 该属性允许用户让多个来自同一应用的文档出现在概览屏幕（recent app）中。该属性有四个值，会在用户使用该应用打开文档时产生以下效果：\n\n| **Value**      | **Description**                          |\n| -------------- | ---------------------------------------- |\n| “intoExisting” | Activity 会为文档重复使用现有任务。使用该值与不设置 [FLAG_ACTIVITY_MULTIPLE_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK) 标志、但设置 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT) 标志所产生的效果相同，如使用 [Intent 标志添加任务中](https://developer.android.com/guide/components/recents.html#flag-new-doc)所述。 |\n| “always”       | Activity 为文档创建新任务，即便文档已打开也是如此。 这与同时设置 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT) 和 [FLAG_ACTIVITY_MULTIPLE_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK) 标志的效果相同。 |\n| “none”         | 该 Activity 不会为 Activity 创建新任务。这是默认值，它只会在设置了 [FLAG_ACTIVITY_NEW_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK) 时创建新任务。 概览屏幕将按其默认方式对待此 Activity：为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。 |\n| “never”        | 即使 Intent 包含 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT)，该 Activity 也不会启动到新文档之中。 设置此值会替代 [FLAG_ACTIVITY_NEW_DOCUMENT](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT) 和 [FLAG_ACTIVITY_MULTIPLE_TASK](https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK) 标志的行为（如果在 Activity 中设置了其中一个标志），并且概览屏幕将为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。 |\n> 注：对于除“none”和“never”以外的值，必须使用 launchMode=”standard” 定义 Activity。 如果未指定此属性，则使用 documentLaunchMode=”none”。\n\n**android:enabled=[“true” | “false”]**\n该属性用来标示系统是否可将 Activity 实例化 — “true” 表示可以，“false”表示不可以。 默认值为“true”。\n上面提到了 元素具有自己的 enabled 属性，该属性适用于所有应用组件，包括 Activity。 和 属性必须都是“true”（因为它们都默认使用该值），系统才能将 Activity 实例化。 如果任何一个属性是“false”，则无法进行实例化。\n\n**android:excludeFromRecents**\n该标识用来标示是否应将该 Activity 启动的任务排除在最近使用的应用列表（即概览屏幕）之外。 也就是说，当该 Activity 是新任务的根 Activity 时，此属性确定任务是否应出现在最近使用的应用列表中。 如果应将任务排除在列表之外，请设置“true”；如果应将其包括在内，则设置“false”。 默认值为“false”。\n\n**android:exported=[“true” | “false”]**\n该标识用来指明Activity 是否可由其他应用的组件启动 —“true”表示可以，“false”表示不可以。若为“false”，则 Activity 只能由同一应用的组件或使用同一用户 ID 的不同应用启动。\n需要注意的是该默认值取决于 Activity 是否包含 Intent 过滤器。没有任何过滤器意味着 Activity 只能通过指定其确切的类名称进行调用。 这意味着 Activity 专供应用内部使用（因为其他应用不知晓其类名称）。 因此，在这种情况下，默认值为“false”。另一方面，至少存在一个过滤器意味着 Activity 专供外部使用，因此默认值为“true”。\n该属性并非限制 Activity 对其他应用开放度的唯一手段。 您还可以利用权限来限制哪些外部实体可以调用 Activity。\n\n**android:finishOnTaskLaunch**\n该标识用来标示每当用户再次启动其任务（在主屏幕上选择任务）时，是否应关闭（完成）现有 Activity 实例 —“true”表示应关闭，“false”表示不应关闭。 默认值为“false”。如果该属性和 allowTaskReparenting 均为“true”，则优先使用该属性。 Activity 的亲和关系会被忽略。 系统不是更改 Activity 的父项，而是将其销毁。\n\n**android:hardwareAccelerated=[“true” | “false”]**\n该标识用来表明是否应为此 Activity 启用硬件加速渲染 —“true”表示应启用，“false”表示不应启用，默认值为“false”。和 application 的标识不一样的是，该标示只针对 Activity。\n从 Android 3.0 开始，为应用提供了硬件加速 OpenGL 渲染器，以改善许多常见 2D 图形运算的性能。 启用硬件加速渲染器时，Canvas、Paint、Xfermode、ColorFilter、Shader 和 Camera 中的大多数运算都会得到加速。这可以提高动画、滚动的流畅度和总体响应速度，即便是并不明确使用框架 OpenGL 库的应用也会受益。 由于启用硬件加速会增加资源消耗，因此您的应用将占用更多内存。 \n需要注意的是，并非所有 OpenGL 2D 运算都会得到加速。如果您启用硬件加速渲染器，请对应用进行测试，以确保其在利用渲染器时不会出错。\n\n**android:icon**\n一个表示 Activity 的图标。该图标会在需要在屏幕上表示 Activity 时显示给用户。 例如，代表启动任务的 Activity 的图标显示在启动器窗口中。该图标通常附带标签（请参阅 android:label 属性）。\n必须将该属性设置为对包含图像定义的可绘制资源的引用。 如果未设置该属性，则改为使用为应用整体指定的图标（请参阅 元素的 icon 属性），activity 的该属性会覆盖 application 的该属性。这个 Activity 的图标 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认图标（请参阅 元素的 icon 属性）。\n\n**android:label=”string resource”**\n一种可由用户读取的 Activity 标签。该标签会在必须将 Activity 呈现给用户时显示在屏幕上。 它通常与 Activity 图标一并显示。如果未设置该属性，则改为使用为应用整体设置的标签（请参阅 元素的 label 属性），activity 的该属性会覆盖 application 的该属性。\n这个 Activity 的标签 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认标签（请参阅 元素的 label 属性）。应将该标签设置为对字符串资源的引用，以便可以像用户界面中的其他字符串那样进行本地化。不过，为便于开发应用，也可将其设置为原始字符串。\n\n**android:launchMode(Activity加载模式)**\n在多Activity开发中，有可能是自己应用之间的Activity跳转，或者夹带其他应用的可复用Activity。可能会希望跳转到原来某个Activity实例，而不是产生大量重复的Activity。这需要为Activity配置特定的加载模式，而不是使用默认的加载模式\n\nActivity有四种加载模式：\n\n`standard`、`singleTop`、`singleTask`、`singleInstance`(其中前两个是一组、后两个是一组)，默认为`standard`\n\n`standard`：就是intent将发送给新的实例，所以每次跳转都会生成新的activity。\n\n`singleTop`：也是发送新的实例，但不同standard的一点是，在请求的Activity正好位于栈顶时(配置成singleTop的Activity)，不会构造新的实例\n\n`singleTask`：和后面的singleInstance都只创建一个实例，当intent到来，需要创建设置为singleTask的Activity的时候，系统会检查栈里面是否已经有该Activity的实例。如果有直接将intent发送给它。\n\n`singleInstance`：\n首先说明一下task这个概念，Task可以认为是一个栈，可放入多个Activity。比如启动一个应用，那么Android就创建了一个Task，然后启动这个应用的入口Activity，那在它的界面上调用其他的Activity也只是在这个task里面。那如果在多个task中共享一个Activity的话怎么办呢。举个例来说，如果开启一个导游服务类的应用程序，里面有个Activity是开启GOOGLE地图的，当按下home键退回到主菜单又启动GOOGLE地图的应用时，显示的就是刚才的地图，实际上是同一个Activity，实际上这就引入了singleInstance。singleInstance模式就是将该Activity单独放入一个栈中，这样这个栈中只有这一个Activity，不同应用的intent都由这个Activity接收和展示，这样就做到了共享。当然前提是这些应用都没有被销毁，所以刚才是按下的HOME键，如果按下了返回键，则无效\n\n**android:maxRecents=”integer”**\n该标识用来指明概览屏幕中位于此 Activity 根位置的任务数上限。 达到该条目数时，系统会从概览屏幕中移除最近最少使用的实例。 有效值为 1-50（低内存设备使用 25）；0 为无效值。 该值必须是整数，例如 50。默认值为 16。\n\n**android:multiprocess**\n该标识用来指明是否可以将 Activity 实例启动到启动该实例的组件进程内 —“true”表示可以，“false”表示不可以。默认值为“false”。\n正常情况下，新的 Activity 实例会启动到定义它的应用进程内，因此所有 Activity 实例都在同一进程内运行。 不过，如果该标志设置为“true”，Activity 实例便可在多个进程内运行，这样系统就能在任何使用实例的地方创建实例（前提是权限允许这样做），但是貌似使用的场景和案例不是很多。\n\n**android:name=”string”**\n该标识应该不用介绍了，用来指定 Activity 的类的名称，是 Activity 的子类。 该属性值应为完全限定类名称（例如，“com.example.project.DemoActivity”）。不过，为了简便起见，如果名称的第一个字符是句点（例如，“.DemoActivity”），则名称将追加到 元素中指定的软件包 com.example.project 名称之后。还有一个需要注意的是，应用一旦发布，即不应更改该名称（除非您设置了 android:exported=”false”），也就是说如果您的 Activity 有让其他应用使用到，那么最好不要修改名字，因为有可能其他应用是通过显式的方式指定的 Activity 名字，修改名字可能会造成其他应用无法正常使用甚至崩溃。\n该标识没有默认值。必须指定该名称。\n\n**android:noHistory**\n当用户离开 Activity 并且其在屏幕上不再可见时，是否应从 Activity 堆栈中将其移除并完成（调用其 finish() 方法）—“true”表示应将其完成，“false”表示不应将其完成。 默认值为“false”。“true”一值表示 Activity 不会留下历史轨迹。 它不会留在任务的 Activity 堆栈内，因此用户将无法返回 Activity。 所以有一点需要特别注意的是，在此情况下，如果从这个定义了 noHistory 的 Activity 启动另一个 Activity 来获取它的结果，系统永远不会调用 onActivityResult()，因为此时这个 Activity 已经关闭了。\n\n**android:parentActivityName=”string”**\nActivity 逻辑父项的类名称。此处的名称必须与为相应 元素的 android:name 属性指定的类名称一致。系统会读取该属性，以确定当用户按下操作栏中的“向上”按钮时应该启动哪一个 Activity。 系统还可以利用这些信息通过 TaskStackBuilder 合成 Activity 的返回栈\n关于向上导航的详细信息，可以看看  [Providing Up Navigation](https://developer.android.com/training/implementing-navigation/ancestral.html#NavigateUp)\n\n**android:permission=”string”**\n参见[android permission 1](http://blog.csdn.net/self_study/article/details/50074781)  和 [android permission 2](http://blog.csdn.net/self_study/article/details/50186435)\n\n**android:process=”string”**\n应在其中运行 Activity 的进程的名称。正常情况下，应用的所有组件都在为应用创建的默认进程名称内运行，您无需使用该属性。 但在必要时，您可以使用该属性替换默认进程名称，以便让应用组件散布到多个进程中。如果为该属性分配的名称以冒号（“:”）开头，则会在需要时创建应用专用的新进程，并且 Activity 会在该进程中运行。如果进程名称以小写字符开头，Activity 将在该名称的全局进程中运行，前提是它拥有相应的权限。这可以让不同应用中的组件共享一个进程，从而减少资源占用。\n上面提到的 Application 元素的 process 属性可为所有组件设置一个不同的默认进程名称。\n\n**android:relinquishTaskIdentity**\nActivity 是否将其任务标识符交给任务栈中在其之上的 Activity。 如果任务根 Activity 的该属性设置为“true”，则任务会用其内的下一个 Activity 的 Intent 替换基本 Intent。 如果下一个 Activity 的该属性也设置为“true”，则该 Activity 会将基本 Intent 给予其在同一任务中启动的任何 Activity。 系统继续为每个 Activity 执行此过程，直至遇到的某个 Activity 将该属性设置为“false”为止。 默认值为“false”。\n还有一个很有意思的功能是，如果该属性设置为“true”，则 Activity 还可利用 ActivityManager.TaskDescription 来更改概览屏幕中的标签、颜色和图标。\n\n**android:resizeableActivity=[“true” | “false”]**\n这个标识和 里面的作用一样，如果在 activity 里面定义的话则代表这个 activity 是否支持分屏模式。如果您将该属性设置为 true，则用户可以分屏和自由形状模式启动 Activity。 如果您将该属性设置为 false，Activity 将不支持多窗口模式。 如果该值为 false，且用户尝试在多窗口模式下启动 Activity，该 Activity 将全屏显示。\n该属性是在 API 级别 24 添加的，如果您的应用面向 API 级别 24 或更高级别，但未对该属性指定值，则该属性的值默认设为 true。\n\n**android:screenOrientation**\nActivity 在设备上的显示方向。如果 Activity 是在多窗口模式下运行，系统会忽略该属性。它的取值可以是如下：\n| **Value**          | **Description**                          |\n| ------------------ | ---------------------------------------- |\n| “unspecified”      | 默认值。由系统选择方向。在不同设备上，系统使用的政策以及基于政策在特定上下文所做的选择可能有所差异。 |\n| “behind”           | 与 Activity 栈中紧接着它的 Activity 的方向相同。       |\n| “landscape”        | 横向方向（显示的宽度大于高度）。                         |\n| “portrait”         | 纵向方向（显示的高度大于宽度）。                         |\n| “reverseLandscape” | 与正常横向方向相反的横向方向。API 级别 9 中的新增配置。          |\n| “reversePortrait”  | 与正常纵向方向相反的纵向方向。API 级别 9 中的新增配置。          |\n| “sensorLandscape”  | 横向方向，但根据设备传感器，可以是正常或反向的横向方向。API 级别 9 中的新增配置。 |\n| “sensorPortrait”   | 纵向方向，但根据设备传感器，可以是正常或反向的纵向方向。API 级别 9 中的新增配置。 |\n| “userLandscape”    | 横向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的横向方向。 如果用户锁定了基于传感器的旋转，其行为与 landscape 相同，否则，其行为与 sensorLandscape 相同。API 级别 18 中的新增配置。 |\n| “userPortrait”     | 纵向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的纵向方向。 如果用户锁定了基于传感器的旋转，其行为与 portrait 相同，否则，其行为与 sensorPortrait 相同。API 级别 18 中的新增配置。 |\n| “sensor”           | 方向由设备方向传感器决定。显示方向取决于用户如何手持设备，它会在用户旋转设备时发生变化。 但一些设备默认情况下不会旋转到所有四种可能的方向。要允许全部四种方向，请使用 “fullSensor”。 |\n| “fullSensor”       | 方向由 4 种方向中任一方向的设备方向传感器决定。这与 “sensor” 类似，不同的是它允许所有 4 种可能的屏幕方向，无论设备正常情况下采用什么方向（例如，一些设备正常情况下不使用反向纵向或反向横向，但它支持这些方向）。 API 级别 9 中的新增配置。 |\n| “nosensor”         | 决定方向时不考虑物理方向传感器。传感器会被忽略，因此显示不会随用户对设备的移动而旋转。 除了这个区别，系统在选择方向时使用的政策与“unspecified”设置相同。 |\n| “user”             | 用户当前的首选方向。                               |\n| “fullUser”         | 如果用户锁定了基于传感器的旋转，其行为与 user 相同，否则，其行为与 fullSensor 相同，允许所有 4 种可能的屏幕方向。 API 级别 18 中的新增配置。 |\n| “locked”           | 将方向锁定在其当前的任意旋转方向。API 级别 18 中的新增配置。       |\n> 注：如果您声明其中一个横向或纵向值，系统将其视为对 Activity 运行方向的硬性要求。 因此，您声明的值支持通过 Google Play 之类的服务进行过滤，这样就能将您的应用只提供给支持 Activity 所要求方向的设备。 例如，如果您声明了 “landscape”、”reverseLandscape” 或 “sensorLandscape”，则您的应用将只提供给支持横向方向的设备。 不过，您还应通过 元素明确声明，您的应用要求采用纵向或横向方向。 例如，。这纯粹是 Google Play（以及其他支持它的服务）提供的一种过滤行为，平台本身并不能控制当设备仅支持特定方向时您的应用能否安装\n\n**android:stateNotNeeded**\n该标识用来指明能否在不保存 Activity 状态的情况下将其终止并成功重新启动 —“true”表示可在不考虑其之前状态的情况下重新启动，“false”表示需要之前状态，默认值为“false”。一般情况下，为保存资源而暂时关闭 Activity 前，系统会调用 onSaveInstanceState() 方法，该方法将 Activity 的当前状态存储在一个 Bundle 对象中，然后在 Activity 重新启动时将其传递给 onCreate() 。如果该属性设置为 true，系统可能不会调用 onSaveInstanceState()，并且会向 onCreate() 传递 null 而不是 Bundle，这样就与它在 Activity 首次启动时完全一样。\n这个标识又一个特别有用的地方是，true 设置可确保 Activity 能够在未保留状态时重新启动。 例如，显示主屏幕的 Activity 可以使用该设置来确保其由于某种原因崩溃时不会被移除。\n\n**android:supportsPictureInPicture=[“true” | “false”]**\n指定 Activity 是否支持画中画显示，设置该属性的同时，需要将 android:resizeableActivity 标识设置为 true，要不然系统会忽略该属性，可以看到设置完该属性之后，android TV 就可以实现手机端一个悬浮 activity 的效果，类似于 youtube 。\n所以同样这个标识和 android:resizeableActivity 一样都是 API24 版本添加的。\n\n**android:taskAffinity=”string”**\n这个标识用来指明一个 Activity 的亲和性，使用方案可以看看我的博客：android深入解析Activity的launchMode启动模式，Intent Flag，taskAffinity。从概念上讲，具有相同亲和关系的 Activity 归属同一任务（从用户的角度来看，则是归属同一“应用”）。 任务的亲和关系由其根 Activity 的亲和关系确定。亲和关系确定两件事 - Activity 更改到的父项任务（请参阅上面提到的 allowTaskReparenting 属性）和通过 FLAG_ACTIVITY_NEW_TASK 标志启动 Activity 时将用来容纳它的任务。默认情况下，应用中的所有 Activity 都具有相同的亲和关系。您可以设置该属性来以不同方式组合它们，甚至可以将在不同应用中定义的 Activity 置于同一任务内。 要指定 Activity 与任何任务均无亲和关系，请将其设置为空字符串。如果未设置该属性，则 Activity 继承为应用设置的亲和关系（可以参考 元素的 taskAffinity 属性），应用默认亲和关系的名称是 元素设置的 packageName。\n\n**android:theme=”resource or theme”**\n这个标识用的应该很多了，用来定义一个 activity 的样式，为一个资源的引用，它会自动将 Activity 的上下文设置为使用该主题（请参阅 setTheme()），它还可以引发 Activity 启动前的“启动”动画（以更加符合 Activity 的实际外观）。如果未设置该属性，则 Activity 继承通过 application 元素的 theme 属性为应用整体设置的主题。 如果该属性也未设置，则使用默认系统主题。\n\n**android:uiOptions=[“none” | “splitActionBarWhenNarrow”]**\n这个标识主要是用来针对 action bar 的，它有两个值：\n\n| **Value**                  | **Description**                          |\n| -------------------------- | ---------------------------------------- |\n| “none”                     | 无附加 UI 选项。这是默认值。                         |\n| “splitActionBarWhenNarrow” | 当水平空间受限时（例如在手持设备上的纵向模式下时）在屏幕底部添加一个栏以显示应用栏（也称为操作栏）中的操作项）。 应用栏不是以少量操作项形式出现在屏幕顶部的应用栏中，而是分成了顶部导航区和底部操作项栏。 这可以确保操作项以及顶部的导航和标题元素都能获得合理的空间。 菜单项不会拆分到两个栏中，它们始终一起出现。 |\n\n**android:windowSoftInputMode**\nactivity主窗口与软键盘的交互模式，可以用来避免输入法面板遮挡问题，Android1.5后的一个新特性。\n这个属性能影响两件事情：\n- 当 Activity 成为用户注意的焦点时软键盘的状态 — 隐藏还是可见\n- 对 Activity 主窗口所做的调整 — 是否将其尺寸调小以为软键盘腾出空间，或者当窗口部分被软键盘遮挡时是否平移其内容以使当前焦点可见\n  各值的含义：\n- stateUnspecified：软键盘的状态并没有指定，系统将选择一个合适的状态或依赖于主题的设置\n- stateUnchanged：当这个activity出现时，软键盘将一直保持在上一个activity里的状态，无论是隐藏还是显示\n- stateHidden：用户选择activity时，软键盘总是被隐藏\n- stateAlwaysHidden：当用户选择 Activity 时 — 也就是说，当用户确实是向前导航到 Activity，而不是因离开另一 Activity 而返回时 — 隐藏软键盘。（当该Activity主窗口获取焦点时，软键盘也总是被隐藏的）\n- stateVisible：软键盘通常是可见的\n- stateAlwaysVisible：用户选择activity时，软键盘总是显示的状态\n- adjustUnspecified：默认设置，通常由系统自行决定是隐藏还是显示\n- adjustResize：该Activity总是调整屏幕的大小以便留出软键盘的空间\n- adjustPan：当前窗口的内容将自动移动以便当前焦点从不被键盘覆盖和用户能总是看到输入内容的部分\n> adjustResize 和 adjustPan 的区别就在于前者是调整 Activity 的窗口尺寸来达到适配的目的，而 adjustPan 仅仅只是将窗口平移，界面的一部分就会被软键盘覆盖住，就不会被挤到软键盘之上了。","slug":"android/android-config-activity","published":1,"updated":"2018-01-31T09:35:37.812Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ea000gizcbxzufp466","content":"<h2 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;activity android:allowEmbedded=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:allowTaskReparenting=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:alwaysRetainTaskState=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:alwaysRetainTaskState=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:autoRemoveFromRecents=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:banner=”drawable resource”</span><br><span class=\"line\">          android:clearTaskOnLaunch=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:configChanges=[<span class=\"string\">\"mcc\"</span>, <span class=\"string\">\"mnc\"</span>, <span class=\"string\">\"locale\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"touchscreen\"</span>, <span class=\"string\">\"keyboard\"</span>, <span class=\"string\">\"keyboardHidden\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"navigation\"</span>, <span class=\"string\">\"screenLayout\"</span>, <span class=\"string\">\"fontScale\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"uiMode\"</span>, <span class=\"string\">\"orientation\"</span>,<span class=\"string\">\"screenSize\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"smallestScreenSize\"</span>]</span><br><span class=\"line\">          android:documentLaunchMode=[<span class=\"string\">\"intoExisting\"</span> | <span class=\"string\">\"always\"</span> | </span><br><span class=\"line\">“none” | “never”]</span><br><span class=\"line\">          android:enabled=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:excludeFromRecents=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:exported=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:finishOnTaskLaunch=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:hardwareAccelerated=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:icon=<span class=\"string\">\"drawable resource\"</span></span><br><span class=\"line\">          android:label=<span class=\"string\">\"string resource\"</span></span><br><span class=\"line\">          android:launchMode=[<span class=\"string\">\"standard\"</span> | <span class=\"string\">\"singleTop\"</span> |</span><br><span class=\"line\">                              <span class=\"string\">\"singleTask\"</span> | <span class=\"string\">\"singleInstance\"</span>]</span><br><span class=\"line\">          android:maxRecents=<span class=\"string\">\"integer\"</span></span><br><span class=\"line\">          android:multiprocess=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:name=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:noHistory=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]  </span><br><span class=\"line\">          android:parentActivityName=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:permission=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:process=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:relinquishTaskIdentity=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:resizeableActivity=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:screenOrientation=[<span class=\"string\">\"unspecified\"</span> | <span class=\"string\">\"behind\"</span> | <span class=\"string\">\"landscape\"</span> |</span><br><span class=\"line\">                                     <span class=\"string\">\"portrait\"</span> | <span class=\"string\">\"reverseLandscape\"</span> | <span class=\"string\">\"sensorLandscape\"</span> |</span><br><span class=\"line\">                                     <span class=\"string\">\"sensorPortrait\"</span> | <span class=\"string\">\"userLandscape\"</span> | <span class=\"string\">\"userPortrait\"</span> |</span><br><span class=\"line\">                                     <span class=\"string\">\"sensor\"</span> | <span class=\"string\">\"fullSensor\"</span> | <span class=\"string\">\"nosensor\"</span>]</span><br><span class=\"line\">                                     <span class=\"string\">\"user\"</span> | <span class=\"string\">\"fullUser\"</span> | <span class=\"string\">\"locked\"</span></span><br><span class=\"line\">          android:stateNotNeeded=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:supportsPictureInPicture=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:taskAffinity=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:theme=<span class=\"string\">\"resource or theme\"</span></span><br><span class=\"line\">          android:uiOptions=[<span class=\"string\">\"none\"</span> | <span class=\"string\">\"splitActionBarWhenNarrow\"</span>]</span><br><span class=\"line\">          android:windowSoftInputMode=[<span class=\"string\">\"stateUnspecified\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"stateUnchanged\"</span>, <span class=\"string\">\"stateHidden\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"stateAlwaysHidden\"</span>, <span class=\"string\">\"stateVisible\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"stateAlwaysVisible\"</span>, <span class=\"string\">\"adjustUnspecified\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"adjustResize\"</span>, <span class=\"string\">\"adjustPan\"</span>] &gt;   </span><br><span class=\"line\">&lt;/activity&gt;</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>android:allowEmbedded=[“true” | “false”]**<br>这个标识一般为开发可穿戴设备时使用，表示该 Activity 可作为另一 Activity 的嵌入式子项启动。 它尤其适用于子项所在的容器（如 Display）为另一 Activity 所拥有的情况。 例如，用于 Wear 自定义通知的 Activity 必须声明此项，以便 Wear 在其上下文流中显示 Activity，后者位于另一进程中。该属性的默认值为 false。</p>\n<p><strong>android:allowTaskReparenting=[“true” | “false”]</strong><br>这个标示和 Application 的标识意义一样，所以如果同时声明该标识，这个标识会覆盖 Application 的标识</p>\n<p><strong>android:alwaysRetainTaskState</strong><br>这个标识用来指示系统是否始终保持 Activity 所在任务的状态 —“true”表示保持，“false”表示允许系统在特定情况下将任务重置到其初始状态。 默认值为“false”。该属性只对任务的根 Activity 有意义；对于所有其他 Activity，均忽略该属性。<br>正常情况下，当用户从主屏幕重新选择某个任务时，系统会在特定情况下清除该任务（从根 Activity 之上的堆栈中移除所有 Activity）。 系统通常会在用户一段时间（如 30 分钟）内未访问任务时执行此操作。<br>不过，如果该属性的值是“true”，则无论用户如何到达任务，将始终返回到最后状态的任务。 例如，在网络浏览器这类存在大量用户不愿失去的状态（如多个打开的标签）的应用中，该属性会很有用。</p>\n<p><strong>android:autoRemoveFromRecents=[“true” | “false”]</strong><br>这个标识为 API21 版本添加，由具有该属性的 Activity 启动的任务是否一直保留在概览屏幕中，直至任务中的最后一个 Activity 完成为止。 若为 true，则自动从概览屏幕中移除任务。 它会替换调用方使用的 FLAG_ACTIVITY_RETAIN_IN_RECENTS。 它必须是布尔值“true”或“false”。</p>\n<p>android:banner=”drawable resource”<br>这个和 application 里面的 banner 标识一样，也是用在 android TV 上的</p>\n<p><strong>android:clearTaskOnLaunch</strong><br>这个标识用来指明当应用从主屏幕重新启动时是否都从中移除除根 Activity 之外的所有 Activity，true 表示始终将任务清除到只剩其根 Activity，false 表示不清除，默认值为 false。需要注意的是该属性只对启动新任务的 Activity（根 Activity）有意义；对于任务中的所有其他 Activity，均忽略该属性。当值为“false”时，可在某些情况下清除任务中的 Activity（参考结合 alwaysRetainTaskState 属性），但并非一律可以。如果该属性和 allowTaskReparenting 的值均为“true”，则如上所述，任何可以更改父项的 Activity 都将转移到与其有亲和关系的任务；其余 Activity 随即被移除。<br>例如，假定有人从主屏幕启动了 Activity P，然后从那里转到 Activity Q。该用户接着按了主屏幕按钮，然后返回到 Activity P。正常情况下，用户将看到 Activity Q，因为那是其最后在 P 的任务中执行的 Activity。 不过，如果 P 将此标志设置为“true”，则当用户按下主屏幕将任务转入后台时，其上的所有 Activity（在本例中为 Q）都会被移除。 因此用户返回任务时只会看到 P。</p>\n<p><strong>android:configChanges</strong><br>列出 Activity 将自行处理的配置更改。在运行时发生配置更改时，默认情况下会关闭 Activity 然后将其重新启动，但使用该属性声明配置将阻止 Activity 重新启动。 Activity 反而会保持运行状态，并且系统会调用其 onConfigurationChanged() 方法。以下为该属性的值，多个值使用“|”分隔 — 例如，“locale|navigation|orientation”：<br>| <strong>Value</strong>            | <strong>Description</strong>                          |<br>| ——————– | —————————————- |<br>| “mcc”                | IMSI 移动国家/地区代码 (MCC) 发生了变化 - 检测到了 SIM 并更新了 MCC。 |<br>| “mnc”                | IMSI 移动网络代码 (MNC) 发生了变化 - 检测到了 SIM 并更新了 MNC。 |<br>| locale”              | 语言区域发生了变化 — 用户为文本选择了新的显示语言。              |<br>| “touchscreen”        | 触摸屏发生了变化。（这种情况通常永远不会发生。）                 |<br>| “keyboard”           | 键盘类型发生了变化 — 例如，用户插入了一个外置键盘。              |<br>| “keyboardHidden”     | 键盘无障碍功能发生了变化 — 例如，用户显示了硬件键盘。             |<br>| “navigation”         | 导航类型（轨迹球/方向键）发生了变化。（这种情况通常永远不会发生。）       |<br>| “screenLayout”       | 屏幕布局发生了变化 — 这可能是由激活了其他显示方式所致。            |<br>| “fontScale”          | 字体缩放系数发生了变化 — 用户选择了新的全局字号。               |<br>| “uiMode”             | 用户界面模式发生了变化 — 这可能是因用户将设备放入桌面/车载基座或夜间模式发生变化所致。 请参阅 <a href=\"https://developer.android.com/reference/android/app/UiModeManager.html\" target=\"_blank\" rel=\"noopener\">UiModeManager</a>。 此项为 API 级别 8 中新增配置。 |<br>| “orientation”        | 屏幕方向发生了变化 — 用户旋转了设备。 注：如果您的应用面向 API 级别 13 或更高级别（按照 minSdkVersion 和 targetSdkVersion 属性所声明的级别），则还应声明 “screenSize” 配置，因为当设备在横向与纵向之间切换时，该配置也会发生变化。 |<br>| “screenSize”         | 当前可用屏幕尺寸发生了变化。它表示当前可用尺寸相对于当前纵横比的变化，因此会在用户在横向与纵向之间切换时发生变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |<br>| “smallestScreenSize” | 物理屏幕尺寸发生了变化。它表示与方向无关的尺寸变化，因此只有在实际物理屏幕尺寸发生变化（如切换到外部显示器）时才会变化。对此配置的变更对应于smallestWidth 配置的变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |<br>| “layoutDirection”    | 布局方向发生了变化。例如，从从左至右 (LTR) 更改为从右至左 (RTL)。 此项为 API 级别 17 中新增配置。 |<br>所有这些配置变更都可能影响应用看到的资源值。 因此，调用 onConfigurationChanged() 时，通常有必要再次获取所有资源（包括视图布局、可绘制对象等），以正确处理变化。<br>　　我们平常接触到最多的就是屏幕的旋转，屏幕的旋转如果在没有特殊设置的情况下会销毁当前的 Activity 重新创建一个新的，为了避免创建新的，就可以在 AndroidMainfest.xml 中对指定 Activity 对应的 配置android:configChanges=”orientation”，这样，每次旋转方向时，只有 onConfigurationChanged 方法被调用，没有了销毁重建的过程。<br>　　<br><strong>android:documentLaunchMode=[“intoExisting” | “always” | “none” | “never”]</strong><br>指定每次启动任务时应如何向其中添加新的 Activity 实例。 该属性允许用户让多个来自同一应用的文档出现在概览屏幕（recent app）中。该属性有四个值，会在用户使用该应用打开文档时产生以下效果：</p>\n<table>\n<thead>\n<tr>\n<th><strong>Value</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>“intoExisting”</td>\n<td>Activity 会为文档重复使用现有任务。使用该值与不设置 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_MULTIPLE_TASK</a> 标志、但设置 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a> 标志所产生的效果相同，如使用 <a href=\"https://developer.android.com/guide/components/recents.html#flag-new-doc\" target=\"_blank\" rel=\"noopener\">Intent 标志添加任务中</a>所述。</td>\n</tr>\n<tr>\n<td>“always”</td>\n<td>Activity 为文档创建新任务，即便文档已打开也是如此。 这与同时设置 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a> 和 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_MULTIPLE_TASK</a> 标志的效果相同。</td>\n</tr>\n<tr>\n<td>“none”</td>\n<td>该 Activity 不会为 Activity 创建新任务。这是默认值，它只会在设置了 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_TASK</a> 时创建新任务。 概览屏幕将按其默认方式对待此 Activity：为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。</td>\n</tr>\n<tr>\n<td>“never”</td>\n<td>即使 Intent 包含 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a>，该 Activity 也不会启动到新文档之中。 设置此值会替代 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a> 和 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_MULTIPLE_TASK</a> 标志的行为（如果在 Activity 中设置了其中一个标志），并且概览屏幕将为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>注：对于除“none”和“never”以外的值，必须使用 launchMode=”standard” 定义 Activity。 如果未指定此属性，则使用 documentLaunchMode=”none”。</p>\n</blockquote>\n<p><strong>android:enabled=[“true” | “false”]</strong><br>该属性用来标示系统是否可将 Activity 实例化 — “true” 表示可以，“false”表示不可以。 默认值为“true”。<br>上面提到了 元素具有自己的 enabled 属性，该属性适用于所有应用组件，包括 Activity。 和 属性必须都是“true”（因为它们都默认使用该值），系统才能将 Activity 实例化。 如果任何一个属性是“false”，则无法进行实例化。</p>\n<p><strong>android:excludeFromRecents</strong><br>该标识用来标示是否应将该 Activity 启动的任务排除在最近使用的应用列表（即概览屏幕）之外。 也就是说，当该 Activity 是新任务的根 Activity 时，此属性确定任务是否应出现在最近使用的应用列表中。 如果应将任务排除在列表之外，请设置“true”；如果应将其包括在内，则设置“false”。 默认值为“false”。</p>\n<p><strong>android:exported=[“true” | “false”]</strong><br>该标识用来指明Activity 是否可由其他应用的组件启动 —“true”表示可以，“false”表示不可以。若为“false”，则 Activity 只能由同一应用的组件或使用同一用户 ID 的不同应用启动。<br>需要注意的是该默认值取决于 Activity 是否包含 Intent 过滤器。没有任何过滤器意味着 Activity 只能通过指定其确切的类名称进行调用。 这意味着 Activity 专供应用内部使用（因为其他应用不知晓其类名称）。 因此，在这种情况下，默认值为“false”。另一方面，至少存在一个过滤器意味着 Activity 专供外部使用，因此默认值为“true”。<br>该属性并非限制 Activity 对其他应用开放度的唯一手段。 您还可以利用权限来限制哪些外部实体可以调用 Activity。</p>\n<p><strong>android:finishOnTaskLaunch</strong><br>该标识用来标示每当用户再次启动其任务（在主屏幕上选择任务）时，是否应关闭（完成）现有 Activity 实例 —“true”表示应关闭，“false”表示不应关闭。 默认值为“false”。如果该属性和 allowTaskReparenting 均为“true”，则优先使用该属性。 Activity 的亲和关系会被忽略。 系统不是更改 Activity 的父项，而是将其销毁。</p>\n<p><strong>android:hardwareAccelerated=[“true” | “false”]</strong><br>该标识用来表明是否应为此 Activity 启用硬件加速渲染 —“true”表示应启用，“false”表示不应启用，默认值为“false”。和 application 的标识不一样的是，该标示只针对 Activity。<br>从 Android 3.0 开始，为应用提供了硬件加速 OpenGL 渲染器，以改善许多常见 2D 图形运算的性能。 启用硬件加速渲染器时，Canvas、Paint、Xfermode、ColorFilter、Shader 和 Camera 中的大多数运算都会得到加速。这可以提高动画、滚动的流畅度和总体响应速度，即便是并不明确使用框架 OpenGL 库的应用也会受益。 由于启用硬件加速会增加资源消耗，因此您的应用将占用更多内存。<br>需要注意的是，并非所有 OpenGL 2D 运算都会得到加速。如果您启用硬件加速渲染器，请对应用进行测试，以确保其在利用渲染器时不会出错。</p>\n<p><strong>android:icon</strong><br>一个表示 Activity 的图标。该图标会在需要在屏幕上表示 Activity 时显示给用户。 例如，代表启动任务的 Activity 的图标显示在启动器窗口中。该图标通常附带标签（请参阅 android:label 属性）。<br>必须将该属性设置为对包含图像定义的可绘制资源的引用。 如果未设置该属性，则改为使用为应用整体指定的图标（请参阅 元素的 icon 属性），activity 的该属性会覆盖 application 的该属性。这个 Activity 的图标 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认图标（请参阅 元素的 icon 属性）。</p>\n<p><strong>android:label=”string resource”</strong><br>一种可由用户读取的 Activity 标签。该标签会在必须将 Activity 呈现给用户时显示在屏幕上。 它通常与 Activity 图标一并显示。如果未设置该属性，则改为使用为应用整体设置的标签（请参阅 元素的 label 属性），activity 的该属性会覆盖 application 的该属性。<br>这个 Activity 的标签 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认标签（请参阅 元素的 label 属性）。应将该标签设置为对字符串资源的引用，以便可以像用户界面中的其他字符串那样进行本地化。不过，为便于开发应用，也可将其设置为原始字符串。</p>\n<p><strong>android:launchMode(Activity加载模式)</strong><br>在多Activity开发中，有可能是自己应用之间的Activity跳转，或者夹带其他应用的可复用Activity。可能会希望跳转到原来某个Activity实例，而不是产生大量重复的Activity。这需要为Activity配置特定的加载模式，而不是使用默认的加载模式</p>\n<p>Activity有四种加载模式：</p>\n<p><code>standard</code>、<code>singleTop</code>、<code>singleTask</code>、<code>singleInstance</code>(其中前两个是一组、后两个是一组)，默认为<code>standard</code></p>\n<p><code>standard</code>：就是intent将发送给新的实例，所以每次跳转都会生成新的activity。</p>\n<p><code>singleTop</code>：也是发送新的实例，但不同standard的一点是，在请求的Activity正好位于栈顶时(配置成singleTop的Activity)，不会构造新的实例</p>\n<p><code>singleTask</code>：和后面的singleInstance都只创建一个实例，当intent到来，需要创建设置为singleTask的Activity的时候，系统会检查栈里面是否已经有该Activity的实例。如果有直接将intent发送给它。</p>\n<p><code>singleInstance</code>：<br>首先说明一下task这个概念，Task可以认为是一个栈，可放入多个Activity。比如启动一个应用，那么Android就创建了一个Task，然后启动这个应用的入口Activity，那在它的界面上调用其他的Activity也只是在这个task里面。那如果在多个task中共享一个Activity的话怎么办呢。举个例来说，如果开启一个导游服务类的应用程序，里面有个Activity是开启GOOGLE地图的，当按下home键退回到主菜单又启动GOOGLE地图的应用时，显示的就是刚才的地图，实际上是同一个Activity，实际上这就引入了singleInstance。singleInstance模式就是将该Activity单独放入一个栈中，这样这个栈中只有这一个Activity，不同应用的intent都由这个Activity接收和展示，这样就做到了共享。当然前提是这些应用都没有被销毁，所以刚才是按下的HOME键，如果按下了返回键，则无效</p>\n<p><strong>android:maxRecents=”integer”</strong><br>该标识用来指明概览屏幕中位于此 Activity 根位置的任务数上限。 达到该条目数时，系统会从概览屏幕中移除最近最少使用的实例。 有效值为 1-50（低内存设备使用 25）；0 为无效值。 该值必须是整数，例如 50。默认值为 16。</p>\n<p><strong>android:multiprocess</strong><br>该标识用来指明是否可以将 Activity 实例启动到启动该实例的组件进程内 —“true”表示可以，“false”表示不可以。默认值为“false”。<br>正常情况下，新的 Activity 实例会启动到定义它的应用进程内，因此所有 Activity 实例都在同一进程内运行。 不过，如果该标志设置为“true”，Activity 实例便可在多个进程内运行，这样系统就能在任何使用实例的地方创建实例（前提是权限允许这样做），但是貌似使用的场景和案例不是很多。</p>\n<p><strong>android:name=”string”</strong><br>该标识应该不用介绍了，用来指定 Activity 的类的名称，是 Activity 的子类。 该属性值应为完全限定类名称（例如，“com.example.project.DemoActivity”）。不过，为了简便起见，如果名称的第一个字符是句点（例如，“.DemoActivity”），则名称将追加到 元素中指定的软件包 com.example.project 名称之后。还有一个需要注意的是，应用一旦发布，即不应更改该名称（除非您设置了 android:exported=”false”），也就是说如果您的 Activity 有让其他应用使用到，那么最好不要修改名字，因为有可能其他应用是通过显式的方式指定的 Activity 名字，修改名字可能会造成其他应用无法正常使用甚至崩溃。<br>该标识没有默认值。必须指定该名称。</p>\n<p><strong>android:noHistory</strong><br>当用户离开 Activity 并且其在屏幕上不再可见时，是否应从 Activity 堆栈中将其移除并完成（调用其 finish() 方法）—“true”表示应将其完成，“false”表示不应将其完成。 默认值为“false”。“true”一值表示 Activity 不会留下历史轨迹。 它不会留在任务的 Activity 堆栈内，因此用户将无法返回 Activity。 所以有一点需要特别注意的是，在此情况下，如果从这个定义了 noHistory 的 Activity 启动另一个 Activity 来获取它的结果，系统永远不会调用 onActivityResult()，因为此时这个 Activity 已经关闭了。</p>\n<p><strong>android:parentActivityName=”string”</strong><br>Activity 逻辑父项的类名称。此处的名称必须与为相应 元素的 android:name 属性指定的类名称一致。系统会读取该属性，以确定当用户按下操作栏中的“向上”按钮时应该启动哪一个 Activity。 系统还可以利用这些信息通过 TaskStackBuilder 合成 Activity 的返回栈<br>关于向上导航的详细信息，可以看看  <a href=\"https://developer.android.com/training/implementing-navigation/ancestral.html#NavigateUp\" target=\"_blank\" rel=\"noopener\">Providing Up Navigation</a></p>\n<p><strong>android:permission=”string”</strong><br>参见<a href=\"http://blog.csdn.net/self_study/article/details/50074781\" target=\"_blank\" rel=\"noopener\">android permission 1</a>  和 <a href=\"http://blog.csdn.net/self_study/article/details/50186435\" target=\"_blank\" rel=\"noopener\">android permission 2</a></p>\n<p><strong>android:process=”string”</strong><br>应在其中运行 Activity 的进程的名称。正常情况下，应用的所有组件都在为应用创建的默认进程名称内运行，您无需使用该属性。 但在必要时，您可以使用该属性替换默认进程名称，以便让应用组件散布到多个进程中。如果为该属性分配的名称以冒号（“:”）开头，则会在需要时创建应用专用的新进程，并且 Activity 会在该进程中运行。如果进程名称以小写字符开头，Activity 将在该名称的全局进程中运行，前提是它拥有相应的权限。这可以让不同应用中的组件共享一个进程，从而减少资源占用。<br>上面提到的 Application 元素的 process 属性可为所有组件设置一个不同的默认进程名称。</p>\n<p><strong>android:relinquishTaskIdentity</strong><br>Activity 是否将其任务标识符交给任务栈中在其之上的 Activity。 如果任务根 Activity 的该属性设置为“true”，则任务会用其内的下一个 Activity 的 Intent 替换基本 Intent。 如果下一个 Activity 的该属性也设置为“true”，则该 Activity 会将基本 Intent 给予其在同一任务中启动的任何 Activity。 系统继续为每个 Activity 执行此过程，直至遇到的某个 Activity 将该属性设置为“false”为止。 默认值为“false”。<br>还有一个很有意思的功能是，如果该属性设置为“true”，则 Activity 还可利用 ActivityManager.TaskDescription 来更改概览屏幕中的标签、颜色和图标。</p>\n<p><strong>android:resizeableActivity=[“true” | “false”]</strong><br>这个标识和 里面的作用一样，如果在 activity 里面定义的话则代表这个 activity 是否支持分屏模式。如果您将该属性设置为 true，则用户可以分屏和自由形状模式启动 Activity。 如果您将该属性设置为 false，Activity 将不支持多窗口模式。 如果该值为 false，且用户尝试在多窗口模式下启动 Activity，该 Activity 将全屏显示。<br>该属性是在 API 级别 24 添加的，如果您的应用面向 API 级别 24 或更高级别，但未对该属性指定值，则该属性的值默认设为 true。</p>\n<p><strong>android:screenOrientation</strong><br>Activity 在设备上的显示方向。如果 Activity 是在多窗口模式下运行，系统会忽略该属性。它的取值可以是如下：<br>| <strong>Value</strong>          | <strong>Description</strong>                          |<br>| —————— | —————————————- |<br>| “unspecified”      | 默认值。由系统选择方向。在不同设备上，系统使用的政策以及基于政策在特定上下文所做的选择可能有所差异。 |<br>| “behind”           | 与 Activity 栈中紧接着它的 Activity 的方向相同。       |<br>| “landscape”        | 横向方向（显示的宽度大于高度）。                         |<br>| “portrait”         | 纵向方向（显示的高度大于宽度）。                         |<br>| “reverseLandscape” | 与正常横向方向相反的横向方向。API 级别 9 中的新增配置。          |<br>| “reversePortrait”  | 与正常纵向方向相反的纵向方向。API 级别 9 中的新增配置。          |<br>| “sensorLandscape”  | 横向方向，但根据设备传感器，可以是正常或反向的横向方向。API 级别 9 中的新增配置。 |<br>| “sensorPortrait”   | 纵向方向，但根据设备传感器，可以是正常或反向的纵向方向。API 级别 9 中的新增配置。 |<br>| “userLandscape”    | 横向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的横向方向。 如果用户锁定了基于传感器的旋转，其行为与 landscape 相同，否则，其行为与 sensorLandscape 相同。API 级别 18 中的新增配置。 |<br>| “userPortrait”     | 纵向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的纵向方向。 如果用户锁定了基于传感器的旋转，其行为与 portrait 相同，否则，其行为与 sensorPortrait 相同。API 级别 18 中的新增配置。 |<br>| “sensor”           | 方向由设备方向传感器决定。显示方向取决于用户如何手持设备，它会在用户旋转设备时发生变化。 但一些设备默认情况下不会旋转到所有四种可能的方向。要允许全部四种方向，请使用 “fullSensor”。 |<br>| “fullSensor”       | 方向由 4 种方向中任一方向的设备方向传感器决定。这与 “sensor” 类似，不同的是它允许所有 4 种可能的屏幕方向，无论设备正常情况下采用什么方向（例如，一些设备正常情况下不使用反向纵向或反向横向，但它支持这些方向）。 API 级别 9 中的新增配置。 |<br>| “nosensor”         | 决定方向时不考虑物理方向传感器。传感器会被忽略，因此显示不会随用户对设备的移动而旋转。 除了这个区别，系统在选择方向时使用的政策与“unspecified”设置相同。 |<br>| “user”             | 用户当前的首选方向。                               |<br>| “fullUser”         | 如果用户锁定了基于传感器的旋转，其行为与 user 相同，否则，其行为与 fullSensor 相同，允许所有 4 种可能的屏幕方向。 API 级别 18 中的新增配置。 |<br>| “locked”           | 将方向锁定在其当前的任意旋转方向。API 级别 18 中的新增配置。       |</p>\n<blockquote>\n<p>注：如果您声明其中一个横向或纵向值，系统将其视为对 Activity 运行方向的硬性要求。 因此，您声明的值支持通过 Google Play 之类的服务进行过滤，这样就能将您的应用只提供给支持 Activity 所要求方向的设备。 例如，如果您声明了 “landscape”、”reverseLandscape” 或 “sensorLandscape”，则您的应用将只提供给支持横向方向的设备。 不过，您还应通过 元素明确声明，您的应用要求采用纵向或横向方向。 例如，。这纯粹是 Google Play（以及其他支持它的服务）提供的一种过滤行为，平台本身并不能控制当设备仅支持特定方向时您的应用能否安装</p>\n</blockquote>\n<p><strong>android:stateNotNeeded</strong><br>该标识用来指明能否在不保存 Activity 状态的情况下将其终止并成功重新启动 —“true”表示可在不考虑其之前状态的情况下重新启动，“false”表示需要之前状态，默认值为“false”。一般情况下，为保存资源而暂时关闭 Activity 前，系统会调用 onSaveInstanceState() 方法，该方法将 Activity 的当前状态存储在一个 Bundle 对象中，然后在 Activity 重新启动时将其传递给 onCreate() 。如果该属性设置为 true，系统可能不会调用 onSaveInstanceState()，并且会向 onCreate() 传递 null 而不是 Bundle，这样就与它在 Activity 首次启动时完全一样。<br>这个标识又一个特别有用的地方是，true 设置可确保 Activity 能够在未保留状态时重新启动。 例如，显示主屏幕的 Activity 可以使用该设置来确保其由于某种原因崩溃时不会被移除。</p>\n<p><strong>android:supportsPictureInPicture=[“true” | “false”]</strong><br>指定 Activity 是否支持画中画显示，设置该属性的同时，需要将 android:resizeableActivity 标识设置为 true，要不然系统会忽略该属性，可以看到设置完该属性之后，android TV 就可以实现手机端一个悬浮 activity 的效果，类似于 youtube 。<br>所以同样这个标识和 android:resizeableActivity 一样都是 API24 版本添加的。</p>\n<p><strong>android:taskAffinity=”string”</strong><br>这个标识用来指明一个 Activity 的亲和性，使用方案可以看看我的博客：android深入解析Activity的launchMode启动模式，Intent Flag，taskAffinity。从概念上讲，具有相同亲和关系的 Activity 归属同一任务（从用户的角度来看，则是归属同一“应用”）。 任务的亲和关系由其根 Activity 的亲和关系确定。亲和关系确定两件事 - Activity 更改到的父项任务（请参阅上面提到的 allowTaskReparenting 属性）和通过 FLAG_ACTIVITY_NEW_TASK 标志启动 Activity 时将用来容纳它的任务。默认情况下，应用中的所有 Activity 都具有相同的亲和关系。您可以设置该属性来以不同方式组合它们，甚至可以将在不同应用中定义的 Activity 置于同一任务内。 要指定 Activity 与任何任务均无亲和关系，请将其设置为空字符串。如果未设置该属性，则 Activity 继承为应用设置的亲和关系（可以参考 元素的 taskAffinity 属性），应用默认亲和关系的名称是 元素设置的 packageName。</p>\n<p><strong>android:theme=”resource or theme”</strong><br>这个标识用的应该很多了，用来定义一个 activity 的样式，为一个资源的引用，它会自动将 Activity 的上下文设置为使用该主题（请参阅 setTheme()），它还可以引发 Activity 启动前的“启动”动画（以更加符合 Activity 的实际外观）。如果未设置该属性，则 Activity 继承通过 application 元素的 theme 属性为应用整体设置的主题。 如果该属性也未设置，则使用默认系统主题。</p>\n<p><strong>android:uiOptions=[“none” | “splitActionBarWhenNarrow”]</strong><br>这个标识主要是用来针对 action bar 的，它有两个值：</p>\n<table>\n<thead>\n<tr>\n<th><strong>Value</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>“none”</td>\n<td>无附加 UI 选项。这是默认值。</td>\n</tr>\n<tr>\n<td>“splitActionBarWhenNarrow”</td>\n<td>当水平空间受限时（例如在手持设备上的纵向模式下时）在屏幕底部添加一个栏以显示应用栏（也称为操作栏）中的操作项）。 应用栏不是以少量操作项形式出现在屏幕顶部的应用栏中，而是分成了顶部导航区和底部操作项栏。 这可以确保操作项以及顶部的导航和标题元素都能获得合理的空间。 菜单项不会拆分到两个栏中，它们始终一起出现。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>android:windowSoftInputMode</strong><br>activity主窗口与软键盘的交互模式，可以用来避免输入法面板遮挡问题，Android1.5后的一个新特性。<br>这个属性能影响两件事情：</p>\n<ul>\n<li>当 Activity 成为用户注意的焦点时软键盘的状态 — 隐藏还是可见</li>\n<li>对 Activity 主窗口所做的调整 — 是否将其尺寸调小以为软键盘腾出空间，或者当窗口部分被软键盘遮挡时是否平移其内容以使当前焦点可见<br>各值的含义：</li>\n<li>stateUnspecified：软键盘的状态并没有指定，系统将选择一个合适的状态或依赖于主题的设置</li>\n<li>stateUnchanged：当这个activity出现时，软键盘将一直保持在上一个activity里的状态，无论是隐藏还是显示</li>\n<li>stateHidden：用户选择activity时，软键盘总是被隐藏</li>\n<li>stateAlwaysHidden：当用户选择 Activity 时 — 也就是说，当用户确实是向前导航到 Activity，而不是因离开另一 Activity 而返回时 — 隐藏软键盘。（当该Activity主窗口获取焦点时，软键盘也总是被隐藏的）</li>\n<li>stateVisible：软键盘通常是可见的</li>\n<li>stateAlwaysVisible：用户选择activity时，软键盘总是显示的状态</li>\n<li>adjustUnspecified：默认设置，通常由系统自行决定是隐藏还是显示</li>\n<li>adjustResize：该Activity总是调整屏幕的大小以便留出软键盘的空间</li>\n<li>adjustPan：当前窗口的内容将自动移动以便当前焦点从不被键盘覆盖和用户能总是看到输入内容的部分<blockquote>\n<p>adjustResize 和 adjustPan 的区别就在于前者是调整 Activity 的窗口尺寸来达到适配的目的，而 adjustPan 仅仅只是将窗口平移，界面的一部分就会被软键盘覆盖住，就不会被挤到软键盘之上了。</p>\n</blockquote>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"<h2 id=\"Activity\"><a href=\"#Activity\" class=\"headerlink\" title=\"Activity\"></a>Activity</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;activity android:allowEmbedded=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:allowTaskReparenting=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:alwaysRetainTaskState=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:alwaysRetainTaskState=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:autoRemoveFromRecents=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:banner=”drawable resource”</span><br><span class=\"line\">          android:clearTaskOnLaunch=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:configChanges=[<span class=\"string\">\"mcc\"</span>, <span class=\"string\">\"mnc\"</span>, <span class=\"string\">\"locale\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"touchscreen\"</span>, <span class=\"string\">\"keyboard\"</span>, <span class=\"string\">\"keyboardHidden\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"navigation\"</span>, <span class=\"string\">\"screenLayout\"</span>, <span class=\"string\">\"fontScale\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"uiMode\"</span>, <span class=\"string\">\"orientation\"</span>,<span class=\"string\">\"screenSize\"</span>,</span><br><span class=\"line\">                                 <span class=\"string\">\"smallestScreenSize\"</span>]</span><br><span class=\"line\">          android:documentLaunchMode=[<span class=\"string\">\"intoExisting\"</span> | <span class=\"string\">\"always\"</span> | </span><br><span class=\"line\">“none” | “never”]</span><br><span class=\"line\">          android:enabled=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:excludeFromRecents=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:exported=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:finishOnTaskLaunch=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:hardwareAccelerated=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:icon=<span class=\"string\">\"drawable resource\"</span></span><br><span class=\"line\">          android:label=<span class=\"string\">\"string resource\"</span></span><br><span class=\"line\">          android:launchMode=[<span class=\"string\">\"standard\"</span> | <span class=\"string\">\"singleTop\"</span> |</span><br><span class=\"line\">                              <span class=\"string\">\"singleTask\"</span> | <span class=\"string\">\"singleInstance\"</span>]</span><br><span class=\"line\">          android:maxRecents=<span class=\"string\">\"integer\"</span></span><br><span class=\"line\">          android:multiprocess=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:name=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:noHistory=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]  </span><br><span class=\"line\">          android:parentActivityName=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:permission=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:process=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:relinquishTaskIdentity=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:resizeableActivity=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:screenOrientation=[<span class=\"string\">\"unspecified\"</span> | <span class=\"string\">\"behind\"</span> | <span class=\"string\">\"landscape\"</span> |</span><br><span class=\"line\">                                     <span class=\"string\">\"portrait\"</span> | <span class=\"string\">\"reverseLandscape\"</span> | <span class=\"string\">\"sensorLandscape\"</span> |</span><br><span class=\"line\">                                     <span class=\"string\">\"sensorPortrait\"</span> | <span class=\"string\">\"userLandscape\"</span> | <span class=\"string\">\"userPortrait\"</span> |</span><br><span class=\"line\">                                     <span class=\"string\">\"sensor\"</span> | <span class=\"string\">\"fullSensor\"</span> | <span class=\"string\">\"nosensor\"</span>]</span><br><span class=\"line\">                                     <span class=\"string\">\"user\"</span> | <span class=\"string\">\"fullUser\"</span> | <span class=\"string\">\"locked\"</span></span><br><span class=\"line\">          android:stateNotNeeded=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:supportsPictureInPicture=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">          android:taskAffinity=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">          android:theme=<span class=\"string\">\"resource or theme\"</span></span><br><span class=\"line\">          android:uiOptions=[<span class=\"string\">\"none\"</span> | <span class=\"string\">\"splitActionBarWhenNarrow\"</span>]</span><br><span class=\"line\">          android:windowSoftInputMode=[<span class=\"string\">\"stateUnspecified\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"stateUnchanged\"</span>, <span class=\"string\">\"stateHidden\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"stateAlwaysHidden\"</span>, <span class=\"string\">\"stateVisible\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"stateAlwaysVisible\"</span>, <span class=\"string\">\"adjustUnspecified\"</span>,</span><br><span class=\"line\">                                       <span class=\"string\">\"adjustResize\"</span>, <span class=\"string\">\"adjustPan\"</span>] &gt;   </span><br><span class=\"line\">&lt;/activity&gt;</span><br></pre></td></tr></table></figure>","more":"<p>android:allowEmbedded=[“true” | “false”]**<br>这个标识一般为开发可穿戴设备时使用，表示该 Activity 可作为另一 Activity 的嵌入式子项启动。 它尤其适用于子项所在的容器（如 Display）为另一 Activity 所拥有的情况。 例如，用于 Wear 自定义通知的 Activity 必须声明此项，以便 Wear 在其上下文流中显示 Activity，后者位于另一进程中。该属性的默认值为 false。</p>\n<p><strong>android:allowTaskReparenting=[“true” | “false”]</strong><br>这个标示和 Application 的标识意义一样，所以如果同时声明该标识，这个标识会覆盖 Application 的标识</p>\n<p><strong>android:alwaysRetainTaskState</strong><br>这个标识用来指示系统是否始终保持 Activity 所在任务的状态 —“true”表示保持，“false”表示允许系统在特定情况下将任务重置到其初始状态。 默认值为“false”。该属性只对任务的根 Activity 有意义；对于所有其他 Activity，均忽略该属性。<br>正常情况下，当用户从主屏幕重新选择某个任务时，系统会在特定情况下清除该任务（从根 Activity 之上的堆栈中移除所有 Activity）。 系统通常会在用户一段时间（如 30 分钟）内未访问任务时执行此操作。<br>不过，如果该属性的值是“true”，则无论用户如何到达任务，将始终返回到最后状态的任务。 例如，在网络浏览器这类存在大量用户不愿失去的状态（如多个打开的标签）的应用中，该属性会很有用。</p>\n<p><strong>android:autoRemoveFromRecents=[“true” | “false”]</strong><br>这个标识为 API21 版本添加，由具有该属性的 Activity 启动的任务是否一直保留在概览屏幕中，直至任务中的最后一个 Activity 完成为止。 若为 true，则自动从概览屏幕中移除任务。 它会替换调用方使用的 FLAG_ACTIVITY_RETAIN_IN_RECENTS。 它必须是布尔值“true”或“false”。</p>\n<p>android:banner=”drawable resource”<br>这个和 application 里面的 banner 标识一样，也是用在 android TV 上的</p>\n<p><strong>android:clearTaskOnLaunch</strong><br>这个标识用来指明当应用从主屏幕重新启动时是否都从中移除除根 Activity 之外的所有 Activity，true 表示始终将任务清除到只剩其根 Activity，false 表示不清除，默认值为 false。需要注意的是该属性只对启动新任务的 Activity（根 Activity）有意义；对于任务中的所有其他 Activity，均忽略该属性。当值为“false”时，可在某些情况下清除任务中的 Activity（参考结合 alwaysRetainTaskState 属性），但并非一律可以。如果该属性和 allowTaskReparenting 的值均为“true”，则如上所述，任何可以更改父项的 Activity 都将转移到与其有亲和关系的任务；其余 Activity 随即被移除。<br>例如，假定有人从主屏幕启动了 Activity P，然后从那里转到 Activity Q。该用户接着按了主屏幕按钮，然后返回到 Activity P。正常情况下，用户将看到 Activity Q，因为那是其最后在 P 的任务中执行的 Activity。 不过，如果 P 将此标志设置为“true”，则当用户按下主屏幕将任务转入后台时，其上的所有 Activity（在本例中为 Q）都会被移除。 因此用户返回任务时只会看到 P。</p>\n<p><strong>android:configChanges</strong><br>列出 Activity 将自行处理的配置更改。在运行时发生配置更改时，默认情况下会关闭 Activity 然后将其重新启动，但使用该属性声明配置将阻止 Activity 重新启动。 Activity 反而会保持运行状态，并且系统会调用其 onConfigurationChanged() 方法。以下为该属性的值，多个值使用“|”分隔 — 例如，“locale|navigation|orientation”：<br>| <strong>Value</strong>            | <strong>Description</strong>                          |<br>| ——————– | —————————————- |<br>| “mcc”                | IMSI 移动国家/地区代码 (MCC) 发生了变化 - 检测到了 SIM 并更新了 MCC。 |<br>| “mnc”                | IMSI 移动网络代码 (MNC) 发生了变化 - 检测到了 SIM 并更新了 MNC。 |<br>| locale”              | 语言区域发生了变化 — 用户为文本选择了新的显示语言。              |<br>| “touchscreen”        | 触摸屏发生了变化。（这种情况通常永远不会发生。）                 |<br>| “keyboard”           | 键盘类型发生了变化 — 例如，用户插入了一个外置键盘。              |<br>| “keyboardHidden”     | 键盘无障碍功能发生了变化 — 例如，用户显示了硬件键盘。             |<br>| “navigation”         | 导航类型（轨迹球/方向键）发生了变化。（这种情况通常永远不会发生。）       |<br>| “screenLayout”       | 屏幕布局发生了变化 — 这可能是由激活了其他显示方式所致。            |<br>| “fontScale”          | 字体缩放系数发生了变化 — 用户选择了新的全局字号。               |<br>| “uiMode”             | 用户界面模式发生了变化 — 这可能是因用户将设备放入桌面/车载基座或夜间模式发生变化所致。 请参阅 <a href=\"https://developer.android.com/reference/android/app/UiModeManager.html\" target=\"_blank\" rel=\"noopener\">UiModeManager</a>。 此项为 API 级别 8 中新增配置。 |<br>| “orientation”        | 屏幕方向发生了变化 — 用户旋转了设备。 注：如果您的应用面向 API 级别 13 或更高级别（按照 minSdkVersion 和 targetSdkVersion 属性所声明的级别），则还应声明 “screenSize” 配置，因为当设备在横向与纵向之间切换时，该配置也会发生变化。 |<br>| “screenSize”         | 当前可用屏幕尺寸发生了变化。它表示当前可用尺寸相对于当前纵横比的变化，因此会在用户在横向与纵向之间切换时发生变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |<br>| “smallestScreenSize” | 物理屏幕尺寸发生了变化。它表示与方向无关的尺寸变化，因此只有在实际物理屏幕尺寸发生变化（如切换到外部显示器）时才会变化。对此配置的变更对应于smallestWidth 配置的变化。 不过，如果您的应用面向 API 级别 12 或更低级别，则 Activity 始终会自行处理此配置变更（即便是在 Android 3.2 或更高版本的设备上运行，此配置变更也不会重新启动 Activity）。此项为 API 级别 13 中新增配置。 |<br>| “layoutDirection”    | 布局方向发生了变化。例如，从从左至右 (LTR) 更改为从右至左 (RTL)。 此项为 API 级别 17 中新增配置。 |<br>所有这些配置变更都可能影响应用看到的资源值。 因此，调用 onConfigurationChanged() 时，通常有必要再次获取所有资源（包括视图布局、可绘制对象等），以正确处理变化。<br>　　我们平常接触到最多的就是屏幕的旋转，屏幕的旋转如果在没有特殊设置的情况下会销毁当前的 Activity 重新创建一个新的，为了避免创建新的，就可以在 AndroidMainfest.xml 中对指定 Activity 对应的 配置android:configChanges=”orientation”，这样，每次旋转方向时，只有 onConfigurationChanged 方法被调用，没有了销毁重建的过程。<br>　　<br><strong>android:documentLaunchMode=[“intoExisting” | “always” | “none” | “never”]</strong><br>指定每次启动任务时应如何向其中添加新的 Activity 实例。 该属性允许用户让多个来自同一应用的文档出现在概览屏幕（recent app）中。该属性有四个值，会在用户使用该应用打开文档时产生以下效果：</p>\n<table>\n<thead>\n<tr>\n<th><strong>Value</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>“intoExisting”</td>\n<td>Activity 会为文档重复使用现有任务。使用该值与不设置 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_MULTIPLE_TASK</a> 标志、但设置 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a> 标志所产生的效果相同，如使用 <a href=\"https://developer.android.com/guide/components/recents.html#flag-new-doc\" target=\"_blank\" rel=\"noopener\">Intent 标志添加任务中</a>所述。</td>\n</tr>\n<tr>\n<td>“always”</td>\n<td>Activity 为文档创建新任务，即便文档已打开也是如此。 这与同时设置 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a> 和 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_MULTIPLE_TASK</a> 标志的效果相同。</td>\n</tr>\n<tr>\n<td>“none”</td>\n<td>该 Activity 不会为 Activity 创建新任务。这是默认值，它只会在设置了 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_TASK</a> 时创建新任务。 概览屏幕将按其默认方式对待此 Activity：为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。</td>\n</tr>\n<tr>\n<td>“never”</td>\n<td>即使 Intent 包含 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a>，该 Activity 也不会启动到新文档之中。 设置此值会替代 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NEW_DOCUMENT\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_NEW_DOCUMENT</a> 和 <a href=\"https://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_MULTIPLE_TASK\" target=\"_blank\" rel=\"noopener\">FLAG_ACTIVITY_MULTIPLE_TASK</a> 标志的行为（如果在 Activity 中设置了其中一个标志），并且概览屏幕将为应用显示单个任务，该任务将从用户上次调用的任意 Activity 开始继续执行。</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>注：对于除“none”和“never”以外的值，必须使用 launchMode=”standard” 定义 Activity。 如果未指定此属性，则使用 documentLaunchMode=”none”。</p>\n</blockquote>\n<p><strong>android:enabled=[“true” | “false”]</strong><br>该属性用来标示系统是否可将 Activity 实例化 — “true” 表示可以，“false”表示不可以。 默认值为“true”。<br>上面提到了 元素具有自己的 enabled 属性，该属性适用于所有应用组件，包括 Activity。 和 属性必须都是“true”（因为它们都默认使用该值），系统才能将 Activity 实例化。 如果任何一个属性是“false”，则无法进行实例化。</p>\n<p><strong>android:excludeFromRecents</strong><br>该标识用来标示是否应将该 Activity 启动的任务排除在最近使用的应用列表（即概览屏幕）之外。 也就是说，当该 Activity 是新任务的根 Activity 时，此属性确定任务是否应出现在最近使用的应用列表中。 如果应将任务排除在列表之外，请设置“true”；如果应将其包括在内，则设置“false”。 默认值为“false”。</p>\n<p><strong>android:exported=[“true” | “false”]</strong><br>该标识用来指明Activity 是否可由其他应用的组件启动 —“true”表示可以，“false”表示不可以。若为“false”，则 Activity 只能由同一应用的组件或使用同一用户 ID 的不同应用启动。<br>需要注意的是该默认值取决于 Activity 是否包含 Intent 过滤器。没有任何过滤器意味着 Activity 只能通过指定其确切的类名称进行调用。 这意味着 Activity 专供应用内部使用（因为其他应用不知晓其类名称）。 因此，在这种情况下，默认值为“false”。另一方面，至少存在一个过滤器意味着 Activity 专供外部使用，因此默认值为“true”。<br>该属性并非限制 Activity 对其他应用开放度的唯一手段。 您还可以利用权限来限制哪些外部实体可以调用 Activity。</p>\n<p><strong>android:finishOnTaskLaunch</strong><br>该标识用来标示每当用户再次启动其任务（在主屏幕上选择任务）时，是否应关闭（完成）现有 Activity 实例 —“true”表示应关闭，“false”表示不应关闭。 默认值为“false”。如果该属性和 allowTaskReparenting 均为“true”，则优先使用该属性。 Activity 的亲和关系会被忽略。 系统不是更改 Activity 的父项，而是将其销毁。</p>\n<p><strong>android:hardwareAccelerated=[“true” | “false”]</strong><br>该标识用来表明是否应为此 Activity 启用硬件加速渲染 —“true”表示应启用，“false”表示不应启用，默认值为“false”。和 application 的标识不一样的是，该标示只针对 Activity。<br>从 Android 3.0 开始，为应用提供了硬件加速 OpenGL 渲染器，以改善许多常见 2D 图形运算的性能。 启用硬件加速渲染器时，Canvas、Paint、Xfermode、ColorFilter、Shader 和 Camera 中的大多数运算都会得到加速。这可以提高动画、滚动的流畅度和总体响应速度，即便是并不明确使用框架 OpenGL 库的应用也会受益。 由于启用硬件加速会增加资源消耗，因此您的应用将占用更多内存。<br>需要注意的是，并非所有 OpenGL 2D 运算都会得到加速。如果您启用硬件加速渲染器，请对应用进行测试，以确保其在利用渲染器时不会出错。</p>\n<p><strong>android:icon</strong><br>一个表示 Activity 的图标。该图标会在需要在屏幕上表示 Activity 时显示给用户。 例如，代表启动任务的 Activity 的图标显示在启动器窗口中。该图标通常附带标签（请参阅 android:label 属性）。<br>必须将该属性设置为对包含图像定义的可绘制资源的引用。 如果未设置该属性，则改为使用为应用整体指定的图标（请参阅 元素的 icon 属性），activity 的该属性会覆盖 application 的该属性。这个 Activity 的图标 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认图标（请参阅 元素的 icon 属性）。</p>\n<p><strong>android:label=”string resource”</strong><br>一种可由用户读取的 Activity 标签。该标签会在必须将 Activity 呈现给用户时显示在屏幕上。 它通常与 Activity 图标一并显示。如果未设置该属性，则改为使用为应用整体设置的标签（请参阅 元素的 label 属性），activity 的该属性会覆盖 application 的该属性。<br>这个 Activity 的标签 — 无论设置于此处还是由 元素设置 — 同时也是 Activity 所有 Intent 过滤器的默认标签（请参阅 元素的 label 属性）。应将该标签设置为对字符串资源的引用，以便可以像用户界面中的其他字符串那样进行本地化。不过，为便于开发应用，也可将其设置为原始字符串。</p>\n<p><strong>android:launchMode(Activity加载模式)</strong><br>在多Activity开发中，有可能是自己应用之间的Activity跳转，或者夹带其他应用的可复用Activity。可能会希望跳转到原来某个Activity实例，而不是产生大量重复的Activity。这需要为Activity配置特定的加载模式，而不是使用默认的加载模式</p>\n<p>Activity有四种加载模式：</p>\n<p><code>standard</code>、<code>singleTop</code>、<code>singleTask</code>、<code>singleInstance</code>(其中前两个是一组、后两个是一组)，默认为<code>standard</code></p>\n<p><code>standard</code>：就是intent将发送给新的实例，所以每次跳转都会生成新的activity。</p>\n<p><code>singleTop</code>：也是发送新的实例，但不同standard的一点是，在请求的Activity正好位于栈顶时(配置成singleTop的Activity)，不会构造新的实例</p>\n<p><code>singleTask</code>：和后面的singleInstance都只创建一个实例，当intent到来，需要创建设置为singleTask的Activity的时候，系统会检查栈里面是否已经有该Activity的实例。如果有直接将intent发送给它。</p>\n<p><code>singleInstance</code>：<br>首先说明一下task这个概念，Task可以认为是一个栈，可放入多个Activity。比如启动一个应用，那么Android就创建了一个Task，然后启动这个应用的入口Activity，那在它的界面上调用其他的Activity也只是在这个task里面。那如果在多个task中共享一个Activity的话怎么办呢。举个例来说，如果开启一个导游服务类的应用程序，里面有个Activity是开启GOOGLE地图的，当按下home键退回到主菜单又启动GOOGLE地图的应用时，显示的就是刚才的地图，实际上是同一个Activity，实际上这就引入了singleInstance。singleInstance模式就是将该Activity单独放入一个栈中，这样这个栈中只有这一个Activity，不同应用的intent都由这个Activity接收和展示，这样就做到了共享。当然前提是这些应用都没有被销毁，所以刚才是按下的HOME键，如果按下了返回键，则无效</p>\n<p><strong>android:maxRecents=”integer”</strong><br>该标识用来指明概览屏幕中位于此 Activity 根位置的任务数上限。 达到该条目数时，系统会从概览屏幕中移除最近最少使用的实例。 有效值为 1-50（低内存设备使用 25）；0 为无效值。 该值必须是整数，例如 50。默认值为 16。</p>\n<p><strong>android:multiprocess</strong><br>该标识用来指明是否可以将 Activity 实例启动到启动该实例的组件进程内 —“true”表示可以，“false”表示不可以。默认值为“false”。<br>正常情况下，新的 Activity 实例会启动到定义它的应用进程内，因此所有 Activity 实例都在同一进程内运行。 不过，如果该标志设置为“true”，Activity 实例便可在多个进程内运行，这样系统就能在任何使用实例的地方创建实例（前提是权限允许这样做），但是貌似使用的场景和案例不是很多。</p>\n<p><strong>android:name=”string”</strong><br>该标识应该不用介绍了，用来指定 Activity 的类的名称，是 Activity 的子类。 该属性值应为完全限定类名称（例如，“com.example.project.DemoActivity”）。不过，为了简便起见，如果名称的第一个字符是句点（例如，“.DemoActivity”），则名称将追加到 元素中指定的软件包 com.example.project 名称之后。还有一个需要注意的是，应用一旦发布，即不应更改该名称（除非您设置了 android:exported=”false”），也就是说如果您的 Activity 有让其他应用使用到，那么最好不要修改名字，因为有可能其他应用是通过显式的方式指定的 Activity 名字，修改名字可能会造成其他应用无法正常使用甚至崩溃。<br>该标识没有默认值。必须指定该名称。</p>\n<p><strong>android:noHistory</strong><br>当用户离开 Activity 并且其在屏幕上不再可见时，是否应从 Activity 堆栈中将其移除并完成（调用其 finish() 方法）—“true”表示应将其完成，“false”表示不应将其完成。 默认值为“false”。“true”一值表示 Activity 不会留下历史轨迹。 它不会留在任务的 Activity 堆栈内，因此用户将无法返回 Activity。 所以有一点需要特别注意的是，在此情况下，如果从这个定义了 noHistory 的 Activity 启动另一个 Activity 来获取它的结果，系统永远不会调用 onActivityResult()，因为此时这个 Activity 已经关闭了。</p>\n<p><strong>android:parentActivityName=”string”</strong><br>Activity 逻辑父项的类名称。此处的名称必须与为相应 元素的 android:name 属性指定的类名称一致。系统会读取该属性，以确定当用户按下操作栏中的“向上”按钮时应该启动哪一个 Activity。 系统还可以利用这些信息通过 TaskStackBuilder 合成 Activity 的返回栈<br>关于向上导航的详细信息，可以看看  <a href=\"https://developer.android.com/training/implementing-navigation/ancestral.html#NavigateUp\" target=\"_blank\" rel=\"noopener\">Providing Up Navigation</a></p>\n<p><strong>android:permission=”string”</strong><br>参见<a href=\"http://blog.csdn.net/self_study/article/details/50074781\" target=\"_blank\" rel=\"noopener\">android permission 1</a>  和 <a href=\"http://blog.csdn.net/self_study/article/details/50186435\" target=\"_blank\" rel=\"noopener\">android permission 2</a></p>\n<p><strong>android:process=”string”</strong><br>应在其中运行 Activity 的进程的名称。正常情况下，应用的所有组件都在为应用创建的默认进程名称内运行，您无需使用该属性。 但在必要时，您可以使用该属性替换默认进程名称，以便让应用组件散布到多个进程中。如果为该属性分配的名称以冒号（“:”）开头，则会在需要时创建应用专用的新进程，并且 Activity 会在该进程中运行。如果进程名称以小写字符开头，Activity 将在该名称的全局进程中运行，前提是它拥有相应的权限。这可以让不同应用中的组件共享一个进程，从而减少资源占用。<br>上面提到的 Application 元素的 process 属性可为所有组件设置一个不同的默认进程名称。</p>\n<p><strong>android:relinquishTaskIdentity</strong><br>Activity 是否将其任务标识符交给任务栈中在其之上的 Activity。 如果任务根 Activity 的该属性设置为“true”，则任务会用其内的下一个 Activity 的 Intent 替换基本 Intent。 如果下一个 Activity 的该属性也设置为“true”，则该 Activity 会将基本 Intent 给予其在同一任务中启动的任何 Activity。 系统继续为每个 Activity 执行此过程，直至遇到的某个 Activity 将该属性设置为“false”为止。 默认值为“false”。<br>还有一个很有意思的功能是，如果该属性设置为“true”，则 Activity 还可利用 ActivityManager.TaskDescription 来更改概览屏幕中的标签、颜色和图标。</p>\n<p><strong>android:resizeableActivity=[“true” | “false”]</strong><br>这个标识和 里面的作用一样，如果在 activity 里面定义的话则代表这个 activity 是否支持分屏模式。如果您将该属性设置为 true，则用户可以分屏和自由形状模式启动 Activity。 如果您将该属性设置为 false，Activity 将不支持多窗口模式。 如果该值为 false，且用户尝试在多窗口模式下启动 Activity，该 Activity 将全屏显示。<br>该属性是在 API 级别 24 添加的，如果您的应用面向 API 级别 24 或更高级别，但未对该属性指定值，则该属性的值默认设为 true。</p>\n<p><strong>android:screenOrientation</strong><br>Activity 在设备上的显示方向。如果 Activity 是在多窗口模式下运行，系统会忽略该属性。它的取值可以是如下：<br>| <strong>Value</strong>          | <strong>Description</strong>                          |<br>| —————— | —————————————- |<br>| “unspecified”      | 默认值。由系统选择方向。在不同设备上，系统使用的政策以及基于政策在特定上下文所做的选择可能有所差异。 |<br>| “behind”           | 与 Activity 栈中紧接着它的 Activity 的方向相同。       |<br>| “landscape”        | 横向方向（显示的宽度大于高度）。                         |<br>| “portrait”         | 纵向方向（显示的高度大于宽度）。                         |<br>| “reverseLandscape” | 与正常横向方向相反的横向方向。API 级别 9 中的新增配置。          |<br>| “reversePortrait”  | 与正常纵向方向相反的纵向方向。API 级别 9 中的新增配置。          |<br>| “sensorLandscape”  | 横向方向，但根据设备传感器，可以是正常或反向的横向方向。API 级别 9 中的新增配置。 |<br>| “sensorPortrait”   | 纵向方向，但根据设备传感器，可以是正常或反向的纵向方向。API 级别 9 中的新增配置。 |<br>| “userLandscape”    | 横向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的横向方向。 如果用户锁定了基于传感器的旋转，其行为与 landscape 相同，否则，其行为与 sensorLandscape 相同。API 级别 18 中的新增配置。 |<br>| “userPortrait”     | 纵向方向，但根据设备传感器和用户的传感器首选项，可以是正常或反向的纵向方向。 如果用户锁定了基于传感器的旋转，其行为与 portrait 相同，否则，其行为与 sensorPortrait 相同。API 级别 18 中的新增配置。 |<br>| “sensor”           | 方向由设备方向传感器决定。显示方向取决于用户如何手持设备，它会在用户旋转设备时发生变化。 但一些设备默认情况下不会旋转到所有四种可能的方向。要允许全部四种方向，请使用 “fullSensor”。 |<br>| “fullSensor”       | 方向由 4 种方向中任一方向的设备方向传感器决定。这与 “sensor” 类似，不同的是它允许所有 4 种可能的屏幕方向，无论设备正常情况下采用什么方向（例如，一些设备正常情况下不使用反向纵向或反向横向，但它支持这些方向）。 API 级别 9 中的新增配置。 |<br>| “nosensor”         | 决定方向时不考虑物理方向传感器。传感器会被忽略，因此显示不会随用户对设备的移动而旋转。 除了这个区别，系统在选择方向时使用的政策与“unspecified”设置相同。 |<br>| “user”             | 用户当前的首选方向。                               |<br>| “fullUser”         | 如果用户锁定了基于传感器的旋转，其行为与 user 相同，否则，其行为与 fullSensor 相同，允许所有 4 种可能的屏幕方向。 API 级别 18 中的新增配置。 |<br>| “locked”           | 将方向锁定在其当前的任意旋转方向。API 级别 18 中的新增配置。       |</p>\n<blockquote>\n<p>注：如果您声明其中一个横向或纵向值，系统将其视为对 Activity 运行方向的硬性要求。 因此，您声明的值支持通过 Google Play 之类的服务进行过滤，这样就能将您的应用只提供给支持 Activity 所要求方向的设备。 例如，如果您声明了 “landscape”、”reverseLandscape” 或 “sensorLandscape”，则您的应用将只提供给支持横向方向的设备。 不过，您还应通过 元素明确声明，您的应用要求采用纵向或横向方向。 例如，。这纯粹是 Google Play（以及其他支持它的服务）提供的一种过滤行为，平台本身并不能控制当设备仅支持特定方向时您的应用能否安装</p>\n</blockquote>\n<p><strong>android:stateNotNeeded</strong><br>该标识用来指明能否在不保存 Activity 状态的情况下将其终止并成功重新启动 —“true”表示可在不考虑其之前状态的情况下重新启动，“false”表示需要之前状态，默认值为“false”。一般情况下，为保存资源而暂时关闭 Activity 前，系统会调用 onSaveInstanceState() 方法，该方法将 Activity 的当前状态存储在一个 Bundle 对象中，然后在 Activity 重新启动时将其传递给 onCreate() 。如果该属性设置为 true，系统可能不会调用 onSaveInstanceState()，并且会向 onCreate() 传递 null 而不是 Bundle，这样就与它在 Activity 首次启动时完全一样。<br>这个标识又一个特别有用的地方是，true 设置可确保 Activity 能够在未保留状态时重新启动。 例如，显示主屏幕的 Activity 可以使用该设置来确保其由于某种原因崩溃时不会被移除。</p>\n<p><strong>android:supportsPictureInPicture=[“true” | “false”]</strong><br>指定 Activity 是否支持画中画显示，设置该属性的同时，需要将 android:resizeableActivity 标识设置为 true，要不然系统会忽略该属性，可以看到设置完该属性之后，android TV 就可以实现手机端一个悬浮 activity 的效果，类似于 youtube 。<br>所以同样这个标识和 android:resizeableActivity 一样都是 API24 版本添加的。</p>\n<p><strong>android:taskAffinity=”string”</strong><br>这个标识用来指明一个 Activity 的亲和性，使用方案可以看看我的博客：android深入解析Activity的launchMode启动模式，Intent Flag，taskAffinity。从概念上讲，具有相同亲和关系的 Activity 归属同一任务（从用户的角度来看，则是归属同一“应用”）。 任务的亲和关系由其根 Activity 的亲和关系确定。亲和关系确定两件事 - Activity 更改到的父项任务（请参阅上面提到的 allowTaskReparenting 属性）和通过 FLAG_ACTIVITY_NEW_TASK 标志启动 Activity 时将用来容纳它的任务。默认情况下，应用中的所有 Activity 都具有相同的亲和关系。您可以设置该属性来以不同方式组合它们，甚至可以将在不同应用中定义的 Activity 置于同一任务内。 要指定 Activity 与任何任务均无亲和关系，请将其设置为空字符串。如果未设置该属性，则 Activity 继承为应用设置的亲和关系（可以参考 元素的 taskAffinity 属性），应用默认亲和关系的名称是 元素设置的 packageName。</p>\n<p><strong>android:theme=”resource or theme”</strong><br>这个标识用的应该很多了，用来定义一个 activity 的样式，为一个资源的引用，它会自动将 Activity 的上下文设置为使用该主题（请参阅 setTheme()），它还可以引发 Activity 启动前的“启动”动画（以更加符合 Activity 的实际外观）。如果未设置该属性，则 Activity 继承通过 application 元素的 theme 属性为应用整体设置的主题。 如果该属性也未设置，则使用默认系统主题。</p>\n<p><strong>android:uiOptions=[“none” | “splitActionBarWhenNarrow”]</strong><br>这个标识主要是用来针对 action bar 的，它有两个值：</p>\n<table>\n<thead>\n<tr>\n<th><strong>Value</strong></th>\n<th><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>“none”</td>\n<td>无附加 UI 选项。这是默认值。</td>\n</tr>\n<tr>\n<td>“splitActionBarWhenNarrow”</td>\n<td>当水平空间受限时（例如在手持设备上的纵向模式下时）在屏幕底部添加一个栏以显示应用栏（也称为操作栏）中的操作项）。 应用栏不是以少量操作项形式出现在屏幕顶部的应用栏中，而是分成了顶部导航区和底部操作项栏。 这可以确保操作项以及顶部的导航和标题元素都能获得合理的空间。 菜单项不会拆分到两个栏中，它们始终一起出现。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>android:windowSoftInputMode</strong><br>activity主窗口与软键盘的交互模式，可以用来避免输入法面板遮挡问题，Android1.5后的一个新特性。<br>这个属性能影响两件事情：</p>\n<ul>\n<li>当 Activity 成为用户注意的焦点时软键盘的状态 — 隐藏还是可见</li>\n<li>对 Activity 主窗口所做的调整 — 是否将其尺寸调小以为软键盘腾出空间，或者当窗口部分被软键盘遮挡时是否平移其内容以使当前焦点可见<br>各值的含义：</li>\n<li>stateUnspecified：软键盘的状态并没有指定，系统将选择一个合适的状态或依赖于主题的设置</li>\n<li>stateUnchanged：当这个activity出现时，软键盘将一直保持在上一个activity里的状态，无论是隐藏还是显示</li>\n<li>stateHidden：用户选择activity时，软键盘总是被隐藏</li>\n<li>stateAlwaysHidden：当用户选择 Activity 时 — 也就是说，当用户确实是向前导航到 Activity，而不是因离开另一 Activity 而返回时 — 隐藏软键盘。（当该Activity主窗口获取焦点时，软键盘也总是被隐藏的）</li>\n<li>stateVisible：软键盘通常是可见的</li>\n<li>stateAlwaysVisible：用户选择activity时，软键盘总是显示的状态</li>\n<li>adjustUnspecified：默认设置，通常由系统自行决定是隐藏还是显示</li>\n<li>adjustResize：该Activity总是调整屏幕的大小以便留出软键盘的空间</li>\n<li>adjustPan：当前窗口的内容将自动移动以便当前焦点从不被键盘覆盖和用户能总是看到输入内容的部分<blockquote>\n<p>adjustResize 和 adjustPan 的区别就在于前者是调整 Activity 的窗口尺寸来达到适配的目的，而 adjustPan 仅仅只是将窗口平移，界面的一部分就会被软键盘覆盖住，就不会被挤到软键盘之上了。</p>\n</blockquote>\n</li>\n</ul>"},{"title":"Android配置文件详解-AndroidManifest","date":"2017-02-22T03:51:47.000Z","_content":"\n# AndroidManifest\n\n> 每个应用的根目录中都必须包含一个AndroidManifest.xml文件(且文件名精确无误)。AndroidManifest向Android系统提供应用的必要信息，系统必须具备有这些信息方可运行应用的任何代码。\n> 此外，AndroidManifest还可执行以下操作\n\n- 为应用的Java软件包命名。软件包名称充当应用的唯一标识符。\n- 描述应用的各个组件，包括构成应用的 Activity、服务、广播接收器和内容提供程序。它还为实现每个组件的类命名并发布其功能，例如它们可以处理的 [Intent](https://developer.android.com/reference/android/content/Intent.html) 消息。这些声明向 Android 系统告知有关组件以及可以启动这些组件的条件的信息。\n- 确定托管应用组件的进程。\n- 声明应用必须具备哪些权限才能访问 API 中受保护的部分并与其他应用交互。还声明其他应用与该应用组件交互所需具备的权限。\n- 列出 [Instrumentation](https://developer.android.com/reference/android/app/Instrumentation.html) 类，这些类可在应用运行时提供分析和其他信息。这些声明只会在应用处于开发阶段时出现在清单中，在应用发布之前将移除。\n- 声明应用所需的最低 Android API 级别\n- 列出应用必须链接到的库\n\n注：准备要在 Chromebook 上运行的 Android 应用时，要考虑一些重要的硬件和软件功能限制。如需了解详细信息，请参阅 [Chromebook 的应用清单兼容性](https://developer.android.com/topic/arc/manifest.html)文档。\n\n<!--more-->\n\n## AndroidManifest文件结构\n\n下面是AndroidManifest文件的示例：\n\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<manifest>\n\n    <uses-permission />\n    <permission />\n    <permission-tree />\n    <permission-group />\n    <instrumentation />\n    <uses-sdk />\n    <uses-configuration />  \n    <uses-feature />  \n    <supports-screens />  \n    <compatible-screens />  \n    <supports-gl-texture />  \n\n    <application>\n  \t\t<meta-data />\n        <activity>\n            <intent-filter>\n                <action />\n                <category />\n                <data />\n            </intent-filter>\n            <meta-data />\n        </activity>\n\n        <activity-alias>\n            <intent-filter> . . . </intent-filter>\n            <meta-data />\n        </activity-alias>\n\n        <service>\n            <intent-filter> . . . </intent-filter>\n            <meta-data/>\n        </service>\n\n        <receiver>\n            <intent-filter> . . . </intent-filter>\n            <meta-data />\n        </receiver>\n\n        <provider>\n            <grant-uri-permission />\n            <meta-data />\n            <path-permission />\n        </provider>\n\n        <uses-library />\n\n    </application>\n\n</manifest>\n```\n\n### AndroidManifest属性\n\n##### Application\n\n```java\n<application  \n  \tandroid:allowBackup=[\"true\" | \"false\"]\n\tandroid:allowClearUserData=[\"true\" | \"false\"]\n    android:allowTaskReparenting=[\"true\" | \"false\"]\n    android:backupAgent=\"string\"\n    android:backupInForeground=[\"true\" | \"false\"]\n    android:banner=\"drawable resource\" \n    android:debuggable=[\"true\" | \"false\"]\n    android:description=\"string resource\"\n    android:enabled=[\"true\" | \"false\"]\n    android:extractNativeLibs=[\"true\" | \"false\"]\n    android:fullBackupContent=\"string\"\n    android:fullBackupOnly=[\"true\" | \"false\"]\n    android:hasCode=[\"true\" | \"false\"]\n    android:hardwareAccelerated=[\"true\" | \"false\"]\n    android:isGame=[\"true\" | \"false\"]\n    android:icon=\"drawable resource\"\n    android:killAfterRestore=[\"true\" | \"false\"]\n    android:label=\"string resource\"\n    android:largeHeap=[\"true\" | \"false\"]\n    android:logo=\"drawable resource\"\n    android:manageSpaceActivity=\"string\"\n    android:name=\"string\"\n    android:permission=\"string\"\n    android:persistent=[\"true\" | \"false\"]\n    android:process=\"string\"\n    android:restoreAnyVersion=[\"true\" | \"false\"]\n    android:requiredAccountType=\"string\"\n    android:resizeableActivity=[\"true\" | \"false\"]\n    android:restrictedAccountType=\"string\"\n    android:supportsRtl=[\"true\" | \"false\"]\n    android:taskAffinity=\"string\"\n    android:testOnly=[\"true\" | \"false\"]\n    android:theme=\"resource or theme\" \n    android:uiOptions=[\"none\" | \"splitActionBarWhenNarrow\"]\n    android:usesCleartextTraffic=[\"true\" | \"false\"]\n    android:vmSafeMode=[\"true\" | \"false\"]>\n</application>\n```\n\n**android:allowBackup**\n开启或关闭应用程序数据的备份和恢复功能，注意该属性值默认为true，如果你不需要你的应用被恢复导致隐私数据暴露（如果值为true，甚至可以直接通过adb命令获取该应用中的数据），必须手动设置此属性\n```bash\n// 备份\nadb backup -nosystem -noshared -apk -f d:/com.test.bak.ab com.test.bak\n\n-nosystem: 不备份系统应用\n-noshared: 不备份应用存储在SD中的数据\n-apk: 备份应用APK安装包\n-f d:/com.test.bak.ab: 备份文件在PC上的路径\ncom.test.bak: 要备份的包名\n\n// 恢复\nadb restore d:/com.test.bak.ab\n```\n\n\n**android:allowClearUserData**\n默认为`true`。用户是否能选择自行清除数据，程序管理器包含一个选择允许用户清除数据。当为true时，用户可自己清理用户数据，反之亦然\n\n**android:allowTaskReparenting(‘true’ or ‘false’)**\n默认值为`false`。是否允许activity`更换从属的任务。当该`Task`下一次被带到前面时，应用程序定义的`Activity`是否可以从启动它们的`Task`移动到有相同`affinity`的Task，比如从短信息任务切换到浏览器任务。Activity可以设置自己的`allowTaskReparenting`属性来覆盖Application节点下的这个属性。\n\n**android:backupAgent**\n此属性没有默认值。实现应用backup代理的类名，它是BackupAgent的一个子类。这个属性值应该是一个完整的类名，如com.project.BackupAgent.。如果类名的第一个字母是\".\"，它会附加到`mainfest`元素指定的包名之后。\n\n**android:backupInForeground**\n默认为`false`。一个应用即使在前台状态下也可以执行自动备份。当应用正在自动备份时，系统可能会停止应用，因此要谨慎的使用该属性。该属性设置为true会影响到处于激活状态下的应用的行为。\n\n**android:banner**\n没有默认值。一个drawable资源，用来提供一个扩展的图形banner。使用`application`标签为应用所有的Activity提供一个默认的banner，或者使用`activity`标签为一个指定的Activity设置banner。在`Android TV`的home页，系统使用banner来表示一个应用。由于banner仅仅在home页显示，当一个应用中有处理`CATEGORY_LEANBACK_LAUNCHER`这个intent的Activity时，才能指定该属性。这个属性必须设置一个包含图片的drawable资源的引用(例如\"@drawable/banner\")。\n\n**android:debuggable**\n默认为`false`。这个从字面上就可以看出是什么作用的，当设置为true时，表明该APP在手机上可以被调试。在false的情况下调试该APP，就会报以下错误：\nDevice XXX requires that applications explicitely declare themselves as debuggable in their manifest.\nApplication XXX does not have the attribute ‘debuggable’ set to TRUE in its manifest and cannot be debugged.\n\n**android:description**\n关于应用的用户可读的文字，比label属性更长、更具描述性。这个属性必须设置为一个字符串资源的引用。不像label属性，它不能是一个raw字符串。没有默认值\n\n**android:enabled**\n默认为`true`。Android系统是否能够实例化该应用程序的组件-true表示可以，false表示不可以。如果为true，每个组件的enabled属性决定那个组件是否可以被 enabled。如果为false，它覆盖组件指定的值，即所有组件都是disabled。\n\n**android:extractNativeLibs**\n默认值为true。包安装器能否从apk中抽取本地库到文件系统。如果设置为false，你的本地库必须页对其并且在apk中以未压缩的方式存储。链接器在运行时从apk中直接加载库不会导致代码改动。\n\n**android:fullBackupContent**\n该属性指向一个xml文件，这个文件包含了自动备份时全部的备份规则。这些规则决定了哪些文件会被备份。该属性为可选的。如果没设置，默认情况下，自动备份会备份应用的大部分的文件。\n\n**android:fullBackupOnly=[\"true\" | \"false\"]**\n默认值是`false`。当设备可用时是否使用自动备份。如果设置为true，当应用安装到运行Android 6.0及其更高版本的的设备上时，会运行自动备份，在低版本的设备上，应用将忽略这个属性并执行key/value方式的备份。\n\n**android:hasCode(‘true’ or ‘false’)**\n默认为`true`。表示此APP是否包含任何的代码。若为false，则系统在运行组件时，不会去尝试加载任何的APP代码\n一个应用程序自身不会含有任何的代码，除非内置组件类，比如Activity类，此类使用了AliasActivity类，当然这是个罕见的现象\n(在Android2.3可以用标准C来开发应用程序，可在androidManifest.xml中将此属性设置为false,因为这个APP本身已经不含有任何的JAVA代码了)\n\n**android:hardwareAccelerated=[\"true\" | \"false\"]**\n如果你设置了minSdkVersion或targetSdkVersion 为14或更高，默认是启用；否则默认不启用。应用中所有的Activity和View是否启用硬件加速渲染-true表示启用，false表示不启用。\n从 Android 3.0 (API level 11)开始，应用可使用支持硬件加速的OpenGL 渲染，用来提升许多通用的2D图形操作性能。当硬件加速渲染打开时，Canvas, Paint, Xfermode, ColorFilter, Shader, 和 Camera中的大部分操作都会被加速。这会使得动画更流畅、滑动更流畅，提升整体的响应性，甚至应用不必显式的使用framework的 OpenGL库。\n需要注意的是，不是全部的OpenGL 2D操作都会被加速。如果你打开了硬件加速渲染，请测试你的应用以确保使用渲染的过程中不会出错。\n\n**android:icon**\n没有默认图标。一个作为整体应用的图标，就是声明整个APP的图标(在桌面的启动图标,图片一般都放在drawable文件夹下)，并且是应用的每个组件的默认图标。 < activity>, < activity-alias>, < service>, < receiver>和 < provider>都可以有各自的图标。这个属性必须被设置为一个包含图片的drawable资源文件的引用（比如\"@drawable/icon\"）。\n\n**android:isGame=[\"true\" | \"false\"]**\n应用是否为游戏。系统可能把应用根据游戏分组或把它们与其他的应用分开来显示。默认为false。\n\n**android:killAfterRestore**\n`默认值为true`。当应用在全系统层面的恢复操作时，应用的设置被恢复后，应用应当终止运行。单个包的恢复操作不会导致应用关闭。全系统的恢复操作一般来说只会发生一次，即在手机第一次启动时。第三方的应用一般没必要使用这个属性。意味着当应用在全系统的恢复操作中处理完自己的数据后，将会停止运行。\n\n**android:largeHeap=[\"true\" | \"false\"]**\n你的应用进程是否通过一个largeDalvik heap 被创建。这个属性适用于所有的为应用创建的进程。它仅适用于被加载到进程的第一个应用；如果你使用shared user id来允许多个应用在同一个进程中，它们都必需一致的使用这个选项，否则可能出现不可预知的结果。\n大部分app都不应使用这个属性，而应该把焦点放在如何减少整体的内存使用来提示性能。启用此功能也不能保证可用内存的固定增加，因为一些设备被全部可用内存限制了。\n可使用ActivityManager.getMemoryClass() or ActivityManager.getLargeMemoryClass()在运行时获取可用的内存大小。\n\n**android:label**\n应用的标签名(应用名称)。把应用作为整体的用户可读标签，也是应用中各个组件的默认标签。 < activity>, < activity-alias>, < service>, < receiver>, < provider> 都可以设置各自的标签。标签应设置为一个字符串资源的引用，以便可以像用户界面中的其他字符串一样进行本地化。为了方便，在开发应用时可以设置为原始字符串。\n\n**android:logo=\"drawable resource\"**\n应用作为一个整体的logo，也是所有Activity的默认logo。这个属性必须被设置为一个包含图片的drawable资源的引用（比如@drawable/logo）。没有默认logo。默认情况下，使用在ActionBar中使用icon，如果同时也设置了logo属性，ActionBar上将使用logo。logo应比icon远，但不应包括不必要的文本。 只有在以用户认可的传统格式表示您的品牌时才应使用logo。 logo代表预期的使用者品牌，而应用程序的的icon是符合启动器图示方形要求的修改版本。\n\n**android:manageSpaceActivity**\n一个Activity子类的全限定名，系统可以启动它来让用户管理设备上应用的内存使用情况。这个Activity也必须使用< activity> 元素来声明。\n\n**android:name**\n为应用程序所实现的Application子类的全名。当应用程序进程开始时，该类在所有应用程序组件之前被实例化。\n若该类(比方androidMain类)是在声明的package下，则可以直接声明android:name=”androidMain”,但此类是在package下面的子包的话，就必须声明为全路径或android:name=”package名称.子包名成.androidMain”\n\n**android:permission**\n为了跟应用交互，客户端必须拥有的权限。这个属性是适用于应用中所有组件设置权限的一个方便的方法。每个组件可设置各自的permission属性来覆盖application中的这个属性。\n\n**android:presistent**\n默认值是false。该应用程序是否应该在任何时候都保持运行状态,默认为false。因为应用程序通常不应该设置本标识，持续模式仅仅应该设置给某些系统应用程序才是有意义的。\n\n**android:process**\n应用程序运行的进程名，它的默认值为元素里设置的包名，当然每个组件都可以通过设置该属性来覆盖默认值。如果你想两个应用程序共用一个进程的话，你可以设置他们的android:process相同，但前提条件是他们共享一个用户ID及被赋予了相同证书的时候\n\n**android:restoreAnyVersion**\n此属性的默认值为`false`。用来表明应用是否准备尝试恢复所有的备份，即使该备份是由比当前在设备上安装的应用程序的更新版本存储的。 将此属性设置为true将允许备份管理器尝试恢复，即使版本不匹配表明数据不兼容。 使用时要小心！。\n\n**android:requiredAccountType=\"string\"**\n指定应用程序为了运行所需的帐户类型。 如果您的应用需要帐户，则此属性的值必须与您的应用使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。\n由于受限个人资料目前无法添加帐户，因此指定此属性会使您的应用无法从受限个人资料中获取，除非您也声明了android：restrictedAccountType具有相同的值。\n警告：如果帐户数据可能显示个人身份信息，请务必声明此属性并将android：restrictedAccountType设置为null，以便受限配置文件无法使用您的应用访问属于所有者用户的个人信息。\n此属性在API级别18中添加。\n\n**android:resizeableActivity=[\"true\" | \"false\"]**\n指定应用是否支持多窗口显示。你可以在 < activity> 或 < application>元素中设置该属性。\n如果设置为true，用户可在分屏和freeform 模式下启动Activity。如果设置为false，Activity将不支持多窗口模式。如果这个值为false，并且用户尝试在多窗口模式下启动Activity，Activity将会全屏显示。\n如果你的应用的 targets API 是24或者更高，如果你不指定这个属性，默认值是true。这个属性是在 API level 24新增的。\n\n**android:restrictedAccountType=\"string\"**\n指定此应用程序所需的帐户类型，并指示允许受限制的配置文件访问属于所有者用户的此类帐户。 如果您的应用需要帐户，且受限个人资料可以访问主要用户的帐户，则此属性的值必须与您的应用所使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。\n警告：指定此属性允许受限配置文件使用属于所有者用户的帐户使用您的应用程序，这可能会泄露个人身份信息。 如果帐户可能显示个人详细信息，您不应使用此属性，而应声明android：requiredAccountType属性，使您的应用程序不能使用限制的配置文件。\n此属性在API级别18中添加。\n\n**android:supportsRtl=[\"true\" | \"false\"]**\n默认值是`false`。声明你的应用是否支持从右向左布局。\n如果设置为true并且targetSdkVersion 大于等于17，多个RTL相关的API将被激活，被系统使用，从而使得你的app能够显示从右向左的布局。\n如果设置为false或targetSdkVersion小于17，RTL相关的API将无效或者被忽略，你的app将无视布局方向，始终是从左向右的方向。\n在API level 17中引入的这个属性。\n\n**android:taskAffinity**\n拥有相同的affinity的Activity理论上属于相同的Task，应用程序默认的affinity的名字是元素中设定的package名（manifest中通过 < manifest>元素设置的包名）。除了那些设置了不同affinity属性的Activity\n\n**android:testOnly=[\"true\" | \"false\"]**\n表示一个应用是否仅仅用于测试。例如，它可能暴露它自己的功能或外部数据，这些可能导致一个安全漏洞，但对调试来说有用。这类应用仅仅可以通过adb命令安装。\n\n**android:theme**\n是一个资源的风格，它定义了一个默认的主题风格给所有的activity，可以后续在activity标签层单独覆盖此Theme。\n\n**android:uiOptions=[\"none\" | \"splitActionBarWhenNarrow\"]**\nActivity UI的额外选项，必须是下列值中的一个。\n* \"none\"： 没有额外的UI选项，这是默认值。\n* \"splitActionBarWhenNarrow\"：在屏幕底部添加一个条形，以在水平空间受限时（例如在手机上的纵向模式下）在应用栏（也称为操作栏）中显示操作项目。 而不是显示在屏幕顶部的应用栏中的少量操作项，应用栏分割为顶部导航部分和操作项的底部栏。 这确保了不仅为操作项目而且在顶部的导航和标题元素提供合理的空间量。 菜单项不分割在两个条上; 他们总是出现在一起。\n  该属性是在 API level 14中新增的。\n\n**android:usesCleartextTraffic=[\"true\" | \"false\"]**\n默认值为`true`。指示应用程序是否要使用明文网络流量，例如明文HTTP。当属性设置为“false”时，平台组件（例如，HTTP和FTP堆栈，DownloadManager，MediaPlayer）将拒绝应用程序使用明文流量的请求。强烈鼓励第三方图书馆也遵守此设置。避免明文流量的关键原因是缺乏保密性，真实性和防止篡改的保护：网络攻击者可以窃听传输的数据，并且还可以在不检测的情况下对其进行修改。\n这个标志是最好的努力的基础上，因为它是不可能防止来自Android应用程序的所有明文流量给定的访问级别提供给他们。例如，没有期望Socket API将尊重此标志，因为它不能确定其流量是否为明文。然而，来自应用程序的大多数网络流量由更高级网络堆栈/组件处理，可以通过从ApplicationInfo.flags或NetworkSecurityPolicy.isCleartextTrafficPermitted（）读取该标志来处理该标志。\n注意：WebView不遵守此标志。\n在应用程序开发期间，StrictMode可用于标识来自应用程序的任何明文流量：请参阅StrictMode.VmPolicy.Builder.detectCleartextNetwork（）。\n此属性是在API级别23中添加的。\n如果存在Android网络安全配置，此标记在Android 7.0（API级别24）及以上版本中将被忽略。\n\n**android:vmSafeMode=[\"true\" | \"false\"]**\n表示应用让虚拟机运行在安全模式。默认值为false。这个属性在 API level 8 中引入，true表示禁用DalvikJIT编译器。在API level 22 中有改动，true表示禁用ART AOT编译器\n","source":"_posts/android/android-config-am.md","raw":"---\ntitle: Android配置文件详解-AndroidManifest\ndate: 2017-02-22 11:51:47\ntags: android\n---\n\n# AndroidManifest\n\n> 每个应用的根目录中都必须包含一个AndroidManifest.xml文件(且文件名精确无误)。AndroidManifest向Android系统提供应用的必要信息，系统必须具备有这些信息方可运行应用的任何代码。\n> 此外，AndroidManifest还可执行以下操作\n\n- 为应用的Java软件包命名。软件包名称充当应用的唯一标识符。\n- 描述应用的各个组件，包括构成应用的 Activity、服务、广播接收器和内容提供程序。它还为实现每个组件的类命名并发布其功能，例如它们可以处理的 [Intent](https://developer.android.com/reference/android/content/Intent.html) 消息。这些声明向 Android 系统告知有关组件以及可以启动这些组件的条件的信息。\n- 确定托管应用组件的进程。\n- 声明应用必须具备哪些权限才能访问 API 中受保护的部分并与其他应用交互。还声明其他应用与该应用组件交互所需具备的权限。\n- 列出 [Instrumentation](https://developer.android.com/reference/android/app/Instrumentation.html) 类，这些类可在应用运行时提供分析和其他信息。这些声明只会在应用处于开发阶段时出现在清单中，在应用发布之前将移除。\n- 声明应用所需的最低 Android API 级别\n- 列出应用必须链接到的库\n\n注：准备要在 Chromebook 上运行的 Android 应用时，要考虑一些重要的硬件和软件功能限制。如需了解详细信息，请参阅 [Chromebook 的应用清单兼容性](https://developer.android.com/topic/arc/manifest.html)文档。\n\n<!--more-->\n\n## AndroidManifest文件结构\n\n下面是AndroidManifest文件的示例：\n\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n<manifest>\n\n    <uses-permission />\n    <permission />\n    <permission-tree />\n    <permission-group />\n    <instrumentation />\n    <uses-sdk />\n    <uses-configuration />  \n    <uses-feature />  \n    <supports-screens />  \n    <compatible-screens />  \n    <supports-gl-texture />  \n\n    <application>\n  \t\t<meta-data />\n        <activity>\n            <intent-filter>\n                <action />\n                <category />\n                <data />\n            </intent-filter>\n            <meta-data />\n        </activity>\n\n        <activity-alias>\n            <intent-filter> . . . </intent-filter>\n            <meta-data />\n        </activity-alias>\n\n        <service>\n            <intent-filter> . . . </intent-filter>\n            <meta-data/>\n        </service>\n\n        <receiver>\n            <intent-filter> . . . </intent-filter>\n            <meta-data />\n        </receiver>\n\n        <provider>\n            <grant-uri-permission />\n            <meta-data />\n            <path-permission />\n        </provider>\n\n        <uses-library />\n\n    </application>\n\n</manifest>\n```\n\n### AndroidManifest属性\n\n##### Application\n\n```java\n<application  \n  \tandroid:allowBackup=[\"true\" | \"false\"]\n\tandroid:allowClearUserData=[\"true\" | \"false\"]\n    android:allowTaskReparenting=[\"true\" | \"false\"]\n    android:backupAgent=\"string\"\n    android:backupInForeground=[\"true\" | \"false\"]\n    android:banner=\"drawable resource\" \n    android:debuggable=[\"true\" | \"false\"]\n    android:description=\"string resource\"\n    android:enabled=[\"true\" | \"false\"]\n    android:extractNativeLibs=[\"true\" | \"false\"]\n    android:fullBackupContent=\"string\"\n    android:fullBackupOnly=[\"true\" | \"false\"]\n    android:hasCode=[\"true\" | \"false\"]\n    android:hardwareAccelerated=[\"true\" | \"false\"]\n    android:isGame=[\"true\" | \"false\"]\n    android:icon=\"drawable resource\"\n    android:killAfterRestore=[\"true\" | \"false\"]\n    android:label=\"string resource\"\n    android:largeHeap=[\"true\" | \"false\"]\n    android:logo=\"drawable resource\"\n    android:manageSpaceActivity=\"string\"\n    android:name=\"string\"\n    android:permission=\"string\"\n    android:persistent=[\"true\" | \"false\"]\n    android:process=\"string\"\n    android:restoreAnyVersion=[\"true\" | \"false\"]\n    android:requiredAccountType=\"string\"\n    android:resizeableActivity=[\"true\" | \"false\"]\n    android:restrictedAccountType=\"string\"\n    android:supportsRtl=[\"true\" | \"false\"]\n    android:taskAffinity=\"string\"\n    android:testOnly=[\"true\" | \"false\"]\n    android:theme=\"resource or theme\" \n    android:uiOptions=[\"none\" | \"splitActionBarWhenNarrow\"]\n    android:usesCleartextTraffic=[\"true\" | \"false\"]\n    android:vmSafeMode=[\"true\" | \"false\"]>\n</application>\n```\n\n**android:allowBackup**\n开启或关闭应用程序数据的备份和恢复功能，注意该属性值默认为true，如果你不需要你的应用被恢复导致隐私数据暴露（如果值为true，甚至可以直接通过adb命令获取该应用中的数据），必须手动设置此属性\n```bash\n// 备份\nadb backup -nosystem -noshared -apk -f d:/com.test.bak.ab com.test.bak\n\n-nosystem: 不备份系统应用\n-noshared: 不备份应用存储在SD中的数据\n-apk: 备份应用APK安装包\n-f d:/com.test.bak.ab: 备份文件在PC上的路径\ncom.test.bak: 要备份的包名\n\n// 恢复\nadb restore d:/com.test.bak.ab\n```\n\n\n**android:allowClearUserData**\n默认为`true`。用户是否能选择自行清除数据，程序管理器包含一个选择允许用户清除数据。当为true时，用户可自己清理用户数据，反之亦然\n\n**android:allowTaskReparenting(‘true’ or ‘false’)**\n默认值为`false`。是否允许activity`更换从属的任务。当该`Task`下一次被带到前面时，应用程序定义的`Activity`是否可以从启动它们的`Task`移动到有相同`affinity`的Task，比如从短信息任务切换到浏览器任务。Activity可以设置自己的`allowTaskReparenting`属性来覆盖Application节点下的这个属性。\n\n**android:backupAgent**\n此属性没有默认值。实现应用backup代理的类名，它是BackupAgent的一个子类。这个属性值应该是一个完整的类名，如com.project.BackupAgent.。如果类名的第一个字母是\".\"，它会附加到`mainfest`元素指定的包名之后。\n\n**android:backupInForeground**\n默认为`false`。一个应用即使在前台状态下也可以执行自动备份。当应用正在自动备份时，系统可能会停止应用，因此要谨慎的使用该属性。该属性设置为true会影响到处于激活状态下的应用的行为。\n\n**android:banner**\n没有默认值。一个drawable资源，用来提供一个扩展的图形banner。使用`application`标签为应用所有的Activity提供一个默认的banner，或者使用`activity`标签为一个指定的Activity设置banner。在`Android TV`的home页，系统使用banner来表示一个应用。由于banner仅仅在home页显示，当一个应用中有处理`CATEGORY_LEANBACK_LAUNCHER`这个intent的Activity时，才能指定该属性。这个属性必须设置一个包含图片的drawable资源的引用(例如\"@drawable/banner\")。\n\n**android:debuggable**\n默认为`false`。这个从字面上就可以看出是什么作用的，当设置为true时，表明该APP在手机上可以被调试。在false的情况下调试该APP，就会报以下错误：\nDevice XXX requires that applications explicitely declare themselves as debuggable in their manifest.\nApplication XXX does not have the attribute ‘debuggable’ set to TRUE in its manifest and cannot be debugged.\n\n**android:description**\n关于应用的用户可读的文字，比label属性更长、更具描述性。这个属性必须设置为一个字符串资源的引用。不像label属性，它不能是一个raw字符串。没有默认值\n\n**android:enabled**\n默认为`true`。Android系统是否能够实例化该应用程序的组件-true表示可以，false表示不可以。如果为true，每个组件的enabled属性决定那个组件是否可以被 enabled。如果为false，它覆盖组件指定的值，即所有组件都是disabled。\n\n**android:extractNativeLibs**\n默认值为true。包安装器能否从apk中抽取本地库到文件系统。如果设置为false，你的本地库必须页对其并且在apk中以未压缩的方式存储。链接器在运行时从apk中直接加载库不会导致代码改动。\n\n**android:fullBackupContent**\n该属性指向一个xml文件，这个文件包含了自动备份时全部的备份规则。这些规则决定了哪些文件会被备份。该属性为可选的。如果没设置，默认情况下，自动备份会备份应用的大部分的文件。\n\n**android:fullBackupOnly=[\"true\" | \"false\"]**\n默认值是`false`。当设备可用时是否使用自动备份。如果设置为true，当应用安装到运行Android 6.0及其更高版本的的设备上时，会运行自动备份，在低版本的设备上，应用将忽略这个属性并执行key/value方式的备份。\n\n**android:hasCode(‘true’ or ‘false’)**\n默认为`true`。表示此APP是否包含任何的代码。若为false，则系统在运行组件时，不会去尝试加载任何的APP代码\n一个应用程序自身不会含有任何的代码，除非内置组件类，比如Activity类，此类使用了AliasActivity类，当然这是个罕见的现象\n(在Android2.3可以用标准C来开发应用程序，可在androidManifest.xml中将此属性设置为false,因为这个APP本身已经不含有任何的JAVA代码了)\n\n**android:hardwareAccelerated=[\"true\" | \"false\"]**\n如果你设置了minSdkVersion或targetSdkVersion 为14或更高，默认是启用；否则默认不启用。应用中所有的Activity和View是否启用硬件加速渲染-true表示启用，false表示不启用。\n从 Android 3.0 (API level 11)开始，应用可使用支持硬件加速的OpenGL 渲染，用来提升许多通用的2D图形操作性能。当硬件加速渲染打开时，Canvas, Paint, Xfermode, ColorFilter, Shader, 和 Camera中的大部分操作都会被加速。这会使得动画更流畅、滑动更流畅，提升整体的响应性，甚至应用不必显式的使用framework的 OpenGL库。\n需要注意的是，不是全部的OpenGL 2D操作都会被加速。如果你打开了硬件加速渲染，请测试你的应用以确保使用渲染的过程中不会出错。\n\n**android:icon**\n没有默认图标。一个作为整体应用的图标，就是声明整个APP的图标(在桌面的启动图标,图片一般都放在drawable文件夹下)，并且是应用的每个组件的默认图标。 < activity>, < activity-alias>, < service>, < receiver>和 < provider>都可以有各自的图标。这个属性必须被设置为一个包含图片的drawable资源文件的引用（比如\"@drawable/icon\"）。\n\n**android:isGame=[\"true\" | \"false\"]**\n应用是否为游戏。系统可能把应用根据游戏分组或把它们与其他的应用分开来显示。默认为false。\n\n**android:killAfterRestore**\n`默认值为true`。当应用在全系统层面的恢复操作时，应用的设置被恢复后，应用应当终止运行。单个包的恢复操作不会导致应用关闭。全系统的恢复操作一般来说只会发生一次，即在手机第一次启动时。第三方的应用一般没必要使用这个属性。意味着当应用在全系统的恢复操作中处理完自己的数据后，将会停止运行。\n\n**android:largeHeap=[\"true\" | \"false\"]**\n你的应用进程是否通过一个largeDalvik heap 被创建。这个属性适用于所有的为应用创建的进程。它仅适用于被加载到进程的第一个应用；如果你使用shared user id来允许多个应用在同一个进程中，它们都必需一致的使用这个选项，否则可能出现不可预知的结果。\n大部分app都不应使用这个属性，而应该把焦点放在如何减少整体的内存使用来提示性能。启用此功能也不能保证可用内存的固定增加，因为一些设备被全部可用内存限制了。\n可使用ActivityManager.getMemoryClass() or ActivityManager.getLargeMemoryClass()在运行时获取可用的内存大小。\n\n**android:label**\n应用的标签名(应用名称)。把应用作为整体的用户可读标签，也是应用中各个组件的默认标签。 < activity>, < activity-alias>, < service>, < receiver>, < provider> 都可以设置各自的标签。标签应设置为一个字符串资源的引用，以便可以像用户界面中的其他字符串一样进行本地化。为了方便，在开发应用时可以设置为原始字符串。\n\n**android:logo=\"drawable resource\"**\n应用作为一个整体的logo，也是所有Activity的默认logo。这个属性必须被设置为一个包含图片的drawable资源的引用（比如@drawable/logo）。没有默认logo。默认情况下，使用在ActionBar中使用icon，如果同时也设置了logo属性，ActionBar上将使用logo。logo应比icon远，但不应包括不必要的文本。 只有在以用户认可的传统格式表示您的品牌时才应使用logo。 logo代表预期的使用者品牌，而应用程序的的icon是符合启动器图示方形要求的修改版本。\n\n**android:manageSpaceActivity**\n一个Activity子类的全限定名，系统可以启动它来让用户管理设备上应用的内存使用情况。这个Activity也必须使用< activity> 元素来声明。\n\n**android:name**\n为应用程序所实现的Application子类的全名。当应用程序进程开始时，该类在所有应用程序组件之前被实例化。\n若该类(比方androidMain类)是在声明的package下，则可以直接声明android:name=”androidMain”,但此类是在package下面的子包的话，就必须声明为全路径或android:name=”package名称.子包名成.androidMain”\n\n**android:permission**\n为了跟应用交互，客户端必须拥有的权限。这个属性是适用于应用中所有组件设置权限的一个方便的方法。每个组件可设置各自的permission属性来覆盖application中的这个属性。\n\n**android:presistent**\n默认值是false。该应用程序是否应该在任何时候都保持运行状态,默认为false。因为应用程序通常不应该设置本标识，持续模式仅仅应该设置给某些系统应用程序才是有意义的。\n\n**android:process**\n应用程序运行的进程名，它的默认值为元素里设置的包名，当然每个组件都可以通过设置该属性来覆盖默认值。如果你想两个应用程序共用一个进程的话，你可以设置他们的android:process相同，但前提条件是他们共享一个用户ID及被赋予了相同证书的时候\n\n**android:restoreAnyVersion**\n此属性的默认值为`false`。用来表明应用是否准备尝试恢复所有的备份，即使该备份是由比当前在设备上安装的应用程序的更新版本存储的。 将此属性设置为true将允许备份管理器尝试恢复，即使版本不匹配表明数据不兼容。 使用时要小心！。\n\n**android:requiredAccountType=\"string\"**\n指定应用程序为了运行所需的帐户类型。 如果您的应用需要帐户，则此属性的值必须与您的应用使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。\n由于受限个人资料目前无法添加帐户，因此指定此属性会使您的应用无法从受限个人资料中获取，除非您也声明了android：restrictedAccountType具有相同的值。\n警告：如果帐户数据可能显示个人身份信息，请务必声明此属性并将android：restrictedAccountType设置为null，以便受限配置文件无法使用您的应用访问属于所有者用户的个人信息。\n此属性在API级别18中添加。\n\n**android:resizeableActivity=[\"true\" | \"false\"]**\n指定应用是否支持多窗口显示。你可以在 < activity> 或 < application>元素中设置该属性。\n如果设置为true，用户可在分屏和freeform 模式下启动Activity。如果设置为false，Activity将不支持多窗口模式。如果这个值为false，并且用户尝试在多窗口模式下启动Activity，Activity将会全屏显示。\n如果你的应用的 targets API 是24或者更高，如果你不指定这个属性，默认值是true。这个属性是在 API level 24新增的。\n\n**android:restrictedAccountType=\"string\"**\n指定此应用程序所需的帐户类型，并指示允许受限制的配置文件访问属于所有者用户的此类帐户。 如果您的应用需要帐户，且受限个人资料可以访问主要用户的帐户，则此属性的值必须与您的应用所使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。\n警告：指定此属性允许受限配置文件使用属于所有者用户的帐户使用您的应用程序，这可能会泄露个人身份信息。 如果帐户可能显示个人详细信息，您不应使用此属性，而应声明android：requiredAccountType属性，使您的应用程序不能使用限制的配置文件。\n此属性在API级别18中添加。\n\n**android:supportsRtl=[\"true\" | \"false\"]**\n默认值是`false`。声明你的应用是否支持从右向左布局。\n如果设置为true并且targetSdkVersion 大于等于17，多个RTL相关的API将被激活，被系统使用，从而使得你的app能够显示从右向左的布局。\n如果设置为false或targetSdkVersion小于17，RTL相关的API将无效或者被忽略，你的app将无视布局方向，始终是从左向右的方向。\n在API level 17中引入的这个属性。\n\n**android:taskAffinity**\n拥有相同的affinity的Activity理论上属于相同的Task，应用程序默认的affinity的名字是元素中设定的package名（manifest中通过 < manifest>元素设置的包名）。除了那些设置了不同affinity属性的Activity\n\n**android:testOnly=[\"true\" | \"false\"]**\n表示一个应用是否仅仅用于测试。例如，它可能暴露它自己的功能或外部数据，这些可能导致一个安全漏洞，但对调试来说有用。这类应用仅仅可以通过adb命令安装。\n\n**android:theme**\n是一个资源的风格，它定义了一个默认的主题风格给所有的activity，可以后续在activity标签层单独覆盖此Theme。\n\n**android:uiOptions=[\"none\" | \"splitActionBarWhenNarrow\"]**\nActivity UI的额外选项，必须是下列值中的一个。\n* \"none\"： 没有额外的UI选项，这是默认值。\n* \"splitActionBarWhenNarrow\"：在屏幕底部添加一个条形，以在水平空间受限时（例如在手机上的纵向模式下）在应用栏（也称为操作栏）中显示操作项目。 而不是显示在屏幕顶部的应用栏中的少量操作项，应用栏分割为顶部导航部分和操作项的底部栏。 这确保了不仅为操作项目而且在顶部的导航和标题元素提供合理的空间量。 菜单项不分割在两个条上; 他们总是出现在一起。\n  该属性是在 API level 14中新增的。\n\n**android:usesCleartextTraffic=[\"true\" | \"false\"]**\n默认值为`true`。指示应用程序是否要使用明文网络流量，例如明文HTTP。当属性设置为“false”时，平台组件（例如，HTTP和FTP堆栈，DownloadManager，MediaPlayer）将拒绝应用程序使用明文流量的请求。强烈鼓励第三方图书馆也遵守此设置。避免明文流量的关键原因是缺乏保密性，真实性和防止篡改的保护：网络攻击者可以窃听传输的数据，并且还可以在不检测的情况下对其进行修改。\n这个标志是最好的努力的基础上，因为它是不可能防止来自Android应用程序的所有明文流量给定的访问级别提供给他们。例如，没有期望Socket API将尊重此标志，因为它不能确定其流量是否为明文。然而，来自应用程序的大多数网络流量由更高级网络堆栈/组件处理，可以通过从ApplicationInfo.flags或NetworkSecurityPolicy.isCleartextTrafficPermitted（）读取该标志来处理该标志。\n注意：WebView不遵守此标志。\n在应用程序开发期间，StrictMode可用于标识来自应用程序的任何明文流量：请参阅StrictMode.VmPolicy.Builder.detectCleartextNetwork（）。\n此属性是在API级别23中添加的。\n如果存在Android网络安全配置，此标记在Android 7.0（API级别24）及以上版本中将被忽略。\n\n**android:vmSafeMode=[\"true\" | \"false\"]**\n表示应用让虚拟机运行在安全模式。默认值为false。这个属性在 API level 8 中引入，true表示禁用DalvikJIT编译器。在API level 22 中有改动，true表示禁用ART AOT编译器\n","slug":"android/android-config-am","published":1,"updated":"2018-01-31T09:35:37.812Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61eb000iizcb10x03sfp","content":"<h1 id=\"AndroidManifest\"><a href=\"#AndroidManifest\" class=\"headerlink\" title=\"AndroidManifest\"></a>AndroidManifest</h1><blockquote>\n<p>每个应用的根目录中都必须包含一个AndroidManifest.xml文件(且文件名精确无误)。AndroidManifest向Android系统提供应用的必要信息，系统必须具备有这些信息方可运行应用的任何代码。<br>此外，AndroidManifest还可执行以下操作</p>\n</blockquote>\n<ul>\n<li>为应用的Java软件包命名。软件包名称充当应用的唯一标识符。</li>\n<li>描述应用的各个组件，包括构成应用的 Activity、服务、广播接收器和内容提供程序。它还为实现每个组件的类命名并发布其功能，例如它们可以处理的 <a href=\"https://developer.android.com/reference/android/content/Intent.html\" target=\"_blank\" rel=\"noopener\">Intent</a> 消息。这些声明向 Android 系统告知有关组件以及可以启动这些组件的条件的信息。</li>\n<li>确定托管应用组件的进程。</li>\n<li>声明应用必须具备哪些权限才能访问 API 中受保护的部分并与其他应用交互。还声明其他应用与该应用组件交互所需具备的权限。</li>\n<li>列出 <a href=\"https://developer.android.com/reference/android/app/Instrumentation.html\" target=\"_blank\" rel=\"noopener\">Instrumentation</a> 类，这些类可在应用运行时提供分析和其他信息。这些声明只会在应用处于开发阶段时出现在清单中，在应用发布之前将移除。</li>\n<li>声明应用所需的最低 Android API 级别</li>\n<li>列出应用必须链接到的库</li>\n</ul>\n<p>注：准备要在 Chromebook 上运行的 Android 应用时，要考虑一些重要的硬件和软件功能限制。如需了解详细信息，请参阅 <a href=\"https://developer.android.com/topic/arc/manifest.html\" target=\"_blank\" rel=\"noopener\">Chromebook 的应用清单兼容性</a>文档。</p>\n<a id=\"more\"></a>\n<h2 id=\"AndroidManifest文件结构\"><a href=\"#AndroidManifest文件结构\" class=\"headerlink\" title=\"AndroidManifest文件结构\"></a>AndroidManifest文件结构</h2><p>下面是AndroidManifest文件的示例：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;manifest&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;uses-permission /&gt;</span><br><span class=\"line\">    &lt;permission /&gt;</span><br><span class=\"line\">    &lt;permission-tree /&gt;</span><br><span class=\"line\">    &lt;permission-group /&gt;</span><br><span class=\"line\">    &lt;instrumentation /&gt;</span><br><span class=\"line\">    &lt;uses-sdk /&gt;</span><br><span class=\"line\">    &lt;uses-configuration /&gt;  </span><br><span class=\"line\">    &lt;uses-feature /&gt;  </span><br><span class=\"line\">    &lt;supports-screens /&gt;  </span><br><span class=\"line\">    &lt;compatible-screens /&gt;  </span><br><span class=\"line\">    &lt;supports-gl-texture /&gt;  </span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;application&gt;</span><br><span class=\"line\">  \t\t&lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;activity&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt;</span><br><span class=\"line\">                &lt;action /&gt;</span><br><span class=\"line\">                &lt;category /&gt;</span><br><span class=\"line\">                &lt;data /&gt;</span><br><span class=\"line\">            &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;/activity&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;activity-alias&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt; . . . &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;/activity-alias&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;service&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt; . . . &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data/&gt;</span><br><span class=\"line\">        &lt;/service&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;receiver&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt; . . . &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;/receiver&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;provider&gt;</span><br><span class=\"line\">            &lt;grant-uri-permission /&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">            &lt;path-permission /&gt;</span><br><span class=\"line\">        &lt;/provider&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;uses-library /&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/application&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/manifest&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"AndroidManifest属性\"><a href=\"#AndroidManifest属性\" class=\"headerlink\" title=\"AndroidManifest属性\"></a>AndroidManifest属性</h3><h5 id=\"Application\"><a href=\"#Application\" class=\"headerlink\" title=\"Application\"></a>Application</h5><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;application  </span><br><span class=\"line\">  \tandroid:allowBackup=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">\tandroid:allowClearUserData=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:allowTaskReparenting=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:backupAgent=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:backupInForeground=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:banner=<span class=\"string\">\"drawable resource\"</span> </span><br><span class=\"line\">    android:debuggable=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:description=<span class=\"string\">\"string resource\"</span></span><br><span class=\"line\">    android:enabled=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:extractNativeLibs=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:fullBackupContent=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:fullBackupOnly=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:hasCode=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:hardwareAccelerated=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:isGame=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:icon=<span class=\"string\">\"drawable resource\"</span></span><br><span class=\"line\">    android:killAfterRestore=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:label=<span class=\"string\">\"string resource\"</span></span><br><span class=\"line\">    android:largeHeap=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:logo=<span class=\"string\">\"drawable resource\"</span></span><br><span class=\"line\">    android:manageSpaceActivity=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:name=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:permission=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:persistent=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:process=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:restoreAnyVersion=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:requiredAccountType=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:resizeableActivity=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:restrictedAccountType=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:supportsRtl=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:taskAffinity=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:testOnly=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:theme=<span class=\"string\">\"resource or theme\"</span> </span><br><span class=\"line\">    android:uiOptions=[<span class=\"string\">\"none\"</span> | <span class=\"string\">\"splitActionBarWhenNarrow\"</span>]</span><br><span class=\"line\">    android:usesCleartextTraffic=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:vmSafeMode=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]&gt;</span><br><span class=\"line\">&lt;/application&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>android:allowBackup</strong><br>开启或关闭应用程序数据的备份和恢复功能，注意该属性值默认为true，如果你不需要你的应用被恢复导致隐私数据暴露（如果值为true，甚至可以直接通过adb命令获取该应用中的数据），必须手动设置此属性<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 备份</span><br><span class=\"line\">adb backup -nosystem -noshared -apk -f d:/com.test.bak.ab com.test.bak</span><br><span class=\"line\"></span><br><span class=\"line\">-nosystem: 不备份系统应用</span><br><span class=\"line\">-noshared: 不备份应用存储在SD中的数据</span><br><span class=\"line\">-apk: 备份应用APK安装包</span><br><span class=\"line\">-f d:/com.test.bak.ab: 备份文件在PC上的路径</span><br><span class=\"line\">com.test.bak: 要备份的包名</span><br><span class=\"line\"></span><br><span class=\"line\">// 恢复</span><br><span class=\"line\">adb restore d:/com.test.bak.ab</span><br></pre></td></tr></table></figure></p>\n<p><strong>android:allowClearUserData</strong><br>默认为<code>true</code>。用户是否能选择自行清除数据，程序管理器包含一个选择允许用户清除数据。当为true时，用户可自己清理用户数据，反之亦然</p>\n<p><strong>android:allowTaskReparenting(‘true’ or ‘false’)</strong><br>默认值为<code>false</code>。是否允许activity<code>更换从属的任务。当该</code>Task<code>下一次被带到前面时，应用程序定义的</code>Activity<code>是否可以从启动它们的</code>Task<code>移动到有相同</code>affinity<code>的Task，比如从短信息任务切换到浏览器任务。Activity可以设置自己的</code>allowTaskReparenting`属性来覆盖Application节点下的这个属性。</p>\n<p><strong>android:backupAgent</strong><br>此属性没有默认值。实现应用backup代理的类名，它是BackupAgent的一个子类。这个属性值应该是一个完整的类名，如com.project.BackupAgent.。如果类名的第一个字母是”.”，它会附加到<code>mainfest</code>元素指定的包名之后。</p>\n<p><strong>android:backupInForeground</strong><br>默认为<code>false</code>。一个应用即使在前台状态下也可以执行自动备份。当应用正在自动备份时，系统可能会停止应用，因此要谨慎的使用该属性。该属性设置为true会影响到处于激活状态下的应用的行为。</p>\n<p><strong>android:banner</strong><br>没有默认值。一个drawable资源，用来提供一个扩展的图形banner。使用<code>application</code>标签为应用所有的Activity提供一个默认的banner，或者使用<code>activity</code>标签为一个指定的Activity设置banner。在<code>Android TV</code>的home页，系统使用banner来表示一个应用。由于banner仅仅在home页显示，当一个应用中有处理<code>CATEGORY_LEANBACK_LAUNCHER</code>这个intent的Activity时，才能指定该属性。这个属性必须设置一个包含图片的drawable资源的引用(例如”@drawable/banner”)。</p>\n<p><strong>android:debuggable</strong><br>默认为<code>false</code>。这个从字面上就可以看出是什么作用的，当设置为true时，表明该APP在手机上可以被调试。在false的情况下调试该APP，就会报以下错误：<br>Device XXX requires that applications explicitely declare themselves as debuggable in their manifest.<br>Application XXX does not have the attribute ‘debuggable’ set to TRUE in its manifest and cannot be debugged.</p>\n<p><strong>android:description</strong><br>关于应用的用户可读的文字，比label属性更长、更具描述性。这个属性必须设置为一个字符串资源的引用。不像label属性，它不能是一个raw字符串。没有默认值</p>\n<p><strong>android:enabled</strong><br>默认为<code>true</code>。Android系统是否能够实例化该应用程序的组件-true表示可以，false表示不可以。如果为true，每个组件的enabled属性决定那个组件是否可以被 enabled。如果为false，它覆盖组件指定的值，即所有组件都是disabled。</p>\n<p><strong>android:extractNativeLibs</strong><br>默认值为true。包安装器能否从apk中抽取本地库到文件系统。如果设置为false，你的本地库必须页对其并且在apk中以未压缩的方式存储。链接器在运行时从apk中直接加载库不会导致代码改动。</p>\n<p><strong>android:fullBackupContent</strong><br>该属性指向一个xml文件，这个文件包含了自动备份时全部的备份规则。这些规则决定了哪些文件会被备份。该属性为可选的。如果没设置，默认情况下，自动备份会备份应用的大部分的文件。</p>\n<p><strong>android:fullBackupOnly=[“true” | “false”]</strong><br>默认值是<code>false</code>。当设备可用时是否使用自动备份。如果设置为true，当应用安装到运行Android 6.0及其更高版本的的设备上时，会运行自动备份，在低版本的设备上，应用将忽略这个属性并执行key/value方式的备份。</p>\n<p><strong>android:hasCode(‘true’ or ‘false’)</strong><br>默认为<code>true</code>。表示此APP是否包含任何的代码。若为false，则系统在运行组件时，不会去尝试加载任何的APP代码<br>一个应用程序自身不会含有任何的代码，除非内置组件类，比如Activity类，此类使用了AliasActivity类，当然这是个罕见的现象<br>(在Android2.3可以用标准C来开发应用程序，可在androidManifest.xml中将此属性设置为false,因为这个APP本身已经不含有任何的JAVA代码了)</p>\n<p><strong>android:hardwareAccelerated=[“true” | “false”]</strong><br>如果你设置了minSdkVersion或targetSdkVersion 为14或更高，默认是启用；否则默认不启用。应用中所有的Activity和View是否启用硬件加速渲染-true表示启用，false表示不启用。<br>从 Android 3.0 (API level 11)开始，应用可使用支持硬件加速的OpenGL 渲染，用来提升许多通用的2D图形操作性能。当硬件加速渲染打开时，Canvas, Paint, Xfermode, ColorFilter, Shader, 和 Camera中的大部分操作都会被加速。这会使得动画更流畅、滑动更流畅，提升整体的响应性，甚至应用不必显式的使用framework的 OpenGL库。<br>需要注意的是，不是全部的OpenGL 2D操作都会被加速。如果你打开了硬件加速渲染，请测试你的应用以确保使用渲染的过程中不会出错。</p>\n<p><strong>android:icon</strong><br>没有默认图标。一个作为整体应用的图标，就是声明整个APP的图标(在桌面的启动图标,图片一般都放在drawable文件夹下)，并且是应用的每个组件的默认图标。 &lt; activity&gt;, &lt; activity-alias&gt;, &lt; service&gt;, &lt; receiver&gt;和 &lt; provider&gt;都可以有各自的图标。这个属性必须被设置为一个包含图片的drawable资源文件的引用（比如”@drawable/icon”）。</p>\n<p><strong>android:isGame=[“true” | “false”]</strong><br>应用是否为游戏。系统可能把应用根据游戏分组或把它们与其他的应用分开来显示。默认为false。</p>\n<p><strong>android:killAfterRestore</strong><br><code>默认值为true</code>。当应用在全系统层面的恢复操作时，应用的设置被恢复后，应用应当终止运行。单个包的恢复操作不会导致应用关闭。全系统的恢复操作一般来说只会发生一次，即在手机第一次启动时。第三方的应用一般没必要使用这个属性。意味着当应用在全系统的恢复操作中处理完自己的数据后，将会停止运行。</p>\n<p><strong>android:largeHeap=[“true” | “false”]</strong><br>你的应用进程是否通过一个largeDalvik heap 被创建。这个属性适用于所有的为应用创建的进程。它仅适用于被加载到进程的第一个应用；如果你使用shared user id来允许多个应用在同一个进程中，它们都必需一致的使用这个选项，否则可能出现不可预知的结果。<br>大部分app都不应使用这个属性，而应该把焦点放在如何减少整体的内存使用来提示性能。启用此功能也不能保证可用内存的固定增加，因为一些设备被全部可用内存限制了。<br>可使用ActivityManager.getMemoryClass() or ActivityManager.getLargeMemoryClass()在运行时获取可用的内存大小。</p>\n<p><strong>android:label</strong><br>应用的标签名(应用名称)。把应用作为整体的用户可读标签，也是应用中各个组件的默认标签。 &lt; activity&gt;, &lt; activity-alias&gt;, &lt; service&gt;, &lt; receiver&gt;, &lt; provider&gt; 都可以设置各自的标签。标签应设置为一个字符串资源的引用，以便可以像用户界面中的其他字符串一样进行本地化。为了方便，在开发应用时可以设置为原始字符串。</p>\n<p><strong>android:logo=”drawable resource”</strong><br>应用作为一个整体的logo，也是所有Activity的默认logo。这个属性必须被设置为一个包含图片的drawable资源的引用（比如@drawable/logo）。没有默认logo。默认情况下，使用在ActionBar中使用icon，如果同时也设置了logo属性，ActionBar上将使用logo。logo应比icon远，但不应包括不必要的文本。 只有在以用户认可的传统格式表示您的品牌时才应使用logo。 logo代表预期的使用者品牌，而应用程序的的icon是符合启动器图示方形要求的修改版本。</p>\n<p><strong>android:manageSpaceActivity</strong><br>一个Activity子类的全限定名，系统可以启动它来让用户管理设备上应用的内存使用情况。这个Activity也必须使用&lt; activity&gt; 元素来声明。</p>\n<p><strong>android:name</strong><br>为应用程序所实现的Application子类的全名。当应用程序进程开始时，该类在所有应用程序组件之前被实例化。<br>若该类(比方androidMain类)是在声明的package下，则可以直接声明android:name=”androidMain”,但此类是在package下面的子包的话，就必须声明为全路径或android:name=”package名称.子包名成.androidMain”</p>\n<p><strong>android:permission</strong><br>为了跟应用交互，客户端必须拥有的权限。这个属性是适用于应用中所有组件设置权限的一个方便的方法。每个组件可设置各自的permission属性来覆盖application中的这个属性。</p>\n<p><strong>android:presistent</strong><br>默认值是false。该应用程序是否应该在任何时候都保持运行状态,默认为false。因为应用程序通常不应该设置本标识，持续模式仅仅应该设置给某些系统应用程序才是有意义的。</p>\n<p><strong>android:process</strong><br>应用程序运行的进程名，它的默认值为元素里设置的包名，当然每个组件都可以通过设置该属性来覆盖默认值。如果你想两个应用程序共用一个进程的话，你可以设置他们的android:process相同，但前提条件是他们共享一个用户ID及被赋予了相同证书的时候</p>\n<p><strong>android:restoreAnyVersion</strong><br>此属性的默认值为<code>false</code>。用来表明应用是否准备尝试恢复所有的备份，即使该备份是由比当前在设备上安装的应用程序的更新版本存储的。 将此属性设置为true将允许备份管理器尝试恢复，即使版本不匹配表明数据不兼容。 使用时要小心！。</p>\n<p><strong>android:requiredAccountType=”string”</strong><br>指定应用程序为了运行所需的帐户类型。 如果您的应用需要帐户，则此属性的值必须与您的应用使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。<br>由于受限个人资料目前无法添加帐户，因此指定此属性会使您的应用无法从受限个人资料中获取，除非您也声明了android：restrictedAccountType具有相同的值。<br>警告：如果帐户数据可能显示个人身份信息，请务必声明此属性并将android：restrictedAccountType设置为null，以便受限配置文件无法使用您的应用访问属于所有者用户的个人信息。<br>此属性在API级别18中添加。</p>\n<p><strong>android:resizeableActivity=[“true” | “false”]</strong><br>指定应用是否支持多窗口显示。你可以在 &lt; activity&gt; 或 &lt; application&gt;元素中设置该属性。<br>如果设置为true，用户可在分屏和freeform 模式下启动Activity。如果设置为false，Activity将不支持多窗口模式。如果这个值为false，并且用户尝试在多窗口模式下启动Activity，Activity将会全屏显示。<br>如果你的应用的 targets API 是24或者更高，如果你不指定这个属性，默认值是true。这个属性是在 API level 24新增的。</p>\n<p><strong>android:restrictedAccountType=”string”</strong><br>指定此应用程序所需的帐户类型，并指示允许受限制的配置文件访问属于所有者用户的此类帐户。 如果您的应用需要帐户，且受限个人资料可以访问主要用户的帐户，则此属性的值必须与您的应用所使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。<br>警告：指定此属性允许受限配置文件使用属于所有者用户的帐户使用您的应用程序，这可能会泄露个人身份信息。 如果帐户可能显示个人详细信息，您不应使用此属性，而应声明android：requiredAccountType属性，使您的应用程序不能使用限制的配置文件。<br>此属性在API级别18中添加。</p>\n<p><strong>android:supportsRtl=[“true” | “false”]</strong><br>默认值是<code>false</code>。声明你的应用是否支持从右向左布局。<br>如果设置为true并且targetSdkVersion 大于等于17，多个RTL相关的API将被激活，被系统使用，从而使得你的app能够显示从右向左的布局。<br>如果设置为false或targetSdkVersion小于17，RTL相关的API将无效或者被忽略，你的app将无视布局方向，始终是从左向右的方向。<br>在API level 17中引入的这个属性。</p>\n<p><strong>android:taskAffinity</strong><br>拥有相同的affinity的Activity理论上属于相同的Task，应用程序默认的affinity的名字是元素中设定的package名（manifest中通过 &lt; manifest&gt;元素设置的包名）。除了那些设置了不同affinity属性的Activity</p>\n<p><strong>android:testOnly=[“true” | “false”]</strong><br>表示一个应用是否仅仅用于测试。例如，它可能暴露它自己的功能或外部数据，这些可能导致一个安全漏洞，但对调试来说有用。这类应用仅仅可以通过adb命令安装。</p>\n<p><strong>android:theme</strong><br>是一个资源的风格，它定义了一个默认的主题风格给所有的activity，可以后续在activity标签层单独覆盖此Theme。</p>\n<p><strong>android:uiOptions=[“none” | “splitActionBarWhenNarrow”]</strong><br>Activity UI的额外选项，必须是下列值中的一个。</p>\n<ul>\n<li>“none”： 没有额外的UI选项，这是默认值。</li>\n<li>“splitActionBarWhenNarrow”：在屏幕底部添加一个条形，以在水平空间受限时（例如在手机上的纵向模式下）在应用栏（也称为操作栏）中显示操作项目。 而不是显示在屏幕顶部的应用栏中的少量操作项，应用栏分割为顶部导航部分和操作项的底部栏。 这确保了不仅为操作项目而且在顶部的导航和标题元素提供合理的空间量。 菜单项不分割在两个条上; 他们总是出现在一起。<br>该属性是在 API level 14中新增的。</li>\n</ul>\n<p><strong>android:usesCleartextTraffic=[“true” | “false”]</strong><br>默认值为<code>true</code>。指示应用程序是否要使用明文网络流量，例如明文HTTP。当属性设置为“false”时，平台组件（例如，HTTP和FTP堆栈，DownloadManager，MediaPlayer）将拒绝应用程序使用明文流量的请求。强烈鼓励第三方图书馆也遵守此设置。避免明文流量的关键原因是缺乏保密性，真实性和防止篡改的保护：网络攻击者可以窃听传输的数据，并且还可以在不检测的情况下对其进行修改。<br>这个标志是最好的努力的基础上，因为它是不可能防止来自Android应用程序的所有明文流量给定的访问级别提供给他们。例如，没有期望Socket API将尊重此标志，因为它不能确定其流量是否为明文。然而，来自应用程序的大多数网络流量由更高级网络堆栈/组件处理，可以通过从ApplicationInfo.flags或NetworkSecurityPolicy.isCleartextTrafficPermitted（）读取该标志来处理该标志。<br>注意：WebView不遵守此标志。<br>在应用程序开发期间，StrictMode可用于标识来自应用程序的任何明文流量：请参阅StrictMode.VmPolicy.Builder.detectCleartextNetwork（）。<br>此属性是在API级别23中添加的。<br>如果存在Android网络安全配置，此标记在Android 7.0（API级别24）及以上版本中将被忽略。</p>\n<p><strong>android:vmSafeMode=[“true” | “false”]</strong><br>表示应用让虚拟机运行在安全模式。默认值为false。这个属性在 API level 8 中引入，true表示禁用DalvikJIT编译器。在API level 22 中有改动，true表示禁用ART AOT编译器</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"AndroidManifest\"><a href=\"#AndroidManifest\" class=\"headerlink\" title=\"AndroidManifest\"></a>AndroidManifest</h1><blockquote>\n<p>每个应用的根目录中都必须包含一个AndroidManifest.xml文件(且文件名精确无误)。AndroidManifest向Android系统提供应用的必要信息，系统必须具备有这些信息方可运行应用的任何代码。<br>此外，AndroidManifest还可执行以下操作</p>\n</blockquote>\n<ul>\n<li>为应用的Java软件包命名。软件包名称充当应用的唯一标识符。</li>\n<li>描述应用的各个组件，包括构成应用的 Activity、服务、广播接收器和内容提供程序。它还为实现每个组件的类命名并发布其功能，例如它们可以处理的 <a href=\"https://developer.android.com/reference/android/content/Intent.html\" target=\"_blank\" rel=\"noopener\">Intent</a> 消息。这些声明向 Android 系统告知有关组件以及可以启动这些组件的条件的信息。</li>\n<li>确定托管应用组件的进程。</li>\n<li>声明应用必须具备哪些权限才能访问 API 中受保护的部分并与其他应用交互。还声明其他应用与该应用组件交互所需具备的权限。</li>\n<li>列出 <a href=\"https://developer.android.com/reference/android/app/Instrumentation.html\" target=\"_blank\" rel=\"noopener\">Instrumentation</a> 类，这些类可在应用运行时提供分析和其他信息。这些声明只会在应用处于开发阶段时出现在清单中，在应用发布之前将移除。</li>\n<li>声明应用所需的最低 Android API 级别</li>\n<li>列出应用必须链接到的库</li>\n</ul>\n<p>注：准备要在 Chromebook 上运行的 Android 应用时，要考虑一些重要的硬件和软件功能限制。如需了解详细信息，请参阅 <a href=\"https://developer.android.com/topic/arc/manifest.html\" target=\"_blank\" rel=\"noopener\">Chromebook 的应用清单兼容性</a>文档。</p>","more":"<h2 id=\"AndroidManifest文件结构\"><a href=\"#AndroidManifest文件结构\" class=\"headerlink\" title=\"AndroidManifest文件结构\"></a>AndroidManifest文件结构</h2><p>下面是AndroidManifest文件的示例：</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;manifest&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;uses-permission /&gt;</span><br><span class=\"line\">    &lt;permission /&gt;</span><br><span class=\"line\">    &lt;permission-tree /&gt;</span><br><span class=\"line\">    &lt;permission-group /&gt;</span><br><span class=\"line\">    &lt;instrumentation /&gt;</span><br><span class=\"line\">    &lt;uses-sdk /&gt;</span><br><span class=\"line\">    &lt;uses-configuration /&gt;  </span><br><span class=\"line\">    &lt;uses-feature /&gt;  </span><br><span class=\"line\">    &lt;supports-screens /&gt;  </span><br><span class=\"line\">    &lt;compatible-screens /&gt;  </span><br><span class=\"line\">    &lt;supports-gl-texture /&gt;  </span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;application&gt;</span><br><span class=\"line\">  \t\t&lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;activity&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt;</span><br><span class=\"line\">                &lt;action /&gt;</span><br><span class=\"line\">                &lt;category /&gt;</span><br><span class=\"line\">                &lt;data /&gt;</span><br><span class=\"line\">            &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;/activity&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;activity-alias&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt; . . . &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;/activity-alias&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;service&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt; . . . &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data/&gt;</span><br><span class=\"line\">        &lt;/service&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;receiver&gt;</span><br><span class=\"line\">            &lt;intent-filter&gt; . . . &lt;/intent-filter&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">        &lt;/receiver&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;provider&gt;</span><br><span class=\"line\">            &lt;grant-uri-permission /&gt;</span><br><span class=\"line\">            &lt;meta-data /&gt;</span><br><span class=\"line\">            &lt;path-permission /&gt;</span><br><span class=\"line\">        &lt;/provider&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;uses-library /&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/application&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/manifest&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"AndroidManifest属性\"><a href=\"#AndroidManifest属性\" class=\"headerlink\" title=\"AndroidManifest属性\"></a>AndroidManifest属性</h3><h5 id=\"Application\"><a href=\"#Application\" class=\"headerlink\" title=\"Application\"></a>Application</h5><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;application  </span><br><span class=\"line\">  \tandroid:allowBackup=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">\tandroid:allowClearUserData=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:allowTaskReparenting=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:backupAgent=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:backupInForeground=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:banner=<span class=\"string\">\"drawable resource\"</span> </span><br><span class=\"line\">    android:debuggable=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:description=<span class=\"string\">\"string resource\"</span></span><br><span class=\"line\">    android:enabled=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:extractNativeLibs=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:fullBackupContent=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:fullBackupOnly=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:hasCode=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:hardwareAccelerated=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:isGame=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:icon=<span class=\"string\">\"drawable resource\"</span></span><br><span class=\"line\">    android:killAfterRestore=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:label=<span class=\"string\">\"string resource\"</span></span><br><span class=\"line\">    android:largeHeap=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:logo=<span class=\"string\">\"drawable resource\"</span></span><br><span class=\"line\">    android:manageSpaceActivity=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:name=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:permission=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:persistent=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:process=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:restoreAnyVersion=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:requiredAccountType=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:resizeableActivity=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:restrictedAccountType=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:supportsRtl=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:taskAffinity=<span class=\"string\">\"string\"</span></span><br><span class=\"line\">    android:testOnly=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:theme=<span class=\"string\">\"resource or theme\"</span> </span><br><span class=\"line\">    android:uiOptions=[<span class=\"string\">\"none\"</span> | <span class=\"string\">\"splitActionBarWhenNarrow\"</span>]</span><br><span class=\"line\">    android:usesCleartextTraffic=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]</span><br><span class=\"line\">    android:vmSafeMode=[<span class=\"string\">\"true\"</span> | <span class=\"string\">\"false\"</span>]&gt;</span><br><span class=\"line\">&lt;/application&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>android:allowBackup</strong><br>开启或关闭应用程序数据的备份和恢复功能，注意该属性值默认为true，如果你不需要你的应用被恢复导致隐私数据暴露（如果值为true，甚至可以直接通过adb命令获取该应用中的数据），必须手动设置此属性<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 备份</span><br><span class=\"line\">adb backup -nosystem -noshared -apk -f d:/com.test.bak.ab com.test.bak</span><br><span class=\"line\"></span><br><span class=\"line\">-nosystem: 不备份系统应用</span><br><span class=\"line\">-noshared: 不备份应用存储在SD中的数据</span><br><span class=\"line\">-apk: 备份应用APK安装包</span><br><span class=\"line\">-f d:/com.test.bak.ab: 备份文件在PC上的路径</span><br><span class=\"line\">com.test.bak: 要备份的包名</span><br><span class=\"line\"></span><br><span class=\"line\">// 恢复</span><br><span class=\"line\">adb restore d:/com.test.bak.ab</span><br></pre></td></tr></table></figure></p>\n<p><strong>android:allowClearUserData</strong><br>默认为<code>true</code>。用户是否能选择自行清除数据，程序管理器包含一个选择允许用户清除数据。当为true时，用户可自己清理用户数据，反之亦然</p>\n<p><strong>android:allowTaskReparenting(‘true’ or ‘false’)</strong><br>默认值为<code>false</code>。是否允许activity<code>更换从属的任务。当该</code>Task<code>下一次被带到前面时，应用程序定义的</code>Activity<code>是否可以从启动它们的</code>Task<code>移动到有相同</code>affinity<code>的Task，比如从短信息任务切换到浏览器任务。Activity可以设置自己的</code>allowTaskReparenting`属性来覆盖Application节点下的这个属性。</p>\n<p><strong>android:backupAgent</strong><br>此属性没有默认值。实现应用backup代理的类名，它是BackupAgent的一个子类。这个属性值应该是一个完整的类名，如com.project.BackupAgent.。如果类名的第一个字母是”.”，它会附加到<code>mainfest</code>元素指定的包名之后。</p>\n<p><strong>android:backupInForeground</strong><br>默认为<code>false</code>。一个应用即使在前台状态下也可以执行自动备份。当应用正在自动备份时，系统可能会停止应用，因此要谨慎的使用该属性。该属性设置为true会影响到处于激活状态下的应用的行为。</p>\n<p><strong>android:banner</strong><br>没有默认值。一个drawable资源，用来提供一个扩展的图形banner。使用<code>application</code>标签为应用所有的Activity提供一个默认的banner，或者使用<code>activity</code>标签为一个指定的Activity设置banner。在<code>Android TV</code>的home页，系统使用banner来表示一个应用。由于banner仅仅在home页显示，当一个应用中有处理<code>CATEGORY_LEANBACK_LAUNCHER</code>这个intent的Activity时，才能指定该属性。这个属性必须设置一个包含图片的drawable资源的引用(例如”@drawable/banner”)。</p>\n<p><strong>android:debuggable</strong><br>默认为<code>false</code>。这个从字面上就可以看出是什么作用的，当设置为true时，表明该APP在手机上可以被调试。在false的情况下调试该APP，就会报以下错误：<br>Device XXX requires that applications explicitely declare themselves as debuggable in their manifest.<br>Application XXX does not have the attribute ‘debuggable’ set to TRUE in its manifest and cannot be debugged.</p>\n<p><strong>android:description</strong><br>关于应用的用户可读的文字，比label属性更长、更具描述性。这个属性必须设置为一个字符串资源的引用。不像label属性，它不能是一个raw字符串。没有默认值</p>\n<p><strong>android:enabled</strong><br>默认为<code>true</code>。Android系统是否能够实例化该应用程序的组件-true表示可以，false表示不可以。如果为true，每个组件的enabled属性决定那个组件是否可以被 enabled。如果为false，它覆盖组件指定的值，即所有组件都是disabled。</p>\n<p><strong>android:extractNativeLibs</strong><br>默认值为true。包安装器能否从apk中抽取本地库到文件系统。如果设置为false，你的本地库必须页对其并且在apk中以未压缩的方式存储。链接器在运行时从apk中直接加载库不会导致代码改动。</p>\n<p><strong>android:fullBackupContent</strong><br>该属性指向一个xml文件，这个文件包含了自动备份时全部的备份规则。这些规则决定了哪些文件会被备份。该属性为可选的。如果没设置，默认情况下，自动备份会备份应用的大部分的文件。</p>\n<p><strong>android:fullBackupOnly=[“true” | “false”]</strong><br>默认值是<code>false</code>。当设备可用时是否使用自动备份。如果设置为true，当应用安装到运行Android 6.0及其更高版本的的设备上时，会运行自动备份，在低版本的设备上，应用将忽略这个属性并执行key/value方式的备份。</p>\n<p><strong>android:hasCode(‘true’ or ‘false’)</strong><br>默认为<code>true</code>。表示此APP是否包含任何的代码。若为false，则系统在运行组件时，不会去尝试加载任何的APP代码<br>一个应用程序自身不会含有任何的代码，除非内置组件类，比如Activity类，此类使用了AliasActivity类，当然这是个罕见的现象<br>(在Android2.3可以用标准C来开发应用程序，可在androidManifest.xml中将此属性设置为false,因为这个APP本身已经不含有任何的JAVA代码了)</p>\n<p><strong>android:hardwareAccelerated=[“true” | “false”]</strong><br>如果你设置了minSdkVersion或targetSdkVersion 为14或更高，默认是启用；否则默认不启用。应用中所有的Activity和View是否启用硬件加速渲染-true表示启用，false表示不启用。<br>从 Android 3.0 (API level 11)开始，应用可使用支持硬件加速的OpenGL 渲染，用来提升许多通用的2D图形操作性能。当硬件加速渲染打开时，Canvas, Paint, Xfermode, ColorFilter, Shader, 和 Camera中的大部分操作都会被加速。这会使得动画更流畅、滑动更流畅，提升整体的响应性，甚至应用不必显式的使用framework的 OpenGL库。<br>需要注意的是，不是全部的OpenGL 2D操作都会被加速。如果你打开了硬件加速渲染，请测试你的应用以确保使用渲染的过程中不会出错。</p>\n<p><strong>android:icon</strong><br>没有默认图标。一个作为整体应用的图标，就是声明整个APP的图标(在桌面的启动图标,图片一般都放在drawable文件夹下)，并且是应用的每个组件的默认图标。 &lt; activity&gt;, &lt; activity-alias&gt;, &lt; service&gt;, &lt; receiver&gt;和 &lt; provider&gt;都可以有各自的图标。这个属性必须被设置为一个包含图片的drawable资源文件的引用（比如”@drawable/icon”）。</p>\n<p><strong>android:isGame=[“true” | “false”]</strong><br>应用是否为游戏。系统可能把应用根据游戏分组或把它们与其他的应用分开来显示。默认为false。</p>\n<p><strong>android:killAfterRestore</strong><br><code>默认值为true</code>。当应用在全系统层面的恢复操作时，应用的设置被恢复后，应用应当终止运行。单个包的恢复操作不会导致应用关闭。全系统的恢复操作一般来说只会发生一次，即在手机第一次启动时。第三方的应用一般没必要使用这个属性。意味着当应用在全系统的恢复操作中处理完自己的数据后，将会停止运行。</p>\n<p><strong>android:largeHeap=[“true” | “false”]</strong><br>你的应用进程是否通过一个largeDalvik heap 被创建。这个属性适用于所有的为应用创建的进程。它仅适用于被加载到进程的第一个应用；如果你使用shared user id来允许多个应用在同一个进程中，它们都必需一致的使用这个选项，否则可能出现不可预知的结果。<br>大部分app都不应使用这个属性，而应该把焦点放在如何减少整体的内存使用来提示性能。启用此功能也不能保证可用内存的固定增加，因为一些设备被全部可用内存限制了。<br>可使用ActivityManager.getMemoryClass() or ActivityManager.getLargeMemoryClass()在运行时获取可用的内存大小。</p>\n<p><strong>android:label</strong><br>应用的标签名(应用名称)。把应用作为整体的用户可读标签，也是应用中各个组件的默认标签。 &lt; activity&gt;, &lt; activity-alias&gt;, &lt; service&gt;, &lt; receiver&gt;, &lt; provider&gt; 都可以设置各自的标签。标签应设置为一个字符串资源的引用，以便可以像用户界面中的其他字符串一样进行本地化。为了方便，在开发应用时可以设置为原始字符串。</p>\n<p><strong>android:logo=”drawable resource”</strong><br>应用作为一个整体的logo，也是所有Activity的默认logo。这个属性必须被设置为一个包含图片的drawable资源的引用（比如@drawable/logo）。没有默认logo。默认情况下，使用在ActionBar中使用icon，如果同时也设置了logo属性，ActionBar上将使用logo。logo应比icon远，但不应包括不必要的文本。 只有在以用户认可的传统格式表示您的品牌时才应使用logo。 logo代表预期的使用者品牌，而应用程序的的icon是符合启动器图示方形要求的修改版本。</p>\n<p><strong>android:manageSpaceActivity</strong><br>一个Activity子类的全限定名，系统可以启动它来让用户管理设备上应用的内存使用情况。这个Activity也必须使用&lt; activity&gt; 元素来声明。</p>\n<p><strong>android:name</strong><br>为应用程序所实现的Application子类的全名。当应用程序进程开始时，该类在所有应用程序组件之前被实例化。<br>若该类(比方androidMain类)是在声明的package下，则可以直接声明android:name=”androidMain”,但此类是在package下面的子包的话，就必须声明为全路径或android:name=”package名称.子包名成.androidMain”</p>\n<p><strong>android:permission</strong><br>为了跟应用交互，客户端必须拥有的权限。这个属性是适用于应用中所有组件设置权限的一个方便的方法。每个组件可设置各自的permission属性来覆盖application中的这个属性。</p>\n<p><strong>android:presistent</strong><br>默认值是false。该应用程序是否应该在任何时候都保持运行状态,默认为false。因为应用程序通常不应该设置本标识，持续模式仅仅应该设置给某些系统应用程序才是有意义的。</p>\n<p><strong>android:process</strong><br>应用程序运行的进程名，它的默认值为元素里设置的包名，当然每个组件都可以通过设置该属性来覆盖默认值。如果你想两个应用程序共用一个进程的话，你可以设置他们的android:process相同，但前提条件是他们共享一个用户ID及被赋予了相同证书的时候</p>\n<p><strong>android:restoreAnyVersion</strong><br>此属性的默认值为<code>false</code>。用来表明应用是否准备尝试恢复所有的备份，即使该备份是由比当前在设备上安装的应用程序的更新版本存储的。 将此属性设置为true将允许备份管理器尝试恢复，即使版本不匹配表明数据不兼容。 使用时要小心！。</p>\n<p><strong>android:requiredAccountType=”string”</strong><br>指定应用程序为了运行所需的帐户类型。 如果您的应用需要帐户，则此属性的值必须与您的应用使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。<br>由于受限个人资料目前无法添加帐户，因此指定此属性会使您的应用无法从受限个人资料中获取，除非您也声明了android：restrictedAccountType具有相同的值。<br>警告：如果帐户数据可能显示个人身份信息，请务必声明此属性并将android：restrictedAccountType设置为null，以便受限配置文件无法使用您的应用访问属于所有者用户的个人信息。<br>此属性在API级别18中添加。</p>\n<p><strong>android:resizeableActivity=[“true” | “false”]</strong><br>指定应用是否支持多窗口显示。你可以在 &lt; activity&gt; 或 &lt; application&gt;元素中设置该属性。<br>如果设置为true，用户可在分屏和freeform 模式下启动Activity。如果设置为false，Activity将不支持多窗口模式。如果这个值为false，并且用户尝试在多窗口模式下启动Activity，Activity将会全屏显示。<br>如果你的应用的 targets API 是24或者更高，如果你不指定这个属性，默认值是true。这个属性是在 API level 24新增的。</p>\n<p><strong>android:restrictedAccountType=”string”</strong><br>指定此应用程序所需的帐户类型，并指示允许受限制的配置文件访问属于所有者用户的此类帐户。 如果您的应用需要帐户，且受限个人资料可以访问主要用户的帐户，则此属性的值必须与您的应用所使用的帐户验证器类型（由AuthenticatorDescription定义）（如“com.google”）相对应。默认值为null，表示应用程序可以在没有任何帐户的情况下工作。<br>警告：指定此属性允许受限配置文件使用属于所有者用户的帐户使用您的应用程序，这可能会泄露个人身份信息。 如果帐户可能显示个人详细信息，您不应使用此属性，而应声明android：requiredAccountType属性，使您的应用程序不能使用限制的配置文件。<br>此属性在API级别18中添加。</p>\n<p><strong>android:supportsRtl=[“true” | “false”]</strong><br>默认值是<code>false</code>。声明你的应用是否支持从右向左布局。<br>如果设置为true并且targetSdkVersion 大于等于17，多个RTL相关的API将被激活，被系统使用，从而使得你的app能够显示从右向左的布局。<br>如果设置为false或targetSdkVersion小于17，RTL相关的API将无效或者被忽略，你的app将无视布局方向，始终是从左向右的方向。<br>在API level 17中引入的这个属性。</p>\n<p><strong>android:taskAffinity</strong><br>拥有相同的affinity的Activity理论上属于相同的Task，应用程序默认的affinity的名字是元素中设定的package名（manifest中通过 &lt; manifest&gt;元素设置的包名）。除了那些设置了不同affinity属性的Activity</p>\n<p><strong>android:testOnly=[“true” | “false”]</strong><br>表示一个应用是否仅仅用于测试。例如，它可能暴露它自己的功能或外部数据，这些可能导致一个安全漏洞，但对调试来说有用。这类应用仅仅可以通过adb命令安装。</p>\n<p><strong>android:theme</strong><br>是一个资源的风格，它定义了一个默认的主题风格给所有的activity，可以后续在activity标签层单独覆盖此Theme。</p>\n<p><strong>android:uiOptions=[“none” | “splitActionBarWhenNarrow”]</strong><br>Activity UI的额外选项，必须是下列值中的一个。</p>\n<ul>\n<li>“none”： 没有额外的UI选项，这是默认值。</li>\n<li>“splitActionBarWhenNarrow”：在屏幕底部添加一个条形，以在水平空间受限时（例如在手机上的纵向模式下）在应用栏（也称为操作栏）中显示操作项目。 而不是显示在屏幕顶部的应用栏中的少量操作项，应用栏分割为顶部导航部分和操作项的底部栏。 这确保了不仅为操作项目而且在顶部的导航和标题元素提供合理的空间量。 菜单项不分割在两个条上; 他们总是出现在一起。<br>该属性是在 API level 14中新增的。</li>\n</ul>\n<p><strong>android:usesCleartextTraffic=[“true” | “false”]</strong><br>默认值为<code>true</code>。指示应用程序是否要使用明文网络流量，例如明文HTTP。当属性设置为“false”时，平台组件（例如，HTTP和FTP堆栈，DownloadManager，MediaPlayer）将拒绝应用程序使用明文流量的请求。强烈鼓励第三方图书馆也遵守此设置。避免明文流量的关键原因是缺乏保密性，真实性和防止篡改的保护：网络攻击者可以窃听传输的数据，并且还可以在不检测的情况下对其进行修改。<br>这个标志是最好的努力的基础上，因为它是不可能防止来自Android应用程序的所有明文流量给定的访问级别提供给他们。例如，没有期望Socket API将尊重此标志，因为它不能确定其流量是否为明文。然而，来自应用程序的大多数网络流量由更高级网络堆栈/组件处理，可以通过从ApplicationInfo.flags或NetworkSecurityPolicy.isCleartextTrafficPermitted（）读取该标志来处理该标志。<br>注意：WebView不遵守此标志。<br>在应用程序开发期间，StrictMode可用于标识来自应用程序的任何明文流量：请参阅StrictMode.VmPolicy.Builder.detectCleartextNetwork（）。<br>此属性是在API级别23中添加的。<br>如果存在Android网络安全配置，此标记在Android 7.0（API级别24）及以上版本中将被忽略。</p>\n<p><strong>android:vmSafeMode=[“true” | “false”]</strong><br>表示应用让虚拟机运行在安全模式。默认值为false。这个属性在 API level 8 中引入，true表示禁用DalvikJIT编译器。在API level 22 中有改动，true表示禁用ART AOT编译器</p>"},{"title":"android-context","date":"2016-05-21T10:53:02.000Z","_content":"\n## Context的能力\n\nContext能做的通用操作决定于这个context最初来源于哪里。下表所列的是，在应用中常见的会收到context对象，以及对应的每种情况，它可以用于哪些地方：\n\n|                     | Application | Activity | Service | ContentProvider | BroadcaseReceiver |\n| ------------------- | ----------- | -------- | ------- | --------------- | ----------------- |\n| 显示Dialog            | NO          | YEA      | NO      | NO              | NO                |\n| 启动Activity          | NO1         | YES      | NO1     | NO1             | NO1               |\n| Layout Inflation    | NO2         | YES      | NO2     | NO2             | NO2               |\n| 启动Service           | YES         | YES      | YES     | YES             | YES               |\n| 绑定Service           | YES         | YES      | YES     | YES             | NO                |\n| 发送Broadcast         | YES         | YES      | YES     | YES             | YES               |\n| 注册BroadcastReceiver | YES         | YES      | YES     | YES             | NO3               |\n| 加载Resource          | YES         | YES      | YES     | YES             | YES               |\n\n需要注意的是：\n\n- NO1：表示这些类的确可以开始一个Activity，但是它需要创建一个新的task。这可能会满足一些特定的需求，但是在你的应用中会创建一个不标准的回退栈（back stack），这通常是不推荐的或者不是最好的实践\n- NO2：表示这些类去layout inflate是合法的，但是会使用系统默认的主题，如果你自定义了某些样式，可能不会被使用\n- NO3：表示在receiver为null时允许，在4.2或以上的版本中，用于获取黏性广播的当前值。\n\n### 总结\n\n对于UI相关的方法，都不建议或者不可使用Application，都应该使用Activity作为Context来处理。另外需要注意Context引用的持有，防止内存泄漏。","source":"_posts/android/android-context.md","raw":"---\ntitle: android-context\ndate: 2016-05-21 18:53:02\ntags: android\n---\n\n## Context的能力\n\nContext能做的通用操作决定于这个context最初来源于哪里。下表所列的是，在应用中常见的会收到context对象，以及对应的每种情况，它可以用于哪些地方：\n\n|                     | Application | Activity | Service | ContentProvider | BroadcaseReceiver |\n| ------------------- | ----------- | -------- | ------- | --------------- | ----------------- |\n| 显示Dialog            | NO          | YEA      | NO      | NO              | NO                |\n| 启动Activity          | NO1         | YES      | NO1     | NO1             | NO1               |\n| Layout Inflation    | NO2         | YES      | NO2     | NO2             | NO2               |\n| 启动Service           | YES         | YES      | YES     | YES             | YES               |\n| 绑定Service           | YES         | YES      | YES     | YES             | NO                |\n| 发送Broadcast         | YES         | YES      | YES     | YES             | YES               |\n| 注册BroadcastReceiver | YES         | YES      | YES     | YES             | NO3               |\n| 加载Resource          | YES         | YES      | YES     | YES             | YES               |\n\n需要注意的是：\n\n- NO1：表示这些类的确可以开始一个Activity，但是它需要创建一个新的task。这可能会满足一些特定的需求，但是在你的应用中会创建一个不标准的回退栈（back stack），这通常是不推荐的或者不是最好的实践\n- NO2：表示这些类去layout inflate是合法的，但是会使用系统默认的主题，如果你自定义了某些样式，可能不会被使用\n- NO3：表示在receiver为null时允许，在4.2或以上的版本中，用于获取黏性广播的当前值。\n\n### 总结\n\n对于UI相关的方法，都不建议或者不可使用Application，都应该使用Activity作为Context来处理。另外需要注意Context引用的持有，防止内存泄漏。","slug":"android/android-context","published":1,"updated":"2018-05-20T13:04:25.680Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ec000lizcb6bn50lna","content":"<h2 id=\"Context的能力\"><a href=\"#Context的能力\" class=\"headerlink\" title=\"Context的能力\"></a>Context的能力</h2><p>Context能做的通用操作决定于这个context最初来源于哪里。下表所列的是，在应用中常见的会收到context对象，以及对应的每种情况，它可以用于哪些地方：</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Application</th>\n<th>Activity</th>\n<th>Service</th>\n<th>ContentProvider</th>\n<th>BroadcaseReceiver</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>显示Dialog</td>\n<td>NO</td>\n<td>YEA</td>\n<td>NO</td>\n<td>NO</td>\n<td>NO</td>\n</tr>\n<tr>\n<td>启动Activity</td>\n<td>NO1</td>\n<td>YES</td>\n<td>NO1</td>\n<td>NO1</td>\n<td>NO1</td>\n</tr>\n<tr>\n<td>Layout Inflation</td>\n<td>NO2</td>\n<td>YES</td>\n<td>NO2</td>\n<td>NO2</td>\n<td>NO2</td>\n</tr>\n<tr>\n<td>启动Service</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>绑定Service</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>NO</td>\n</tr>\n<tr>\n<td>发送Broadcast</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>注册BroadcastReceiver</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>NO3</td>\n</tr>\n<tr>\n<td>加载Resource</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n</tbody>\n</table>\n<p>需要注意的是：</p>\n<ul>\n<li>NO1：表示这些类的确可以开始一个Activity，但是它需要创建一个新的task。这可能会满足一些特定的需求，但是在你的应用中会创建一个不标准的回退栈（back stack），这通常是不推荐的或者不是最好的实践</li>\n<li>NO2：表示这些类去layout inflate是合法的，但是会使用系统默认的主题，如果你自定义了某些样式，可能不会被使用</li>\n<li>NO3：表示在receiver为null时允许，在4.2或以上的版本中，用于获取黏性广播的当前值。</li>\n</ul>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>对于UI相关的方法，都不建议或者不可使用Application，都应该使用Activity作为Context来处理。另外需要注意Context引用的持有，防止内存泄漏。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Context的能力\"><a href=\"#Context的能力\" class=\"headerlink\" title=\"Context的能力\"></a>Context的能力</h2><p>Context能做的通用操作决定于这个context最初来源于哪里。下表所列的是，在应用中常见的会收到context对象，以及对应的每种情况，它可以用于哪些地方：</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Application</th>\n<th>Activity</th>\n<th>Service</th>\n<th>ContentProvider</th>\n<th>BroadcaseReceiver</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>显示Dialog</td>\n<td>NO</td>\n<td>YEA</td>\n<td>NO</td>\n<td>NO</td>\n<td>NO</td>\n</tr>\n<tr>\n<td>启动Activity</td>\n<td>NO1</td>\n<td>YES</td>\n<td>NO1</td>\n<td>NO1</td>\n<td>NO1</td>\n</tr>\n<tr>\n<td>Layout Inflation</td>\n<td>NO2</td>\n<td>YES</td>\n<td>NO2</td>\n<td>NO2</td>\n<td>NO2</td>\n</tr>\n<tr>\n<td>启动Service</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>绑定Service</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>NO</td>\n</tr>\n<tr>\n<td>发送Broadcast</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>注册BroadcastReceiver</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>NO3</td>\n</tr>\n<tr>\n<td>加载Resource</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n</tbody>\n</table>\n<p>需要注意的是：</p>\n<ul>\n<li>NO1：表示这些类的确可以开始一个Activity，但是它需要创建一个新的task。这可能会满足一些特定的需求，但是在你的应用中会创建一个不标准的回退栈（back stack），这通常是不推荐的或者不是最好的实践</li>\n<li>NO2：表示这些类去layout inflate是合法的，但是会使用系统默认的主题，如果你自定义了某些样式，可能不会被使用</li>\n<li>NO3：表示在receiver为null时允许，在4.2或以上的版本中，用于获取黏性广播的当前值。</li>\n</ul>\n<h3 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h3><p>对于UI相关的方法，都不建议或者不可使用Application，都应该使用Activity作为Context来处理。另外需要注意Context引用的持有，防止内存泄漏。</p>\n"},{"title":"Android 自定义注解","date":"2018-04-11T09:56:24.000Z","_content":"\n新建一个module，选择`Java Library`\n\n[auto-service](https://link.jianshu.com/?t=https://github.com/google/auto/tree/master/service)：Google 公司出品，用于自动为 JAVA Processor 生成 META-INF 信息。\n\n**AutoService**注解处理器是Google开发的，用来生成 **META-INF/services/javax.annotation.processing.Processor **文件的，你只需要在你定义的注解处理器上添加 @AutoService(Processor.class) 就可以了，简直不能再方便了。","source":"_posts/android/android-customer-annotations.md","raw":"---\ntitle: Android 自定义注解\ndate: 2018-04-11 17:56:24\ntags: android\n---\n\n新建一个module，选择`Java Library`\n\n[auto-service](https://link.jianshu.com/?t=https://github.com/google/auto/tree/master/service)：Google 公司出品，用于自动为 JAVA Processor 生成 META-INF 信息。\n\n**AutoService**注解处理器是Google开发的，用来生成 **META-INF/services/javax.annotation.processing.Processor **文件的，你只需要在你定义的注解处理器上添加 @AutoService(Processor.class) 就可以了，简直不能再方便了。","slug":"android/android-customer-annotations","published":1,"updated":"2018-05-20T13:04:25.680Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ed000mizcby4cxcgxt","content":"<p>新建一个module，选择<code>Java Library</code></p>\n<p><a href=\"https://link.jianshu.com/?t=https://github.com/google/auto/tree/master/service\" target=\"_blank\" rel=\"noopener\">auto-service</a>：Google 公司出品，用于自动为 JAVA Processor 生成 META-INF 信息。</p>\n<p><strong>AutoService</strong>注解处理器是Google开发的，用来生成 <strong>META-INF/services/javax.annotation.processing.Processor </strong>文件的，你只需要在你定义的注解处理器上添加 @AutoService(Processor.class) 就可以了，简直不能再方便了。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>新建一个module，选择<code>Java Library</code></p>\n<p><a href=\"https://link.jianshu.com/?t=https://github.com/google/auto/tree/master/service\" target=\"_blank\" rel=\"noopener\">auto-service</a>：Google 公司出品，用于自动为 JAVA Processor 生成 META-INF 信息。</p>\n<p><strong>AutoService</strong>注解处理器是Google开发的，用来生成 <strong>META-INF/services/javax.annotation.processing.Processor </strong>文件的，你只需要在你定义的注解处理器上添加 @AutoService(Processor.class) 就可以了，简直不能再方便了。</p>\n"},{"title":"android-guides","date":"2017-02-13T08:33:02.000Z","_content":"\n## 基本用法\n### Button\n对于Button上的文本，系统会对Button中的所有英文字母自动进行大写转换，如果这不是你想要的效果，可以使用如下配置来禁用这一默认特性\n```java\n// android:textAllCaps=\"false\"\n<Button\n  \tandroid:id=\"@+id/button\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:text=\"Button\"\n    android:textAllCaps=\"false\" />\n```\n\n<!--more-->\n\n### ProgressBar\n\n```java\n// style 默认圆形\nstyle=\"?android:attr/progressBarStyleLarge\"\nstyle=\"?android:attr/progressBarStyleSmall\"\nstyle=\"?android:attr/progressBarStyleSmallTitle\"\nstyle=\"?android:attr/progressBarStyleHorizonal\" //水平\n```\n\n### ProgressDialog\n\n### Broadcast \n\n> 不允许开启线程，不能做耗时操作(10秒左右)\n>\n> 注册：registerReceiver(本地广播需要使用LocalBroadcastManager)\n>\n> 取消注册：unregisterReceiver\n\n##### 广播类型：\n\n- 无序广播(默认)：所有广播接收器都可以接受到。调用`sendBroadcast()`发送广播\n\n- 有序广播：优先级比较高的广播接收器(`android:priority`)可以先收到广播，使用`abortBroadcast`可以截断广播。调用`sendOrderedBroadcast`发送广播\n\n  ```java\n  <intent-filter android:priority=\"100\">\n  \t......\n  </intent-filter>\n  ```\n\n- 本地广播：发出的广播只能本程序才能收到。调用`LocalBroadcastManager`的`sendBroadcast`发送广播\n\n##### ACTION\n\n```java\nandroid.net.conn.CONNECTIVITY_CHANGE // 网络状态发生变化  权限：ACCESS_NETWORK_STATE\nandroid.intent.action.BOOT_COMPLETED // 开机广播 权限：RECEIVE_BOOT_COMPLETED\n```\n\n### Shader\n\n\n\n## 权限\n\n> 可以使用[RxPermissions](https://github.com/tbruyelle/RxPermissions)简化权限操作\n\n下表列出了Android中所有的危险权限，一共是9组24个权限。\n\n|    权限组名    |                   权限名                    |\n| :--------: | :--------------------------------------: |\n|  CALENDAR  |     READ_CALENDAR<br>WRITE_CALENDAR      |\n|   CAMERA   |                  CAMERA                  |\n|  CONTACTS  | READ_CONTACTS<br>WRITE_CONTACTS<br>GET_ACCOUNTS |\n|  LOCATION  | ACCESS_FINE_LOCATION<br>ACCESS_COARSE_LOCATION |\n| MICROPHONE |               RECORD_AUDIO               |\n|   PHONE    | READ_PHONE_STATE<br>CALL_PHONE<br>READ_CALL_LOG<br>WRITE_CALL_LOG<br>ADD_VOICEMAIL<br>USE_SIP<br>PROCESS_OUTGOING_CALLS |\n|  SENSORS   |               BODY_SENSORS               |\n|    SMS     | SEND_SMS<br>RECCEIVE_SMS<br>READ_SMS<br>RECEIVE_WAP_PUSH<br>RECEIVE_MMS |\n|  STORAGE   | READ_EXTERNAL_STORAGE<br>WRITE_EXTERNAL_STORAGE |\n\n| 密度             | 建议尺寸      |\n| -------------- | --------- |\n| mipmap-mdpi    | 48 * 48   |\n| mipmap-hdpi    | 72 * 72   |\n| mipmap-xhdpi   | 96 * 96   |\n| mipmap-xxhdpi  | 144 * 144 |\n| mipmap-xxxhdpi | 192 * 192 |\n\nfloat xdpi = getResources().getDisplayMetrics().xdpi;\nfloat ydpi = getResources().getDisplayMetrics().ydpi;\n\n| dpi范围           | 密度      |\n| --------------- | ------- |\n| 0dpi ~ 120dpi   | ldpi    |\n| 120dpi ~ 160dpi | mdpi    |\n| 160dpi ~ 240dpi | hdpi    |\n| 240dpi ~ 320dpi | xhdpi   |\n| 320dpi ~ 480dpi | xxhdpi  |\n| 480dpi ~ 640dpi | xxxhdpi |\n\n**子线程更新UI**\n\n因为在 OnCreate 的 时候，View 是还没有被 ViewRootImpl\n加载到 Window，所以子线程修改 View 的代码没有经过 ViewRootImpl 的检测。贯穿全文，就告诉了大家在 onResum 之前在子线程可以修改 UI，具体原因没讲清楚。可以讲讲 contentView 是怎样被ViewRootImplement 加载到 Window。Window、Activity、View、ViewRootImpl 之间的关系？","source":"_posts/android/android-guides.md","raw":"---\ntitle: android-guides\ndate: 2017-02-13 16:33:02\ntags: android\n---\n\n## 基本用法\n### Button\n对于Button上的文本，系统会对Button中的所有英文字母自动进行大写转换，如果这不是你想要的效果，可以使用如下配置来禁用这一默认特性\n```java\n// android:textAllCaps=\"false\"\n<Button\n  \tandroid:id=\"@+id/button\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:text=\"Button\"\n    android:textAllCaps=\"false\" />\n```\n\n<!--more-->\n\n### ProgressBar\n\n```java\n// style 默认圆形\nstyle=\"?android:attr/progressBarStyleLarge\"\nstyle=\"?android:attr/progressBarStyleSmall\"\nstyle=\"?android:attr/progressBarStyleSmallTitle\"\nstyle=\"?android:attr/progressBarStyleHorizonal\" //水平\n```\n\n### ProgressDialog\n\n### Broadcast \n\n> 不允许开启线程，不能做耗时操作(10秒左右)\n>\n> 注册：registerReceiver(本地广播需要使用LocalBroadcastManager)\n>\n> 取消注册：unregisterReceiver\n\n##### 广播类型：\n\n- 无序广播(默认)：所有广播接收器都可以接受到。调用`sendBroadcast()`发送广播\n\n- 有序广播：优先级比较高的广播接收器(`android:priority`)可以先收到广播，使用`abortBroadcast`可以截断广播。调用`sendOrderedBroadcast`发送广播\n\n  ```java\n  <intent-filter android:priority=\"100\">\n  \t......\n  </intent-filter>\n  ```\n\n- 本地广播：发出的广播只能本程序才能收到。调用`LocalBroadcastManager`的`sendBroadcast`发送广播\n\n##### ACTION\n\n```java\nandroid.net.conn.CONNECTIVITY_CHANGE // 网络状态发生变化  权限：ACCESS_NETWORK_STATE\nandroid.intent.action.BOOT_COMPLETED // 开机广播 权限：RECEIVE_BOOT_COMPLETED\n```\n\n### Shader\n\n\n\n## 权限\n\n> 可以使用[RxPermissions](https://github.com/tbruyelle/RxPermissions)简化权限操作\n\n下表列出了Android中所有的危险权限，一共是9组24个权限。\n\n|    权限组名    |                   权限名                    |\n| :--------: | :--------------------------------------: |\n|  CALENDAR  |     READ_CALENDAR<br>WRITE_CALENDAR      |\n|   CAMERA   |                  CAMERA                  |\n|  CONTACTS  | READ_CONTACTS<br>WRITE_CONTACTS<br>GET_ACCOUNTS |\n|  LOCATION  | ACCESS_FINE_LOCATION<br>ACCESS_COARSE_LOCATION |\n| MICROPHONE |               RECORD_AUDIO               |\n|   PHONE    | READ_PHONE_STATE<br>CALL_PHONE<br>READ_CALL_LOG<br>WRITE_CALL_LOG<br>ADD_VOICEMAIL<br>USE_SIP<br>PROCESS_OUTGOING_CALLS |\n|  SENSORS   |               BODY_SENSORS               |\n|    SMS     | SEND_SMS<br>RECCEIVE_SMS<br>READ_SMS<br>RECEIVE_WAP_PUSH<br>RECEIVE_MMS |\n|  STORAGE   | READ_EXTERNAL_STORAGE<br>WRITE_EXTERNAL_STORAGE |\n\n| 密度             | 建议尺寸      |\n| -------------- | --------- |\n| mipmap-mdpi    | 48 * 48   |\n| mipmap-hdpi    | 72 * 72   |\n| mipmap-xhdpi   | 96 * 96   |\n| mipmap-xxhdpi  | 144 * 144 |\n| mipmap-xxxhdpi | 192 * 192 |\n\nfloat xdpi = getResources().getDisplayMetrics().xdpi;\nfloat ydpi = getResources().getDisplayMetrics().ydpi;\n\n| dpi范围           | 密度      |\n| --------------- | ------- |\n| 0dpi ~ 120dpi   | ldpi    |\n| 120dpi ~ 160dpi | mdpi    |\n| 160dpi ~ 240dpi | hdpi    |\n| 240dpi ~ 320dpi | xhdpi   |\n| 320dpi ~ 480dpi | xxhdpi  |\n| 480dpi ~ 640dpi | xxxhdpi |\n\n**子线程更新UI**\n\n因为在 OnCreate 的 时候，View 是还没有被 ViewRootImpl\n加载到 Window，所以子线程修改 View 的代码没有经过 ViewRootImpl 的检测。贯穿全文，就告诉了大家在 onResum 之前在子线程可以修改 UI，具体原因没讲清楚。可以讲讲 contentView 是怎样被ViewRootImplement 加载到 Window。Window、Activity、View、ViewRootImpl 之间的关系？","slug":"android/android-guides","published":1,"updated":"2018-01-31T09:35:37.813Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ed000pizcbt426qlkk","content":"<h2 id=\"基本用法\"><a href=\"#基本用法\" class=\"headerlink\" title=\"基本用法\"></a>基本用法</h2><h3 id=\"Button\"><a href=\"#Button\" class=\"headerlink\" title=\"Button\"></a>Button</h3><p>对于Button上的文本，系统会对Button中的所有英文字母自动进行大写转换，如果这不是你想要的效果，可以使用如下配置来禁用这一默认特性<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// android:textAllCaps=\"false\"</span></span><br><span class=\"line\">&lt;Button</span><br><span class=\"line\">  \tandroid:id=<span class=\"string\">\"@+id/button\"</span></span><br><span class=\"line\">    android:layout_width=<span class=\"string\">\"match_parent\"</span></span><br><span class=\"line\">    android:layout_height=<span class=\"string\">\"wrap_content\"</span></span><br><span class=\"line\">    android:text=<span class=\"string\">\"Button\"</span></span><br><span class=\"line\">    android:textAllCaps=<span class=\"string\">\"false\"</span> /&gt;</span><br></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h3 id=\"ProgressBar\"><a href=\"#ProgressBar\" class=\"headerlink\" title=\"ProgressBar\"></a>ProgressBar</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// style 默认圆形</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleLarge\"</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleSmall\"</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleSmallTitle\"</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleHorizonal\"</span> <span class=\"comment\">//水平</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"ProgressDialog\"><a href=\"#ProgressDialog\" class=\"headerlink\" title=\"ProgressDialog\"></a>ProgressDialog</h3><h3 id=\"Broadcast\"><a href=\"#Broadcast\" class=\"headerlink\" title=\"Broadcast\"></a>Broadcast</h3><blockquote>\n<p>不允许开启线程，不能做耗时操作(10秒左右)</p>\n<p>注册：registerReceiver(本地广播需要使用LocalBroadcastManager)</p>\n<p>取消注册：unregisterReceiver</p>\n</blockquote>\n<h5 id=\"广播类型：\"><a href=\"#广播类型：\" class=\"headerlink\" title=\"广播类型：\"></a>广播类型：</h5><ul>\n<li><p>无序广播(默认)：所有广播接收器都可以接受到。调用<code>sendBroadcast()</code>发送广播</p>\n</li>\n<li><p>有序广播：优先级比较高的广播接收器(<code>android:priority</code>)可以先收到广播，使用<code>abortBroadcast</code>可以截断广播。调用<code>sendOrderedBroadcast</code>发送广播</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;intent-filter android:priority=<span class=\"string\">\"100\"</span>&gt;</span><br><span class=\"line\">\t......</span><br><span class=\"line\">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>本地广播：发出的广播只能本程序才能收到。调用<code>LocalBroadcastManager</code>的<code>sendBroadcast</code>发送广播</p>\n</li>\n</ul>\n<h5 id=\"ACTION\"><a href=\"#ACTION\" class=\"headerlink\" title=\"ACTION\"></a>ACTION</h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android.net.conn.CONNECTIVITY_CHANGE <span class=\"comment\">// 网络状态发生变化  权限：ACCESS_NETWORK_STATE</span></span><br><span class=\"line\">android.intent.action.BOOT_COMPLETED <span class=\"comment\">// 开机广播 权限：RECEIVE_BOOT_COMPLETED</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Shader\"><a href=\"#Shader\" class=\"headerlink\" title=\"Shader\"></a>Shader</h3><h2 id=\"权限\"><a href=\"#权限\" class=\"headerlink\" title=\"权限\"></a>权限</h2><blockquote>\n<p>可以使用<a href=\"https://github.com/tbruyelle/RxPermissions\" target=\"_blank\" rel=\"noopener\">RxPermissions</a>简化权限操作</p>\n</blockquote>\n<p>下表列出了Android中所有的危险权限，一共是9组24个权限。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">权限组名</th>\n<th style=\"text-align:center\">权限名</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CALENDAR</td>\n<td style=\"text-align:center\">READ_CALENDAR<br>WRITE_CALENDAR</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CAMERA</td>\n<td style=\"text-align:center\">CAMERA</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONTACTS</td>\n<td style=\"text-align:center\">READ_CONTACTS<br>WRITE_CONTACTS<br>GET_ACCOUNTS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">LOCATION</td>\n<td style=\"text-align:center\">ACCESS_FINE_LOCATION<br>ACCESS_COARSE_LOCATION</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MICROPHONE</td>\n<td style=\"text-align:center\">RECORD_AUDIO</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">PHONE</td>\n<td style=\"text-align:center\">READ_PHONE_STATE<br>CALL_PHONE<br>READ_CALL_LOG<br>WRITE_CALL_LOG<br>ADD_VOICEMAIL<br>USE_SIP<br>PROCESS_OUTGOING_CALLS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SENSORS</td>\n<td style=\"text-align:center\">BODY_SENSORS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SMS</td>\n<td style=\"text-align:center\">SEND_SMS<br>RECCEIVE_SMS<br>READ_SMS<br>RECEIVE_WAP_PUSH<br>RECEIVE_MMS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">STORAGE</td>\n<td style=\"text-align:center\">READ_EXTERNAL_STORAGE<br>WRITE_EXTERNAL_STORAGE</td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>密度</th>\n<th>建议尺寸</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>mipmap-mdpi</td>\n<td>48 * 48</td>\n</tr>\n<tr>\n<td>mipmap-hdpi</td>\n<td>72 * 72</td>\n</tr>\n<tr>\n<td>mipmap-xhdpi</td>\n<td>96 * 96</td>\n</tr>\n<tr>\n<td>mipmap-xxhdpi</td>\n<td>144 * 144</td>\n</tr>\n<tr>\n<td>mipmap-xxxhdpi</td>\n<td>192 * 192</td>\n</tr>\n</tbody>\n</table>\n<p>float xdpi = getResources().getDisplayMetrics().xdpi;<br>float ydpi = getResources().getDisplayMetrics().ydpi;</p>\n<table>\n<thead>\n<tr>\n<th>dpi范围</th>\n<th>密度</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0dpi ~ 120dpi</td>\n<td>ldpi</td>\n</tr>\n<tr>\n<td>120dpi ~ 160dpi</td>\n<td>mdpi</td>\n</tr>\n<tr>\n<td>160dpi ~ 240dpi</td>\n<td>hdpi</td>\n</tr>\n<tr>\n<td>240dpi ~ 320dpi</td>\n<td>xhdpi</td>\n</tr>\n<tr>\n<td>320dpi ~ 480dpi</td>\n<td>xxhdpi</td>\n</tr>\n<tr>\n<td>480dpi ~ 640dpi</td>\n<td>xxxhdpi</td>\n</tr>\n</tbody>\n</table>\n<p><strong>子线程更新UI</strong></p>\n<p>因为在 OnCreate 的 时候，View 是还没有被 ViewRootImpl<br>加载到 Window，所以子线程修改 View 的代码没有经过 ViewRootImpl 的检测。贯穿全文，就告诉了大家在 onResum 之前在子线程可以修改 UI，具体原因没讲清楚。可以讲讲 contentView 是怎样被ViewRootImplement 加载到 Window。Window、Activity、View、ViewRootImpl 之间的关系？</p>\n","site":{"data":{}},"excerpt":"<h2 id=\"基本用法\"><a href=\"#基本用法\" class=\"headerlink\" title=\"基本用法\"></a>基本用法</h2><h3 id=\"Button\"><a href=\"#Button\" class=\"headerlink\" title=\"Button\"></a>Button</h3><p>对于Button上的文本，系统会对Button中的所有英文字母自动进行大写转换，如果这不是你想要的效果，可以使用如下配置来禁用这一默认特性<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// android:textAllCaps=\"false\"</span></span><br><span class=\"line\">&lt;Button</span><br><span class=\"line\">  \tandroid:id=<span class=\"string\">\"@+id/button\"</span></span><br><span class=\"line\">    android:layout_width=<span class=\"string\">\"match_parent\"</span></span><br><span class=\"line\">    android:layout_height=<span class=\"string\">\"wrap_content\"</span></span><br><span class=\"line\">    android:text=<span class=\"string\">\"Button\"</span></span><br><span class=\"line\">    android:textAllCaps=<span class=\"string\">\"false\"</span> /&gt;</span><br></pre></td></tr></table></figure></p>","more":"<h3 id=\"ProgressBar\"><a href=\"#ProgressBar\" class=\"headerlink\" title=\"ProgressBar\"></a>ProgressBar</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// style 默认圆形</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleLarge\"</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleSmall\"</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleSmallTitle\"</span></span><br><span class=\"line\">style=<span class=\"string\">\"?android:attr/progressBarStyleHorizonal\"</span> <span class=\"comment\">//水平</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"ProgressDialog\"><a href=\"#ProgressDialog\" class=\"headerlink\" title=\"ProgressDialog\"></a>ProgressDialog</h3><h3 id=\"Broadcast\"><a href=\"#Broadcast\" class=\"headerlink\" title=\"Broadcast\"></a>Broadcast</h3><blockquote>\n<p>不允许开启线程，不能做耗时操作(10秒左右)</p>\n<p>注册：registerReceiver(本地广播需要使用LocalBroadcastManager)</p>\n<p>取消注册：unregisterReceiver</p>\n</blockquote>\n<h5 id=\"广播类型：\"><a href=\"#广播类型：\" class=\"headerlink\" title=\"广播类型：\"></a>广播类型：</h5><ul>\n<li><p>无序广播(默认)：所有广播接收器都可以接受到。调用<code>sendBroadcast()</code>发送广播</p>\n</li>\n<li><p>有序广播：优先级比较高的广播接收器(<code>android:priority</code>)可以先收到广播，使用<code>abortBroadcast</code>可以截断广播。调用<code>sendOrderedBroadcast</code>发送广播</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;intent-filter android:priority=<span class=\"string\">\"100\"</span>&gt;</span><br><span class=\"line\">\t......</span><br><span class=\"line\">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>本地广播：发出的广播只能本程序才能收到。调用<code>LocalBroadcastManager</code>的<code>sendBroadcast</code>发送广播</p>\n</li>\n</ul>\n<h5 id=\"ACTION\"><a href=\"#ACTION\" class=\"headerlink\" title=\"ACTION\"></a>ACTION</h5><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android.net.conn.CONNECTIVITY_CHANGE <span class=\"comment\">// 网络状态发生变化  权限：ACCESS_NETWORK_STATE</span></span><br><span class=\"line\">android.intent.action.BOOT_COMPLETED <span class=\"comment\">// 开机广播 权限：RECEIVE_BOOT_COMPLETED</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Shader\"><a href=\"#Shader\" class=\"headerlink\" title=\"Shader\"></a>Shader</h3><h2 id=\"权限\"><a href=\"#权限\" class=\"headerlink\" title=\"权限\"></a>权限</h2><blockquote>\n<p>可以使用<a href=\"https://github.com/tbruyelle/RxPermissions\" target=\"_blank\" rel=\"noopener\">RxPermissions</a>简化权限操作</p>\n</blockquote>\n<p>下表列出了Android中所有的危险权限，一共是9组24个权限。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">权限组名</th>\n<th style=\"text-align:center\">权限名</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CALENDAR</td>\n<td style=\"text-align:center\">READ_CALENDAR<br>WRITE_CALENDAR</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CAMERA</td>\n<td style=\"text-align:center\">CAMERA</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONTACTS</td>\n<td style=\"text-align:center\">READ_CONTACTS<br>WRITE_CONTACTS<br>GET_ACCOUNTS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">LOCATION</td>\n<td style=\"text-align:center\">ACCESS_FINE_LOCATION<br>ACCESS_COARSE_LOCATION</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MICROPHONE</td>\n<td style=\"text-align:center\">RECORD_AUDIO</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">PHONE</td>\n<td style=\"text-align:center\">READ_PHONE_STATE<br>CALL_PHONE<br>READ_CALL_LOG<br>WRITE_CALL_LOG<br>ADD_VOICEMAIL<br>USE_SIP<br>PROCESS_OUTGOING_CALLS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SENSORS</td>\n<td style=\"text-align:center\">BODY_SENSORS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SMS</td>\n<td style=\"text-align:center\">SEND_SMS<br>RECCEIVE_SMS<br>READ_SMS<br>RECEIVE_WAP_PUSH<br>RECEIVE_MMS</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">STORAGE</td>\n<td style=\"text-align:center\">READ_EXTERNAL_STORAGE<br>WRITE_EXTERNAL_STORAGE</td>\n</tr>\n</tbody>\n</table>\n<table>\n<thead>\n<tr>\n<th>密度</th>\n<th>建议尺寸</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>mipmap-mdpi</td>\n<td>48 * 48</td>\n</tr>\n<tr>\n<td>mipmap-hdpi</td>\n<td>72 * 72</td>\n</tr>\n<tr>\n<td>mipmap-xhdpi</td>\n<td>96 * 96</td>\n</tr>\n<tr>\n<td>mipmap-xxhdpi</td>\n<td>144 * 144</td>\n</tr>\n<tr>\n<td>mipmap-xxxhdpi</td>\n<td>192 * 192</td>\n</tr>\n</tbody>\n</table>\n<p>float xdpi = getResources().getDisplayMetrics().xdpi;<br>float ydpi = getResources().getDisplayMetrics().ydpi;</p>\n<table>\n<thead>\n<tr>\n<th>dpi范围</th>\n<th>密度</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0dpi ~ 120dpi</td>\n<td>ldpi</td>\n</tr>\n<tr>\n<td>120dpi ~ 160dpi</td>\n<td>mdpi</td>\n</tr>\n<tr>\n<td>160dpi ~ 240dpi</td>\n<td>hdpi</td>\n</tr>\n<tr>\n<td>240dpi ~ 320dpi</td>\n<td>xhdpi</td>\n</tr>\n<tr>\n<td>320dpi ~ 480dpi</td>\n<td>xxhdpi</td>\n</tr>\n<tr>\n<td>480dpi ~ 640dpi</td>\n<td>xxxhdpi</td>\n</tr>\n</tbody>\n</table>\n<p><strong>子线程更新UI</strong></p>\n<p>因为在 OnCreate 的 时候，View 是还没有被 ViewRootImpl<br>加载到 Window，所以子线程修改 View 的代码没有经过 ViewRootImpl 的检测。贯穿全文，就告诉了大家在 onResum 之前在子线程可以修改 UI，具体原因没讲清楚。可以讲讲 contentView 是怎样被ViewRootImplement 加载到 Window。Window、Activity、View、ViewRootImpl 之间的关系？</p>"},{"title":"android-okhttp-流程简析","date":"2017-03-10T06:51:38.000Z","_content":"\n### 前言\n\n> **OkHttp进行网络请求不是基于HttpURLConnection，而是基于socket。本篇只是对源码流程的简析。**\n\n### 源码分析Request\n\n> 不熟悉如何使用OKHttp3的同学，可以先阅读android-okhttp章节\n\n在使用OKHttp3进行网络请求时，我们会使用下面2种方式进行调用\n\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\n// 同步\nResponse response = client.newCall(request).execute();\n// 异步\nclient.newCall(request).enqueue(new Callback() {\n    @Override \n    public void onFailure(Call call, IOException e) {\n    }\n\n    @Override \n    public void onResponse(Call call, Response response) throws IOException {\n    }\n});\n```\n\n从上面的代码可以看出，会先调用`newCall(request)`方法获取一个`Call`对象，再调用`Call`对象的`excute`方法或`enqueue`方法执行同步或异步请求。\n\n<!--more-->\n\n接下来，我们来看看源码:\n![okhttpclient01](/img/okhttp/okhttpclient01.jpg)\n\n我们来看看`newCall`方法，该方法返回了一个`RealCall`对象\n\n![realcall01](/img/okhttp/realcall01.jpg)\n\n我们来看看execute和enqueue方法，我们可以看到这2个方法都用到了client.dispatcher()，这个方法得到的是一个Dispatcher对象，如下图：\n\n![dispatcher01](/img/okhttp/dispatcher01.jpg)\n\nDispatcher类设置了一个最大的请求数，定义了一些双队列用于存储request请求，同时定义了一个ExecutorService线程池用于执行异步请求。我们来看看Dispatcher的enqueue方法\n\n![dispatcher02](/img/okhttp/dispatcher02.jpg)\n\n在Dispatcher的enqueue方法中，会使用创建的线程池执行AsyncCall，我们再来看看AsyncCall的实现\n\n![realcall02](/img/okhttp/realcall02.jpg)\n\n大家看图中标红的地方，是不是和我们RealCall同步execute方法很像，都是调用了`getResponseWithInterceptorChain`方法返回`response`，而且我们也可以知道**onFailure**和**onResponse**回调的逻辑了\n\n我们再来持看`getResponseWithInterceptorChain`方法\n\n![realcall03](/img/okhttp/realcall03.jpg)\n\n在`getResponseWithInterceptorChain`方法内部，会定义一个List，装载你自己定义的拦截器和一些Okhttp3定义的拦截器，最后会调用`RealInterceptorChain`类的proceed方法去递归调用List中的拦截器的intercept方法，\n\n![realinterceptorchain01](/img/okhttp/realinterceptorchain01.jpg)\n\n我们来看看`ConnectInterceptor`拦截器，通过名字我们大概能知道是做网络连接用的。\n\n![realinterceptorchain01](/img/okhttp/connectinterceptor01.jpg)\n\n在`ConnectInterceptor`的intercept方法中会用调用StreamAllocation类的newStream获取HttpStream对象，调用connection方法得到RealConnection对象，在connection方法里面仅仅是返回了一个对象，那么RealConnection对象是怎么生成的呢，我们大概可以猜到是在newStream里生成的。我们来看看newStream方法\n\n![streamallocation01](/img/okhttp/streamallocation01.jpg)\n\n在方法内部，大家可以看到是调用了`findHealthyConnection`方法获取到了`RealConnection`对象，同时会把RealConnection的数据(**source/sink**)存放在**Http1xStream **OR **Http2xStream**中(大家先记住这一点，后面获取Reaponse时会用到**Http1xStream**或**Http2xStream**的数据)。在方法`findHealthyConnection`内部，会调用`findConnection`方法\n\n![streamallocation02](/img/okhttp/streamallocation02.jpg)\n\n在`findConnection`方法内部，最终会调到`193`行的`connect`方法，接下来，我们看看RealConnection的connect方法。\n\n![realconnection01](/img/okhttp/realconnection01.jpg)\n\n在connect方法的内部，最终会调用buildTunneledConnection或buildConnection方法，这2个方法最终都会调用RealConnection的connectSocket方法和establishProtocol方法。在connectSocket方法内部，会进行socket进行数据传输，在establishProtocol方法内部，会使用Okio进行数据流的读取，并给RealConnection的source和sink进行赋值，这个值会存储在后续Response的body中。\n\n![realconnection02](/img/okhttp/realconnection02.jpg)\n\n从上图可以看出，在connectSocket内部，会调用Platform的get方法获取相应平台，并调用Platform的connectSocket方法进行socket连接。\n\n![platform01](/img/okhttp/platform01.jpg)\n**至此，我们知道了Okhttp3是通过socket进行数据传输的，同时request请求大致也清楚了**\n\n\n\n### 源码分析Response\n\n在上面的**Request**分析篇中，大家还记得，在RealCall的`getResponseWithInterceptorChain`方法吗\n\n![realcall03](/img/okhttp/realcall03.jpg)\n\n我们在这个方法分析了`ConnectInterceptor`拦截器中的网络请求流程，在这个方法的最后，会调用`CallServerInterceptor`拦截器去进行Response的结果获取，接下来，我们来看看`CallServerInterceptor`\n\n![callserverinterceptor01](/img/okhttp/callserverinterceptor01.jpg)\n\n大家看第**62**行，**Response**的**body**就是在这赋值的，这里的**httpStream**就是我们**Request**篇叫大家记住的**Http1xStream**或**Http2xStream**，这2种**httpStream**流程差不多，我们这里以**Http1xStream**为例来分析\n\n![http1xstream](/img/okhttp/http1xstream.jpg)\n\n这里比较简单，调用**openResponseBody**返回一个**RealResponseBody**对象返回，在方法内部先调用**getTransferStream**方法获取一个**source**对象，然后生成一个**RealResponseBody**对象进行返回。熟悉Okhttp3用法的同学应该知道，在**onResponse**回调里，我们会使用**response.body.string()**获取字符串或**response.body.byteStream()**获取流对象。通过上面对**CallServerInterceptor**拦截器的分析(第**62**行)，我们知道**response.body**就是调用**httpStream**的**openResponseBody**方法返回的**RealResponseBody**，我们再来看看**RealResponseBody**类\n\n![responsebody01](/img/okhttp/responsebody01.jpg)\n\n通过上面的源码，我们可以看出，其它就是调用了**source**的一些方法进行数据处理，然后返回，这里的source就是我们**Request**分析篇中**RealConnection**的**source**\n\n**至此，response整个流程也大致清楚了**","source":"_posts/android/android-okhttp-source.md","raw":"---\ntitle: android-okhttp-流程简析\ndate: 2017-03-10 14:51:38\ntags: android\n---\n\n### 前言\n\n> **OkHttp进行网络请求不是基于HttpURLConnection，而是基于socket。本篇只是对源码流程的简析。**\n\n### 源码分析Request\n\n> 不熟悉如何使用OKHttp3的同学，可以先阅读android-okhttp章节\n\n在使用OKHttp3进行网络请求时，我们会使用下面2种方式进行调用\n\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\n// 同步\nResponse response = client.newCall(request).execute();\n// 异步\nclient.newCall(request).enqueue(new Callback() {\n    @Override \n    public void onFailure(Call call, IOException e) {\n    }\n\n    @Override \n    public void onResponse(Call call, Response response) throws IOException {\n    }\n});\n```\n\n从上面的代码可以看出，会先调用`newCall(request)`方法获取一个`Call`对象，再调用`Call`对象的`excute`方法或`enqueue`方法执行同步或异步请求。\n\n<!--more-->\n\n接下来，我们来看看源码:\n![okhttpclient01](/img/okhttp/okhttpclient01.jpg)\n\n我们来看看`newCall`方法，该方法返回了一个`RealCall`对象\n\n![realcall01](/img/okhttp/realcall01.jpg)\n\n我们来看看execute和enqueue方法，我们可以看到这2个方法都用到了client.dispatcher()，这个方法得到的是一个Dispatcher对象，如下图：\n\n![dispatcher01](/img/okhttp/dispatcher01.jpg)\n\nDispatcher类设置了一个最大的请求数，定义了一些双队列用于存储request请求，同时定义了一个ExecutorService线程池用于执行异步请求。我们来看看Dispatcher的enqueue方法\n\n![dispatcher02](/img/okhttp/dispatcher02.jpg)\n\n在Dispatcher的enqueue方法中，会使用创建的线程池执行AsyncCall，我们再来看看AsyncCall的实现\n\n![realcall02](/img/okhttp/realcall02.jpg)\n\n大家看图中标红的地方，是不是和我们RealCall同步execute方法很像，都是调用了`getResponseWithInterceptorChain`方法返回`response`，而且我们也可以知道**onFailure**和**onResponse**回调的逻辑了\n\n我们再来持看`getResponseWithInterceptorChain`方法\n\n![realcall03](/img/okhttp/realcall03.jpg)\n\n在`getResponseWithInterceptorChain`方法内部，会定义一个List，装载你自己定义的拦截器和一些Okhttp3定义的拦截器，最后会调用`RealInterceptorChain`类的proceed方法去递归调用List中的拦截器的intercept方法，\n\n![realinterceptorchain01](/img/okhttp/realinterceptorchain01.jpg)\n\n我们来看看`ConnectInterceptor`拦截器，通过名字我们大概能知道是做网络连接用的。\n\n![realinterceptorchain01](/img/okhttp/connectinterceptor01.jpg)\n\n在`ConnectInterceptor`的intercept方法中会用调用StreamAllocation类的newStream获取HttpStream对象，调用connection方法得到RealConnection对象，在connection方法里面仅仅是返回了一个对象，那么RealConnection对象是怎么生成的呢，我们大概可以猜到是在newStream里生成的。我们来看看newStream方法\n\n![streamallocation01](/img/okhttp/streamallocation01.jpg)\n\n在方法内部，大家可以看到是调用了`findHealthyConnection`方法获取到了`RealConnection`对象，同时会把RealConnection的数据(**source/sink**)存放在**Http1xStream **OR **Http2xStream**中(大家先记住这一点，后面获取Reaponse时会用到**Http1xStream**或**Http2xStream**的数据)。在方法`findHealthyConnection`内部，会调用`findConnection`方法\n\n![streamallocation02](/img/okhttp/streamallocation02.jpg)\n\n在`findConnection`方法内部，最终会调到`193`行的`connect`方法，接下来，我们看看RealConnection的connect方法。\n\n![realconnection01](/img/okhttp/realconnection01.jpg)\n\n在connect方法的内部，最终会调用buildTunneledConnection或buildConnection方法，这2个方法最终都会调用RealConnection的connectSocket方法和establishProtocol方法。在connectSocket方法内部，会进行socket进行数据传输，在establishProtocol方法内部，会使用Okio进行数据流的读取，并给RealConnection的source和sink进行赋值，这个值会存储在后续Response的body中。\n\n![realconnection02](/img/okhttp/realconnection02.jpg)\n\n从上图可以看出，在connectSocket内部，会调用Platform的get方法获取相应平台，并调用Platform的connectSocket方法进行socket连接。\n\n![platform01](/img/okhttp/platform01.jpg)\n**至此，我们知道了Okhttp3是通过socket进行数据传输的，同时request请求大致也清楚了**\n\n\n\n### 源码分析Response\n\n在上面的**Request**分析篇中，大家还记得，在RealCall的`getResponseWithInterceptorChain`方法吗\n\n![realcall03](/img/okhttp/realcall03.jpg)\n\n我们在这个方法分析了`ConnectInterceptor`拦截器中的网络请求流程，在这个方法的最后，会调用`CallServerInterceptor`拦截器去进行Response的结果获取，接下来，我们来看看`CallServerInterceptor`\n\n![callserverinterceptor01](/img/okhttp/callserverinterceptor01.jpg)\n\n大家看第**62**行，**Response**的**body**就是在这赋值的，这里的**httpStream**就是我们**Request**篇叫大家记住的**Http1xStream**或**Http2xStream**，这2种**httpStream**流程差不多，我们这里以**Http1xStream**为例来分析\n\n![http1xstream](/img/okhttp/http1xstream.jpg)\n\n这里比较简单，调用**openResponseBody**返回一个**RealResponseBody**对象返回，在方法内部先调用**getTransferStream**方法获取一个**source**对象，然后生成一个**RealResponseBody**对象进行返回。熟悉Okhttp3用法的同学应该知道，在**onResponse**回调里，我们会使用**response.body.string()**获取字符串或**response.body.byteStream()**获取流对象。通过上面对**CallServerInterceptor**拦截器的分析(第**62**行)，我们知道**response.body**就是调用**httpStream**的**openResponseBody**方法返回的**RealResponseBody**，我们再来看看**RealResponseBody**类\n\n![responsebody01](/img/okhttp/responsebody01.jpg)\n\n通过上面的源码，我们可以看出，其它就是调用了**source**的一些方法进行数据处理，然后返回，这里的source就是我们**Request**分析篇中**RealConnection**的**source**\n\n**至此，response整个流程也大致清楚了**","slug":"android/android-okhttp-source","published":1,"updated":"2018-01-31T09:35:37.813Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ee000qizcbnnp18uj1","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><blockquote>\n<p><strong>OkHttp进行网络请求不是基于HttpURLConnection，而是基于socket。本篇只是对源码流程的简析。</strong></p>\n</blockquote>\n<h3 id=\"源码分析Request\"><a href=\"#源码分析Request\" class=\"headerlink\" title=\"源码分析Request\"></a>源码分析Request</h3><blockquote>\n<p>不熟悉如何使用OKHttp3的同学，可以先阅读android-okhttp章节</p>\n</blockquote>\n<p>在使用OKHttp3进行网络请求时，我们会使用下面2种方式进行调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 同步</span></span><br><span class=\"line\">Response response = client.newCall(request).execute();</span><br><span class=\"line\"><span class=\"comment\">// 异步</span></span><br><span class=\"line\">client.newCall(request).enqueue(<span class=\"keyword\">new</span> Callback() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call call, IOException e)</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call call, Response response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>从上面的代码可以看出，会先调用<code>newCall(request)</code>方法获取一个<code>Call</code>对象，再调用<code>Call</code>对象的<code>excute</code>方法或<code>enqueue</code>方法执行同步或异步请求。</p>\n<a id=\"more\"></a>\n<p>接下来，我们来看看源码:<br><img src=\"/img/okhttp/okhttpclient01.jpg\" alt=\"okhttpclient01\"></p>\n<p>我们来看看<code>newCall</code>方法，该方法返回了一个<code>RealCall</code>对象</p>\n<p><img src=\"/img/okhttp/realcall01.jpg\" alt=\"realcall01\"></p>\n<p>我们来看看execute和enqueue方法，我们可以看到这2个方法都用到了client.dispatcher()，这个方法得到的是一个Dispatcher对象，如下图：</p>\n<p><img src=\"/img/okhttp/dispatcher01.jpg\" alt=\"dispatcher01\"></p>\n<p>Dispatcher类设置了一个最大的请求数，定义了一些双队列用于存储request请求，同时定义了一个ExecutorService线程池用于执行异步请求。我们来看看Dispatcher的enqueue方法</p>\n<p><img src=\"/img/okhttp/dispatcher02.jpg\" alt=\"dispatcher02\"></p>\n<p>在Dispatcher的enqueue方法中，会使用创建的线程池执行AsyncCall，我们再来看看AsyncCall的实现</p>\n<p><img src=\"/img/okhttp/realcall02.jpg\" alt=\"realcall02\"></p>\n<p>大家看图中标红的地方，是不是和我们RealCall同步execute方法很像，都是调用了<code>getResponseWithInterceptorChain</code>方法返回<code>response</code>，而且我们也可以知道<strong>onFailure</strong>和<strong>onResponse</strong>回调的逻辑了</p>\n<p>我们再来持看<code>getResponseWithInterceptorChain</code>方法</p>\n<p><img src=\"/img/okhttp/realcall03.jpg\" alt=\"realcall03\"></p>\n<p>在<code>getResponseWithInterceptorChain</code>方法内部，会定义一个List，装载你自己定义的拦截器和一些Okhttp3定义的拦截器，最后会调用<code>RealInterceptorChain</code>类的proceed方法去递归调用List中的拦截器的intercept方法，</p>\n<p><img src=\"/img/okhttp/realinterceptorchain01.jpg\" alt=\"realinterceptorchain01\"></p>\n<p>我们来看看<code>ConnectInterceptor</code>拦截器，通过名字我们大概能知道是做网络连接用的。</p>\n<p><img src=\"/img/okhttp/connectinterceptor01.jpg\" alt=\"realinterceptorchain01\"></p>\n<p>在<code>ConnectInterceptor</code>的intercept方法中会用调用StreamAllocation类的newStream获取HttpStream对象，调用connection方法得到RealConnection对象，在connection方法里面仅仅是返回了一个对象，那么RealConnection对象是怎么生成的呢，我们大概可以猜到是在newStream里生成的。我们来看看newStream方法</p>\n<p><img src=\"/img/okhttp/streamallocation01.jpg\" alt=\"streamallocation01\"></p>\n<p>在方法内部，大家可以看到是调用了<code>findHealthyConnection</code>方法获取到了<code>RealConnection</code>对象，同时会把RealConnection的数据(<strong>source/sink</strong>)存放在<strong>Http1xStream </strong>OR <strong>Http2xStream</strong>中(大家先记住这一点，后面获取Reaponse时会用到<strong>Http1xStream</strong>或<strong>Http2xStream</strong>的数据)。在方法<code>findHealthyConnection</code>内部，会调用<code>findConnection</code>方法</p>\n<p><img src=\"/img/okhttp/streamallocation02.jpg\" alt=\"streamallocation02\"></p>\n<p>在<code>findConnection</code>方法内部，最终会调到<code>193</code>行的<code>connect</code>方法，接下来，我们看看RealConnection的connect方法。</p>\n<p><img src=\"/img/okhttp/realconnection01.jpg\" alt=\"realconnection01\"></p>\n<p>在connect方法的内部，最终会调用buildTunneledConnection或buildConnection方法，这2个方法最终都会调用RealConnection的connectSocket方法和establishProtocol方法。在connectSocket方法内部，会进行socket进行数据传输，在establishProtocol方法内部，会使用Okio进行数据流的读取，并给RealConnection的source和sink进行赋值，这个值会存储在后续Response的body中。</p>\n<p><img src=\"/img/okhttp/realconnection02.jpg\" alt=\"realconnection02\"></p>\n<p>从上图可以看出，在connectSocket内部，会调用Platform的get方法获取相应平台，并调用Platform的connectSocket方法进行socket连接。</p>\n<p><img src=\"/img/okhttp/platform01.jpg\" alt=\"platform01\"><br><strong>至此，我们知道了Okhttp3是通过socket进行数据传输的，同时request请求大致也清楚了</strong></p>\n<h3 id=\"源码分析Response\"><a href=\"#源码分析Response\" class=\"headerlink\" title=\"源码分析Response\"></a>源码分析Response</h3><p>在上面的<strong>Request</strong>分析篇中，大家还记得，在RealCall的<code>getResponseWithInterceptorChain</code>方法吗</p>\n<p><img src=\"/img/okhttp/realcall03.jpg\" alt=\"realcall03\"></p>\n<p>我们在这个方法分析了<code>ConnectInterceptor</code>拦截器中的网络请求流程，在这个方法的最后，会调用<code>CallServerInterceptor</code>拦截器去进行Response的结果获取，接下来，我们来看看<code>CallServerInterceptor</code></p>\n<p><img src=\"/img/okhttp/callserverinterceptor01.jpg\" alt=\"callserverinterceptor01\"></p>\n<p>大家看第<strong>62</strong>行，<strong>Response</strong>的<strong>body</strong>就是在这赋值的，这里的<strong>httpStream</strong>就是我们<strong>Request</strong>篇叫大家记住的<strong>Http1xStream</strong>或<strong>Http2xStream</strong>，这2种<strong>httpStream</strong>流程差不多，我们这里以<strong>Http1xStream</strong>为例来分析</p>\n<p><img src=\"/img/okhttp/http1xstream.jpg\" alt=\"http1xstream\"></p>\n<p>这里比较简单，调用<strong>openResponseBody</strong>返回一个<strong>RealResponseBody</strong>对象返回，在方法内部先调用<strong>getTransferStream</strong>方法获取一个<strong>source</strong>对象，然后生成一个<strong>RealResponseBody</strong>对象进行返回。熟悉Okhttp3用法的同学应该知道，在<strong>onResponse</strong>回调里，我们会使用<strong>response.body.string()</strong>获取字符串或<strong>response.body.byteStream()</strong>获取流对象。通过上面对<strong>CallServerInterceptor</strong>拦截器的分析(第<strong>62</strong>行)，我们知道<strong>response.body</strong>就是调用<strong>httpStream</strong>的<strong>openResponseBody</strong>方法返回的<strong>RealResponseBody</strong>，我们再来看看<strong>RealResponseBody</strong>类</p>\n<p><img src=\"/img/okhttp/responsebody01.jpg\" alt=\"responsebody01\"></p>\n<p>通过上面的源码，我们可以看出，其它就是调用了<strong>source</strong>的一些方法进行数据处理，然后返回，这里的source就是我们<strong>Request</strong>分析篇中<strong>RealConnection</strong>的<strong>source</strong></p>\n<p><strong>至此，response整个流程也大致清楚了</strong></p>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><blockquote>\n<p><strong>OkHttp进行网络请求不是基于HttpURLConnection，而是基于socket。本篇只是对源码流程的简析。</strong></p>\n</blockquote>\n<h3 id=\"源码分析Request\"><a href=\"#源码分析Request\" class=\"headerlink\" title=\"源码分析Request\"></a>源码分析Request</h3><blockquote>\n<p>不熟悉如何使用OKHttp3的同学，可以先阅读android-okhttp章节</p>\n</blockquote>\n<p>在使用OKHttp3进行网络请求时，我们会使用下面2种方式进行调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 同步</span></span><br><span class=\"line\">Response response = client.newCall(request).execute();</span><br><span class=\"line\"><span class=\"comment\">// 异步</span></span><br><span class=\"line\">client.newCall(request).enqueue(<span class=\"keyword\">new</span> Callback() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call call, IOException e)</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span> </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call call, Response response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>从上面的代码可以看出，会先调用<code>newCall(request)</code>方法获取一个<code>Call</code>对象，再调用<code>Call</code>对象的<code>excute</code>方法或<code>enqueue</code>方法执行同步或异步请求。</p>","more":"<p>接下来，我们来看看源码:<br><img src=\"/img/okhttp/okhttpclient01.jpg\" alt=\"okhttpclient01\"></p>\n<p>我们来看看<code>newCall</code>方法，该方法返回了一个<code>RealCall</code>对象</p>\n<p><img src=\"/img/okhttp/realcall01.jpg\" alt=\"realcall01\"></p>\n<p>我们来看看execute和enqueue方法，我们可以看到这2个方法都用到了client.dispatcher()，这个方法得到的是一个Dispatcher对象，如下图：</p>\n<p><img src=\"/img/okhttp/dispatcher01.jpg\" alt=\"dispatcher01\"></p>\n<p>Dispatcher类设置了一个最大的请求数，定义了一些双队列用于存储request请求，同时定义了一个ExecutorService线程池用于执行异步请求。我们来看看Dispatcher的enqueue方法</p>\n<p><img src=\"/img/okhttp/dispatcher02.jpg\" alt=\"dispatcher02\"></p>\n<p>在Dispatcher的enqueue方法中，会使用创建的线程池执行AsyncCall，我们再来看看AsyncCall的实现</p>\n<p><img src=\"/img/okhttp/realcall02.jpg\" alt=\"realcall02\"></p>\n<p>大家看图中标红的地方，是不是和我们RealCall同步execute方法很像，都是调用了<code>getResponseWithInterceptorChain</code>方法返回<code>response</code>，而且我们也可以知道<strong>onFailure</strong>和<strong>onResponse</strong>回调的逻辑了</p>\n<p>我们再来持看<code>getResponseWithInterceptorChain</code>方法</p>\n<p><img src=\"/img/okhttp/realcall03.jpg\" alt=\"realcall03\"></p>\n<p>在<code>getResponseWithInterceptorChain</code>方法内部，会定义一个List，装载你自己定义的拦截器和一些Okhttp3定义的拦截器，最后会调用<code>RealInterceptorChain</code>类的proceed方法去递归调用List中的拦截器的intercept方法，</p>\n<p><img src=\"/img/okhttp/realinterceptorchain01.jpg\" alt=\"realinterceptorchain01\"></p>\n<p>我们来看看<code>ConnectInterceptor</code>拦截器，通过名字我们大概能知道是做网络连接用的。</p>\n<p><img src=\"/img/okhttp/connectinterceptor01.jpg\" alt=\"realinterceptorchain01\"></p>\n<p>在<code>ConnectInterceptor</code>的intercept方法中会用调用StreamAllocation类的newStream获取HttpStream对象，调用connection方法得到RealConnection对象，在connection方法里面仅仅是返回了一个对象，那么RealConnection对象是怎么生成的呢，我们大概可以猜到是在newStream里生成的。我们来看看newStream方法</p>\n<p><img src=\"/img/okhttp/streamallocation01.jpg\" alt=\"streamallocation01\"></p>\n<p>在方法内部，大家可以看到是调用了<code>findHealthyConnection</code>方法获取到了<code>RealConnection</code>对象，同时会把RealConnection的数据(<strong>source/sink</strong>)存放在<strong>Http1xStream </strong>OR <strong>Http2xStream</strong>中(大家先记住这一点，后面获取Reaponse时会用到<strong>Http1xStream</strong>或<strong>Http2xStream</strong>的数据)。在方法<code>findHealthyConnection</code>内部，会调用<code>findConnection</code>方法</p>\n<p><img src=\"/img/okhttp/streamallocation02.jpg\" alt=\"streamallocation02\"></p>\n<p>在<code>findConnection</code>方法内部，最终会调到<code>193</code>行的<code>connect</code>方法，接下来，我们看看RealConnection的connect方法。</p>\n<p><img src=\"/img/okhttp/realconnection01.jpg\" alt=\"realconnection01\"></p>\n<p>在connect方法的内部，最终会调用buildTunneledConnection或buildConnection方法，这2个方法最终都会调用RealConnection的connectSocket方法和establishProtocol方法。在connectSocket方法内部，会进行socket进行数据传输，在establishProtocol方法内部，会使用Okio进行数据流的读取，并给RealConnection的source和sink进行赋值，这个值会存储在后续Response的body中。</p>\n<p><img src=\"/img/okhttp/realconnection02.jpg\" alt=\"realconnection02\"></p>\n<p>从上图可以看出，在connectSocket内部，会调用Platform的get方法获取相应平台，并调用Platform的connectSocket方法进行socket连接。</p>\n<p><img src=\"/img/okhttp/platform01.jpg\" alt=\"platform01\"><br><strong>至此，我们知道了Okhttp3是通过socket进行数据传输的，同时request请求大致也清楚了</strong></p>\n<h3 id=\"源码分析Response\"><a href=\"#源码分析Response\" class=\"headerlink\" title=\"源码分析Response\"></a>源码分析Response</h3><p>在上面的<strong>Request</strong>分析篇中，大家还记得，在RealCall的<code>getResponseWithInterceptorChain</code>方法吗</p>\n<p><img src=\"/img/okhttp/realcall03.jpg\" alt=\"realcall03\"></p>\n<p>我们在这个方法分析了<code>ConnectInterceptor</code>拦截器中的网络请求流程，在这个方法的最后，会调用<code>CallServerInterceptor</code>拦截器去进行Response的结果获取，接下来，我们来看看<code>CallServerInterceptor</code></p>\n<p><img src=\"/img/okhttp/callserverinterceptor01.jpg\" alt=\"callserverinterceptor01\"></p>\n<p>大家看第<strong>62</strong>行，<strong>Response</strong>的<strong>body</strong>就是在这赋值的，这里的<strong>httpStream</strong>就是我们<strong>Request</strong>篇叫大家记住的<strong>Http1xStream</strong>或<strong>Http2xStream</strong>，这2种<strong>httpStream</strong>流程差不多，我们这里以<strong>Http1xStream</strong>为例来分析</p>\n<p><img src=\"/img/okhttp/http1xstream.jpg\" alt=\"http1xstream\"></p>\n<p>这里比较简单，调用<strong>openResponseBody</strong>返回一个<strong>RealResponseBody</strong>对象返回，在方法内部先调用<strong>getTransferStream</strong>方法获取一个<strong>source</strong>对象，然后生成一个<strong>RealResponseBody</strong>对象进行返回。熟悉Okhttp3用法的同学应该知道，在<strong>onResponse</strong>回调里，我们会使用<strong>response.body.string()</strong>获取字符串或<strong>response.body.byteStream()</strong>获取流对象。通过上面对<strong>CallServerInterceptor</strong>拦截器的分析(第<strong>62</strong>行)，我们知道<strong>response.body</strong>就是调用<strong>httpStream</strong>的<strong>openResponseBody</strong>方法返回的<strong>RealResponseBody</strong>，我们再来看看<strong>RealResponseBody</strong>类</p>\n<p><img src=\"/img/okhttp/responsebody01.jpg\" alt=\"responsebody01\"></p>\n<p>通过上面的源码，我们可以看出，其它就是调用了<strong>source</strong>的一些方法进行数据处理，然后返回，这里的source就是我们<strong>Request</strong>分析篇中<strong>RealConnection</strong>的<strong>source</strong></p>\n<p><strong>至此，response整个流程也大致清楚了</strong></p>"},{"title":"android-okhttp","date":"2017-02-06T08:14:28.000Z","_content":"\n## 概述\n\n> OKhttp3是一个高效的http&http/2的客户端，用于android和java，支持同步和异步请求。\n\nOKhttp3是开源界著名的Square公司的大作，大神[JakeWharton](https://github.com/JakeWharton)的公司。Google已把Android的网络请求替换为Okhttp的实现\n\nOKhttp3有以下优点：\n\n1. 支持请求相同host的所有请求，共享socket\n\n2. 连接池可以减少请求延迟(如果HTTP / 2不可使用)。\n\n3. 透明的GZIP压缩\n\n4. 响应缓存避免了完全重复的网络请求\n\n5. socket自动选择最好路线，并支持自动重连\n\n6. …...\n\n支持版本：Android 2.3及以上，java1.7及以上\n\n<!--more-->\n\n## 引用\n\n> 注:okhttp内部依赖okio，同时导入okio：\n\nGrade\n\n```java\ncompile ‘com.squareup.okhttp3:okhttp:3.3.1’\ncompile ‘com.squareup.okio:okio:1.8.0’\n```\n\n对于使用Eclipse的同学，可以去Square官网去下载相应的jar包\n\n[官网](http://square.github.io/okhttp/)\n\n[okhttp](https://search.maven.org/remote_content?g=com.squareup.okhttp3&a=okhttp&v=LATEST)\n\n[okio](https://search.maven.org/remote_content?g=com.squareup.okio&a=okio&v=LATEST)\n\n## 基本用法\n\n初始化一个client: \n\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n```\n\nGet请求\n```java\npublic void run() throws Exception {\n  Request request = new Request.Builder()\n      .url(\"http://publicobject.com/helloworld.txt\")\n      .build();\n\n  // 同步\n  Response response = client.newCall(request).execute();\n  \n  // 异步\n  client.newCall(request).enqueue(new Callback() {\n      @Override \n      public void onFailure(Call call, IOException e) {\n      }\n\n      @Override \n      public void onResponse(Call call, Response response) throws IOException {\n      }\n  });\n}\n```\n\nPost请求\n```java\npublic void run() throws Exception {\n  Request.Builder builder = new Request.Builder()\n  FormBody.Builder formEncodingBuilder = new FormBody.Builder();\n  formEncodingBuilder.add(key,value);\n  RequestBody requestBody = formEncodingBuilder.build()\n  builder.post(requestBody)\n  builder.url(“http://publicobject.com/helloworld.txt”);\n  Request request = builder.build();\n  \n  // 同步\n  Response response = client.newCall(request).execute();\n              \n  // 异步\n  client.newCall(request).enqueue(new Callback() {\n      @Override \n      public void onFailure(Call call, IOException e) {\n      }\n\n      @Override \n      public void onResponse(Call call, Response response) throws IOException {\n      }\n  });           \n}\n```\n\n添加Headers\n```java\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/repos/square/okhttp/issues\")\n        .header(\"User-Agent\", \"OkHttp Headers.java\")\n        .addHeader(\"Accept\", \"application/json; q=0.5\")\n        .addHeader(\"Accept\", \"application/vnd.github.v3+json\")\n        .build();\n\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n\n    System.out.println(\"Server: \" + response.header(\"Server\"));\n    System.out.println(\"Date: \" + response.header(\"Date\"));\n    System.out.println(\"Vary: \" + response.headers(\"Vary\"));\n}\n```\n\n上传文件\n```java\npublic static final MediaType MEDIA_TYPE_MARKDOWN\n      = MediaType.parse(\"text/x-markdown; charset=utf-8\");\n\npublic void run() throws Exception {\n    File file = new File(\"README.md\");\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/markdown/raw\")\n        .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))\n        .build();\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()){}\n    System.out.println(response.body().string());\n}\n```\n\n发送多个请求\n```java\nprivate static final String IMGUR_CLIENT_ID = \"...\";\nprivate static final MediaType MEDIA_TYPE_PNG = MediaType.parse(\"image/png\");\n\npublic void run() throws Exception {\n    RequestBody requestBody = new MultipartBody.Builder()\n        .setType(MultipartBody.FORM)\n        .addFormDataPart(\"title\", \"Square Logo\")\n        .addFormDataPart(\"image\", \"logo-square.png\",\n         RequestBody.create(MEDIA_TYPE_PNG, new File(\"website/static/logo-square.png\")))\n        .build();\n\n    Request request = new Request.Builder()\n        .header(\"Authorization\", \"Client-ID \" + IMGUR_CLIENT_ID)\n        .url(\"https://api.imgur.com/3/image\")\n        .post(requestBody)\n        .build();\n\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()){}\n}\n```\n\n用Gson解析Json Response\n```java\nprivate final Gson gson = new Gson();\n\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/gists/c2a7c39532239ff261be\")\n        .build();\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n\n    Gist gist = gson.fromJson(response.body().charStream(), Gist.class);\n    for (Map.Entry<String, GistFile> entry : gist.files.entrySet()) {\n      System.out.println(entry.getKey());\n      System.out.println(entry.getValue().content);\n    }\n}\n\nstatic class Gist {\n  Map<String, GistFile> files;\n}\n\nstatic class GistFile {\n  String content;\n}\n```\n\n缓存\n```java\nprivate final OkHttpClient client;\n\npublic CacheResponse(File cacheDirectory) throws Exception {\n    int cacheSize = 10 * 1024 * 1024; // 10 MiB\n    Cache cache = new Cache(cacheDirectory, cacheSize);\n    client = new OkHttpClient.Builder()\n        .cache(cache)\n        .build();\n     Request request = new Request.Builder()\n        .url(\"http://publicobject.com/helloworld.txt\")\n        .build();\n    Response response1 = client.newCall(request).execute();\n}\n```\n\n取消一个请求\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/2\")\n        .build();\n    final Call call = client.newCall(request);\n    Response response = call.execute();    \n    call.cancel();\n}\n```\n\n设置超时\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\npublic ConfigureTimeouts() throws Exception {\n    client = new OkHttpClient.Builder()\n        .connectTimeout(10, TimeUnit.SECONDS)\n        .writeTimeout(10, TimeUnit.SECONDS)\n        .readTimeout(30, TimeUnit.SECONDS)\n        .build();\n}\n\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/2\")\n        .build();\n    final Call call = client.newCall(request);\n    Response response = call.execute();\n}\n```\n\n自定义拦截器\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\npublic void run() throws Exception {\n  client.networkInterceptors().add(new Interceptor() {    \n      @Override    \n      public Response intercept(Chain chain) throws IOException {   \n          Request originalRequest = paramChain.request();\n          ……\n          ……\n          ……         \n          return paramChain.proceed(compressedRequest);       \n      }\n  });\n  Request request = new Request.Builder()\n    \t.url(\"http://httpbin.org/delay/2\")\n    \t.build();\n  final Call call = client.newCall(request);\n  Response response = call.execute();\n}\n```","source":"_posts/android/android-okhttp.md","raw":"---\ntitle: android-okhttp\ndate: 2017-02-06 16:14:28\ntags: android\n---\n\n## 概述\n\n> OKhttp3是一个高效的http&http/2的客户端，用于android和java，支持同步和异步请求。\n\nOKhttp3是开源界著名的Square公司的大作，大神[JakeWharton](https://github.com/JakeWharton)的公司。Google已把Android的网络请求替换为Okhttp的实现\n\nOKhttp3有以下优点：\n\n1. 支持请求相同host的所有请求，共享socket\n\n2. 连接池可以减少请求延迟(如果HTTP / 2不可使用)。\n\n3. 透明的GZIP压缩\n\n4. 响应缓存避免了完全重复的网络请求\n\n5. socket自动选择最好路线，并支持自动重连\n\n6. …...\n\n支持版本：Android 2.3及以上，java1.7及以上\n\n<!--more-->\n\n## 引用\n\n> 注:okhttp内部依赖okio，同时导入okio：\n\nGrade\n\n```java\ncompile ‘com.squareup.okhttp3:okhttp:3.3.1’\ncompile ‘com.squareup.okio:okio:1.8.0’\n```\n\n对于使用Eclipse的同学，可以去Square官网去下载相应的jar包\n\n[官网](http://square.github.io/okhttp/)\n\n[okhttp](https://search.maven.org/remote_content?g=com.squareup.okhttp3&a=okhttp&v=LATEST)\n\n[okio](https://search.maven.org/remote_content?g=com.squareup.okio&a=okio&v=LATEST)\n\n## 基本用法\n\n初始化一个client: \n\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n```\n\nGet请求\n```java\npublic void run() throws Exception {\n  Request request = new Request.Builder()\n      .url(\"http://publicobject.com/helloworld.txt\")\n      .build();\n\n  // 同步\n  Response response = client.newCall(request).execute();\n  \n  // 异步\n  client.newCall(request).enqueue(new Callback() {\n      @Override \n      public void onFailure(Call call, IOException e) {\n      }\n\n      @Override \n      public void onResponse(Call call, Response response) throws IOException {\n      }\n  });\n}\n```\n\nPost请求\n```java\npublic void run() throws Exception {\n  Request.Builder builder = new Request.Builder()\n  FormBody.Builder formEncodingBuilder = new FormBody.Builder();\n  formEncodingBuilder.add(key,value);\n  RequestBody requestBody = formEncodingBuilder.build()\n  builder.post(requestBody)\n  builder.url(“http://publicobject.com/helloworld.txt”);\n  Request request = builder.build();\n  \n  // 同步\n  Response response = client.newCall(request).execute();\n              \n  // 异步\n  client.newCall(request).enqueue(new Callback() {\n      @Override \n      public void onFailure(Call call, IOException e) {\n      }\n\n      @Override \n      public void onResponse(Call call, Response response) throws IOException {\n      }\n  });           \n}\n```\n\n添加Headers\n```java\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/repos/square/okhttp/issues\")\n        .header(\"User-Agent\", \"OkHttp Headers.java\")\n        .addHeader(\"Accept\", \"application/json; q=0.5\")\n        .addHeader(\"Accept\", \"application/vnd.github.v3+json\")\n        .build();\n\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n\n    System.out.println(\"Server: \" + response.header(\"Server\"));\n    System.out.println(\"Date: \" + response.header(\"Date\"));\n    System.out.println(\"Vary: \" + response.headers(\"Vary\"));\n}\n```\n\n上传文件\n```java\npublic static final MediaType MEDIA_TYPE_MARKDOWN\n      = MediaType.parse(\"text/x-markdown; charset=utf-8\");\n\npublic void run() throws Exception {\n    File file = new File(\"README.md\");\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/markdown/raw\")\n        .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))\n        .build();\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()){}\n    System.out.println(response.body().string());\n}\n```\n\n发送多个请求\n```java\nprivate static final String IMGUR_CLIENT_ID = \"...\";\nprivate static final MediaType MEDIA_TYPE_PNG = MediaType.parse(\"image/png\");\n\npublic void run() throws Exception {\n    RequestBody requestBody = new MultipartBody.Builder()\n        .setType(MultipartBody.FORM)\n        .addFormDataPart(\"title\", \"Square Logo\")\n        .addFormDataPart(\"image\", \"logo-square.png\",\n         RequestBody.create(MEDIA_TYPE_PNG, new File(\"website/static/logo-square.png\")))\n        .build();\n\n    Request request = new Request.Builder()\n        .header(\"Authorization\", \"Client-ID \" + IMGUR_CLIENT_ID)\n        .url(\"https://api.imgur.com/3/image\")\n        .post(requestBody)\n        .build();\n\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()){}\n}\n```\n\n用Gson解析Json Response\n```java\nprivate final Gson gson = new Gson();\n\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"https://api.github.com/gists/c2a7c39532239ff261be\")\n        .build();\n    Response response = client.newCall(request).execute();\n    if (!response.isSuccessful()) throw new IOException(\"Unexpected code \" + response);\n\n    Gist gist = gson.fromJson(response.body().charStream(), Gist.class);\n    for (Map.Entry<String, GistFile> entry : gist.files.entrySet()) {\n      System.out.println(entry.getKey());\n      System.out.println(entry.getValue().content);\n    }\n}\n\nstatic class Gist {\n  Map<String, GistFile> files;\n}\n\nstatic class GistFile {\n  String content;\n}\n```\n\n缓存\n```java\nprivate final OkHttpClient client;\n\npublic CacheResponse(File cacheDirectory) throws Exception {\n    int cacheSize = 10 * 1024 * 1024; // 10 MiB\n    Cache cache = new Cache(cacheDirectory, cacheSize);\n    client = new OkHttpClient.Builder()\n        .cache(cache)\n        .build();\n     Request request = new Request.Builder()\n        .url(\"http://publicobject.com/helloworld.txt\")\n        .build();\n    Response response1 = client.newCall(request).execute();\n}\n```\n\n取消一个请求\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/2\")\n        .build();\n    final Call call = client.newCall(request);\n    Response response = call.execute();    \n    call.cancel();\n}\n```\n\n设置超时\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\npublic ConfigureTimeouts() throws Exception {\n    client = new OkHttpClient.Builder()\n        .connectTimeout(10, TimeUnit.SECONDS)\n        .writeTimeout(10, TimeUnit.SECONDS)\n        .readTimeout(30, TimeUnit.SECONDS)\n        .build();\n}\n\npublic void run() throws Exception {\n    Request request = new Request.Builder()\n        .url(\"http://httpbin.org/delay/2\")\n        .build();\n    final Call call = client.newCall(request);\n    Response response = call.execute();\n}\n```\n\n自定义拦截器\n```java\nprivate final OkHttpClient client = new OkHttpClient();\n\npublic void run() throws Exception {\n  client.networkInterceptors().add(new Interceptor() {    \n      @Override    \n      public Response intercept(Chain chain) throws IOException {   \n          Request originalRequest = paramChain.request();\n          ……\n          ……\n          ……         \n          return paramChain.proceed(compressedRequest);       \n      }\n  });\n  Request request = new Request.Builder()\n    \t.url(\"http://httpbin.org/delay/2\")\n    \t.build();\n  final Call call = client.newCall(request);\n  Response response = call.execute();\n}\n```","slug":"android/android-okhttp","published":1,"updated":"2018-01-31T09:35:37.813Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ef000tizcbnt7n9rm9","content":"<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><blockquote>\n<p>OKhttp3是一个高效的http&amp;http/2的客户端，用于android和java，支持同步和异步请求。</p>\n</blockquote>\n<p>OKhttp3是开源界著名的Square公司的大作，大神<a href=\"https://github.com/JakeWharton\" target=\"_blank\" rel=\"noopener\">JakeWharton</a>的公司。Google已把Android的网络请求替换为Okhttp的实现</p>\n<p>OKhttp3有以下优点：</p>\n<ol>\n<li><p>支持请求相同host的所有请求，共享socket</p>\n</li>\n<li><p>连接池可以减少请求延迟(如果HTTP / 2不可使用)。</p>\n</li>\n<li><p>透明的GZIP压缩</p>\n</li>\n<li><p>响应缓存避免了完全重复的网络请求</p>\n</li>\n<li><p>socket自动选择最好路线，并支持自动重连</p>\n</li>\n<li><p>……</p>\n</li>\n</ol>\n<p>支持版本：Android 2.3及以上，java1.7及以上</p>\n<a id=\"more\"></a>\n<h2 id=\"引用\"><a href=\"#引用\" class=\"headerlink\" title=\"引用\"></a>引用</h2><blockquote>\n<p>注:okhttp内部依赖okio，同时导入okio：</p>\n</blockquote>\n<p>Grade</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile ‘com.squareup.okhttp3:okhttp:<span class=\"number\">3.3</span>.1’</span><br><span class=\"line\">compile ‘com.squareup.okio:okio:<span class=\"number\">1.8</span>.0’</span><br></pre></td></tr></table></figure>\n<p>对于使用Eclipse的同学，可以去Square官网去下载相应的jar包</p>\n<p><a href=\"http://square.github.io/okhttp/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n<p><a href=\"https://search.maven.org/remote_content?g=com.squareup.okhttp3&amp;a=okhttp&amp;v=LATEST\" target=\"_blank\" rel=\"noopener\">okhttp</a></p>\n<p><a href=\"https://search.maven.org/remote_content?g=com.squareup.okio&amp;a=okio&amp;v=LATEST\" target=\"_blank\" rel=\"noopener\">okio</a></p>\n<h2 id=\"基本用法\"><a href=\"#基本用法\" class=\"headerlink\" title=\"基本用法\"></a>基本用法</h2><p>初始化一个client: </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br></pre></td></tr></table></figure>\n<p>Get请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">  Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">      .url(<span class=\"string\">\"http://publicobject.com/helloworld.txt\"</span>)</span><br><span class=\"line\">      .build();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 同步</span></span><br><span class=\"line\">  Response response = client.newCall(request).execute();</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// 异步</span></span><br><span class=\"line\">  client.newCall(request).enqueue(<span class=\"keyword\">new</span> Callback() &#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call call, IOException e)</span> </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call call, Response response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>Post请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">  Request.Builder builder = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">  FormBody.Builder formEncodingBuilder = <span class=\"keyword\">new</span> FormBody.Builder();</span><br><span class=\"line\">  formEncodingBuilder.add(key,value);</span><br><span class=\"line\">  RequestBody requestBody = formEncodingBuilder.build()</span><br><span class=\"line\">  builder.post(requestBody)</span><br><span class=\"line\">  builder.url(“http:<span class=\"comment\">//publicobject.com/helloworld.txt”);</span></span><br><span class=\"line\">  Request request = builder.build();</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// 同步</span></span><br><span class=\"line\">  Response response = client.newCall(request).execute();</span><br><span class=\"line\">              </span><br><span class=\"line\">  <span class=\"comment\">// 异步</span></span><br><span class=\"line\">  client.newCall(request).enqueue(<span class=\"keyword\">new</span> Callback() &#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call call, IOException e)</span> </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call call, Response response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;);           </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>添加Headers<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.github.com/repos/square/okhttp/issues\"</span>)</span><br><span class=\"line\">        .header(<span class=\"string\">\"User-Agent\"</span>, <span class=\"string\">\"OkHttp Headers.java\"</span>)</span><br><span class=\"line\">        .addHeader(<span class=\"string\">\"Accept\"</span>, <span class=\"string\">\"application/json; q=0.5\"</span>)</span><br><span class=\"line\">        .addHeader(<span class=\"string\">\"Accept\"</span>, <span class=\"string\">\"application/vnd.github.v3+json\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful()) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IOException(<span class=\"string\">\"Unexpected code \"</span> + response);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"Server: \"</span> + response.header(<span class=\"string\">\"Server\"</span>));</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"Date: \"</span> + response.header(<span class=\"string\">\"Date\"</span>));</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"Vary: \"</span> + response.headers(<span class=\"string\">\"Vary\"</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>上传文件<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> MediaType MEDIA_TYPE_MARKDOWN</span><br><span class=\"line\">      = MediaType.parse(<span class=\"string\">\"text/x-markdown; charset=utf-8\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    File file = <span class=\"keyword\">new</span> File(<span class=\"string\">\"README.md\"</span>);</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.github.com/markdown/raw\"</span>)</span><br><span class=\"line\">        .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful())&#123;&#125;</span><br><span class=\"line\">    System.out.println(response.body().string());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>发送多个请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String IMGUR_CLIENT_ID = <span class=\"string\">\"...\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> MediaType MEDIA_TYPE_PNG = MediaType.parse(<span class=\"string\">\"image/png\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    RequestBody requestBody = <span class=\"keyword\">new</span> MultipartBody.Builder()</span><br><span class=\"line\">        .setType(MultipartBody.FORM)</span><br><span class=\"line\">        .addFormDataPart(<span class=\"string\">\"title\"</span>, <span class=\"string\">\"Square Logo\"</span>)</span><br><span class=\"line\">        .addFormDataPart(<span class=\"string\">\"image\"</span>, <span class=\"string\">\"logo-square.png\"</span>,</span><br><span class=\"line\">         RequestBody.create(MEDIA_TYPE_PNG, <span class=\"keyword\">new</span> File(<span class=\"string\">\"website/static/logo-square.png\"</span>)))</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .header(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"Client-ID \"</span> + IMGUR_CLIENT_ID)</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.imgur.com/3/image\"</span>)</span><br><span class=\"line\">        .post(requestBody)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful())&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>用Gson解析Json Response<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Gson gson = <span class=\"keyword\">new</span> Gson();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.github.com/gists/c2a7c39532239ff261be\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful()) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IOException(<span class=\"string\">\"Unexpected code \"</span> + response);</span><br><span class=\"line\"></span><br><span class=\"line\">    Gist gist = gson.fromJson(response.body().charStream(), Gist.class);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Map.Entry&lt;String, GistFile&gt; entry : gist.files.entrySet()) &#123;</span><br><span class=\"line\">      System.out.println(entry.getKey());</span><br><span class=\"line\">      System.out.println(entry.getValue().content);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Gist</span> </span>&#123;</span><br><span class=\"line\">  Map&lt;String, GistFile&gt; files;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GistFile</span> </span>&#123;</span><br><span class=\"line\">  String content;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>缓存<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CacheResponse</span><span class=\"params\">(File cacheDirectory)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> cacheSize = <span class=\"number\">10</span> * <span class=\"number\">1024</span> * <span class=\"number\">1024</span>; <span class=\"comment\">// 10 MiB</span></span><br><span class=\"line\">    Cache cache = <span class=\"keyword\">new</span> Cache(cacheDirectory, cacheSize);</span><br><span class=\"line\">    client = <span class=\"keyword\">new</span> OkHttpClient.Builder()</span><br><span class=\"line\">        .cache(cache)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">     Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"http://publicobject.com/helloworld.txt\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    Response response1 = client.newCall(request).execute();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>取消一个请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"http://httpbin.org/delay/2\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> Call call = client.newCall(request);</span><br><span class=\"line\">    Response response = call.execute();    </span><br><span class=\"line\">    call.cancel();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>设置超时<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ConfigureTimeouts</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    client = <span class=\"keyword\">new</span> OkHttpClient.Builder()</span><br><span class=\"line\">        .connectTimeout(<span class=\"number\">10</span>, TimeUnit.SECONDS)</span><br><span class=\"line\">        .writeTimeout(<span class=\"number\">10</span>, TimeUnit.SECONDS)</span><br><span class=\"line\">        .readTimeout(<span class=\"number\">30</span>, TimeUnit.SECONDS)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"http://httpbin.org/delay/2\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> Call call = client.newCall(request);</span><br><span class=\"line\">    Response response = call.execute();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>自定义拦截器<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">  client.networkInterceptors().add(<span class=\"keyword\">new</span> Interceptor() &#123;    </span><br><span class=\"line\">      <span class=\"meta\">@Override</span>    </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> Response <span class=\"title\">intercept</span><span class=\"params\">(Chain chain)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;   </span><br><span class=\"line\">          Request originalRequest = paramChain.request();</span><br><span class=\"line\">          ……</span><br><span class=\"line\">          ……</span><br><span class=\"line\">          ……         </span><br><span class=\"line\">          <span class=\"keyword\">return</span> paramChain.proceed(compressedRequest);       </span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">    \t.url(<span class=\"string\">\"http://httpbin.org/delay/2\"</span>)</span><br><span class=\"line\">    \t.build();</span><br><span class=\"line\">  <span class=\"keyword\">final</span> Call call = client.newCall(request);</span><br><span class=\"line\">  Response response = call.execute();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><blockquote>\n<p>OKhttp3是一个高效的http&amp;http/2的客户端，用于android和java，支持同步和异步请求。</p>\n</blockquote>\n<p>OKhttp3是开源界著名的Square公司的大作，大神<a href=\"https://github.com/JakeWharton\" target=\"_blank\" rel=\"noopener\">JakeWharton</a>的公司。Google已把Android的网络请求替换为Okhttp的实现</p>\n<p>OKhttp3有以下优点：</p>\n<ol>\n<li><p>支持请求相同host的所有请求，共享socket</p>\n</li>\n<li><p>连接池可以减少请求延迟(如果HTTP / 2不可使用)。</p>\n</li>\n<li><p>透明的GZIP压缩</p>\n</li>\n<li><p>响应缓存避免了完全重复的网络请求</p>\n</li>\n<li><p>socket自动选择最好路线，并支持自动重连</p>\n</li>\n<li><p>……</p>\n</li>\n</ol>\n<p>支持版本：Android 2.3及以上，java1.7及以上</p>","more":"<h2 id=\"引用\"><a href=\"#引用\" class=\"headerlink\" title=\"引用\"></a>引用</h2><blockquote>\n<p>注:okhttp内部依赖okio，同时导入okio：</p>\n</blockquote>\n<p>Grade</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compile ‘com.squareup.okhttp3:okhttp:<span class=\"number\">3.3</span>.1’</span><br><span class=\"line\">compile ‘com.squareup.okio:okio:<span class=\"number\">1.8</span>.0’</span><br></pre></td></tr></table></figure>\n<p>对于使用Eclipse的同学，可以去Square官网去下载相应的jar包</p>\n<p><a href=\"http://square.github.io/okhttp/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n<p><a href=\"https://search.maven.org/remote_content?g=com.squareup.okhttp3&amp;a=okhttp&amp;v=LATEST\" target=\"_blank\" rel=\"noopener\">okhttp</a></p>\n<p><a href=\"https://search.maven.org/remote_content?g=com.squareup.okio&amp;a=okio&amp;v=LATEST\" target=\"_blank\" rel=\"noopener\">okio</a></p>\n<h2 id=\"基本用法\"><a href=\"#基本用法\" class=\"headerlink\" title=\"基本用法\"></a>基本用法</h2><p>初始化一个client: </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br></pre></td></tr></table></figure>\n<p>Get请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">  Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">      .url(<span class=\"string\">\"http://publicobject.com/helloworld.txt\"</span>)</span><br><span class=\"line\">      .build();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 同步</span></span><br><span class=\"line\">  Response response = client.newCall(request).execute();</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// 异步</span></span><br><span class=\"line\">  client.newCall(request).enqueue(<span class=\"keyword\">new</span> Callback() &#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call call, IOException e)</span> </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call call, Response response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>Post请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">  Request.Builder builder = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">  FormBody.Builder formEncodingBuilder = <span class=\"keyword\">new</span> FormBody.Builder();</span><br><span class=\"line\">  formEncodingBuilder.add(key,value);</span><br><span class=\"line\">  RequestBody requestBody = formEncodingBuilder.build()</span><br><span class=\"line\">  builder.post(requestBody)</span><br><span class=\"line\">  builder.url(“http:<span class=\"comment\">//publicobject.com/helloworld.txt”);</span></span><br><span class=\"line\">  Request request = builder.build();</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// 同步</span></span><br><span class=\"line\">  Response response = client.newCall(request).execute();</span><br><span class=\"line\">              </span><br><span class=\"line\">  <span class=\"comment\">// 异步</span></span><br><span class=\"line\">  client.newCall(request).enqueue(<span class=\"keyword\">new</span> Callback() &#123;</span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onFailure</span><span class=\"params\">(Call call, IOException e)</span> </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"meta\">@Override</span> </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onResponse</span><span class=\"params\">(Call call, Response response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;);           </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>添加Headers<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.github.com/repos/square/okhttp/issues\"</span>)</span><br><span class=\"line\">        .header(<span class=\"string\">\"User-Agent\"</span>, <span class=\"string\">\"OkHttp Headers.java\"</span>)</span><br><span class=\"line\">        .addHeader(<span class=\"string\">\"Accept\"</span>, <span class=\"string\">\"application/json; q=0.5\"</span>)</span><br><span class=\"line\">        .addHeader(<span class=\"string\">\"Accept\"</span>, <span class=\"string\">\"application/vnd.github.v3+json\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful()) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IOException(<span class=\"string\">\"Unexpected code \"</span> + response);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"Server: \"</span> + response.header(<span class=\"string\">\"Server\"</span>));</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"Date: \"</span> + response.header(<span class=\"string\">\"Date\"</span>));</span><br><span class=\"line\">    System.out.println(<span class=\"string\">\"Vary: \"</span> + response.headers(<span class=\"string\">\"Vary\"</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>上传文件<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> MediaType MEDIA_TYPE_MARKDOWN</span><br><span class=\"line\">      = MediaType.parse(<span class=\"string\">\"text/x-markdown; charset=utf-8\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    File file = <span class=\"keyword\">new</span> File(<span class=\"string\">\"README.md\"</span>);</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.github.com/markdown/raw\"</span>)</span><br><span class=\"line\">        .post(RequestBody.create(MEDIA_TYPE_MARKDOWN, file))</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful())&#123;&#125;</span><br><span class=\"line\">    System.out.println(response.body().string());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>发送多个请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String IMGUR_CLIENT_ID = <span class=\"string\">\"...\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> MediaType MEDIA_TYPE_PNG = MediaType.parse(<span class=\"string\">\"image/png\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    RequestBody requestBody = <span class=\"keyword\">new</span> MultipartBody.Builder()</span><br><span class=\"line\">        .setType(MultipartBody.FORM)</span><br><span class=\"line\">        .addFormDataPart(<span class=\"string\">\"title\"</span>, <span class=\"string\">\"Square Logo\"</span>)</span><br><span class=\"line\">        .addFormDataPart(<span class=\"string\">\"image\"</span>, <span class=\"string\">\"logo-square.png\"</span>,</span><br><span class=\"line\">         RequestBody.create(MEDIA_TYPE_PNG, <span class=\"keyword\">new</span> File(<span class=\"string\">\"website/static/logo-square.png\"</span>)))</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .header(<span class=\"string\">\"Authorization\"</span>, <span class=\"string\">\"Client-ID \"</span> + IMGUR_CLIENT_ID)</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.imgur.com/3/image\"</span>)</span><br><span class=\"line\">        .post(requestBody)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\"></span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful())&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>用Gson解析Json Response<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Gson gson = <span class=\"keyword\">new</span> Gson();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"https://api.github.com/gists/c2a7c39532239ff261be\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    Response response = client.newCall(request).execute();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!response.isSuccessful()) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IOException(<span class=\"string\">\"Unexpected code \"</span> + response);</span><br><span class=\"line\"></span><br><span class=\"line\">    Gist gist = gson.fromJson(response.body().charStream(), Gist.class);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Map.Entry&lt;String, GistFile&gt; entry : gist.files.entrySet()) &#123;</span><br><span class=\"line\">      System.out.println(entry.getKey());</span><br><span class=\"line\">      System.out.println(entry.getValue().content);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Gist</span> </span>&#123;</span><br><span class=\"line\">  Map&lt;String, GistFile&gt; files;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GistFile</span> </span>&#123;</span><br><span class=\"line\">  String content;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>缓存<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CacheResponse</span><span class=\"params\">(File cacheDirectory)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> cacheSize = <span class=\"number\">10</span> * <span class=\"number\">1024</span> * <span class=\"number\">1024</span>; <span class=\"comment\">// 10 MiB</span></span><br><span class=\"line\">    Cache cache = <span class=\"keyword\">new</span> Cache(cacheDirectory, cacheSize);</span><br><span class=\"line\">    client = <span class=\"keyword\">new</span> OkHttpClient.Builder()</span><br><span class=\"line\">        .cache(cache)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">     Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"http://publicobject.com/helloworld.txt\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    Response response1 = client.newCall(request).execute();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>取消一个请求<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"http://httpbin.org/delay/2\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> Call call = client.newCall(request);</span><br><span class=\"line\">    Response response = call.execute();    </span><br><span class=\"line\">    call.cancel();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>设置超时<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ConfigureTimeouts</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    client = <span class=\"keyword\">new</span> OkHttpClient.Builder()</span><br><span class=\"line\">        .connectTimeout(<span class=\"number\">10</span>, TimeUnit.SECONDS)</span><br><span class=\"line\">        .writeTimeout(<span class=\"number\">10</span>, TimeUnit.SECONDS)</span><br><span class=\"line\">        .readTimeout(<span class=\"number\">30</span>, TimeUnit.SECONDS)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">        .url(<span class=\"string\">\"http://httpbin.org/delay/2\"</span>)</span><br><span class=\"line\">        .build();</span><br><span class=\"line\">    <span class=\"keyword\">final</span> Call call = client.newCall(request);</span><br><span class=\"line\">    Response response = call.execute();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>自定义拦截器<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> OkHttpClient client = <span class=\"keyword\">new</span> OkHttpClient();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">  client.networkInterceptors().add(<span class=\"keyword\">new</span> Interceptor() &#123;    </span><br><span class=\"line\">      <span class=\"meta\">@Override</span>    </span><br><span class=\"line\">      <span class=\"function\"><span class=\"keyword\">public</span> Response <span class=\"title\">intercept</span><span class=\"params\">(Chain chain)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;   </span><br><span class=\"line\">          Request originalRequest = paramChain.request();</span><br><span class=\"line\">          ……</span><br><span class=\"line\">          ……</span><br><span class=\"line\">          ……         </span><br><span class=\"line\">          <span class=\"keyword\">return</span> paramChain.proceed(compressedRequest);       </span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  Request request = <span class=\"keyword\">new</span> Request.Builder()</span><br><span class=\"line\">    \t.url(<span class=\"string\">\"http://httpbin.org/delay/2\"</span>)</span><br><span class=\"line\">    \t.build();</span><br><span class=\"line\">  <span class=\"keyword\">final</span> Call call = client.newCall(request);</span><br><span class=\"line\">  Response response = call.execute();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>"},{"title":"android-shape","date":"2016-05-18T09:28:11.000Z","_content":"\n​\t在Android程序开发中，我们经常会用到Shape去定义各种各样的形状。shape可以在selector，layout等里面使用，有6个子标签，如下：\n<!--more-->\n## Shape 格式\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\" >\n    <!-- 圆角，同时设置五个属性，则Radius属性无效 -->\n    <corners\n        android:radius=\"9dp\" //设置四个解的半径\n        android:topLeftRadius=\"2dp\" //设置左上角的半径\n        android:topRightRadius=\"2dp\" //设置右上角的半径\n        android:bottomLeftRadius=\"2dp\" //设置左下角的半径\n        android:bottomRightRadius=\"2dp\"/> //设置右下角的半径\n\n    <!-- 渐变，当设置填充颜色后，无渐变效果，angle的值必须是45的倍数(包括0)，仅在type=\"linear\"有效，角度以逆时针方向 -->\n    <gradient\n        android:startColor=\"@android:color/white\"\n        android:centerColor=\"@android:color/black\"\n        android:endColor=\"@android:color/black\"\n        android:useLevel=\"true\"\n        android:angle=\"45\"\n        android:type=\"radial\"\n        android:centerX=\"0\"\n        android:centerY=\"0\"\n        android:gradientRadius=\"90\"/>\n\n    <!-- 间隔，设置四个方向的间隔-->\n    <padding\n        android:left=\"2dp\"\n        android:top=\"2dp\"\n        android:right=\"2dp\"\n        android:bottom=\"2dp\"/><!-- 各方向的间隔 -->\n\n    <!-- 大小，设置大小-->\n    <size\n        android:width=\"50dp\"\n        android:height=\"50dp\"/><!-- 宽度和高度 -->\n\n    <!-- 填充，设置填充的颜色 -->\n    <solid\n        android:color=\"@android:color/white\"/><!-- 填充的颜色 -->\n\n    <!-- 描边 dashWidth和dashGap属性，只要其中一个设置为0dp，则边框为实线边框-->\n    <stroke\n        android:width=\"2dp\" //设置边框的宽度\n        android:color=\"@android:color/black\" //设置边框的颜色\n        android:dashWidth=\"1dp\" //设置虚线的宽度\n        android:dashGap=\"2dp\"/> //设置虚线的间隔宽度\n</shape>\n```\n","source":"_posts/android/android-shape.md","raw":"---\ntitle: android-shape\ndate: 2016-05-18 17:28:11\ntags: android\n---\n\n​\t在Android程序开发中，我们经常会用到Shape去定义各种各样的形状。shape可以在selector，layout等里面使用，有6个子标签，如下：\n<!--more-->\n## Shape 格式\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\" >\n    <!-- 圆角，同时设置五个属性，则Radius属性无效 -->\n    <corners\n        android:radius=\"9dp\" //设置四个解的半径\n        android:topLeftRadius=\"2dp\" //设置左上角的半径\n        android:topRightRadius=\"2dp\" //设置右上角的半径\n        android:bottomLeftRadius=\"2dp\" //设置左下角的半径\n        android:bottomRightRadius=\"2dp\"/> //设置右下角的半径\n\n    <!-- 渐变，当设置填充颜色后，无渐变效果，angle的值必须是45的倍数(包括0)，仅在type=\"linear\"有效，角度以逆时针方向 -->\n    <gradient\n        android:startColor=\"@android:color/white\"\n        android:centerColor=\"@android:color/black\"\n        android:endColor=\"@android:color/black\"\n        android:useLevel=\"true\"\n        android:angle=\"45\"\n        android:type=\"radial\"\n        android:centerX=\"0\"\n        android:centerY=\"0\"\n        android:gradientRadius=\"90\"/>\n\n    <!-- 间隔，设置四个方向的间隔-->\n    <padding\n        android:left=\"2dp\"\n        android:top=\"2dp\"\n        android:right=\"2dp\"\n        android:bottom=\"2dp\"/><!-- 各方向的间隔 -->\n\n    <!-- 大小，设置大小-->\n    <size\n        android:width=\"50dp\"\n        android:height=\"50dp\"/><!-- 宽度和高度 -->\n\n    <!-- 填充，设置填充的颜色 -->\n    <solid\n        android:color=\"@android:color/white\"/><!-- 填充的颜色 -->\n\n    <!-- 描边 dashWidth和dashGap属性，只要其中一个设置为0dp，则边框为实线边框-->\n    <stroke\n        android:width=\"2dp\" //设置边框的宽度\n        android:color=\"@android:color/black\" //设置边框的颜色\n        android:dashWidth=\"1dp\" //设置虚线的宽度\n        android:dashGap=\"2dp\"/> //设置虚线的间隔宽度\n</shape>\n```\n","slug":"android/android-shape","published":1,"updated":"2018-01-31T09:35:37.813Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61eg000vizcb58n9h0cd","content":"<p>​    在Android程序开发中，我们经常会用到Shape去定义各种各样的形状。shape可以在selector，layout等里面使用，有6个子标签，如下：<br><a id=\"more\"></a></p>\n<h2 id=\"Shape-格式\"><a href=\"#Shape-格式\" class=\"headerlink\" title=\"Shape 格式\"></a>Shape 格式</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\">&lt;shape xmlns:android=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span> &gt;</span><br><span class=\"line\">    &lt;!-- 圆角，同时设置五个属性，则Radius属性无效 --&gt;</span><br><span class=\"line\">    &lt;corners</span><br><span class=\"line\">        android:radius=<span class=\"string\">\"9dp\"</span> <span class=\"comment\">//设置四个解的半径</span></span><br><span class=\"line\">        android:topLeftRadius=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置左上角的半径</span></span><br><span class=\"line\">        android:topRightRadius=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置右上角的半径</span></span><br><span class=\"line\">        android:bottomLeftRadius=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置左下角的半径</span></span><br><span class=\"line\">        android:bottomRightRadius=<span class=\"string\">\"2dp\"</span>/&gt; <span class=\"comment\">//设置右下角的半径</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 渐变，当设置填充颜色后，无渐变效果，angle的值必须是<span class=\"number\">45</span>的倍数(包括<span class=\"number\">0</span>)，仅在type=<span class=\"string\">\"linear\"</span>有效，角度以逆时针方向 --&gt;</span><br><span class=\"line\">    &lt;gradient</span><br><span class=\"line\">        android:startColor=<span class=\"string\">\"@android:color/white\"</span></span><br><span class=\"line\">        android:centerColor=<span class=\"string\">\"@android:color/black\"</span></span><br><span class=\"line\">        android:endColor=<span class=\"string\">\"@android:color/black\"</span></span><br><span class=\"line\">        android:useLevel=<span class=\"string\">\"true\"</span></span><br><span class=\"line\">        android:angle=<span class=\"string\">\"45\"</span></span><br><span class=\"line\">        android:type=<span class=\"string\">\"radial\"</span></span><br><span class=\"line\">        android:centerX=<span class=\"string\">\"0\"</span></span><br><span class=\"line\">        android:centerY=<span class=\"string\">\"0\"</span></span><br><span class=\"line\">        android:gradientRadius=<span class=\"string\">\"90\"</span>/&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 间隔，设置四个方向的间隔--&gt;</span><br><span class=\"line\">    &lt;padding</span><br><span class=\"line\">        android:left=<span class=\"string\">\"2dp\"</span></span><br><span class=\"line\">        android:top=<span class=\"string\">\"2dp\"</span></span><br><span class=\"line\">        android:right=<span class=\"string\">\"2dp\"</span></span><br><span class=\"line\">        android:bottom=<span class=\"string\">\"2dp\"</span>/&gt;&lt;!-- 各方向的间隔 --&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 大小，设置大小--&gt;</span><br><span class=\"line\">    &lt;size</span><br><span class=\"line\">        android:width=<span class=\"string\">\"50dp\"</span></span><br><span class=\"line\">        android:height=<span class=\"string\">\"50dp\"</span>/&gt;&lt;!-- 宽度和高度 --&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 填充，设置填充的颜色 --&gt;</span><br><span class=\"line\">    &lt;solid</span><br><span class=\"line\">        android:color=<span class=\"string\">\"@android:color/white\"</span>/&gt;&lt;!-- 填充的颜色 --&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 描边 dashWidth和dashGap属性，只要其中一个设置为<span class=\"number\">0</span>dp，则边框为实线边框--&gt;</span><br><span class=\"line\">    &lt;stroke</span><br><span class=\"line\">        android:width=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置边框的宽度</span></span><br><span class=\"line\">        android:color=<span class=\"string\">\"@android:color/black\"</span> <span class=\"comment\">//设置边框的颜色</span></span><br><span class=\"line\">        android:dashWidth=<span class=\"string\">\"1dp\"</span> <span class=\"comment\">//设置虚线的宽度</span></span><br><span class=\"line\">        android:dashGap=<span class=\"string\">\"2dp\"</span>/&gt; <span class=\"comment\">//设置虚线的间隔宽度</span></span><br><span class=\"line\">&lt;/shape&gt;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p>​    在Android程序开发中，我们经常会用到Shape去定义各种各样的形状。shape可以在selector，layout等里面使用，有6个子标签，如下：<br>","more":"</p>\n<h2 id=\"Shape-格式\"><a href=\"#Shape-格式\" class=\"headerlink\" title=\"Shape 格式\"></a>Shape 格式</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\">&lt;shape xmlns:android=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span> &gt;</span><br><span class=\"line\">    &lt;!-- 圆角，同时设置五个属性，则Radius属性无效 --&gt;</span><br><span class=\"line\">    &lt;corners</span><br><span class=\"line\">        android:radius=<span class=\"string\">\"9dp\"</span> <span class=\"comment\">//设置四个解的半径</span></span><br><span class=\"line\">        android:topLeftRadius=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置左上角的半径</span></span><br><span class=\"line\">        android:topRightRadius=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置右上角的半径</span></span><br><span class=\"line\">        android:bottomLeftRadius=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置左下角的半径</span></span><br><span class=\"line\">        android:bottomRightRadius=<span class=\"string\">\"2dp\"</span>/&gt; <span class=\"comment\">//设置右下角的半径</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 渐变，当设置填充颜色后，无渐变效果，angle的值必须是<span class=\"number\">45</span>的倍数(包括<span class=\"number\">0</span>)，仅在type=<span class=\"string\">\"linear\"</span>有效，角度以逆时针方向 --&gt;</span><br><span class=\"line\">    &lt;gradient</span><br><span class=\"line\">        android:startColor=<span class=\"string\">\"@android:color/white\"</span></span><br><span class=\"line\">        android:centerColor=<span class=\"string\">\"@android:color/black\"</span></span><br><span class=\"line\">        android:endColor=<span class=\"string\">\"@android:color/black\"</span></span><br><span class=\"line\">        android:useLevel=<span class=\"string\">\"true\"</span></span><br><span class=\"line\">        android:angle=<span class=\"string\">\"45\"</span></span><br><span class=\"line\">        android:type=<span class=\"string\">\"radial\"</span></span><br><span class=\"line\">        android:centerX=<span class=\"string\">\"0\"</span></span><br><span class=\"line\">        android:centerY=<span class=\"string\">\"0\"</span></span><br><span class=\"line\">        android:gradientRadius=<span class=\"string\">\"90\"</span>/&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 间隔，设置四个方向的间隔--&gt;</span><br><span class=\"line\">    &lt;padding</span><br><span class=\"line\">        android:left=<span class=\"string\">\"2dp\"</span></span><br><span class=\"line\">        android:top=<span class=\"string\">\"2dp\"</span></span><br><span class=\"line\">        android:right=<span class=\"string\">\"2dp\"</span></span><br><span class=\"line\">        android:bottom=<span class=\"string\">\"2dp\"</span>/&gt;&lt;!-- 各方向的间隔 --&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 大小，设置大小--&gt;</span><br><span class=\"line\">    &lt;size</span><br><span class=\"line\">        android:width=<span class=\"string\">\"50dp\"</span></span><br><span class=\"line\">        android:height=<span class=\"string\">\"50dp\"</span>/&gt;&lt;!-- 宽度和高度 --&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 填充，设置填充的颜色 --&gt;</span><br><span class=\"line\">    &lt;solid</span><br><span class=\"line\">        android:color=<span class=\"string\">\"@android:color/white\"</span>/&gt;&lt;!-- 填充的颜色 --&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 描边 dashWidth和dashGap属性，只要其中一个设置为<span class=\"number\">0</span>dp，则边框为实线边框--&gt;</span><br><span class=\"line\">    &lt;stroke</span><br><span class=\"line\">        android:width=<span class=\"string\">\"2dp\"</span> <span class=\"comment\">//设置边框的宽度</span></span><br><span class=\"line\">        android:color=<span class=\"string\">\"@android:color/black\"</span> <span class=\"comment\">//设置边框的颜色</span></span><br><span class=\"line\">        android:dashWidth=<span class=\"string\">\"1dp\"</span> <span class=\"comment\">//设置虚线的宽度</span></span><br><span class=\"line\">        android:dashGap=<span class=\"string\">\"2dp\"</span>/&gt; <span class=\"comment\">//设置虚线的间隔宽度</span></span><br><span class=\"line\">&lt;/shape&gt;</span><br></pre></td></tr></table></figure>"},{"title":"android-tips","date":"2016-05-31T13:53:23.000Z","_content":"\n\n\n**解决Kotlin项目Parameter specified as non-null is null: method kotlin.jvm.internal.Intrinsics.checkParameterIsNotNull, parameter savedInstanceState**\n\n当我们自定义application并实现ActivityLifecycleCallbacks方法，这时候我们会重写onActivityCreated这个方法\n\n使用kotlin转换java代码，会是下面这样\n\n```kotlin\noverride fun onActivityCreated(activity: Activity, savedInstanceState: Bundle) {\n\n}\n```\n\n这个时候我们需要把savedInstanceState: Bundle改为savedInstanceState: Bundle?，就是在Bundle后面加个?号\n\n```kotlin\noverride fun onActivityCreated(activity: Activity, savedInstanceState: Bundle?) {\n  \n}\n```\n\nOK，又可以继续玩耍了\n\n### Android allowBackup敏感信息泄露的一些解决方案\n\n- 直接在你的Android清单文件中设置`android:allowBackup=”false”`即可，如下：\n\n  ```java\n  <application\n    \tandroid:name=\".app.App\"\n      android:allowBackup=\"true\">\n  ```\n\n- 不在你的Android清单文件中设置`android:allowBackup=”false”`，允许执行备份，但是在你应用启动页进行逻辑判断是否进行重新登陆等，譬如查看设备唯一识别设备编号和备份前是否一致，不一致则直接跳转登陆页面的同时清空当前应用数据及缓存。\n\n### 设置背景颜色偶现无效\n\n最近在开发中碰到了一个问题，在Android5.0以上的手机，对布局设置背景颜色\n\n```java\n android:background=\"@color/c_4897fa\"\n```\n\n会出现背景颜色偶现无效的问题，使用下面的方法解决\n\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:shape=\"rectangle\">\n    <!-- 角度 -->\n    <corners android:radius=\"1dp\" />\n    <!-- 填充色 -->\n    <solid android:color=\"@color/c_4897fa\" />\n</shape>\n```\n\n```java\nandroid:background=\"@drawable/home_nearby_bg\"\n```\n\n先画一个shape，再设置给backgroud\n\n### 清除Android WebView 缓存\n\n```java\npublic static void clearWebCache(Context context) {\n  try {\n    CookieSyncManager.createInstance(context);\n    CookieManager cm = CookieManager.getInstance();\n    cm.removeSessionCookie();\n    cm.removeAllCookie();\n    CookieSyncManager.getInstance().sync();\n\n    WebStorage.getInstance().deleteAllData();\n  } catch (Exception e) {\n    e.printStackTrace();\n  }\n}\n```\n### 捕获全局异常\n\n使用`Thread.UncaughtExceptionHandler`捕获全局异常\n\n### 启动LaunchIntent\n\n```java\nIntent i = getBaseContext().getPackageManager()\n.getLaunchIntentForPackage(getBaseContext().getPackageName());\ni.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);\nstartActivity(i);\n```\n\n### Annotations\n\n```java\n@CallSuper\n@StringRes\n@DrawableRes\n@CheckResult\n@NonNull\n@Nullable\n@AnimatorRes\n@AnimRes\n@AnyRes\n@AnyThread\n@ArrayRes\n@AttrRes\n@BinderThread\n@ColorRes\n@ColorInt\n@BoolRes\n@DimenRes\n@Dimension\n@IdRes\n@FloatRange\n@FractionRes\n@IntegerRes\n@XmlRes\n```\n**关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白**\n\nhttps://github.com/panyz/Blogs/blob/master/Android实战经验/关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白).md\n\n**RecyclerView去掉滚动条和滑动到边界阴影**\n\n```java\n<android.support.v7.widget.RecyclerView\n    android:id=\"@+id/rv_search_one\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:overScrollMode=\"never\"\n    android:scrollbars=\"none\" />\n```\n**设置屏幕常亮**\n\n```java\n@Override\npublic void onCreate(Bundle savedInstanceState) {\n  super.onCreate(savedInstanceState);\n  getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\n}\n@Override\nprotected void onDestroy() {\n  super.onDestroy();\n  getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\n}\n```\n\n**使用PhotoView+Viewpager崩溃问题**\n\njava.lang.IllegalArgumentException: pointerIndex out of range\n\n```java\n// 自定义一个Viewpager，重写onInterceptTouchEvent函数，在里面捕获IllegalArgumentException\npublic class PhotoViewPager extends android.support.v4.view.ViewPager {\n    public PhotoViewPager(Context context) {\n        super(context);\n    }\n\n    public PhotoViewPager(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    @Override\n    public boolean onTouchEvent(MotionEvent ev) {\n        try {\n            return super.onTouchEvent(ev);\n        } catch (IllegalArgumentException ex) {\n            ex.printStackTrace();\n        }\n        return false;\n    }\n\n    @Override\n    public boolean onInterceptTouchEvent(MotionEvent ev) {\n        try {\n            return super.onInterceptTouchEvent(ev);\n        } catch (IllegalArgumentException ex) {\n            ex.printStackTrace();\n        }\n        return false;\n    }\n}\n```\n**WebView自适应高度**\n\n```java\nprivate void setupWebView() {\n    webView.getSettings().setJavaScriptEnabled(true);\n    webView.setWebViewClient(new WebViewClient() {\n        @Override\n        public void onPageFinished(WebView view, String url) {\n            \t\twebView.loadUrl(\"javascript:MyApp.resize(document.body.getBoundingClientRect().height)\");\n            super.onPageFinished(view, url);\n        }\n    });\n    webView.addJavascriptInterface(this, \"MyApp\");\n}\n\n@JavascriptInterface\npublic void resize(final float height) {\n    MyActivity.this.runOnUiThread(new Runnable() {\n        @Override\n        public void run() {\n            webView.setLayoutParams(new LinearLayout.LayoutParams(getResources().getDisplayMetrics().widthPixels, (int) (height * getResources().getDisplayMetrics().density)));\n        }\n    });\n}\n```\nhttp://www.bubuko.com/infodetail-1612451.html\n\n**通过resId获取属性名**\n\n例：R.id.tv_hello = 0x7f080007\n\n当我们调用view的getId()时，我们能获取到0x7f080007，但有时我们需要获取到tv_hello这个属性名，可以使用下面的方法\n\n```\nString name = getResources().getResourceEntryName(id);\n```\n\n**使用AspectJ配置**\n\n使用网上的配置，在gradle版本为2.2.3时，不会出现问题，当切换到2.3.3时，会报\n\nNo such property: project for class: com.android.build.gradle.LibraryPlugin，\n\n修复办法：不使用 LibraryPlugin 直接使用 project\n\n```java\nandroid.libraryVariants.all { variant ->\n//    LibraryPlugin plugin = project.plugins.getPlugin(LibraryPlugin)\n    JavaCompile javaCompile = variant.javaCompile\n    javaCompile.doLast {\n        String[] args = [\"-showWeaveInfo\",\n                         \"-1.5\",\n                         \"-inpath\", javaCompile.destinationDir.toString(),\n                         \"-aspectpath\", javaCompile.classpath.asPath,\n                         \"-d\", javaCompile.destinationDir.toString(),\n                         \"-classpath\", javaCompile.classpath.asPath,\n                         \"-bootclasspath\", project.android.bootClasspath.join(\n                File.pathSeparator)]\n\n        MessageHandler handler = new MessageHandler(true);\n        new Main().run(args, handler)\n\n        def log = project.logger\n        for (IMessage message : handler.getMessages(null, true)) {\n            switch (message.getKind()) {\n                case IMessage.ABORT:\n                case IMessage.ERROR:\n                case IMessage.FAIL:\n                    log.error message.message, message.thrown\n                    break;\n                case IMessage.WARNING:\n                case IMessage.INFO:\n                    log.info message.message, message.thrown\n                    break;\n                case IMessage.DEBUG:\n                    log.debug message.message, message.thrown\n                    break;\n            }\n        }\n    }\n}\n```\n\n**解决支持库版本兼容问题：**\n\n(all com.android.support libraries must use the exact same version specification)\n\n去改第三方库所用的支持库版本比较麻烦，如果用的库很多的话工作量很大。这个时候我们可以考虑强制让所有模块都用相同的支持库版本。\n\n在app build.gradle中添加：\n\n```java\nconfigurations.all {\n    resolutionStrategy.eachDependency { DependencyResolveDetails details ->\n        def requested = details.requested\n        if (requested.group == 'com.android.support') {\n            if (!requested.name.startsWith(\"multidex\")) {\n                details.useVersion '25.3.1'\n            }\n        }\n    }\n}\n```\n\n其中，25.3.1就是你要使用的支持库版本号，你可以根据需要改成其它的。\n\n\n\n[error: style attribute '@android:attr/windowEnterAnimation' not found.](http://blog.csdn.net/u012730980/article/details/78390428)\n\n在Project/gradle.properties中添加 android.enableAapt2=false\n\n**解决Google Pixel Download Manager不在通知栏显示进度的BUG**\n\n```java\nDownloadManager.Request request = new DownloadManager.Request(Download_Uri);\n// 添加下面这行\nrequest.setAllowedOverRoaming(false);\n```\n\n**解决Error:Some file crunching failed, see logs for details**\n\n```java\nandroid {\n\n    compileSdkVersion 25\n    buildToolsVersion '25.0.3'\n    useLibrary 'org.apache.http.legacy'\n\n    aaptOptions {\n        cruncherEnabled = false\n        useNewCruncher = false\n    }\n}\n```\n\n添加aaptOptions一栏\n\n**解决viewpager滑动不流畅的问题**\n\n```java\npublic class customViewpagerView extends ViewPager {  \n  \n    private int preX=0;  \n    public customViewpagerView(Context context, AttributeSet attrs) {  \n        super(context, attrs);  \n          \n    }  \n    public customViewpagerView(Context context) {  \n        super(context);  \n          \n    }  \n      \n    @Override  \n    public boolean onInterceptTouchEvent(MotionEvent even) {  \n          \n        if(even.getAction()==MotionEvent.ACTION_DOWN)  \n        {  \n            preX=(int) even.getX();  \n        }else  \n        {  \n            if(Math.abs((int)even.getX()-preX)>10)  \n            {  \n                return true;  \n            }else  \n            {  \n                preX=(int) even.getX();  \n            }  \n        }  \n        return super.onInterceptTouchEvent(even);  \n    }  \n}  \n```\n\n","source":"_posts/android/android-tips.md","raw":"---\ntitle: android-tips\ndate: 2016-05-31 21:53:23\ntags: android\n---\n\n\n\n**解决Kotlin项目Parameter specified as non-null is null: method kotlin.jvm.internal.Intrinsics.checkParameterIsNotNull, parameter savedInstanceState**\n\n当我们自定义application并实现ActivityLifecycleCallbacks方法，这时候我们会重写onActivityCreated这个方法\n\n使用kotlin转换java代码，会是下面这样\n\n```kotlin\noverride fun onActivityCreated(activity: Activity, savedInstanceState: Bundle) {\n\n}\n```\n\n这个时候我们需要把savedInstanceState: Bundle改为savedInstanceState: Bundle?，就是在Bundle后面加个?号\n\n```kotlin\noverride fun onActivityCreated(activity: Activity, savedInstanceState: Bundle?) {\n  \n}\n```\n\nOK，又可以继续玩耍了\n\n### Android allowBackup敏感信息泄露的一些解决方案\n\n- 直接在你的Android清单文件中设置`android:allowBackup=”false”`即可，如下：\n\n  ```java\n  <application\n    \tandroid:name=\".app.App\"\n      android:allowBackup=\"true\">\n  ```\n\n- 不在你的Android清单文件中设置`android:allowBackup=”false”`，允许执行备份，但是在你应用启动页进行逻辑判断是否进行重新登陆等，譬如查看设备唯一识别设备编号和备份前是否一致，不一致则直接跳转登陆页面的同时清空当前应用数据及缓存。\n\n### 设置背景颜色偶现无效\n\n最近在开发中碰到了一个问题，在Android5.0以上的手机，对布局设置背景颜色\n\n```java\n android:background=\"@color/c_4897fa\"\n```\n\n会出现背景颜色偶现无效的问题，使用下面的方法解决\n\n```java\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:shape=\"rectangle\">\n    <!-- 角度 -->\n    <corners android:radius=\"1dp\" />\n    <!-- 填充色 -->\n    <solid android:color=\"@color/c_4897fa\" />\n</shape>\n```\n\n```java\nandroid:background=\"@drawable/home_nearby_bg\"\n```\n\n先画一个shape，再设置给backgroud\n\n### 清除Android WebView 缓存\n\n```java\npublic static void clearWebCache(Context context) {\n  try {\n    CookieSyncManager.createInstance(context);\n    CookieManager cm = CookieManager.getInstance();\n    cm.removeSessionCookie();\n    cm.removeAllCookie();\n    CookieSyncManager.getInstance().sync();\n\n    WebStorage.getInstance().deleteAllData();\n  } catch (Exception e) {\n    e.printStackTrace();\n  }\n}\n```\n### 捕获全局异常\n\n使用`Thread.UncaughtExceptionHandler`捕获全局异常\n\n### 启动LaunchIntent\n\n```java\nIntent i = getBaseContext().getPackageManager()\n.getLaunchIntentForPackage(getBaseContext().getPackageName());\ni.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);\nstartActivity(i);\n```\n\n### Annotations\n\n```java\n@CallSuper\n@StringRes\n@DrawableRes\n@CheckResult\n@NonNull\n@Nullable\n@AnimatorRes\n@AnimRes\n@AnyRes\n@AnyThread\n@ArrayRes\n@AttrRes\n@BinderThread\n@ColorRes\n@ColorInt\n@BoolRes\n@DimenRes\n@Dimension\n@IdRes\n@FloatRange\n@FractionRes\n@IntegerRes\n@XmlRes\n```\n**关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白**\n\nhttps://github.com/panyz/Blogs/blob/master/Android实战经验/关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白).md\n\n**RecyclerView去掉滚动条和滑动到边界阴影**\n\n```java\n<android.support.v7.widget.RecyclerView\n    android:id=\"@+id/rv_search_one\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:overScrollMode=\"never\"\n    android:scrollbars=\"none\" />\n```\n**设置屏幕常亮**\n\n```java\n@Override\npublic void onCreate(Bundle savedInstanceState) {\n  super.onCreate(savedInstanceState);\n  getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\n}\n@Override\nprotected void onDestroy() {\n  super.onDestroy();\n  getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);\n}\n```\n\n**使用PhotoView+Viewpager崩溃问题**\n\njava.lang.IllegalArgumentException: pointerIndex out of range\n\n```java\n// 自定义一个Viewpager，重写onInterceptTouchEvent函数，在里面捕获IllegalArgumentException\npublic class PhotoViewPager extends android.support.v4.view.ViewPager {\n    public PhotoViewPager(Context context) {\n        super(context);\n    }\n\n    public PhotoViewPager(Context context, AttributeSet attrs) {\n        super(context, attrs);\n    }\n\n    @Override\n    public boolean onTouchEvent(MotionEvent ev) {\n        try {\n            return super.onTouchEvent(ev);\n        } catch (IllegalArgumentException ex) {\n            ex.printStackTrace();\n        }\n        return false;\n    }\n\n    @Override\n    public boolean onInterceptTouchEvent(MotionEvent ev) {\n        try {\n            return super.onInterceptTouchEvent(ev);\n        } catch (IllegalArgumentException ex) {\n            ex.printStackTrace();\n        }\n        return false;\n    }\n}\n```\n**WebView自适应高度**\n\n```java\nprivate void setupWebView() {\n    webView.getSettings().setJavaScriptEnabled(true);\n    webView.setWebViewClient(new WebViewClient() {\n        @Override\n        public void onPageFinished(WebView view, String url) {\n            \t\twebView.loadUrl(\"javascript:MyApp.resize(document.body.getBoundingClientRect().height)\");\n            super.onPageFinished(view, url);\n        }\n    });\n    webView.addJavascriptInterface(this, \"MyApp\");\n}\n\n@JavascriptInterface\npublic void resize(final float height) {\n    MyActivity.this.runOnUiThread(new Runnable() {\n        @Override\n        public void run() {\n            webView.setLayoutParams(new LinearLayout.LayoutParams(getResources().getDisplayMetrics().widthPixels, (int) (height * getResources().getDisplayMetrics().density)));\n        }\n    });\n}\n```\nhttp://www.bubuko.com/infodetail-1612451.html\n\n**通过resId获取属性名**\n\n例：R.id.tv_hello = 0x7f080007\n\n当我们调用view的getId()时，我们能获取到0x7f080007，但有时我们需要获取到tv_hello这个属性名，可以使用下面的方法\n\n```\nString name = getResources().getResourceEntryName(id);\n```\n\n**使用AspectJ配置**\n\n使用网上的配置，在gradle版本为2.2.3时，不会出现问题，当切换到2.3.3时，会报\n\nNo such property: project for class: com.android.build.gradle.LibraryPlugin，\n\n修复办法：不使用 LibraryPlugin 直接使用 project\n\n```java\nandroid.libraryVariants.all { variant ->\n//    LibraryPlugin plugin = project.plugins.getPlugin(LibraryPlugin)\n    JavaCompile javaCompile = variant.javaCompile\n    javaCompile.doLast {\n        String[] args = [\"-showWeaveInfo\",\n                         \"-1.5\",\n                         \"-inpath\", javaCompile.destinationDir.toString(),\n                         \"-aspectpath\", javaCompile.classpath.asPath,\n                         \"-d\", javaCompile.destinationDir.toString(),\n                         \"-classpath\", javaCompile.classpath.asPath,\n                         \"-bootclasspath\", project.android.bootClasspath.join(\n                File.pathSeparator)]\n\n        MessageHandler handler = new MessageHandler(true);\n        new Main().run(args, handler)\n\n        def log = project.logger\n        for (IMessage message : handler.getMessages(null, true)) {\n            switch (message.getKind()) {\n                case IMessage.ABORT:\n                case IMessage.ERROR:\n                case IMessage.FAIL:\n                    log.error message.message, message.thrown\n                    break;\n                case IMessage.WARNING:\n                case IMessage.INFO:\n                    log.info message.message, message.thrown\n                    break;\n                case IMessage.DEBUG:\n                    log.debug message.message, message.thrown\n                    break;\n            }\n        }\n    }\n}\n```\n\n**解决支持库版本兼容问题：**\n\n(all com.android.support libraries must use the exact same version specification)\n\n去改第三方库所用的支持库版本比较麻烦，如果用的库很多的话工作量很大。这个时候我们可以考虑强制让所有模块都用相同的支持库版本。\n\n在app build.gradle中添加：\n\n```java\nconfigurations.all {\n    resolutionStrategy.eachDependency { DependencyResolveDetails details ->\n        def requested = details.requested\n        if (requested.group == 'com.android.support') {\n            if (!requested.name.startsWith(\"multidex\")) {\n                details.useVersion '25.3.1'\n            }\n        }\n    }\n}\n```\n\n其中，25.3.1就是你要使用的支持库版本号，你可以根据需要改成其它的。\n\n\n\n[error: style attribute '@android:attr/windowEnterAnimation' not found.](http://blog.csdn.net/u012730980/article/details/78390428)\n\n在Project/gradle.properties中添加 android.enableAapt2=false\n\n**解决Google Pixel Download Manager不在通知栏显示进度的BUG**\n\n```java\nDownloadManager.Request request = new DownloadManager.Request(Download_Uri);\n// 添加下面这行\nrequest.setAllowedOverRoaming(false);\n```\n\n**解决Error:Some file crunching failed, see logs for details**\n\n```java\nandroid {\n\n    compileSdkVersion 25\n    buildToolsVersion '25.0.3'\n    useLibrary 'org.apache.http.legacy'\n\n    aaptOptions {\n        cruncherEnabled = false\n        useNewCruncher = false\n    }\n}\n```\n\n添加aaptOptions一栏\n\n**解决viewpager滑动不流畅的问题**\n\n```java\npublic class customViewpagerView extends ViewPager {  \n  \n    private int preX=0;  \n    public customViewpagerView(Context context, AttributeSet attrs) {  \n        super(context, attrs);  \n          \n    }  \n    public customViewpagerView(Context context) {  \n        super(context);  \n          \n    }  \n      \n    @Override  \n    public boolean onInterceptTouchEvent(MotionEvent even) {  \n          \n        if(even.getAction()==MotionEvent.ACTION_DOWN)  \n        {  \n            preX=(int) even.getX();  \n        }else  \n        {  \n            if(Math.abs((int)even.getX()-preX)>10)  \n            {  \n                return true;  \n            }else  \n            {  \n                preX=(int) even.getX();  \n            }  \n        }  \n        return super.onInterceptTouchEvent(even);  \n    }  \n}  \n```\n\n","slug":"android/android-tips","published":1,"updated":"2018-05-20T13:04:25.681Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ei000yizcbb0jdj2g8","content":"<p><strong>解决Kotlin项目Parameter specified as non-null is null: method kotlin.jvm.internal.Intrinsics.checkParameterIsNotNull, parameter savedInstanceState</strong></p>\n<p>当我们自定义application并实现ActivityLifecycleCallbacks方法，这时候我们会重写onActivityCreated这个方法</p>\n<p>使用kotlin转换java代码，会是下面这样</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityCreated</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>, savedInstanceState: <span class=\"type\">Bundle</span>)</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这个时候我们需要把savedInstanceState: Bundle改为savedInstanceState: Bundle?，就是在Bundle后面加个?号</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityCreated</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>, savedInstanceState: <span class=\"type\">Bundle</span>?)</span></span> &#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>OK，又可以继续玩耍了</p>\n<h3 id=\"Android-allowBackup敏感信息泄露的一些解决方案\"><a href=\"#Android-allowBackup敏感信息泄露的一些解决方案\" class=\"headerlink\" title=\"Android allowBackup敏感信息泄露的一些解决方案\"></a>Android allowBackup敏感信息泄露的一些解决方案</h3><ul>\n<li><p>直接在你的Android清单文件中设置<code>android:allowBackup=”false”</code>即可，如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;application</span><br><span class=\"line\">  \tandroid:name=<span class=\"string\">\".app.App\"</span></span><br><span class=\"line\">    android:allowBackup=<span class=\"string\">\"true\"</span>&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>不在你的Android清单文件中设置<code>android:allowBackup=”false”</code>，允许执行备份，但是在你应用启动页进行逻辑判断是否进行重新登陆等，譬如查看设备唯一识别设备编号和备份前是否一致，不一致则直接跳转登陆页面的同时清空当前应用数据及缓存。</p>\n</li>\n</ul>\n<h3 id=\"设置背景颜色偶现无效\"><a href=\"#设置背景颜色偶现无效\" class=\"headerlink\" title=\"设置背景颜色偶现无效\"></a>设置背景颜色偶现无效</h3><p>最近在开发中碰到了一个问题，在Android5.0以上的手机，对布局设置背景颜色</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android:background=<span class=\"string\">\"@color/c_4897fa\"</span></span><br></pre></td></tr></table></figure>\n<p>会出现背景颜色偶现无效的问题，使用下面的方法解决</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\">&lt;shape xmlns:android=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span><br><span class=\"line\">    android:shape=<span class=\"string\">\"rectangle\"</span>&gt;</span><br><span class=\"line\">    &lt;!-- 角度 --&gt;</span><br><span class=\"line\">    &lt;corners android:radius=<span class=\"string\">\"1dp\"</span> /&gt;</span><br><span class=\"line\">    &lt;!-- 填充色 --&gt;</span><br><span class=\"line\">    &lt;solid android:color=<span class=\"string\">\"@color/c_4897fa\"</span> /&gt;</span><br><span class=\"line\">&lt;/shape&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android:background=<span class=\"string\">\"@drawable/home_nearby_bg\"</span></span><br></pre></td></tr></table></figure>\n<p>先画一个shape，再设置给backgroud</p>\n<h3 id=\"清除Android-WebView-缓存\"><a href=\"#清除Android-WebView-缓存\" class=\"headerlink\" title=\"清除Android WebView 缓存\"></a>清除Android WebView 缓存</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">clearWebCache</span><span class=\"params\">(Context context)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    CookieSyncManager.createInstance(context);</span><br><span class=\"line\">    CookieManager cm = CookieManager.getInstance();</span><br><span class=\"line\">    cm.removeSessionCookie();</span><br><span class=\"line\">    cm.removeAllCookie();</span><br><span class=\"line\">    CookieSyncManager.getInstance().sync();</span><br><span class=\"line\"></span><br><span class=\"line\">    WebStorage.getInstance().deleteAllData();</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"捕获全局异常\"><a href=\"#捕获全局异常\" class=\"headerlink\" title=\"捕获全局异常\"></a>捕获全局异常</h3><p>使用<code>Thread.UncaughtExceptionHandler</code>捕获全局异常</p>\n<h3 id=\"启动LaunchIntent\"><a href=\"#启动LaunchIntent\" class=\"headerlink\" title=\"启动LaunchIntent\"></a>启动LaunchIntent</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent i = getBaseContext().getPackageManager()</span><br><span class=\"line\">.getLaunchIntentForPackage(getBaseContext().getPackageName());</span><br><span class=\"line\">i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span><br><span class=\"line\">startActivity(i);</span><br></pre></td></tr></table></figure>\n<h3 id=\"Annotations\"><a href=\"#Annotations\" class=\"headerlink\" title=\"Annotations\"></a>Annotations</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@CallSuper</span></span><br><span class=\"line\"><span class=\"meta\">@StringRes</span></span><br><span class=\"line\"><span class=\"meta\">@DrawableRes</span></span><br><span class=\"line\"><span class=\"meta\">@CheckResult</span></span><br><span class=\"line\"><span class=\"meta\">@NonNull</span></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"meta\">@AnimatorRes</span></span><br><span class=\"line\"><span class=\"meta\">@AnimRes</span></span><br><span class=\"line\"><span class=\"meta\">@AnyRes</span></span><br><span class=\"line\"><span class=\"meta\">@AnyThread</span></span><br><span class=\"line\"><span class=\"meta\">@ArrayRes</span></span><br><span class=\"line\"><span class=\"meta\">@AttrRes</span></span><br><span class=\"line\"><span class=\"meta\">@BinderThread</span></span><br><span class=\"line\"><span class=\"meta\">@ColorRes</span></span><br><span class=\"line\"><span class=\"meta\">@ColorInt</span></span><br><span class=\"line\"><span class=\"meta\">@BoolRes</span></span><br><span class=\"line\"><span class=\"meta\">@DimenRes</span></span><br><span class=\"line\"><span class=\"meta\">@Dimension</span></span><br><span class=\"line\"><span class=\"meta\">@IdRes</span></span><br><span class=\"line\"><span class=\"meta\">@FloatRange</span></span><br><span class=\"line\"><span class=\"meta\">@FractionRes</span></span><br><span class=\"line\"><span class=\"meta\">@IntegerRes</span></span><br><span class=\"line\"><span class=\"meta\">@XmlRes</span></span><br></pre></td></tr></table></figure>\n<p><strong>关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白</strong></p>\n<p><a href=\"https://github.com/panyz/Blogs/blob/master/Android实战经验/关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白).md\" target=\"_blank\" rel=\"noopener\">https://github.com/panyz/Blogs/blob/master/Android实战经验/关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白).md</a></p>\n<p><strong>RecyclerView去掉滚动条和滑动到边界阴影</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;android.support.v7.widget.RecyclerView</span><br><span class=\"line\">    android:id=<span class=\"string\">\"@+id/rv_search_one\"</span></span><br><span class=\"line\">    android:layout_width=<span class=\"string\">\"match_parent\"</span></span><br><span class=\"line\">    android:layout_height=<span class=\"string\">\"match_parent\"</span></span><br><span class=\"line\">    android:overScrollMode=<span class=\"string\">\"never\"</span></span><br><span class=\"line\">    android:scrollbars=<span class=\"string\">\"none\"</span> /&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>设置屏幕常亮</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</span><br><span class=\"line\">  getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onDestroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">super</span>.onDestroy();</span><br><span class=\"line\">  getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>使用PhotoView+Viewpager崩溃问题</strong></p>\n<p>java.lang.IllegalArgumentException: pointerIndex out of range</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 自定义一个Viewpager，重写onInterceptTouchEvent函数，在里面捕获IllegalArgumentException</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PhotoViewPager</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">support</span>.<span class=\"title\">v4</span>.<span class=\"title\">view</span>.<span class=\"title\">ViewPager</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">PhotoViewPager</span><span class=\"params\">(Context context)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">PhotoViewPager</span><span class=\"params\">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context, attrs);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTouchEvent</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onTouchEvent(ev);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IllegalArgumentException ex) &#123;</span><br><span class=\"line\">            ex.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onInterceptTouchEvent(ev);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IllegalArgumentException ex) &#123;</span><br><span class=\"line\">            ex.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>WebView自适应高度</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setupWebView</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    webView.getSettings().setJavaScriptEnabled(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    webView.setWebViewClient(<span class=\"keyword\">new</span> WebViewClient() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onPageFinished</span><span class=\"params\">(WebView view, String url)</span> </span>&#123;</span><br><span class=\"line\">            \t\twebView.loadUrl(<span class=\"string\">\"javascript:MyApp.resize(document.body.getBoundingClientRect().height)\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">super</span>.onPageFinished(view, url);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    webView.addJavascriptInterface(<span class=\"keyword\">this</span>, <span class=\"string\">\"MyApp\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@JavascriptInterface</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">resize</span><span class=\"params\">(<span class=\"keyword\">final</span> <span class=\"keyword\">float</span> height)</span> </span>&#123;</span><br><span class=\"line\">    MyActivity.<span class=\"keyword\">this</span>.runOnUiThread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            webView.setLayoutParams(<span class=\"keyword\">new</span> LinearLayout.LayoutParams(getResources().getDisplayMetrics().widthPixels, (<span class=\"keyword\">int</span>) (height * getResources().getDisplayMetrics().density)));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://www.bubuko.com/infodetail-1612451.html\" target=\"_blank\" rel=\"noopener\">http://www.bubuko.com/infodetail-1612451.html</a></p>\n<p><strong>通过resId获取属性名</strong></p>\n<p>例：R.id.tv_hello = 0x7f080007</p>\n<p>当我们调用view的getId()时，我们能获取到0x7f080007，但有时我们需要获取到tv_hello这个属性名，可以使用下面的方法</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String name = getResources().getResourceEntryName(id);</span><br></pre></td></tr></table></figure>\n<p><strong>使用AspectJ配置</strong></p>\n<p>使用网上的配置，在gradle版本为2.2.3时，不会出现问题，当切换到2.3.3时，会报</p>\n<p>No such property: project for class: com.android.build.gradle.LibraryPlugin，</p>\n<p>修复办法：不使用 LibraryPlugin 直接使用 project</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android.libraryVariants.all &#123; variant -&gt;</span><br><span class=\"line\"><span class=\"comment\">//    LibraryPlugin plugin = project.plugins.getPlugin(LibraryPlugin)</span></span><br><span class=\"line\">    JavaCompile javaCompile = variant.javaCompile</span><br><span class=\"line\">    javaCompile.doLast &#123;</span><br><span class=\"line\">        String[] args = [<span class=\"string\">\"-showWeaveInfo\"</span>,</span><br><span class=\"line\">                         <span class=\"string\">\"-1.5\"</span>,</span><br><span class=\"line\">                         <span class=\"string\">\"-inpath\"</span>, javaCompile.destinationDir.toString(),</span><br><span class=\"line\">                         <span class=\"string\">\"-aspectpath\"</span>, javaCompile.classpath.asPath,</span><br><span class=\"line\">                         <span class=\"string\">\"-d\"</span>, javaCompile.destinationDir.toString(),</span><br><span class=\"line\">                         <span class=\"string\">\"-classpath\"</span>, javaCompile.classpath.asPath,</span><br><span class=\"line\">                         <span class=\"string\">\"-bootclasspath\"</span>, project.android.bootClasspath.join(</span><br><span class=\"line\">                File.pathSeparator)]</span><br><span class=\"line\"></span><br><span class=\"line\">        MessageHandler handler = <span class=\"keyword\">new</span> MessageHandler(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Main().run(args, handler)</span><br><span class=\"line\"></span><br><span class=\"line\">        def log = project.logger</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (IMessage message : handler.getMessages(<span class=\"keyword\">null</span>, <span class=\"keyword\">true</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (message.getKind()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.ABORT:</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.ERROR:</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.FAIL:</span><br><span class=\"line\">                    log.error message.message, message.thrown</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.WARNING:</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.INFO:</span><br><span class=\"line\">                    log.info message.message, message.thrown</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.DEBUG:</span><br><span class=\"line\">                    log.debug message.message, message.thrown</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>解决支持库版本兼容问题：</strong></p>\n<p>(all com.android.support libraries must use the exact same version specification)</p>\n<p>去改第三方库所用的支持库版本比较麻烦，如果用的库很多的话工作量很大。这个时候我们可以考虑强制让所有模块都用相同的支持库版本。</p>\n<p>在app build.gradle中添加：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">configurations.all &#123;</span><br><span class=\"line\">    resolutionStrategy.eachDependency &#123; DependencyResolveDetails details -&gt;</span><br><span class=\"line\">        def requested = details.requested</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (requested.group == <span class=\"string\">'com.android.support'</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!requested.name.startsWith(<span class=\"string\">\"multidex\"</span>)) &#123;</span><br><span class=\"line\">                details.useVersion <span class=\"string\">'25.3.1'</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>其中，25.3.1就是你要使用的支持库版本号，你可以根据需要改成其它的。</p>\n<p><a href=\"http://blog.csdn.net/u012730980/article/details/78390428\" target=\"_blank\" rel=\"noopener\">error: style attribute ‘@android:attr/windowEnterAnimation’ not found.</a></p>\n<p>在Project/gradle.properties中添加 android.enableAapt2=false</p>\n<p><strong>解决Google Pixel Download Manager不在通知栏显示进度的BUG</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DownloadManager.Request request = <span class=\"keyword\">new</span> DownloadManager.Request(Download_Uri);</span><br><span class=\"line\"><span class=\"comment\">// 添加下面这行</span></span><br><span class=\"line\">request.setAllowedOverRoaming(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n<p><strong>解决Error:Some file crunching failed, see logs for details</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    compileSdkVersion <span class=\"number\">25</span></span><br><span class=\"line\">    buildToolsVersion <span class=\"string\">'25.0.3'</span></span><br><span class=\"line\">    useLibrary <span class=\"string\">'org.apache.http.legacy'</span></span><br><span class=\"line\"></span><br><span class=\"line\">    aaptOptions &#123;</span><br><span class=\"line\">        cruncherEnabled = <span class=\"keyword\">false</span></span><br><span class=\"line\">        useNewCruncher = <span class=\"keyword\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>添加aaptOptions一栏</p>\n<p><strong>解决viewpager滑动不流畅的问题</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">customViewpagerView</span> <span class=\"keyword\">extends</span> <span class=\"title\">ViewPager</span> </span>&#123;  </span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> preX=<span class=\"number\">0</span>;  </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">customViewpagerView</span><span class=\"params\">(Context context, AttributeSet attrs)</span> </span>&#123;  </span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context, attrs);  </span><br><span class=\"line\">          </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">customViewpagerView</span><span class=\"params\">(Context context)</span> </span>&#123;  </span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context);  </span><br><span class=\"line\">          </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">      </span><br><span class=\"line\">    <span class=\"meta\">@Override</span>  </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(MotionEvent even)</span> </span>&#123;  </span><br><span class=\"line\">          </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(even.getAction()==MotionEvent.ACTION_DOWN)  </span><br><span class=\"line\">        &#123;  </span><br><span class=\"line\">            preX=(<span class=\"keyword\">int</span>) even.getX();  </span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>  </span><br><span class=\"line\">        &#123;  </span><br><span class=\"line\">            <span class=\"keyword\">if</span>(Math.abs((<span class=\"keyword\">int</span>)even.getX()-preX)&gt;<span class=\"number\">10</span>)  </span><br><span class=\"line\">            &#123;  </span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;  </span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span>  </span><br><span class=\"line\">            &#123;  </span><br><span class=\"line\">                preX=(<span class=\"keyword\">int</span>) even.getX();  </span><br><span class=\"line\">            &#125;  </span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onInterceptTouchEvent(even);  </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>解决Kotlin项目Parameter specified as non-null is null: method kotlin.jvm.internal.Intrinsics.checkParameterIsNotNull, parameter savedInstanceState</strong></p>\n<p>当我们自定义application并实现ActivityLifecycleCallbacks方法，这时候我们会重写onActivityCreated这个方法</p>\n<p>使用kotlin转换java代码，会是下面这样</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityCreated</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>, savedInstanceState: <span class=\"type\">Bundle</span>)</span></span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这个时候我们需要把savedInstanceState: Bundle改为savedInstanceState: Bundle?，就是在Bundle后面加个?号</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onActivityCreated</span><span class=\"params\">(activity: <span class=\"type\">Activity</span>, savedInstanceState: <span class=\"type\">Bundle</span>?)</span></span> &#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>OK，又可以继续玩耍了</p>\n<h3 id=\"Android-allowBackup敏感信息泄露的一些解决方案\"><a href=\"#Android-allowBackup敏感信息泄露的一些解决方案\" class=\"headerlink\" title=\"Android allowBackup敏感信息泄露的一些解决方案\"></a>Android allowBackup敏感信息泄露的一些解决方案</h3><ul>\n<li><p>直接在你的Android清单文件中设置<code>android:allowBackup=”false”</code>即可，如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;application</span><br><span class=\"line\">  \tandroid:name=<span class=\"string\">\".app.App\"</span></span><br><span class=\"line\">    android:allowBackup=<span class=\"string\">\"true\"</span>&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>不在你的Android清单文件中设置<code>android:allowBackup=”false”</code>，允许执行备份，但是在你应用启动页进行逻辑判断是否进行重新登陆等，譬如查看设备唯一识别设备编号和备份前是否一致，不一致则直接跳转登陆页面的同时清空当前应用数据及缓存。</p>\n</li>\n</ul>\n<h3 id=\"设置背景颜色偶现无效\"><a href=\"#设置背景颜色偶现无效\" class=\"headerlink\" title=\"设置背景颜色偶现无效\"></a>设置背景颜色偶现无效</h3><p>最近在开发中碰到了一个问题，在Android5.0以上的手机，对布局设置背景颜色</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android:background=<span class=\"string\">\"@color/c_4897fa\"</span></span><br></pre></td></tr></table></figure>\n<p>会出现背景颜色偶现无效的问题，使用下面的方法解决</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=<span class=\"string\">\"1.0\"</span> encoding=<span class=\"string\">\"utf-8\"</span>?&gt;</span><br><span class=\"line\">&lt;shape xmlns:android=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span><br><span class=\"line\">    android:shape=<span class=\"string\">\"rectangle\"</span>&gt;</span><br><span class=\"line\">    &lt;!-- 角度 --&gt;</span><br><span class=\"line\">    &lt;corners android:radius=<span class=\"string\">\"1dp\"</span> /&gt;</span><br><span class=\"line\">    &lt;!-- 填充色 --&gt;</span><br><span class=\"line\">    &lt;solid android:color=<span class=\"string\">\"@color/c_4897fa\"</span> /&gt;</span><br><span class=\"line\">&lt;/shape&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android:background=<span class=\"string\">\"@drawable/home_nearby_bg\"</span></span><br></pre></td></tr></table></figure>\n<p>先画一个shape，再设置给backgroud</p>\n<h3 id=\"清除Android-WebView-缓存\"><a href=\"#清除Android-WebView-缓存\" class=\"headerlink\" title=\"清除Android WebView 缓存\"></a>清除Android WebView 缓存</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">clearWebCache</span><span class=\"params\">(Context context)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    CookieSyncManager.createInstance(context);</span><br><span class=\"line\">    CookieManager cm = CookieManager.getInstance();</span><br><span class=\"line\">    cm.removeSessionCookie();</span><br><span class=\"line\">    cm.removeAllCookie();</span><br><span class=\"line\">    CookieSyncManager.getInstance().sync();</span><br><span class=\"line\"></span><br><span class=\"line\">    WebStorage.getInstance().deleteAllData();</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"捕获全局异常\"><a href=\"#捕获全局异常\" class=\"headerlink\" title=\"捕获全局异常\"></a>捕获全局异常</h3><p>使用<code>Thread.UncaughtExceptionHandler</code>捕获全局异常</p>\n<h3 id=\"启动LaunchIntent\"><a href=\"#启动LaunchIntent\" class=\"headerlink\" title=\"启动LaunchIntent\"></a>启动LaunchIntent</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Intent i = getBaseContext().getPackageManager()</span><br><span class=\"line\">.getLaunchIntentForPackage(getBaseContext().getPackageName());</span><br><span class=\"line\">i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span><br><span class=\"line\">startActivity(i);</span><br></pre></td></tr></table></figure>\n<h3 id=\"Annotations\"><a href=\"#Annotations\" class=\"headerlink\" title=\"Annotations\"></a>Annotations</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@CallSuper</span></span><br><span class=\"line\"><span class=\"meta\">@StringRes</span></span><br><span class=\"line\"><span class=\"meta\">@DrawableRes</span></span><br><span class=\"line\"><span class=\"meta\">@CheckResult</span></span><br><span class=\"line\"><span class=\"meta\">@NonNull</span></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"meta\">@AnimatorRes</span></span><br><span class=\"line\"><span class=\"meta\">@AnimRes</span></span><br><span class=\"line\"><span class=\"meta\">@AnyRes</span></span><br><span class=\"line\"><span class=\"meta\">@AnyThread</span></span><br><span class=\"line\"><span class=\"meta\">@ArrayRes</span></span><br><span class=\"line\"><span class=\"meta\">@AttrRes</span></span><br><span class=\"line\"><span class=\"meta\">@BinderThread</span></span><br><span class=\"line\"><span class=\"meta\">@ColorRes</span></span><br><span class=\"line\"><span class=\"meta\">@ColorInt</span></span><br><span class=\"line\"><span class=\"meta\">@BoolRes</span></span><br><span class=\"line\"><span class=\"meta\">@DimenRes</span></span><br><span class=\"line\"><span class=\"meta\">@Dimension</span></span><br><span class=\"line\"><span class=\"meta\">@IdRes</span></span><br><span class=\"line\"><span class=\"meta\">@FloatRange</span></span><br><span class=\"line\"><span class=\"meta\">@FractionRes</span></span><br><span class=\"line\"><span class=\"meta\">@IntegerRes</span></span><br><span class=\"line\"><span class=\"meta\">@XmlRes</span></span><br></pre></td></tr></table></figure>\n<p><strong>关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白</strong></p>\n<p><a href=\"https://github.com/panyz/Blogs/blob/master/Android实战经验/关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白).md\" target=\"_blank\" rel=\"noopener\">https://github.com/panyz/Blogs/blob/master/Android实战经验/关于Android7.0系统使用webview遇到的一个问题(二级跳转后界面空白).md</a></p>\n<p><strong>RecyclerView去掉滚动条和滑动到边界阴影</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;android.support.v7.widget.RecyclerView</span><br><span class=\"line\">    android:id=<span class=\"string\">\"@+id/rv_search_one\"</span></span><br><span class=\"line\">    android:layout_width=<span class=\"string\">\"match_parent\"</span></span><br><span class=\"line\">    android:layout_height=<span class=\"string\">\"match_parent\"</span></span><br><span class=\"line\">    android:overScrollMode=<span class=\"string\">\"never\"</span></span><br><span class=\"line\">    android:scrollbars=<span class=\"string\">\"none\"</span> /&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>设置屏幕常亮</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</span><br><span class=\"line\">  getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onDestroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">super</span>.onDestroy();</span><br><span class=\"line\">  getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>使用PhotoView+Viewpager崩溃问题</strong></p>\n<p>java.lang.IllegalArgumentException: pointerIndex out of range</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 自定义一个Viewpager，重写onInterceptTouchEvent函数，在里面捕获IllegalArgumentException</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PhotoViewPager</span> <span class=\"keyword\">extends</span> <span class=\"title\">android</span>.<span class=\"title\">support</span>.<span class=\"title\">v4</span>.<span class=\"title\">view</span>.<span class=\"title\">ViewPager</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">PhotoViewPager</span><span class=\"params\">(Context context)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">PhotoViewPager</span><span class=\"params\">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context, attrs);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onTouchEvent</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onTouchEvent(ev);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IllegalArgumentException ex) &#123;</span><br><span class=\"line\">            ex.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(MotionEvent ev)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onInterceptTouchEvent(ev);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IllegalArgumentException ex) &#123;</span><br><span class=\"line\">            ex.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>WebView自适应高度</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">setupWebView</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    webView.getSettings().setJavaScriptEnabled(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">    webView.setWebViewClient(<span class=\"keyword\">new</span> WebViewClient() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onPageFinished</span><span class=\"params\">(WebView view, String url)</span> </span>&#123;</span><br><span class=\"line\">            \t\twebView.loadUrl(<span class=\"string\">\"javascript:MyApp.resize(document.body.getBoundingClientRect().height)\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">super</span>.onPageFinished(view, url);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    webView.addJavascriptInterface(<span class=\"keyword\">this</span>, <span class=\"string\">\"MyApp\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@JavascriptInterface</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">resize</span><span class=\"params\">(<span class=\"keyword\">final</span> <span class=\"keyword\">float</span> height)</span> </span>&#123;</span><br><span class=\"line\">    MyActivity.<span class=\"keyword\">this</span>.runOnUiThread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">            webView.setLayoutParams(<span class=\"keyword\">new</span> LinearLayout.LayoutParams(getResources().getDisplayMetrics().widthPixels, (<span class=\"keyword\">int</span>) (height * getResources().getDisplayMetrics().density)));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://www.bubuko.com/infodetail-1612451.html\" target=\"_blank\" rel=\"noopener\">http://www.bubuko.com/infodetail-1612451.html</a></p>\n<p><strong>通过resId获取属性名</strong></p>\n<p>例：R.id.tv_hello = 0x7f080007</p>\n<p>当我们调用view的getId()时，我们能获取到0x7f080007，但有时我们需要获取到tv_hello这个属性名，可以使用下面的方法</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String name = getResources().getResourceEntryName(id);</span><br></pre></td></tr></table></figure>\n<p><strong>使用AspectJ配置</strong></p>\n<p>使用网上的配置，在gradle版本为2.2.3时，不会出现问题，当切换到2.3.3时，会报</p>\n<p>No such property: project for class: com.android.build.gradle.LibraryPlugin，</p>\n<p>修复办法：不使用 LibraryPlugin 直接使用 project</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android.libraryVariants.all &#123; variant -&gt;</span><br><span class=\"line\"><span class=\"comment\">//    LibraryPlugin plugin = project.plugins.getPlugin(LibraryPlugin)</span></span><br><span class=\"line\">    JavaCompile javaCompile = variant.javaCompile</span><br><span class=\"line\">    javaCompile.doLast &#123;</span><br><span class=\"line\">        String[] args = [<span class=\"string\">\"-showWeaveInfo\"</span>,</span><br><span class=\"line\">                         <span class=\"string\">\"-1.5\"</span>,</span><br><span class=\"line\">                         <span class=\"string\">\"-inpath\"</span>, javaCompile.destinationDir.toString(),</span><br><span class=\"line\">                         <span class=\"string\">\"-aspectpath\"</span>, javaCompile.classpath.asPath,</span><br><span class=\"line\">                         <span class=\"string\">\"-d\"</span>, javaCompile.destinationDir.toString(),</span><br><span class=\"line\">                         <span class=\"string\">\"-classpath\"</span>, javaCompile.classpath.asPath,</span><br><span class=\"line\">                         <span class=\"string\">\"-bootclasspath\"</span>, project.android.bootClasspath.join(</span><br><span class=\"line\">                File.pathSeparator)]</span><br><span class=\"line\"></span><br><span class=\"line\">        MessageHandler handler = <span class=\"keyword\">new</span> MessageHandler(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Main().run(args, handler)</span><br><span class=\"line\"></span><br><span class=\"line\">        def log = project.logger</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (IMessage message : handler.getMessages(<span class=\"keyword\">null</span>, <span class=\"keyword\">true</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> (message.getKind()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.ABORT:</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.ERROR:</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.FAIL:</span><br><span class=\"line\">                    log.error message.message, message.thrown</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.WARNING:</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.INFO:</span><br><span class=\"line\">                    log.info message.message, message.thrown</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                <span class=\"keyword\">case</span> IMessage.DEBUG:</span><br><span class=\"line\">                    log.debug message.message, message.thrown</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>解决支持库版本兼容问题：</strong></p>\n<p>(all com.android.support libraries must use the exact same version specification)</p>\n<p>去改第三方库所用的支持库版本比较麻烦，如果用的库很多的话工作量很大。这个时候我们可以考虑强制让所有模块都用相同的支持库版本。</p>\n<p>在app build.gradle中添加：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">configurations.all &#123;</span><br><span class=\"line\">    resolutionStrategy.eachDependency &#123; DependencyResolveDetails details -&gt;</span><br><span class=\"line\">        def requested = details.requested</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (requested.group == <span class=\"string\">'com.android.support'</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!requested.name.startsWith(<span class=\"string\">\"multidex\"</span>)) &#123;</span><br><span class=\"line\">                details.useVersion <span class=\"string\">'25.3.1'</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>其中，25.3.1就是你要使用的支持库版本号，你可以根据需要改成其它的。</p>\n<p><a href=\"http://blog.csdn.net/u012730980/article/details/78390428\" target=\"_blank\" rel=\"noopener\">error: style attribute ‘@android:attr/windowEnterAnimation’ not found.</a></p>\n<p>在Project/gradle.properties中添加 android.enableAapt2=false</p>\n<p><strong>解决Google Pixel Download Manager不在通知栏显示进度的BUG</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DownloadManager.Request request = <span class=\"keyword\">new</span> DownloadManager.Request(Download_Uri);</span><br><span class=\"line\"><span class=\"comment\">// 添加下面这行</span></span><br><span class=\"line\">request.setAllowedOverRoaming(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n<p><strong>解决Error:Some file crunching failed, see logs for details</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    compileSdkVersion <span class=\"number\">25</span></span><br><span class=\"line\">    buildToolsVersion <span class=\"string\">'25.0.3'</span></span><br><span class=\"line\">    useLibrary <span class=\"string\">'org.apache.http.legacy'</span></span><br><span class=\"line\"></span><br><span class=\"line\">    aaptOptions &#123;</span><br><span class=\"line\">        cruncherEnabled = <span class=\"keyword\">false</span></span><br><span class=\"line\">        useNewCruncher = <span class=\"keyword\">false</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>添加aaptOptions一栏</p>\n<p><strong>解决viewpager滑动不流畅的问题</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">customViewpagerView</span> <span class=\"keyword\">extends</span> <span class=\"title\">ViewPager</span> </span>&#123;  </span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> preX=<span class=\"number\">0</span>;  </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">customViewpagerView</span><span class=\"params\">(Context context, AttributeSet attrs)</span> </span>&#123;  </span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context, attrs);  </span><br><span class=\"line\">          </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">customViewpagerView</span><span class=\"params\">(Context context)</span> </span>&#123;  </span><br><span class=\"line\">        <span class=\"keyword\">super</span>(context);  </span><br><span class=\"line\">          </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">      </span><br><span class=\"line\">    <span class=\"meta\">@Override</span>  </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">onInterceptTouchEvent</span><span class=\"params\">(MotionEvent even)</span> </span>&#123;  </span><br><span class=\"line\">          </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(even.getAction()==MotionEvent.ACTION_DOWN)  </span><br><span class=\"line\">        &#123;  </span><br><span class=\"line\">            preX=(<span class=\"keyword\">int</span>) even.getX();  </span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>  </span><br><span class=\"line\">        &#123;  </span><br><span class=\"line\">            <span class=\"keyword\">if</span>(Math.abs((<span class=\"keyword\">int</span>)even.getX()-preX)&gt;<span class=\"number\">10</span>)  </span><br><span class=\"line\">            &#123;  </span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;  </span><br><span class=\"line\">            &#125;<span class=\"keyword\">else</span>  </span><br><span class=\"line\">            &#123;  </span><br><span class=\"line\">                preX=(<span class=\"keyword\">int</span>) even.getX();  </span><br><span class=\"line\">            &#125;  </span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.onInterceptTouchEvent(even);  </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"使用Android Studio模板节省开发时间","date":"2018-03-05T09:42:53.000Z","_content":"\n### 前言\n\n使用模板能大大减少写重复代码的时间。Android Studio内置三种样式的模板\n\n| 模板                    | 适用范围     |\n| ----------------------- | ------------ |\n| Live Templates          | 代码块       |\n| File and Code Templates | 创建单个文件 |\n| Plugin Templates        | 整个工程     |\n\nPlugin Templates比较复杂，本文主要讲解前二个：Live Templates、File and Code Templates\n\n<!--more-->\n\n### Live Templates\n\n**什么是`Live Templates`呢**\n\n`Live Templates`就是把一些常用的代码块封装成几个快捷的字母，比如`abc`，当我们输入`abc`时，会自动生成封装好的代码。\n\n以Toast为例，平时我们会这样写\n\n```java\nToast.makeText(context, \"\", Toast.LENGTH_SHORT).show();\n```\n\n每当要显示Toast时，都要敲上面的代码，很麻烦。细心的同学会发现，当输入Toast时，会在提示栏显示一些快捷的操作\n\n![android-studio-live-templates-toast](/img/android/android-studio-live-templates-toast.jpg)\n\n我们点击第二项，会自动生成下面的代码\n\n```java\n Toast.makeText(mContext, \"\", Toast.LENGTH_SHORT).show();\n```\n\n第二项中的Toast就是AndroidStudio内置的`Live Templates`\n\n以`mac` 为例，可以通过下面的方式进入到`Live Templates`\n\nAndroid Studio -> Preferences -> Editor -> Live Templates\n\n![android-studio-live-templates](/img/android/android-studio-live-templates.jpg)\n\n从图中，我们可以看到AndroidStudio已经内置了一些模板，点开`Android`栏，会看到一些常用的`Live Templates`，其中包含我们上面提到的`Toast`。\n\n当然，我们也可以定义自己的`Live Templates`，下面我们来封装一个`AlertDialog`\n\n![android-studio-live-templates-add](/img/android/android-studio-live-templates-add.jpg)\n\n点击右边的`+`号，选择`Template Group…`新建一个组，组名我们这里填写`UI`，完成后会在左侧列表显示我们刚刚新建的`UI`组，选中`UI`，再次点击右侧的`+`号，这里我们选择`Live Templates`\n\n![android-studio-live-templates-add-detail](/img/android/android-studio-live-templates-add-detail.jpg)\n\n`Abbreviation`栏填写你要设置的快捷字母，这里我们填写`showDialog`，`Description`填写一个描述，这里我们填`显示AlertDialog`。\n\n`Template Text`栏填写你要封装的代码块\n\n```java\nAlertDialog.Builder builder = new AlertDialog.Builder($context$);\nbuilder.setTitle(\"\");\nbuilder.setMessage(\"\");\nbuilder.setNegativeButton(\"\", new DialogInterface.OnClickListener() {\n    @Override\n    public void onClick(DialogInterface dialog, int which) {\n\n    }\n});\nbuilder.setPositiveButton(\"\", new DialogInterface.OnClickListener() {\n    @Override\n    public void onClick(DialogInterface dialog, int which) {\n\n    }\n});\nbuilder.create().show();\n```\n\n下面蓝色的`Define`，点开选择`Java`，如下图：\n\n![android-studio-live-templates-add-complete](/img/android/android-studio-live-templates-add-complete.jpg)\n\n点击完成，我们的`Live Templates`就生成好啦，我们来试试在代码中输入`showDialog`\n\n![android-studio-live-templates-add-show](/img/android/android-studio-live-templates-add-show.jpg)\n\n点击提示栏的第一个，就会自动生成我们封装好的`AlertDialog`代码，是不是很方便呢^^\n\n### File and Code Templates\n\n我们点击`File -> New`的时候，会在右侧显示一些快捷项，供我们快速的创建文件\n\n![android-stuido-file-templates](/img/android/android-stuido-file-templates.jpg)\n\n有时候我们希望可以定义自己的`Templates`，用于快速生成相应文件，比如`RecycleView`的`Adapter`文件，很多都是差不多的格式。\n\n以`mac` 为例，可以通过下面的方式进入到`File and Code Templates`\n\nAndroid Studio -> Preferences -> Editor ->File and Code Templates\n\nFile -> New -> Edit File Templates\n\n![android-studio-file-templates-add](/img/android/androd-studio-file-templates-add.jpg)\n\n选中`Files`标签页，点击`+`号，`Name`栏输入`RVAdapter`，下面的输入框输入以下代码\n\n```java\n#if (${PACKAGE_NAME} && ${PACKAGE_NAME} != \"\")package ${PACKAGE_NAME};#end\n\nimport android.content.Context;\nimport android.support.v7.widget.RecyclerView;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport java.util.List;\n\n#parse(\"File Header.java\")\npublic class ${NAME} extends RecyclerView.Adapter<${VIEWHOLDER_CLASS}> {\n    private final Context context;\n    private List<${ITEM_CLASS}> items;\n   \n    public ${NAME}(List<${ITEM_CLASS}> items, Context context) {\n        this.items = items;\n        this.context = context;\n    }\n\n    @Override\n    public ${VIEWHOLDER_CLASS} onCreateViewHolder(ViewGroup parent,\n                                             int viewType) {\n        View v = LayoutInflater.from(parent.getContext())\n                .inflate(R.layout.${LAYOUT_RES_ID}, parent, false);\n        return new ${VIEWHOLDER_CLASS}(v);\n    }\n\n    @Override\n    public void onBindViewHolder(${VIEWHOLDER_CLASS} holder, int position) {\n        ${ITEM_CLASS} item = items.get(position);\n        //TODO Fill in your logic for binding the view.\n    }\n\n    @Override\n    public int getItemCount() {\n        if (items == null){\n            return 0;\n        }\n        return items.size();\n    }\n    \n     public class ${VIEWHOLDER_CLASS} extends RecyclerView.ViewHolder {\n\n        public MyViewHolder(View itemView) {\n            super(itemView);\n        }\n    }\n}\n```\n\n点击`OK`，我们的`Templates`就创建好。\n\n接下来，我们点击`File -> New`，就会出现我们创建好的`File Templates`项\n\n![android-studio-file-tempates-add-complete](/img/android/android-studio-file-tempates-add-complete.jpg)\n\n点击它，会出现下面的对话框\n\n![android-studio-file-templates-add-show](/img/android/android-studio-file-templates-add-show.jpg)\n\n- File name：填写你要创建的Adapter名称，例：TestRvAdapter\n- VIEWHOLDER CLASS：填写你要创建的ViewHolder，例：MyViewHolder\n- ITEM CLASS：填写你数据的类型，例: String\n- LAYOUT RES ID：填写你的布局文件名称，例：acitivity_main\n\n填写完成，我们的文件就生成好啦 \n\n![android-studio-file-templates-show](/img/android/android-studio-file-templates-show.jpg)\n\n\nOK，大功造成 ，是不是会节约很多时间呢^^\n\n\n> 参考文章： [How to create your own file template in Android Studio](https://riggaroo.co.za/custom-file-templates-android-studio/)\n\n","source":"_posts/android/android-studio-templates.md","raw":"---\ntitle: 使用Android Studio模板节省开发时间\ndate: 2018-03-05 17:42:53\ntags: android\n---\n\n### 前言\n\n使用模板能大大减少写重复代码的时间。Android Studio内置三种样式的模板\n\n| 模板                    | 适用范围     |\n| ----------------------- | ------------ |\n| Live Templates          | 代码块       |\n| File and Code Templates | 创建单个文件 |\n| Plugin Templates        | 整个工程     |\n\nPlugin Templates比较复杂，本文主要讲解前二个：Live Templates、File and Code Templates\n\n<!--more-->\n\n### Live Templates\n\n**什么是`Live Templates`呢**\n\n`Live Templates`就是把一些常用的代码块封装成几个快捷的字母，比如`abc`，当我们输入`abc`时，会自动生成封装好的代码。\n\n以Toast为例，平时我们会这样写\n\n```java\nToast.makeText(context, \"\", Toast.LENGTH_SHORT).show();\n```\n\n每当要显示Toast时，都要敲上面的代码，很麻烦。细心的同学会发现，当输入Toast时，会在提示栏显示一些快捷的操作\n\n![android-studio-live-templates-toast](/img/android/android-studio-live-templates-toast.jpg)\n\n我们点击第二项，会自动生成下面的代码\n\n```java\n Toast.makeText(mContext, \"\", Toast.LENGTH_SHORT).show();\n```\n\n第二项中的Toast就是AndroidStudio内置的`Live Templates`\n\n以`mac` 为例，可以通过下面的方式进入到`Live Templates`\n\nAndroid Studio -> Preferences -> Editor -> Live Templates\n\n![android-studio-live-templates](/img/android/android-studio-live-templates.jpg)\n\n从图中，我们可以看到AndroidStudio已经内置了一些模板，点开`Android`栏，会看到一些常用的`Live Templates`，其中包含我们上面提到的`Toast`。\n\n当然，我们也可以定义自己的`Live Templates`，下面我们来封装一个`AlertDialog`\n\n![android-studio-live-templates-add](/img/android/android-studio-live-templates-add.jpg)\n\n点击右边的`+`号，选择`Template Group…`新建一个组，组名我们这里填写`UI`，完成后会在左侧列表显示我们刚刚新建的`UI`组，选中`UI`，再次点击右侧的`+`号，这里我们选择`Live Templates`\n\n![android-studio-live-templates-add-detail](/img/android/android-studio-live-templates-add-detail.jpg)\n\n`Abbreviation`栏填写你要设置的快捷字母，这里我们填写`showDialog`，`Description`填写一个描述，这里我们填`显示AlertDialog`。\n\n`Template Text`栏填写你要封装的代码块\n\n```java\nAlertDialog.Builder builder = new AlertDialog.Builder($context$);\nbuilder.setTitle(\"\");\nbuilder.setMessage(\"\");\nbuilder.setNegativeButton(\"\", new DialogInterface.OnClickListener() {\n    @Override\n    public void onClick(DialogInterface dialog, int which) {\n\n    }\n});\nbuilder.setPositiveButton(\"\", new DialogInterface.OnClickListener() {\n    @Override\n    public void onClick(DialogInterface dialog, int which) {\n\n    }\n});\nbuilder.create().show();\n```\n\n下面蓝色的`Define`，点开选择`Java`，如下图：\n\n![android-studio-live-templates-add-complete](/img/android/android-studio-live-templates-add-complete.jpg)\n\n点击完成，我们的`Live Templates`就生成好啦，我们来试试在代码中输入`showDialog`\n\n![android-studio-live-templates-add-show](/img/android/android-studio-live-templates-add-show.jpg)\n\n点击提示栏的第一个，就会自动生成我们封装好的`AlertDialog`代码，是不是很方便呢^^\n\n### File and Code Templates\n\n我们点击`File -> New`的时候，会在右侧显示一些快捷项，供我们快速的创建文件\n\n![android-stuido-file-templates](/img/android/android-stuido-file-templates.jpg)\n\n有时候我们希望可以定义自己的`Templates`，用于快速生成相应文件，比如`RecycleView`的`Adapter`文件，很多都是差不多的格式。\n\n以`mac` 为例，可以通过下面的方式进入到`File and Code Templates`\n\nAndroid Studio -> Preferences -> Editor ->File and Code Templates\n\nFile -> New -> Edit File Templates\n\n![android-studio-file-templates-add](/img/android/androd-studio-file-templates-add.jpg)\n\n选中`Files`标签页，点击`+`号，`Name`栏输入`RVAdapter`，下面的输入框输入以下代码\n\n```java\n#if (${PACKAGE_NAME} && ${PACKAGE_NAME} != \"\")package ${PACKAGE_NAME};#end\n\nimport android.content.Context;\nimport android.support.v7.widget.RecyclerView;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport java.util.List;\n\n#parse(\"File Header.java\")\npublic class ${NAME} extends RecyclerView.Adapter<${VIEWHOLDER_CLASS}> {\n    private final Context context;\n    private List<${ITEM_CLASS}> items;\n   \n    public ${NAME}(List<${ITEM_CLASS}> items, Context context) {\n        this.items = items;\n        this.context = context;\n    }\n\n    @Override\n    public ${VIEWHOLDER_CLASS} onCreateViewHolder(ViewGroup parent,\n                                             int viewType) {\n        View v = LayoutInflater.from(parent.getContext())\n                .inflate(R.layout.${LAYOUT_RES_ID}, parent, false);\n        return new ${VIEWHOLDER_CLASS}(v);\n    }\n\n    @Override\n    public void onBindViewHolder(${VIEWHOLDER_CLASS} holder, int position) {\n        ${ITEM_CLASS} item = items.get(position);\n        //TODO Fill in your logic for binding the view.\n    }\n\n    @Override\n    public int getItemCount() {\n        if (items == null){\n            return 0;\n        }\n        return items.size();\n    }\n    \n     public class ${VIEWHOLDER_CLASS} extends RecyclerView.ViewHolder {\n\n        public MyViewHolder(View itemView) {\n            super(itemView);\n        }\n    }\n}\n```\n\n点击`OK`，我们的`Templates`就创建好。\n\n接下来，我们点击`File -> New`，就会出现我们创建好的`File Templates`项\n\n![android-studio-file-tempates-add-complete](/img/android/android-studio-file-tempates-add-complete.jpg)\n\n点击它，会出现下面的对话框\n\n![android-studio-file-templates-add-show](/img/android/android-studio-file-templates-add-show.jpg)\n\n- File name：填写你要创建的Adapter名称，例：TestRvAdapter\n- VIEWHOLDER CLASS：填写你要创建的ViewHolder，例：MyViewHolder\n- ITEM CLASS：填写你数据的类型，例: String\n- LAYOUT RES ID：填写你的布局文件名称，例：acitivity_main\n\n填写完成，我们的文件就生成好啦 \n\n![android-studio-file-templates-show](/img/android/android-studio-file-templates-show.jpg)\n\n\nOK，大功造成 ，是不是会节约很多时间呢^^\n\n\n> 参考文章： [How to create your own file template in Android Studio](https://riggaroo.co.za/custom-file-templates-android-studio/)\n\n","slug":"android/android-studio-templates","published":1,"updated":"2018-05-20T13:04:25.681Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ei0010izcbjn99u0tz","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>使用模板能大大减少写重复代码的时间。Android Studio内置三种样式的模板</p>\n<table>\n<thead>\n<tr>\n<th>模板</th>\n<th>适用范围</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Live Templates</td>\n<td>代码块</td>\n</tr>\n<tr>\n<td>File and Code Templates</td>\n<td>创建单个文件</td>\n</tr>\n<tr>\n<td>Plugin Templates</td>\n<td>整个工程</td>\n</tr>\n</tbody>\n</table>\n<p>Plugin Templates比较复杂，本文主要讲解前二个：Live Templates、File and Code Templates</p>\n<a id=\"more\"></a>\n<h3 id=\"Live-Templates\"><a href=\"#Live-Templates\" class=\"headerlink\" title=\"Live Templates\"></a>Live Templates</h3><p><strong>什么是<code>Live Templates</code>呢</strong></p>\n<p><code>Live Templates</code>就是把一些常用的代码块封装成几个快捷的字母，比如<code>abc</code>，当我们输入<code>abc</code>时，会自动生成封装好的代码。</p>\n<p>以Toast为例，平时我们会这样写</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Toast.makeText(context, <span class=\"string\">\"\"</span>, Toast.LENGTH_SHORT).show();</span><br></pre></td></tr></table></figure>\n<p>每当要显示Toast时，都要敲上面的代码，很麻烦。细心的同学会发现，当输入Toast时，会在提示栏显示一些快捷的操作</p>\n<p><img src=\"/img/android/android-studio-live-templates-toast.jpg\" alt=\"android-studio-live-templates-toast\"></p>\n<p>我们点击第二项，会自动生成下面的代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Toast.makeText(mContext, <span class=\"string\">\"\"</span>, Toast.LENGTH_SHORT).show();</span><br></pre></td></tr></table></figure>\n<p>第二项中的Toast就是AndroidStudio内置的<code>Live Templates</code></p>\n<p>以<code>mac</code> 为例，可以通过下面的方式进入到<code>Live Templates</code></p>\n<p>Android Studio -&gt; Preferences -&gt; Editor -&gt; Live Templates</p>\n<p><img src=\"/img/android/android-studio-live-templates.jpg\" alt=\"android-studio-live-templates\"></p>\n<p>从图中，我们可以看到AndroidStudio已经内置了一些模板，点开<code>Android</code>栏，会看到一些常用的<code>Live Templates</code>，其中包含我们上面提到的<code>Toast</code>。</p>\n<p>当然，我们也可以定义自己的<code>Live Templates</code>，下面我们来封装一个<code>AlertDialog</code></p>\n<p><img src=\"/img/android/android-studio-live-templates-add.jpg\" alt=\"android-studio-live-templates-add\"></p>\n<p>点击右边的<code>+</code>号，选择<code>Template Group…</code>新建一个组，组名我们这里填写<code>UI</code>，完成后会在左侧列表显示我们刚刚新建的<code>UI</code>组，选中<code>UI</code>，再次点击右侧的<code>+</code>号，这里我们选择<code>Live Templates</code></p>\n<p><img src=\"/img/android/android-studio-live-templates-add-detail.jpg\" alt=\"android-studio-live-templates-add-detail\"></p>\n<p><code>Abbreviation</code>栏填写你要设置的快捷字母，这里我们填写<code>showDialog</code>，<code>Description</code>填写一个描述，这里我们填<code>显示AlertDialog</code>。</p>\n<p><code>Template Text</code>栏填写你要封装的代码块</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AlertDialog.Builder builder = <span class=\"keyword\">new</span> AlertDialog.Builder($context$);</span><br><span class=\"line\">builder.setTitle(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">builder.setMessage(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">builder.setNegativeButton(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(DialogInterface dialog, <span class=\"keyword\">int</span> which)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">builder.setPositiveButton(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(DialogInterface dialog, <span class=\"keyword\">int</span> which)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">builder.create().show();</span><br></pre></td></tr></table></figure>\n<p>下面蓝色的<code>Define</code>，点开选择<code>Java</code>，如下图：</p>\n<p><img src=\"/img/android/android-studio-live-templates-add-complete.jpg\" alt=\"android-studio-live-templates-add-complete\"></p>\n<p>点击完成，我们的<code>Live Templates</code>就生成好啦，我们来试试在代码中输入<code>showDialog</code></p>\n<p><img src=\"/img/android/android-studio-live-templates-add-show.jpg\" alt=\"android-studio-live-templates-add-show\"></p>\n<p>点击提示栏的第一个，就会自动生成我们封装好的<code>AlertDialog</code>代码，是不是很方便呢^^</p>\n<h3 id=\"File-and-Code-Templates\"><a href=\"#File-and-Code-Templates\" class=\"headerlink\" title=\"File and Code Templates\"></a>File and Code Templates</h3><p>我们点击<code>File -&gt; New</code>的时候，会在右侧显示一些快捷项，供我们快速的创建文件</p>\n<p><img src=\"/img/android/android-stuido-file-templates.jpg\" alt=\"android-stuido-file-templates\"></p>\n<p>有时候我们希望可以定义自己的<code>Templates</code>，用于快速生成相应文件，比如<code>RecycleView</code>的<code>Adapter</code>文件，很多都是差不多的格式。</p>\n<p>以<code>mac</code> 为例，可以通过下面的方式进入到<code>File and Code Templates</code></p>\n<p>Android Studio -&gt; Preferences -&gt; Editor -&gt;File and Code Templates</p>\n<p>File -&gt; New -&gt; Edit File Templates</p>\n<p><img src=\"/img/android/androd-studio-file-templates-add.jpg\" alt=\"android-studio-file-templates-add\"></p>\n<p>选中<code>Files</code>标签页，点击<code>+</code>号，<code>Name</code>栏输入<code>RVAdapter</code>，下面的输入框输入以下代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#if ($&#123;PACKAGE_NAME&#125; &amp;&amp; $&#123;PACKAGE_NAME&#125; != \"\")package $&#123;PACKAGE_NAME&#125;;#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> android.content.Context;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.support.v7.widget.RecyclerView;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.view.LayoutInflater;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.view.View;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.view.ViewGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\">#parse(\"File Header.java\")</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> $</span>&#123;NAME&#125; extends RecyclerView.Adapter&lt;$&#123;VIEWHOLDER_CLASS&#125;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Context context;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;$&#123;ITEM_CLASS&#125;&gt; items;</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;NAME&#125;(List&lt;$&#123;ITEM_CLASS&#125;&gt; items, Context context) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.items = items;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.context = context;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;VIEWHOLDER_CLASS&#125; onCreateViewHolder(ViewGroup parent,</span><br><span class=\"line\">                                             <span class=\"keyword\">int</span> viewType) &#123;</span><br><span class=\"line\">        View v = LayoutInflater.from(parent.getContext())</span><br><span class=\"line\">                .inflate(R.layout.$&#123;LAYOUT_RES_ID&#125;, parent, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> $&#123;VIEWHOLDER_CLASS&#125;(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onBindViewHolder</span><span class=\"params\">($&#123;VIEWHOLDER_CLASS&#125; holder, <span class=\"keyword\">int</span> position)</span> </span>&#123;</span><br><span class=\"line\">        $&#123;ITEM_CLASS&#125; item = items.get(position);</span><br><span class=\"line\">        <span class=\"comment\">//TODO Fill in your logic for binding the view.</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getItemCount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (items == <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> items.size();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">     <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> $</span>&#123;VIEWHOLDER_CLASS&#125; extends RecyclerView.ViewHolder &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyViewHolder</span><span class=\"params\">(View itemView)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">super</span>(itemView);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>点击<code>OK</code>，我们的<code>Templates</code>就创建好。</p>\n<p>接下来，我们点击<code>File -&gt; New</code>，就会出现我们创建好的<code>File Templates</code>项</p>\n<p><img src=\"/img/android/android-studio-file-tempates-add-complete.jpg\" alt=\"android-studio-file-tempates-add-complete\"></p>\n<p>点击它，会出现下面的对话框</p>\n<p><img src=\"/img/android/android-studio-file-templates-add-show.jpg\" alt=\"android-studio-file-templates-add-show\"></p>\n<ul>\n<li>File name：填写你要创建的Adapter名称，例：TestRvAdapter</li>\n<li>VIEWHOLDER CLASS：填写你要创建的ViewHolder，例：MyViewHolder</li>\n<li>ITEM CLASS：填写你数据的类型，例: String</li>\n<li>LAYOUT RES ID：填写你的布局文件名称，例：acitivity_main</li>\n</ul>\n<p>填写完成，我们的文件就生成好啦 </p>\n<p><img src=\"/img/android/android-studio-file-templates-show.jpg\" alt=\"android-studio-file-templates-show\"></p>\n<p>OK，大功造成 ，是不是会节约很多时间呢^^</p>\n<blockquote>\n<p>参考文章： <a href=\"https://riggaroo.co.za/custom-file-templates-android-studio/\" target=\"_blank\" rel=\"noopener\">How to create your own file template in Android Studio</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>使用模板能大大减少写重复代码的时间。Android Studio内置三种样式的模板</p>\n<table>\n<thead>\n<tr>\n<th>模板</th>\n<th>适用范围</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Live Templates</td>\n<td>代码块</td>\n</tr>\n<tr>\n<td>File and Code Templates</td>\n<td>创建单个文件</td>\n</tr>\n<tr>\n<td>Plugin Templates</td>\n<td>整个工程</td>\n</tr>\n</tbody>\n</table>\n<p>Plugin Templates比较复杂，本文主要讲解前二个：Live Templates、File and Code Templates</p>","more":"<h3 id=\"Live-Templates\"><a href=\"#Live-Templates\" class=\"headerlink\" title=\"Live Templates\"></a>Live Templates</h3><p><strong>什么是<code>Live Templates</code>呢</strong></p>\n<p><code>Live Templates</code>就是把一些常用的代码块封装成几个快捷的字母，比如<code>abc</code>，当我们输入<code>abc</code>时，会自动生成封装好的代码。</p>\n<p>以Toast为例，平时我们会这样写</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Toast.makeText(context, <span class=\"string\">\"\"</span>, Toast.LENGTH_SHORT).show();</span><br></pre></td></tr></table></figure>\n<p>每当要显示Toast时，都要敲上面的代码，很麻烦。细心的同学会发现，当输入Toast时，会在提示栏显示一些快捷的操作</p>\n<p><img src=\"/img/android/android-studio-live-templates-toast.jpg\" alt=\"android-studio-live-templates-toast\"></p>\n<p>我们点击第二项，会自动生成下面的代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Toast.makeText(mContext, <span class=\"string\">\"\"</span>, Toast.LENGTH_SHORT).show();</span><br></pre></td></tr></table></figure>\n<p>第二项中的Toast就是AndroidStudio内置的<code>Live Templates</code></p>\n<p>以<code>mac</code> 为例，可以通过下面的方式进入到<code>Live Templates</code></p>\n<p>Android Studio -&gt; Preferences -&gt; Editor -&gt; Live Templates</p>\n<p><img src=\"/img/android/android-studio-live-templates.jpg\" alt=\"android-studio-live-templates\"></p>\n<p>从图中，我们可以看到AndroidStudio已经内置了一些模板，点开<code>Android</code>栏，会看到一些常用的<code>Live Templates</code>，其中包含我们上面提到的<code>Toast</code>。</p>\n<p>当然，我们也可以定义自己的<code>Live Templates</code>，下面我们来封装一个<code>AlertDialog</code></p>\n<p><img src=\"/img/android/android-studio-live-templates-add.jpg\" alt=\"android-studio-live-templates-add\"></p>\n<p>点击右边的<code>+</code>号，选择<code>Template Group…</code>新建一个组，组名我们这里填写<code>UI</code>，完成后会在左侧列表显示我们刚刚新建的<code>UI</code>组，选中<code>UI</code>，再次点击右侧的<code>+</code>号，这里我们选择<code>Live Templates</code></p>\n<p><img src=\"/img/android/android-studio-live-templates-add-detail.jpg\" alt=\"android-studio-live-templates-add-detail\"></p>\n<p><code>Abbreviation</code>栏填写你要设置的快捷字母，这里我们填写<code>showDialog</code>，<code>Description</code>填写一个描述，这里我们填<code>显示AlertDialog</code>。</p>\n<p><code>Template Text</code>栏填写你要封装的代码块</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AlertDialog.Builder builder = <span class=\"keyword\">new</span> AlertDialog.Builder($context$);</span><br><span class=\"line\">builder.setTitle(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">builder.setMessage(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">builder.setNegativeButton(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(DialogInterface dialog, <span class=\"keyword\">int</span> which)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">builder.setPositiveButton(<span class=\"string\">\"\"</span>, <span class=\"keyword\">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(DialogInterface dialog, <span class=\"keyword\">int</span> which)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">builder.create().show();</span><br></pre></td></tr></table></figure>\n<p>下面蓝色的<code>Define</code>，点开选择<code>Java</code>，如下图：</p>\n<p><img src=\"/img/android/android-studio-live-templates-add-complete.jpg\" alt=\"android-studio-live-templates-add-complete\"></p>\n<p>点击完成，我们的<code>Live Templates</code>就生成好啦，我们来试试在代码中输入<code>showDialog</code></p>\n<p><img src=\"/img/android/android-studio-live-templates-add-show.jpg\" alt=\"android-studio-live-templates-add-show\"></p>\n<p>点击提示栏的第一个，就会自动生成我们封装好的<code>AlertDialog</code>代码，是不是很方便呢^^</p>\n<h3 id=\"File-and-Code-Templates\"><a href=\"#File-and-Code-Templates\" class=\"headerlink\" title=\"File and Code Templates\"></a>File and Code Templates</h3><p>我们点击<code>File -&gt; New</code>的时候，会在右侧显示一些快捷项，供我们快速的创建文件</p>\n<p><img src=\"/img/android/android-stuido-file-templates.jpg\" alt=\"android-stuido-file-templates\"></p>\n<p>有时候我们希望可以定义自己的<code>Templates</code>，用于快速生成相应文件，比如<code>RecycleView</code>的<code>Adapter</code>文件，很多都是差不多的格式。</p>\n<p>以<code>mac</code> 为例，可以通过下面的方式进入到<code>File and Code Templates</code></p>\n<p>Android Studio -&gt; Preferences -&gt; Editor -&gt;File and Code Templates</p>\n<p>File -&gt; New -&gt; Edit File Templates</p>\n<p><img src=\"/img/android/androd-studio-file-templates-add.jpg\" alt=\"android-studio-file-templates-add\"></p>\n<p>选中<code>Files</code>标签页，点击<code>+</code>号，<code>Name</code>栏输入<code>RVAdapter</code>，下面的输入框输入以下代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#if ($&#123;PACKAGE_NAME&#125; &amp;&amp; $&#123;PACKAGE_NAME&#125; != \"\")package $&#123;PACKAGE_NAME&#125;;#end</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> android.content.Context;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.support.v7.widget.RecyclerView;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.view.LayoutInflater;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.view.View;</span><br><span class=\"line\"><span class=\"keyword\">import</span> android.view.ViewGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\">#parse(\"File Header.java\")</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> $</span>&#123;NAME&#125; extends RecyclerView.Adapter&lt;$&#123;VIEWHOLDER_CLASS&#125;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Context context;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;$&#123;ITEM_CLASS&#125;&gt; items;</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;NAME&#125;(List&lt;$&#123;ITEM_CLASS&#125;&gt; items, Context context) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.items = items;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.context = context;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $&#123;VIEWHOLDER_CLASS&#125; onCreateViewHolder(ViewGroup parent,</span><br><span class=\"line\">                                             <span class=\"keyword\">int</span> viewType) &#123;</span><br><span class=\"line\">        View v = LayoutInflater.from(parent.getContext())</span><br><span class=\"line\">                .inflate(R.layout.$&#123;LAYOUT_RES_ID&#125;, parent, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> $&#123;VIEWHOLDER_CLASS&#125;(v);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onBindViewHolder</span><span class=\"params\">($&#123;VIEWHOLDER_CLASS&#125; holder, <span class=\"keyword\">int</span> position)</span> </span>&#123;</span><br><span class=\"line\">        $&#123;ITEM_CLASS&#125; item = items.get(position);</span><br><span class=\"line\">        <span class=\"comment\">//TODO Fill in your logic for binding the view.</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getItemCount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (items == <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> items.size();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">     <span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> $</span>&#123;VIEWHOLDER_CLASS&#125; extends RecyclerView.ViewHolder &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyViewHolder</span><span class=\"params\">(View itemView)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">super</span>(itemView);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>点击<code>OK</code>，我们的<code>Templates</code>就创建好。</p>\n<p>接下来，我们点击<code>File -&gt; New</code>，就会出现我们创建好的<code>File Templates</code>项</p>\n<p><img src=\"/img/android/android-studio-file-tempates-add-complete.jpg\" alt=\"android-studio-file-tempates-add-complete\"></p>\n<p>点击它，会出现下面的对话框</p>\n<p><img src=\"/img/android/android-studio-file-templates-add-show.jpg\" alt=\"android-studio-file-templates-add-show\"></p>\n<ul>\n<li>File name：填写你要创建的Adapter名称，例：TestRvAdapter</li>\n<li>VIEWHOLDER CLASS：填写你要创建的ViewHolder，例：MyViewHolder</li>\n<li>ITEM CLASS：填写你数据的类型，例: String</li>\n<li>LAYOUT RES ID：填写你的布局文件名称，例：acitivity_main</li>\n</ul>\n<p>填写完成，我们的文件就生成好啦 </p>\n<p><img src=\"/img/android/android-studio-file-templates-show.jpg\" alt=\"android-studio-file-templates-show\"></p>\n<p>OK，大功造成 ，是不是会节约很多时间呢^^</p>\n<blockquote>\n<p>参考文章： <a href=\"https://riggaroo.co.za/custom-file-templates-android-studio/\" target=\"_blank\" rel=\"noopener\">How to create your own file template in Android Studio</a></p>\n</blockquote>"},{"title":"RecyclerView添加快速滚动","date":"2018-03-06T03:10:28.000Z","_content":"\n### RecyclerView快速滚动\n\n使用`ListView`实现快速滚动只需要添加一行代码就可以了\n\n```kotlin\nlistView.setFastScrollEnabled(true)\n```\n\n在`RecyclerView`中，之前官方并没有提供快速滚动的API。但是现在在Android Support Library 26，官方终于提供了。让我们开始吧。\n\n<!--more-->\n\n**首先你需要进行以下配置**\n\n*版本要是26以上哦*\n\n```groovy\ndependencies {\n    ....\n    compile 'com.android.support:design:26.0.1'\n    compile 'com.android.support:recyclerview-v7:26.0.1'\n    ....\n}\n```\n\n```\nbuildscript {\n    \n    repositories {\n        google()\n    }\n    ....\n}\n```\n\n**设置你的xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<android.support.constraint.ConstraintLayout\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    app:layout_behavior=\"@string/appbar_scrolling_view_behavior\"\n    tools:context=\"com.shaishavgandhi.fastscrolling.MainActivity\"\n    tools:showIn=\"@layout/activity_main\">\n\n\n <android.support.v7.widget.RecyclerView\n    android:id=\"@+id/recyclerView\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    app:fastScrollEnabled=\"true\"\n    app:fastScrollHorizontalThumbDrawable=\"@drawable/thumb_drawable\"\n    app:fastScrollHorizontalTrackDrawable=\"@drawable/line_drawable\"\n    app:fastScrollVerticalThumbDrawable=\"@drawable/thumb_drawable\"\n    app:fastScrollVerticalTrackDrawable=\"@drawable/line_drawable\">\n\n </android.support.v7.widget.RecyclerView>\n\n</android.support.constraint.ConstraintLayout>\n```\n\n- **fastScrollEnabled：**是否启用快速滚动\n- **fastScrollHorizontalThumbDrawable：**水平滚动块\n- **fastScrollHorizontalTrackDrawable：** 水平滚动背景\n- **fastScrollVerticalThumbDrawable：** 竖直滚动块\n- **fastScrollVerticalTrackDrawable：** 竖直滚动背景\n\n**line_drawable.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<selector xmlns:android=\"http://schemas.android.com/apk/res/android\">\n    <item\n        android:state_pressed=\"true\"\n        android:drawable=\"@drawable/line\"/>\n\n    <item\n        android:drawable=\"@drawable/line\"/>\n</selector>\n```\n\n**line.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n       android:shape=\"rectangle\">\n\n    <solid android:color=\"@android:color/darker_gray\" />\n\n    <padding\n        android:top=\"10dp\"\n        android:left=\"10dp\"\n        android:right=\"10dp\"\n        android:bottom=\"10dp\"/>\n</shape>\n```\n\n**thumb_drawable.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<selector xmlns:android=\"http://schemas.android.com/apk/res/android\">\n    <item\n        android:state_pressed=\"true\"\n        android:drawable=\"@drawable/thumb\"/>\n\n    <item\n        android:drawable=\"@drawable/thumb\"/>\n</selector>\n```\n\n**thumb.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n       android:shape=\"rectangle\">\n\n    <corners\n        android:topLeftRadius=\"44dp\"\n        android:topRightRadius=\"44dp\"\n        android:bottomLeftRadius=\"44dp\" />\n\n    <padding\n        android:paddingLeft=\"22dp\"\n        android:paddingRight=\"22dp\" />\n\n    <solid android:color=\"@color/colorPrimaryDark\" />\n\n</shape>\n```\n\n**效果如下：**\n\n![android-ui-rv](/img/android/android-ui-rv.gif)\n\n> 原文链接： [Fast Scrolling with RecyclerView](https://android.jlelse.eu/fast-scrolling-with-recyclerview-2b89d4574688)\n\n","source":"_posts/android/android-ui-rv.md","raw":"---\ntitle: RecyclerView添加快速滚动\ndate: 2018-03-06 11:10:28\ntags: android\n---\n\n### RecyclerView快速滚动\n\n使用`ListView`实现快速滚动只需要添加一行代码就可以了\n\n```kotlin\nlistView.setFastScrollEnabled(true)\n```\n\n在`RecyclerView`中，之前官方并没有提供快速滚动的API。但是现在在Android Support Library 26，官方终于提供了。让我们开始吧。\n\n<!--more-->\n\n**首先你需要进行以下配置**\n\n*版本要是26以上哦*\n\n```groovy\ndependencies {\n    ....\n    compile 'com.android.support:design:26.0.1'\n    compile 'com.android.support:recyclerview-v7:26.0.1'\n    ....\n}\n```\n\n```\nbuildscript {\n    \n    repositories {\n        google()\n    }\n    ....\n}\n```\n\n**设置你的xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<android.support.constraint.ConstraintLayout\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    app:layout_behavior=\"@string/appbar_scrolling_view_behavior\"\n    tools:context=\"com.shaishavgandhi.fastscrolling.MainActivity\"\n    tools:showIn=\"@layout/activity_main\">\n\n\n <android.support.v7.widget.RecyclerView\n    android:id=\"@+id/recyclerView\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    app:fastScrollEnabled=\"true\"\n    app:fastScrollHorizontalThumbDrawable=\"@drawable/thumb_drawable\"\n    app:fastScrollHorizontalTrackDrawable=\"@drawable/line_drawable\"\n    app:fastScrollVerticalThumbDrawable=\"@drawable/thumb_drawable\"\n    app:fastScrollVerticalTrackDrawable=\"@drawable/line_drawable\">\n\n </android.support.v7.widget.RecyclerView>\n\n</android.support.constraint.ConstraintLayout>\n```\n\n- **fastScrollEnabled：**是否启用快速滚动\n- **fastScrollHorizontalThumbDrawable：**水平滚动块\n- **fastScrollHorizontalTrackDrawable：** 水平滚动背景\n- **fastScrollVerticalThumbDrawable：** 竖直滚动块\n- **fastScrollVerticalTrackDrawable：** 竖直滚动背景\n\n**line_drawable.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<selector xmlns:android=\"http://schemas.android.com/apk/res/android\">\n    <item\n        android:state_pressed=\"true\"\n        android:drawable=\"@drawable/line\"/>\n\n    <item\n        android:drawable=\"@drawable/line\"/>\n</selector>\n```\n\n**line.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n       android:shape=\"rectangle\">\n\n    <solid android:color=\"@android:color/darker_gray\" />\n\n    <padding\n        android:top=\"10dp\"\n        android:left=\"10dp\"\n        android:right=\"10dp\"\n        android:bottom=\"10dp\"/>\n</shape>\n```\n\n**thumb_drawable.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<selector xmlns:android=\"http://schemas.android.com/apk/res/android\">\n    <item\n        android:state_pressed=\"true\"\n        android:drawable=\"@drawable/thumb\"/>\n\n    <item\n        android:drawable=\"@drawable/thumb\"/>\n</selector>\n```\n\n**thumb.xml**\n\n```xml\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<shape xmlns:android=\"http://schemas.android.com/apk/res/android\"\n       android:shape=\"rectangle\">\n\n    <corners\n        android:topLeftRadius=\"44dp\"\n        android:topRightRadius=\"44dp\"\n        android:bottomLeftRadius=\"44dp\" />\n\n    <padding\n        android:paddingLeft=\"22dp\"\n        android:paddingRight=\"22dp\" />\n\n    <solid android:color=\"@color/colorPrimaryDark\" />\n\n</shape>\n```\n\n**效果如下：**\n\n![android-ui-rv](/img/android/android-ui-rv.gif)\n\n> 原文链接： [Fast Scrolling with RecyclerView](https://android.jlelse.eu/fast-scrolling-with-recyclerview-2b89d4574688)\n\n","slug":"android/android-ui-rv","published":1,"updated":"2018-05-20T13:04:25.681Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ek0013izcbvkx97bpb","content":"<h3 id=\"RecyclerView快速滚动\"><a href=\"#RecyclerView快速滚动\" class=\"headerlink\" title=\"RecyclerView快速滚动\"></a>RecyclerView快速滚动</h3><p>使用<code>ListView</code>实现快速滚动只需要添加一行代码就可以了</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listView.setFastScrollEnabled(<span class=\"literal\">true</span>)</span><br></pre></td></tr></table></figure>\n<p>在<code>RecyclerView</code>中，之前官方并没有提供快速滚动的API。但是现在在Android Support Library 26，官方终于提供了。让我们开始吧。</p>\n<a id=\"more\"></a>\n<p><strong>首先你需要进行以下配置</strong></p>\n<p><em>版本要是26以上哦</em></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    ....</span><br><span class=\"line\">    compile <span class=\"string\">'com.android.support:design:26.0.1'</span></span><br><span class=\"line\">    compile <span class=\"string\">'com.android.support:recyclerview-v7:26.0.1'</span></span><br><span class=\"line\">    ....</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buildscript &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    repositories &#123;</span><br><span class=\"line\">        google()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ....</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>设置你的xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">android.support.constraint.ConstraintLayout</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:app</span>=<span class=\"string\">\"http://schemas.android.com/apk/res-auto\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:tools</span>=<span class=\"string\">\"http://schemas.android.com/tools\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:layout_behavior</span>=<span class=\"string\">\"@string/appbar_scrolling_view_behavior\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">tools:context</span>=<span class=\"string\">\"com.shaishavgandhi.fastscrolling.MainActivity\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">tools:showIn</span>=<span class=\"string\">\"@layout/activity_main\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">android.support.v7.widget.RecyclerView</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:id</span>=<span class=\"string\">\"@+id/recyclerView\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"wrap_content\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollEnabled</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollHorizontalThumbDrawable</span>=<span class=\"string\">\"@drawable/thumb_drawable\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollHorizontalTrackDrawable</span>=<span class=\"string\">\"@drawable/line_drawable\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollVerticalThumbDrawable</span>=<span class=\"string\">\"@drawable/thumb_drawable\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollVerticalTrackDrawable</span>=<span class=\"string\">\"@drawable/line_drawable\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">android.support.v7.widget.RecyclerView</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">android.support.constraint.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>fastScrollEnabled：</strong>是否启用快速滚动</li>\n<li><strong>fastScrollHorizontalThumbDrawable：</strong>水平滚动块</li>\n<li><strong>fastScrollHorizontalTrackDrawable：</strong> 水平滚动背景</li>\n<li><strong>fastScrollVerticalThumbDrawable：</strong> 竖直滚动块</li>\n<li><strong>fastScrollVerticalTrackDrawable：</strong> 竖直滚动背景</li>\n</ul>\n<p><strong>line_drawable.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">selector</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:state_pressed</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/line\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/line\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>line.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">shape</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">android:shape</span>=<span class=\"string\">\"rectangle\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">solid</span> <span class=\"attr\">android:color</span>=<span class=\"string\">\"@android:color/darker_gray\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">padding</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:top</span>=<span class=\"string\">\"10dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:left</span>=<span class=\"string\">\"10dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:right</span>=<span class=\"string\">\"10dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:bottom</span>=<span class=\"string\">\"10dp\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">shape</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>thumb_drawable.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">selector</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:state_pressed</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/thumb\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/thumb\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>thumb.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">shape</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">android:shape</span>=<span class=\"string\">\"rectangle\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">corners</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:topLeftRadius</span>=<span class=\"string\">\"44dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:topRightRadius</span>=<span class=\"string\">\"44dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:bottomLeftRadius</span>=<span class=\"string\">\"44dp\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">padding</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:paddingLeft</span>=<span class=\"string\">\"22dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:paddingRight</span>=<span class=\"string\">\"22dp\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">solid</span> <span class=\"attr\">android:color</span>=<span class=\"string\">\"@color/colorPrimaryDark\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">shape</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>效果如下：</strong></p>\n<p><img src=\"/img/android/android-ui-rv.gif\" alt=\"android-ui-rv\"></p>\n<blockquote>\n<p>原文链接： <a href=\"https://android.jlelse.eu/fast-scrolling-with-recyclerview-2b89d4574688\" target=\"_blank\" rel=\"noopener\">Fast Scrolling with RecyclerView</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<h3 id=\"RecyclerView快速滚动\"><a href=\"#RecyclerView快速滚动\" class=\"headerlink\" title=\"RecyclerView快速滚动\"></a>RecyclerView快速滚动</h3><p>使用<code>ListView</code>实现快速滚动只需要添加一行代码就可以了</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listView.setFastScrollEnabled(<span class=\"literal\">true</span>)</span><br></pre></td></tr></table></figure>\n<p>在<code>RecyclerView</code>中，之前官方并没有提供快速滚动的API。但是现在在Android Support Library 26，官方终于提供了。让我们开始吧。</p>","more":"<p><strong>首先你需要进行以下配置</strong></p>\n<p><em>版本要是26以上哦</em></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    ....</span><br><span class=\"line\">    compile <span class=\"string\">'com.android.support:design:26.0.1'</span></span><br><span class=\"line\">    compile <span class=\"string\">'com.android.support:recyclerview-v7:26.0.1'</span></span><br><span class=\"line\">    ....</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buildscript &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    repositories &#123;</span><br><span class=\"line\">        google()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ....</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>设置你的xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">android.support.constraint.ConstraintLayout</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:app</span>=<span class=\"string\">\"http://schemas.android.com/apk/res-auto\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">xmlns:tools</span>=<span class=\"string\">\"http://schemas.android.com/tools\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:layout_behavior</span>=<span class=\"string\">\"@string/appbar_scrolling_view_behavior\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">tools:context</span>=<span class=\"string\">\"com.shaishavgandhi.fastscrolling.MainActivity\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">tools:showIn</span>=<span class=\"string\">\"@layout/activity_main\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">android.support.v7.widget.RecyclerView</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:id</span>=<span class=\"string\">\"@+id/recyclerView\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_width</span>=<span class=\"string\">\"match_parent\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">android:layout_height</span>=<span class=\"string\">\"wrap_content\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollEnabled</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollHorizontalThumbDrawable</span>=<span class=\"string\">\"@drawable/thumb_drawable\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollHorizontalTrackDrawable</span>=<span class=\"string\">\"@drawable/line_drawable\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollVerticalThumbDrawable</span>=<span class=\"string\">\"@drawable/thumb_drawable\"</span></span></span><br><span class=\"line\"><span class=\"tag\">    <span class=\"attr\">app:fastScrollVerticalTrackDrawable</span>=<span class=\"string\">\"@drawable/line_drawable\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">android.support.v7.widget.RecyclerView</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">android.support.constraint.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>fastScrollEnabled：</strong>是否启用快速滚动</li>\n<li><strong>fastScrollHorizontalThumbDrawable：</strong>水平滚动块</li>\n<li><strong>fastScrollHorizontalTrackDrawable：</strong> 水平滚动背景</li>\n<li><strong>fastScrollVerticalThumbDrawable：</strong> 竖直滚动块</li>\n<li><strong>fastScrollVerticalTrackDrawable：</strong> 竖直滚动背景</li>\n</ul>\n<p><strong>line_drawable.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">selector</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:state_pressed</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/line\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/line\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>line.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">shape</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">android:shape</span>=<span class=\"string\">\"rectangle\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">solid</span> <span class=\"attr\">android:color</span>=<span class=\"string\">\"@android:color/darker_gray\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">padding</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:top</span>=<span class=\"string\">\"10dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:left</span>=<span class=\"string\">\"10dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:right</span>=<span class=\"string\">\"10dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:bottom</span>=<span class=\"string\">\"10dp\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">shape</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>thumb_drawable.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">selector</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:state_pressed</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/thumb\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">item</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:drawable</span>=<span class=\"string\">\"@drawable/thumb\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>thumb.xml</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">shape</span> <span class=\"attr\">xmlns:android</span>=<span class=\"string\">\"http://schemas.android.com/apk/res/android\"</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">android:shape</span>=<span class=\"string\">\"rectangle\"</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">corners</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:topLeftRadius</span>=<span class=\"string\">\"44dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:topRightRadius</span>=<span class=\"string\">\"44dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:bottomLeftRadius</span>=<span class=\"string\">\"44dp\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">padding</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:paddingLeft</span>=<span class=\"string\">\"22dp\"</span></span></span><br><span class=\"line\"><span class=\"tag\">        <span class=\"attr\">android:paddingRight</span>=<span class=\"string\">\"22dp\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">solid</span> <span class=\"attr\">android:color</span>=<span class=\"string\">\"@color/colorPrimaryDark\"</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">shape</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>效果如下：</strong></p>\n<p><img src=\"/img/android/android-ui-rv.gif\" alt=\"android-ui-rv\"></p>\n<blockquote>\n<p>原文链接： <a href=\"https://android.jlelse.eu/fast-scrolling-with-recyclerview-2b89d4574688\" target=\"_blank\" rel=\"noopener\">Fast Scrolling with RecyclerView</a></p>\n</blockquote>"},{"title":"android-view-textview","date":"2018-04-10T08:33:20.000Z","_content":"\n```java\npublic class PartiallyClickableActivity extends AppCompatActivity {\n\n    private TextView tv;\n\n    @Override\n    protected void onCreate(@Nullable Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.partially_clickable_activity);\n\n        tv = (TextView) findViewById(R.id.tv);\n\n        //step1 设置点击背景色为透明\n        tv.setHighlightColor(getResources().getColor(android.R.color.transparent));\n        String st1 = \"产品成立、计息并进封入闭期。购买成功后1-2个交易日可通过\";\n        String st2 = \"【我的理财】\";\n\n\n        //step3 设置SpannableString\n        SpannableString info = new SpannableString(st1 + st2 );\n        info.setSpan(new ForegroundColorSpan(Color.BLACK), 0, st1.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);\n        info.setSpan(new ForegroundColorSpan(Color.RED), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);\n        info.setSpan(new Clickable(clickListener), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE | ~Spanned.SPAN_MARK_MARK);\n\n        //step4 TextView设置SpannableString\n        tv.setText(info);\n        tv.setMovementMethod(LinkMovementMethod.getInstance());\n    }\n\n    private View.OnClickListener clickListener = new View.OnClickListener() {\n        @Override\n        public void onClick(View v) {\n            Toast.makeText(PartiallyClickableActivity.this, \"点击成功....【我的理财】\", Toast.LENGTH_SHORT).show();\n        }\n    };\n\n    //step2 定义ClickableSpan\n    class Clickable extends ClickableSpan {\n        private final View.OnClickListener mListener;\n\n        public Clickable(View.OnClickListener l) {\n            mListener = l;\n        }\n\n\n        @Override\n        public void onClick(View v) {\n            mListener.onClick(v);\n        }\n\n        @Override\n        public void updateDrawState(TextPaint ds) {\n            //取消下滑线\n            ds.setUnderlineText(false);\n//          super.updateDrawState(ds);\n        }\n    }\n}\n```\n\n","source":"_posts/android/android-view-textview.md","raw":"---\ntitle: android-view-textview\ndate: 2018-04-10 16:33:20\ntags:\n---\n\n```java\npublic class PartiallyClickableActivity extends AppCompatActivity {\n\n    private TextView tv;\n\n    @Override\n    protected void onCreate(@Nullable Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.partially_clickable_activity);\n\n        tv = (TextView) findViewById(R.id.tv);\n\n        //step1 设置点击背景色为透明\n        tv.setHighlightColor(getResources().getColor(android.R.color.transparent));\n        String st1 = \"产品成立、计息并进封入闭期。购买成功后1-2个交易日可通过\";\n        String st2 = \"【我的理财】\";\n\n\n        //step3 设置SpannableString\n        SpannableString info = new SpannableString(st1 + st2 );\n        info.setSpan(new ForegroundColorSpan(Color.BLACK), 0, st1.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);\n        info.setSpan(new ForegroundColorSpan(Color.RED), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);\n        info.setSpan(new Clickable(clickListener), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE | ~Spanned.SPAN_MARK_MARK);\n\n        //step4 TextView设置SpannableString\n        tv.setText(info);\n        tv.setMovementMethod(LinkMovementMethod.getInstance());\n    }\n\n    private View.OnClickListener clickListener = new View.OnClickListener() {\n        @Override\n        public void onClick(View v) {\n            Toast.makeText(PartiallyClickableActivity.this, \"点击成功....【我的理财】\", Toast.LENGTH_SHORT).show();\n        }\n    };\n\n    //step2 定义ClickableSpan\n    class Clickable extends ClickableSpan {\n        private final View.OnClickListener mListener;\n\n        public Clickable(View.OnClickListener l) {\n            mListener = l;\n        }\n\n\n        @Override\n        public void onClick(View v) {\n            mListener.onClick(v);\n        }\n\n        @Override\n        public void updateDrawState(TextPaint ds) {\n            //取消下滑线\n            ds.setUnderlineText(false);\n//          super.updateDrawState(ds);\n        }\n    }\n}\n```\n\n","slug":"android/android-view-textview","published":1,"updated":"2018-05-20T13:04:25.682Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61el0015izcbft3mhz08","content":"<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PartiallyClickableActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">AppCompatActivity</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TextView tv;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</span><br><span class=\"line\">        setContentView(R.layout.partially_clickable_activity);</span><br><span class=\"line\"></span><br><span class=\"line\">        tv = (TextView) findViewById(R.id.tv);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//step1 设置点击背景色为透明</span></span><br><span class=\"line\">        tv.setHighlightColor(getResources().getColor(android.R.color.transparent));</span><br><span class=\"line\">        String st1 = <span class=\"string\">\"产品成立、计息并进封入闭期。购买成功后1-2个交易日可通过\"</span>;</span><br><span class=\"line\">        String st2 = <span class=\"string\">\"【我的理财】\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//step3 设置SpannableString</span></span><br><span class=\"line\">        SpannableString info = <span class=\"keyword\">new</span> SpannableString(st1 + st2 );</span><br><span class=\"line\">        info.setSpan(<span class=\"keyword\">new</span> ForegroundColorSpan(Color.BLACK), <span class=\"number\">0</span>, st1.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);</span><br><span class=\"line\">        info.setSpan(<span class=\"keyword\">new</span> ForegroundColorSpan(Color.RED), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);</span><br><span class=\"line\">        info.setSpan(<span class=\"keyword\">new</span> Clickable(clickListener), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE | ~Spanned.SPAN_MARK_MARK);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//step4 TextView设置SpannableString</span></span><br><span class=\"line\">        tv.setText(info);</span><br><span class=\"line\">        tv.setMovementMethod(LinkMovementMethod.getInstance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> View.OnClickListener clickListener = <span class=\"keyword\">new</span> View.OnClickListener() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View v)</span> </span>&#123;</span><br><span class=\"line\">            Toast.makeText(PartiallyClickableActivity.<span class=\"keyword\">this</span>, <span class=\"string\">\"点击成功....【我的理财】\"</span>, Toast.LENGTH_SHORT).show();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//step2 定义ClickableSpan</span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Clickable</span> <span class=\"keyword\">extends</span> <span class=\"title\">ClickableSpan</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> View.OnClickListener mListener;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Clickable</span><span class=\"params\">(View.OnClickListener l)</span> </span>&#123;</span><br><span class=\"line\">            mListener = l;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View v)</span> </span>&#123;</span><br><span class=\"line\">            mListener.onClick(v);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateDrawState</span><span class=\"params\">(TextPaint ds)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//取消下滑线</span></span><br><span class=\"line\">            ds.setUnderlineText(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">//          super.updateDrawState(ds);</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PartiallyClickableActivity</span> <span class=\"keyword\">extends</span> <span class=\"title\">AppCompatActivity</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TextView tv;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">onCreate</span><span class=\"params\">(@Nullable Bundle savedInstanceState)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.onCreate(savedInstanceState);</span><br><span class=\"line\">        setContentView(R.layout.partially_clickable_activity);</span><br><span class=\"line\"></span><br><span class=\"line\">        tv = (TextView) findViewById(R.id.tv);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//step1 设置点击背景色为透明</span></span><br><span class=\"line\">        tv.setHighlightColor(getResources().getColor(android.R.color.transparent));</span><br><span class=\"line\">        String st1 = <span class=\"string\">\"产品成立、计息并进封入闭期。购买成功后1-2个交易日可通过\"</span>;</span><br><span class=\"line\">        String st2 = <span class=\"string\">\"【我的理财】\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//step3 设置SpannableString</span></span><br><span class=\"line\">        SpannableString info = <span class=\"keyword\">new</span> SpannableString(st1 + st2 );</span><br><span class=\"line\">        info.setSpan(<span class=\"keyword\">new</span> ForegroundColorSpan(Color.BLACK), <span class=\"number\">0</span>, st1.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);</span><br><span class=\"line\">        info.setSpan(<span class=\"keyword\">new</span> ForegroundColorSpan(Color.RED), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);</span><br><span class=\"line\">        info.setSpan(<span class=\"keyword\">new</span> Clickable(clickListener), st1.length(), (st1 + st2).length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE | ~Spanned.SPAN_MARK_MARK);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//step4 TextView设置SpannableString</span></span><br><span class=\"line\">        tv.setText(info);</span><br><span class=\"line\">        tv.setMovementMethod(LinkMovementMethod.getInstance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> View.OnClickListener clickListener = <span class=\"keyword\">new</span> View.OnClickListener() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View v)</span> </span>&#123;</span><br><span class=\"line\">            Toast.makeText(PartiallyClickableActivity.<span class=\"keyword\">this</span>, <span class=\"string\">\"点击成功....【我的理财】\"</span>, Toast.LENGTH_SHORT).show();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//step2 定义ClickableSpan</span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Clickable</span> <span class=\"keyword\">extends</span> <span class=\"title\">ClickableSpan</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> View.OnClickListener mListener;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Clickable</span><span class=\"params\">(View.OnClickListener l)</span> </span>&#123;</span><br><span class=\"line\">            mListener = l;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onClick</span><span class=\"params\">(View v)</span> </span>&#123;</span><br><span class=\"line\">            mListener.onClick(v);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">updateDrawState</span><span class=\"params\">(TextPaint ds)</span> </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//取消下滑线</span></span><br><span class=\"line\">            ds.setUnderlineText(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">//          super.updateDrawState(ds);</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n"},{"title":"android-vr-ar-mr","date":"2017-05-03T09:23:57.000Z","_content":"\n**AR**\n\nhttp://www.easyar.cn/view/sdk.html\n\nhttps://www.hiscene.com\n\nhttps://developer.vuforia.com\n\nhttps://developers.google.com/tango/downloads\n\nhttps://github.com/googlesamples/tango-examples-c\n\n\n\nBlog:\n\nhttp://www.jianshu.com/p/49d76c24ae46\n\nhttp://blog.csdn.net/jaikydota163/article/details/52626788\n\nhttp://www.cnblogs.com/yidan621/p/5677544.html\n\nhttp://blog.csdn.net/d276031034/article/details/54846434\n\nhttp://blog.csdn.net/yywan1314520/article/details/51530537","source":"_posts/android/android-vr.md","raw":"---\ntitle: android-vr-ar-mr\ndate: 2017-05-03 17:23:57\ntags: android\n---\n\n**AR**\n\nhttp://www.easyar.cn/view/sdk.html\n\nhttps://www.hiscene.com\n\nhttps://developer.vuforia.com\n\nhttps://developers.google.com/tango/downloads\n\nhttps://github.com/googlesamples/tango-examples-c\n\n\n\nBlog:\n\nhttp://www.jianshu.com/p/49d76c24ae46\n\nhttp://blog.csdn.net/jaikydota163/article/details/52626788\n\nhttp://www.cnblogs.com/yidan621/p/5677544.html\n\nhttp://blog.csdn.net/d276031034/article/details/54846434\n\nhttp://blog.csdn.net/yywan1314520/article/details/51530537","slug":"android/android-vr","published":1,"updated":"2018-01-31T09:35:37.813Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61en0018izcbr1btnqsi","content":"<p><strong>AR</strong></p>\n<p><a href=\"http://www.easyar.cn/view/sdk.html\" target=\"_blank\" rel=\"noopener\">http://www.easyar.cn/view/sdk.html</a></p>\n<p><a href=\"https://www.hiscene.com\" target=\"_blank\" rel=\"noopener\">https://www.hiscene.com</a></p>\n<p><a href=\"https://developer.vuforia.com\" target=\"_blank\" rel=\"noopener\">https://developer.vuforia.com</a></p>\n<p><a href=\"https://developers.google.com/tango/downloads\" target=\"_blank\" rel=\"noopener\">https://developers.google.com/tango/downloads</a></p>\n<p><a href=\"https://github.com/googlesamples/tango-examples-c\" target=\"_blank\" rel=\"noopener\">https://github.com/googlesamples/tango-examples-c</a></p>\n<p>Blog:</p>\n<p><a href=\"http://www.jianshu.com/p/49d76c24ae46\" target=\"_blank\" rel=\"noopener\">http://www.jianshu.com/p/49d76c24ae46</a></p>\n<p><a href=\"http://blog.csdn.net/jaikydota163/article/details/52626788\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/jaikydota163/article/details/52626788</a></p>\n<p><a href=\"http://www.cnblogs.com/yidan621/p/5677544.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/yidan621/p/5677544.html</a></p>\n<p><a href=\"http://blog.csdn.net/d276031034/article/details/54846434\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/d276031034/article/details/54846434</a></p>\n<p><a href=\"http://blog.csdn.net/yywan1314520/article/details/51530537\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/yywan1314520/article/details/51530537</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>AR</strong></p>\n<p><a href=\"http://www.easyar.cn/view/sdk.html\" target=\"_blank\" rel=\"noopener\">http://www.easyar.cn/view/sdk.html</a></p>\n<p><a href=\"https://www.hiscene.com\" target=\"_blank\" rel=\"noopener\">https://www.hiscene.com</a></p>\n<p><a href=\"https://developer.vuforia.com\" target=\"_blank\" rel=\"noopener\">https://developer.vuforia.com</a></p>\n<p><a href=\"https://developers.google.com/tango/downloads\" target=\"_blank\" rel=\"noopener\">https://developers.google.com/tango/downloads</a></p>\n<p><a href=\"https://github.com/googlesamples/tango-examples-c\" target=\"_blank\" rel=\"noopener\">https://github.com/googlesamples/tango-examples-c</a></p>\n<p>Blog:</p>\n<p><a href=\"http://www.jianshu.com/p/49d76c24ae46\" target=\"_blank\" rel=\"noopener\">http://www.jianshu.com/p/49d76c24ae46</a></p>\n<p><a href=\"http://blog.csdn.net/jaikydota163/article/details/52626788\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/jaikydota163/article/details/52626788</a></p>\n<p><a href=\"http://www.cnblogs.com/yidan621/p/5677544.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/yidan621/p/5677544.html</a></p>\n<p><a href=\"http://blog.csdn.net/d276031034/article/details/54846434\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/d276031034/article/details/54846434</a></p>\n<p><a href=\"http://blog.csdn.net/yywan1314520/article/details/51530537\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/yywan1314520/article/details/51530537</a></p>\n"},{"title":"Kotlin注解","date":"2018-03-12T03:44:40.000Z","_content":"\n### 前言\n\n关于注解可以参考以面文章：\n\n[ 秒懂，Java 注解 （Annotation）你可以这样学](http://blog.csdn.net/briblue/article/details/73824058)\n\n<!--more-->\n\n### 注解声明\n\n注解是将元数据附加到代码的方法。\n\nJava\n\n```kotlin\npublic @interface Fancy {}\n```\n\nkotlin\n\n```kotlin\nannotation class Fancy\n```\n\n注解类型\n\n- @Target：指定注解的作用域(类、函数、属性、表达式等)\n  - AnnotationTarget.CLASS：用作类\n  - AnnotationTarget.FIELD：用作字段\n  - AnnotationTarget.FUNCTION：用作方法\n  - AnnotationTarget.PROPERTY：用作属性\n- @Retention：注解的存活时间(SOURCE、BINARY、RUNTIME)\n  - AnnotationRetention.BINARY：注解只被保留到编译进行的时候，它并不会被加载到 JVM 中\n  - AnnotationRetention.RUNTIME：注解可以保留到程序运行的时候，它会被加载进入到 JVM 中，所以在程序运行时可以获取到它们\n  - AnnotationRetention.SOURCE：注解只在源码阶段保留，在编译器进行编译时它将被丢弃忽视\n- @Repeatable：允许在单个元素上多次使用该注解\n- @MustBeDocumented：指定该注解是公有 API 的一部分，并且应该包含在生成的 API 文档中显示的类或方法的签名中。\n\n```kotlin\n@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION,\n        AnnotationTarget.VALUE_PARAMETER, AnnotationTarget.EXPRESSION)\n@Retention(AnnotationRetention.SOURCE)\n@MustBeDocumented\nannotation class Fancy\n```\n\n### 用法\n\n```kotlin\n@Fancy class Foo {\n    @Fancy fun baz(@Fancy foo: Int): Int {\n        return (@Fancy 1)\n    }\n}\n```\n\n对类的主构造函数进行标解，这时的类不能省略`constructor`关键字\n\n```kotlin\nclass Foo @Inject constructor(dependency: MyDependency) {\n    // ……\n}\n```\n\n对属性访问器进行注解\n\n```kotlin\nclass Foo {\n    var x: MyDependency? = null\n        @Inject set\n}\n```\n\n### 构造函数\n\n注解的构造函数可以带参数\n\n```kotlin\nannotation class Special(val why: String)\n@Special(\"example\") class Foo {}\n```\n\n允许的参数类型有：\n\n- 对应Java的原生类型(Int、Long等等)\n- 字符串\n- 类(`Foo::class`)\n- 枚举\n- 其他注解\n- 上面已列类型的数组\n\n注解参数不可以为空类型，因为`JVM`不支持将`null`作为注解属性的值\n\n如果注解用作另一个注解的参数，则其不能以`@`字符作为前缀\n\n```kotlin\nannotation class ReplaceWith(val expression: String)\nannotation class Deprecated(\n        val message: String,\n        val replaceWith: ReplaceWith = ReplaceWith(\"\"))\n@Deprecated(\"This function is deprecated, use === instead\", ReplaceWith(\"this === other\"))\n```\n\n如果需要将一个类作为注解的参数，请使用`Kotlin`的类。Kotlin 编译器会自动将其转换为 Java 类，以便 Java 代码能够正常看到该注解和参数 。\n\n```kotlin\nimport kotlin.reflect.KClass\nannotation class Ann(val arg1: KClass<*>, val arg2: KClass<out Any>)\n@Ann(String::class, Int::class) class MyClass\n```\n\n### Lambada\n\n注解也可以用于`lambda`。它们会应用于生成 lambda 表达式体的 `invoke()` 方法上\n\n```kotlin\nannotation class Suspendable\nval f = @Suspendable { Fiber.sleep(10) }\n```\n\n|      |      |      |\n| ---- | ---- | ---- |\n|      |      |      |\n|      |      |      |\n|      |      |      |\n\n","source":"_posts/android/kotlin-annotations.md","raw":"---\ntitle: Kotlin注解\ndate: 2018-03-12 11:44:40\ntags: [android, kotlin]\n---\n\n### 前言\n\n关于注解可以参考以面文章：\n\n[ 秒懂，Java 注解 （Annotation）你可以这样学](http://blog.csdn.net/briblue/article/details/73824058)\n\n<!--more-->\n\n### 注解声明\n\n注解是将元数据附加到代码的方法。\n\nJava\n\n```kotlin\npublic @interface Fancy {}\n```\n\nkotlin\n\n```kotlin\nannotation class Fancy\n```\n\n注解类型\n\n- @Target：指定注解的作用域(类、函数、属性、表达式等)\n  - AnnotationTarget.CLASS：用作类\n  - AnnotationTarget.FIELD：用作字段\n  - AnnotationTarget.FUNCTION：用作方法\n  - AnnotationTarget.PROPERTY：用作属性\n- @Retention：注解的存活时间(SOURCE、BINARY、RUNTIME)\n  - AnnotationRetention.BINARY：注解只被保留到编译进行的时候，它并不会被加载到 JVM 中\n  - AnnotationRetention.RUNTIME：注解可以保留到程序运行的时候，它会被加载进入到 JVM 中，所以在程序运行时可以获取到它们\n  - AnnotationRetention.SOURCE：注解只在源码阶段保留，在编译器进行编译时它将被丢弃忽视\n- @Repeatable：允许在单个元素上多次使用该注解\n- @MustBeDocumented：指定该注解是公有 API 的一部分，并且应该包含在生成的 API 文档中显示的类或方法的签名中。\n\n```kotlin\n@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION,\n        AnnotationTarget.VALUE_PARAMETER, AnnotationTarget.EXPRESSION)\n@Retention(AnnotationRetention.SOURCE)\n@MustBeDocumented\nannotation class Fancy\n```\n\n### 用法\n\n```kotlin\n@Fancy class Foo {\n    @Fancy fun baz(@Fancy foo: Int): Int {\n        return (@Fancy 1)\n    }\n}\n```\n\n对类的主构造函数进行标解，这时的类不能省略`constructor`关键字\n\n```kotlin\nclass Foo @Inject constructor(dependency: MyDependency) {\n    // ……\n}\n```\n\n对属性访问器进行注解\n\n```kotlin\nclass Foo {\n    var x: MyDependency? = null\n        @Inject set\n}\n```\n\n### 构造函数\n\n注解的构造函数可以带参数\n\n```kotlin\nannotation class Special(val why: String)\n@Special(\"example\") class Foo {}\n```\n\n允许的参数类型有：\n\n- 对应Java的原生类型(Int、Long等等)\n- 字符串\n- 类(`Foo::class`)\n- 枚举\n- 其他注解\n- 上面已列类型的数组\n\n注解参数不可以为空类型，因为`JVM`不支持将`null`作为注解属性的值\n\n如果注解用作另一个注解的参数，则其不能以`@`字符作为前缀\n\n```kotlin\nannotation class ReplaceWith(val expression: String)\nannotation class Deprecated(\n        val message: String,\n        val replaceWith: ReplaceWith = ReplaceWith(\"\"))\n@Deprecated(\"This function is deprecated, use === instead\", ReplaceWith(\"this === other\"))\n```\n\n如果需要将一个类作为注解的参数，请使用`Kotlin`的类。Kotlin 编译器会自动将其转换为 Java 类，以便 Java 代码能够正常看到该注解和参数 。\n\n```kotlin\nimport kotlin.reflect.KClass\nannotation class Ann(val arg1: KClass<*>, val arg2: KClass<out Any>)\n@Ann(String::class, Int::class) class MyClass\n```\n\n### Lambada\n\n注解也可以用于`lambda`。它们会应用于生成 lambda 表达式体的 `invoke()` 方法上\n\n```kotlin\nannotation class Suspendable\nval f = @Suspendable { Fiber.sleep(10) }\n```\n\n|      |      |      |\n| ---- | ---- | ---- |\n|      |      |      |\n|      |      |      |\n|      |      |      |\n\n","slug":"android/kotlin-annotations","published":1,"updated":"2018-05-20T13:04:25.682Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61en001aizcb7vjj7kcv","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>关于注解可以参考以面文章：</p>\n<p><a href=\"http://blog.csdn.net/briblue/article/details/73824058\" target=\"_blank\" rel=\"noopener\"> 秒懂，Java 注解 （Annotation）你可以这样学</a></p>\n<a id=\"more\"></a>\n<h3 id=\"注解声明\"><a href=\"#注解声明\" class=\"headerlink\" title=\"注解声明\"></a>注解声明</h3><p>注解是将元数据附加到代码的方法。</p>\n<p>Java</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Fancy &#123;&#125;</span><br></pre></td></tr></table></figure>\n<p>kotlin</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fancy</span></span></span><br></pre></td></tr></table></figure>\n<p>注解类型</p>\n<ul>\n<li>@Target：指定注解的作用域(类、函数、属性、表达式等)<ul>\n<li>AnnotationTarget.CLASS：用作类</li>\n<li>AnnotationTarget.FIELD：用作字段</li>\n<li>AnnotationTarget.FUNCTION：用作方法</li>\n<li>AnnotationTarget.PROPERTY：用作属性</li>\n</ul>\n</li>\n<li>@Retention：注解的存活时间(SOURCE、BINARY、RUNTIME)<ul>\n<li>AnnotationRetention.BINARY：注解只被保留到编译进行的时候，它并不会被加载到 JVM 中</li>\n<li>AnnotationRetention.RUNTIME：注解可以保留到程序运行的时候，它会被加载进入到 JVM 中，所以在程序运行时可以获取到它们</li>\n<li>AnnotationRetention.SOURCE：注解只在源码阶段保留，在编译器进行编译时它将被丢弃忽视</li>\n</ul>\n</li>\n<li>@Repeatable：允许在单个元素上多次使用该注解</li>\n<li>@MustBeDocumented：指定该注解是公有 API 的一部分，并且应该包含在生成的 API 文档中显示的类或方法的签名中。</li>\n</ul>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION,</span></span><br><span class=\"line\"><span class=\"meta\">        AnnotationTarget.VALUE_PARAMETER, AnnotationTarget.EXPRESSION)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(AnnotationRetention.SOURCE)</span></span><br><span class=\"line\"><span class=\"meta\">@MustBeDocumented</span></span><br><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fancy</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"用法\"><a href=\"#用法\" class=\"headerlink\" title=\"用法\"></a>用法</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Fancy</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Fancy</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">baz</span><span class=\"params\">(<span class=\"meta\">@Fancy</span> foo: <span class=\"type\">Int</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"meta\">@Fancy</span> <span class=\"number\">1</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>对类的主构造函数进行标解，这时的类不能省略<code>constructor</code>关键字</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> <span class=\"meta\">@Inject</span> <span class=\"keyword\">constructor</span></span>(dependency: MyDependency) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ……</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>对属性访问器进行注解</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> x: MyDependency? = <span class=\"literal\">null</span></span><br><span class=\"line\">        <span class=\"meta\">@Inject</span> <span class=\"keyword\">set</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"构造函数\"><a href=\"#构造函数\" class=\"headerlink\" title=\"构造函数\"></a>构造函数</h3><p>注解的构造函数可以带参数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Special</span></span>(<span class=\"keyword\">val</span> why: String)</span><br><span class=\"line\"><span class=\"meta\">@Special(<span class=\"meta-string\">\"example\"</span>)</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<p>允许的参数类型有：</p>\n<ul>\n<li>对应Java的原生类型(Int、Long等等)</li>\n<li>字符串</li>\n<li>类(<code>Foo::class</code>)</li>\n<li>枚举</li>\n<li>其他注解</li>\n<li>上面已列类型的数组</li>\n</ul>\n<p>注解参数不可以为空类型，因为<code>JVM</code>不支持将<code>null</code>作为注解属性的值</p>\n<p>如果注解用作另一个注解的参数，则其不能以<code>@</code>字符作为前缀</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReplaceWith</span></span>(<span class=\"keyword\">val</span> expression: String)</span><br><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Deprecated</span></span>(</span><br><span class=\"line\">        <span class=\"keyword\">val</span> message: String,</span><br><span class=\"line\">        <span class=\"keyword\">val</span> replaceWith: ReplaceWith = ReplaceWith(<span class=\"string\">\"\"</span>))</span><br><span class=\"line\"><span class=\"meta\">@Deprecated(<span class=\"meta-string\">\"This function is deprecated, use === instead\"</span>, ReplaceWith(<span class=\"meta-string\">\"this === other\"</span>)</span>)</span><br></pre></td></tr></table></figure>\n<p>如果需要将一个类作为注解的参数，请使用<code>Kotlin</code>的类。Kotlin 编译器会自动将其转换为 Java 类，以便 Java 代码能够正常看到该注解和参数 。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> kotlin.reflect.KClass</span><br><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Ann</span></span>(<span class=\"keyword\">val</span> arg1: KClass&lt;*&gt;, <span class=\"keyword\">val</span> arg2: KClass&lt;<span class=\"keyword\">out</span> Any&gt;)</span><br><span class=\"line\"><span class=\"meta\">@Ann(String::class, Int::class)</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Lambada\"><a href=\"#Lambada\" class=\"headerlink\" title=\"Lambada\"></a>Lambada</h3><p>注解也可以用于<code>lambda</code>。它们会应用于生成 lambda 表达式体的 <code>invoke()</code> 方法上</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Suspendable</span></span></span><br><span class=\"line\"><span class=\"keyword\">val</span> f = <span class=\"meta\">@Suspendable</span> &#123; Fiber.sleep(<span class=\"number\">10</span>) &#125;</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>关于注解可以参考以面文章：</p>\n<p><a href=\"http://blog.csdn.net/briblue/article/details/73824058\" target=\"_blank\" rel=\"noopener\"> 秒懂，Java 注解 （Annotation）你可以这样学</a></p>","more":"<h3 id=\"注解声明\"><a href=\"#注解声明\" class=\"headerlink\" title=\"注解声明\"></a>注解声明</h3><p>注解是将元数据附加到代码的方法。</p>\n<p>Java</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Fancy &#123;&#125;</span><br></pre></td></tr></table></figure>\n<p>kotlin</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fancy</span></span></span><br></pre></td></tr></table></figure>\n<p>注解类型</p>\n<ul>\n<li>@Target：指定注解的作用域(类、函数、属性、表达式等)<ul>\n<li>AnnotationTarget.CLASS：用作类</li>\n<li>AnnotationTarget.FIELD：用作字段</li>\n<li>AnnotationTarget.FUNCTION：用作方法</li>\n<li>AnnotationTarget.PROPERTY：用作属性</li>\n</ul>\n</li>\n<li>@Retention：注解的存活时间(SOURCE、BINARY、RUNTIME)<ul>\n<li>AnnotationRetention.BINARY：注解只被保留到编译进行的时候，它并不会被加载到 JVM 中</li>\n<li>AnnotationRetention.RUNTIME：注解可以保留到程序运行的时候，它会被加载进入到 JVM 中，所以在程序运行时可以获取到它们</li>\n<li>AnnotationRetention.SOURCE：注解只在源码阶段保留，在编译器进行编译时它将被丢弃忽视</li>\n</ul>\n</li>\n<li>@Repeatable：允许在单个元素上多次使用该注解</li>\n<li>@MustBeDocumented：指定该注解是公有 API 的一部分，并且应该包含在生成的 API 文档中显示的类或方法的签名中。</li>\n</ul>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(AnnotationTarget.CLASS, AnnotationTarget.FUNCTION,</span></span><br><span class=\"line\"><span class=\"meta\">        AnnotationTarget.VALUE_PARAMETER, AnnotationTarget.EXPRESSION)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(AnnotationRetention.SOURCE)</span></span><br><span class=\"line\"><span class=\"meta\">@MustBeDocumented</span></span><br><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fancy</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"用法\"><a href=\"#用法\" class=\"headerlink\" title=\"用法\"></a>用法</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Fancy</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Fancy</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">baz</span><span class=\"params\">(<span class=\"meta\">@Fancy</span> foo: <span class=\"type\">Int</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"meta\">@Fancy</span> <span class=\"number\">1</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>对类的主构造函数进行标解，这时的类不能省略<code>constructor</code>关键字</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> <span class=\"meta\">@Inject</span> <span class=\"keyword\">constructor</span></span>(dependency: MyDependency) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// ……</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>对属性访问器进行注解</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> x: MyDependency? = <span class=\"literal\">null</span></span><br><span class=\"line\">        <span class=\"meta\">@Inject</span> <span class=\"keyword\">set</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"构造函数\"><a href=\"#构造函数\" class=\"headerlink\" title=\"构造函数\"></a>构造函数</h3><p>注解的构造函数可以带参数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Special</span></span>(<span class=\"keyword\">val</span> why: String)</span><br><span class=\"line\"><span class=\"meta\">@Special(<span class=\"meta-string\">\"example\"</span>)</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<p>允许的参数类型有：</p>\n<ul>\n<li>对应Java的原生类型(Int、Long等等)</li>\n<li>字符串</li>\n<li>类(<code>Foo::class</code>)</li>\n<li>枚举</li>\n<li>其他注解</li>\n<li>上面已列类型的数组</li>\n</ul>\n<p>注解参数不可以为空类型，因为<code>JVM</code>不支持将<code>null</code>作为注解属性的值</p>\n<p>如果注解用作另一个注解的参数，则其不能以<code>@</code>字符作为前缀</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ReplaceWith</span></span>(<span class=\"keyword\">val</span> expression: String)</span><br><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Deprecated</span></span>(</span><br><span class=\"line\">        <span class=\"keyword\">val</span> message: String,</span><br><span class=\"line\">        <span class=\"keyword\">val</span> replaceWith: ReplaceWith = ReplaceWith(<span class=\"string\">\"\"</span>))</span><br><span class=\"line\"><span class=\"meta\">@Deprecated(<span class=\"meta-string\">\"This function is deprecated, use === instead\"</span>, ReplaceWith(<span class=\"meta-string\">\"this === other\"</span>)</span>)</span><br></pre></td></tr></table></figure>\n<p>如果需要将一个类作为注解的参数，请使用<code>Kotlin</code>的类。Kotlin 编译器会自动将其转换为 Java 类，以便 Java 代码能够正常看到该注解和参数 。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> kotlin.reflect.KClass</span><br><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Ann</span></span>(<span class=\"keyword\">val</span> arg1: KClass&lt;*&gt;, <span class=\"keyword\">val</span> arg2: KClass&lt;<span class=\"keyword\">out</span> Any&gt;)</span><br><span class=\"line\"><span class=\"meta\">@Ann(String::class, Int::class)</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Lambada\"><a href=\"#Lambada\" class=\"headerlink\" title=\"Lambada\"></a>Lambada</h3><p>注解也可以用于<code>lambda</code>。它们会应用于生成 lambda 表达式体的 <code>invoke()</code> 方法上</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">annotation</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Suspendable</span></span></span><br><span class=\"line\"><span class=\"keyword\">val</span> f = <span class=\"meta\">@Suspendable</span> &#123; Fiber.sleep(<span class=\"number\">10</span>) &#125;</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>"},{"title":"Kotlin类与对象","date":"2018-03-02T03:12:56.000Z","_content":"\n### 声明和初始化类\n\n#### 类的定义\n\n```kotlin\nclass User constructor (_nickname: String) {\n    val nickname: String\n    init {\n        nickname = _nickname\n    }\n}\n```\n\n> \u0011和`java`不同，在`java`中，初始化代码是写在构造方法里面的，而`kotlin`是写在`init`方法里。\n\n<!--more-->\n\n在上面的例子中，不需要把初始化代码放在初始化语句块中，因为它可以与`nickname`属性的声明结合。如果主构造方法没有注解或可见性修饰符，同样可以去掉`constructor`关键字。\n\n```kotlin\nclass User (_nickname: String) {\n    val nickname = _nickname\n}\n```\n\n前两个例子在类体中使用`val`关键字声明了属性。如果属性用相应的构造方法参数来初始化，代码可以通过把`val`关键字加在参数前的方式来进行简化。\n\n```kotlin\nclass User (val _nickname: String)\n```\n\n我们也可以为构造方法参数声明一个默认值\n\n```kotlin\nclass User (val _nickname: String, val isSubscribed: Boolean = true)\n```\n\n> 如果所有的构造方法都有默认值，编译器会生成一个额外的不带参数的构造方法来使用所有的默认值。\n\n如果你的类具有一个父类，主构造方法同样需要初始化父类。可以通过在基类列表的父类引用中提供父类构造方法参数的方式来做到这一点。\n\n```kotlin\nopen class User(val nickName: Stirng) { ...... }\nclass TwitterUser(nickName: String): User(nickName) { ...... }\n```\n\n#### 次构造函数\n\n```kotlin\nopen class View {\n    constructor (ctx: Context) {}\n    constructor (ctx: Context, attr: AttributeSet) {}\n    constructor (ctx: context, attr: AttributeSet, defStyle: Int): this(ctx, attr) {}\n}\nclass MyButton: View {\n    constructor (ctx: Context): super(ctx) {}\n    constructor(ctx: Context, attr: AttributeSet): super(ctx, attr) {}\n}\n```\n\n#### 类的实例\n\n要创建一个类的实例，只需要直接调用构造方法，不需要使用`new`关键字：\n\n```kotlin\nval alice = User(\"Alice\")\nval bob = User(\"Bob\", false)\n```\n\n#### 匿名对象\n\n使用`object`关键字创建匿名对象\n\n```kotlin\nbutton.setOnClickListener(object : View.OnClickListener {\n    override fun onClick(v: View?) {\n    }\n})\n```\n创建单独的类(不继承，不实现接口)\n\n```kotlin\nval pair = object {\n    var first = 1\n    var second = \"a\"\n}\nprintln(\"${pair.first} ${pair.second}\") // 1 a\n```\n\n注意：匿名对象使用`public`修改符，那么匿名对象赋值的函数或属性的实际类型会是匿名对象声明的超类型，如果没声明超类型，会是`Any`。如下图，因为属性`pair`是用`public`，所以它的类型是`Any`，这样就访问不到里面的`first`和`second`\n\n```kotlin\nclass Pair() {\n\tprivate fun getPair() = object {\n\t\tvar first = 1\n\t\tvar second = \"a\"\n\t}\n\n\tpublic val pair = object {\n\t\tval first = 1\n\t\tvar second = \"a\"\n\t}\n\n\tfun get() {\n\t\tgetPair().first\n\t\t// pair.first 这里会报错，因为属性pair是用public修饰的\n\t}\n}\n```\n\n### 静态成员与方法\n\nkotlin没有`static`关键字，需要使用`object`来代替\n\njava\n\n```kotlin\nclass User {\n    static String TAG = \"\"; \n    static void getName() {}\n    void getAge() {}\n}\n// User.TAG\n// User.getName()\n// new User().getAge()\n```\n\nkotlin\n\n```kotlin\nclass User {    \n    companion object {\n        val TAG = \"\"    \n    \tfun getName() {}\n    }\n    fun getAge() {}\n}\n// User.TAG\n// User.getName()\n// User().getAge()\n```\n\n使用`companion object`包裹的代码，都是静态的，`java`代码调用时，需要加`companion`关键字\n\n```java\n// java\nUser.companion.TAG\n```\n\n还有一种，使用`object` 关键修饰类，这样类里的所有成员和方法都是静态的\n\n```kotlin\nobject User {\n    val TAG = \"\"\n    fun getName() {}\n}\n// User.TAG\n// User.getName()\n// User.getAge()\n```\n\n#### 使用`companion object`实现单例模式\n\n```kotlin\nclass SDKManager private constructor() {\n\n    private object SingletonHolder {\n        val instance = SDKManager()\n    }\n\n    companion object {\n        val instance = SingletonHolder.instance\n        // or\n        fun get() = SingletonHolder.instance\n    }\n}\n\nSDKManager.instance\nSDKManager.get()\n```\n\n### 内部类和嵌套类：默认是嵌套类\n\n**嵌套类不持有外部类的引用，而内部类持有**\n\n|    类A在别一个类B中声明    |    在Java中    |  在Kotlin中   |\n| :------------------------: | :------------: | :-----------: |\n| 嵌套类(不存储外部类的引用) | static class A |    class A    |\n|  内部类(存储外部类的引用)  |    class A     | inner class A |\n\n**kotlin引用外部类实例**\n\n```kotlin\nclass Outer {\n    inner class Inner {\n        fun getOuterReference() = this@Outer\n    }\n}\n```","source":"_posts/android/kotlin-class.md","raw":"---\ntitle: Kotlin类与对象\ndate: 2018-03-02 11:12:56\ntags: [android, kotlin]\n---\n\n### 声明和初始化类\n\n#### 类的定义\n\n```kotlin\nclass User constructor (_nickname: String) {\n    val nickname: String\n    init {\n        nickname = _nickname\n    }\n}\n```\n\n> \u0011和`java`不同，在`java`中，初始化代码是写在构造方法里面的，而`kotlin`是写在`init`方法里。\n\n<!--more-->\n\n在上面的例子中，不需要把初始化代码放在初始化语句块中，因为它可以与`nickname`属性的声明结合。如果主构造方法没有注解或可见性修饰符，同样可以去掉`constructor`关键字。\n\n```kotlin\nclass User (_nickname: String) {\n    val nickname = _nickname\n}\n```\n\n前两个例子在类体中使用`val`关键字声明了属性。如果属性用相应的构造方法参数来初始化，代码可以通过把`val`关键字加在参数前的方式来进行简化。\n\n```kotlin\nclass User (val _nickname: String)\n```\n\n我们也可以为构造方法参数声明一个默认值\n\n```kotlin\nclass User (val _nickname: String, val isSubscribed: Boolean = true)\n```\n\n> 如果所有的构造方法都有默认值，编译器会生成一个额外的不带参数的构造方法来使用所有的默认值。\n\n如果你的类具有一个父类，主构造方法同样需要初始化父类。可以通过在基类列表的父类引用中提供父类构造方法参数的方式来做到这一点。\n\n```kotlin\nopen class User(val nickName: Stirng) { ...... }\nclass TwitterUser(nickName: String): User(nickName) { ...... }\n```\n\n#### 次构造函数\n\n```kotlin\nopen class View {\n    constructor (ctx: Context) {}\n    constructor (ctx: Context, attr: AttributeSet) {}\n    constructor (ctx: context, attr: AttributeSet, defStyle: Int): this(ctx, attr) {}\n}\nclass MyButton: View {\n    constructor (ctx: Context): super(ctx) {}\n    constructor(ctx: Context, attr: AttributeSet): super(ctx, attr) {}\n}\n```\n\n#### 类的实例\n\n要创建一个类的实例，只需要直接调用构造方法，不需要使用`new`关键字：\n\n```kotlin\nval alice = User(\"Alice\")\nval bob = User(\"Bob\", false)\n```\n\n#### 匿名对象\n\n使用`object`关键字创建匿名对象\n\n```kotlin\nbutton.setOnClickListener(object : View.OnClickListener {\n    override fun onClick(v: View?) {\n    }\n})\n```\n创建单独的类(不继承，不实现接口)\n\n```kotlin\nval pair = object {\n    var first = 1\n    var second = \"a\"\n}\nprintln(\"${pair.first} ${pair.second}\") // 1 a\n```\n\n注意：匿名对象使用`public`修改符，那么匿名对象赋值的函数或属性的实际类型会是匿名对象声明的超类型，如果没声明超类型，会是`Any`。如下图，因为属性`pair`是用`public`，所以它的类型是`Any`，这样就访问不到里面的`first`和`second`\n\n```kotlin\nclass Pair() {\n\tprivate fun getPair() = object {\n\t\tvar first = 1\n\t\tvar second = \"a\"\n\t}\n\n\tpublic val pair = object {\n\t\tval first = 1\n\t\tvar second = \"a\"\n\t}\n\n\tfun get() {\n\t\tgetPair().first\n\t\t// pair.first 这里会报错，因为属性pair是用public修饰的\n\t}\n}\n```\n\n### 静态成员与方法\n\nkotlin没有`static`关键字，需要使用`object`来代替\n\njava\n\n```kotlin\nclass User {\n    static String TAG = \"\"; \n    static void getName() {}\n    void getAge() {}\n}\n// User.TAG\n// User.getName()\n// new User().getAge()\n```\n\nkotlin\n\n```kotlin\nclass User {    \n    companion object {\n        val TAG = \"\"    \n    \tfun getName() {}\n    }\n    fun getAge() {}\n}\n// User.TAG\n// User.getName()\n// User().getAge()\n```\n\n使用`companion object`包裹的代码，都是静态的，`java`代码调用时，需要加`companion`关键字\n\n```java\n// java\nUser.companion.TAG\n```\n\n还有一种，使用`object` 关键修饰类，这样类里的所有成员和方法都是静态的\n\n```kotlin\nobject User {\n    val TAG = \"\"\n    fun getName() {}\n}\n// User.TAG\n// User.getName()\n// User.getAge()\n```\n\n#### 使用`companion object`实现单例模式\n\n```kotlin\nclass SDKManager private constructor() {\n\n    private object SingletonHolder {\n        val instance = SDKManager()\n    }\n\n    companion object {\n        val instance = SingletonHolder.instance\n        // or\n        fun get() = SingletonHolder.instance\n    }\n}\n\nSDKManager.instance\nSDKManager.get()\n```\n\n### 内部类和嵌套类：默认是嵌套类\n\n**嵌套类不持有外部类的引用，而内部类持有**\n\n|    类A在别一个类B中声明    |    在Java中    |  在Kotlin中   |\n| :------------------------: | :------------: | :-----------: |\n| 嵌套类(不存储外部类的引用) | static class A |    class A    |\n|  内部类(存储外部类的引用)  |    class A     | inner class A |\n\n**kotlin引用外部类实例**\n\n```kotlin\nclass Outer {\n    inner class Inner {\n        fun getOuterReference() = this@Outer\n    }\n}\n```","slug":"android/kotlin-class","published":1,"updated":"2018-05-20T13:04:25.682Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61eo001cizcbxcq0kxts","content":"<h3 id=\"声明和初始化类\"><a href=\"#声明和初始化类\" class=\"headerlink\" title=\"声明和初始化类\"></a>声明和初始化类</h3><h4 id=\"类的定义\"><a href=\"#类的定义\" class=\"headerlink\" title=\"类的定义\"></a>类的定义</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> <span class=\"keyword\">constructor</span> </span>(_nickname: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> nickname: String</span><br><span class=\"line\">    init &#123;</span><br><span class=\"line\">        nickname = _nickname</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>\u0011和<code>java</code>不同，在<code>java</code>中，初始化代码是写在构造方法里面的，而<code>kotlin</code>是写在<code>init</code>方法里。</p>\n</blockquote>\n<a id=\"more\"></a>\n<p>在上面的例子中，不需要把初始化代码放在初始化语句块中，因为它可以与<code>nickname</code>属性的声明结合。如果主构造方法没有注解或可见性修饰符，同样可以去掉<code>constructor</code>关键字。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>(_nickname: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> nickname = _nickname</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>前两个例子在类体中使用<code>val</code>关键字声明了属性。如果属性用相应的构造方法参数来初始化，代码可以通过把<code>val</code>关键字加在参数前的方式来进行简化。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>(<span class=\"keyword\">val</span> _nickname: String)</span><br></pre></td></tr></table></figure>\n<p>我们也可以为构造方法参数声明一个默认值</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>(<span class=\"keyword\">val</span> _nickname: String, <span class=\"keyword\">val</span> isSubscribed: <span class=\"built_in\">Boolean</span> = <span class=\"literal\">true</span>)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如果所有的构造方法都有默认值，编译器会生成一个额外的不带参数的构造方法来使用所有的默认值。</p>\n</blockquote>\n<p>如果你的类具有一个父类，主构造方法同样需要初始化父类。可以通过在基类列表的父类引用中提供父类构造方法参数的方式来做到这一点。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">open</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span></span>(<span class=\"keyword\">val</span> nickName: Stirng) &#123; ...... &#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TwitterUser</span></span>(nickName: String): User(nickName) &#123; ...... &#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"次构造函数\"><a href=\"#次构造函数\" class=\"headerlink\" title=\"次构造函数\"></a>次构造函数</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">open</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">View</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: Context) &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: Context, attr: AttributeSet) &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: context, attr: AttributeSet, defStyle: <span class=\"built_in\">Int</span>): <span class=\"keyword\">this</span>(ctx, attr) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyButton</span>: <span class=\"type\">View &#123;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: Context): <span class=\"keyword\">super</span>(ctx) &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(ctx: Context, attr: AttributeSet): <span class=\"keyword\">super</span>(ctx, attr) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"类的实例\"><a href=\"#类的实例\" class=\"headerlink\" title=\"类的实例\"></a>类的实例</h4><p>要创建一个类的实例，只需要直接调用构造方法，不需要使用<code>new</code>关键字：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> alice = User(<span class=\"string\">\"Alice\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> bob = User(<span class=\"string\">\"Bob\"</span>, <span class=\"literal\">false</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"匿名对象\"><a href=\"#匿名对象\" class=\"headerlink\" title=\"匿名对象\"></a>匿名对象</h4><p>使用<code>object</code>关键字创建匿名对象</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">button.setOnClickListener(<span class=\"keyword\">object</span> : View.OnClickListener &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onClick</span><span class=\"params\">(v: <span class=\"type\">View</span>?)</span></span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>创建单独的类(不继承，不实现接口)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> pair = <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> first = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> second = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">println(<span class=\"string\">\"<span class=\"subst\">$&#123;pair.first&#125;</span> <span class=\"subst\">$&#123;pair.second&#125;</span>\"</span>) <span class=\"comment\">// 1 a</span></span><br></pre></td></tr></table></figure>\n<p>注意：匿名对象使用<code>public</code>修改符，那么匿名对象赋值的函数或属性的实际类型会是匿名对象声明的超类型，如果没声明超类型，会是<code>Any</code>。如下图，因为属性<code>pair</code>是用<code>public</code>，所以它的类型是<code>Any</code>，这样就访问不到里面的<code>first</code>和<code>second</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pair</span></span>() &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getPair</span><span class=\"params\">()</span></span> = <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> first = <span class=\"number\">1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> second = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">val</span> pair = <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">val</span> first = <span class=\"number\">1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> second = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">get</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\tgetPair().first</span><br><span class=\"line\">\t\t<span class=\"comment\">// pair.first 这里会报错，因为属性pair是用public修饰的</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"静态成员与方法\"><a href=\"#静态成员与方法\" class=\"headerlink\" title=\"静态成员与方法\"></a>静态成员与方法</h3><p>kotlin没有<code>static</code>关键字，需要使用<code>object</code>来代替</p>\n<p>java</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    static String TAG = <span class=\"string\">\"\"</span>; </span><br><span class=\"line\">    static void getName() &#123;&#125;</span><br><span class=\"line\">    void getAge() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// User.TAG</span></span><br><span class=\"line\"><span class=\"comment\">// User.getName()</span></span><br><span class=\"line\"><span class=\"comment\">// new User().getAge()</span></span><br></pre></td></tr></table></figure>\n<p>kotlin</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;    </span><br><span class=\"line\">    <span class=\"keyword\">companion</span> <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> TAG = <span class=\"string\">\"\"</span>    </span><br><span class=\"line\">    \t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getName</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getAge</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// User.TAG</span></span><br><span class=\"line\"><span class=\"comment\">// User.getName()</span></span><br><span class=\"line\"><span class=\"comment\">// User().getAge()</span></span><br></pre></td></tr></table></figure>\n<p>使用<code>companion object</code>包裹的代码，都是静态的，<code>java</code>代码调用时，需要加<code>companion</code>关键字</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// java</span></span><br><span class=\"line\">User.companion.TAG</span><br></pre></td></tr></table></figure>\n<p>还有一种，使用<code>object</code> 关键修饰类，这样类里的所有成员和方法都是静态的</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">object</span> User &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> TAG = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getName</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// User.TAG</span></span><br><span class=\"line\"><span class=\"comment\">// User.getName()</span></span><br><span class=\"line\"><span class=\"comment\">// User.getAge()</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"使用companion-object实现单例模式\"><a href=\"#使用companion-object实现单例模式\" class=\"headerlink\" title=\"使用companion object实现单例模式\"></a>使用<code>companion object</code>实现单例模式</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SDKManager</span> <span class=\"keyword\">private</span> <span class=\"keyword\">constructor</span></span>() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">object</span> SingletonHolder &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> instance = SDKManager()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">companion</span> <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> instance = SingletonHolder.instance</span><br><span class=\"line\">        <span class=\"comment\">// or</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">get</span><span class=\"params\">()</span></span> = SingletonHolder.instance</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">SDKManager.instance</span><br><span class=\"line\">SDKManager.<span class=\"keyword\">get</span>()</span><br></pre></td></tr></table></figure>\n<h3 id=\"内部类和嵌套类：默认是嵌套类\"><a href=\"#内部类和嵌套类：默认是嵌套类\" class=\"headerlink\" title=\"内部类和嵌套类：默认是嵌套类\"></a>内部类和嵌套类：默认是嵌套类</h3><p><strong>嵌套类不持有外部类的引用，而内部类持有</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">类A在别一个类B中声明</th>\n<th style=\"text-align:center\">在Java中</th>\n<th style=\"text-align:center\">在Kotlin中</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">嵌套类(不存储外部类的引用)</td>\n<td style=\"text-align:center\">static class A</td>\n<td style=\"text-align:center\">class A</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">内部类(存储外部类的引用)</td>\n<td style=\"text-align:center\">class A</td>\n<td style=\"text-align:center\">inner class A</td>\n</tr>\n</tbody>\n</table>\n<p><strong>kotlin引用外部类实例</strong></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Outer</span> </span>&#123;</span><br><span class=\"line\">    inner <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Inner</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getOuterReference</span><span class=\"params\">()</span></span> = <span class=\"keyword\">this</span><span class=\"symbol\">@Outer</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h3 id=\"声明和初始化类\"><a href=\"#声明和初始化类\" class=\"headerlink\" title=\"声明和初始化类\"></a>声明和初始化类</h3><h4 id=\"类的定义\"><a href=\"#类的定义\" class=\"headerlink\" title=\"类的定义\"></a>类的定义</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> <span class=\"keyword\">constructor</span> </span>(_nickname: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> nickname: String</span><br><span class=\"line\">    init &#123;</span><br><span class=\"line\">        nickname = _nickname</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>\u0011和<code>java</code>不同，在<code>java</code>中，初始化代码是写在构造方法里面的，而<code>kotlin</code>是写在<code>init</code>方法里。</p>\n</blockquote>","more":"<p>在上面的例子中，不需要把初始化代码放在初始化语句块中，因为它可以与<code>nickname</code>属性的声明结合。如果主构造方法没有注解或可见性修饰符，同样可以去掉<code>constructor</code>关键字。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>(_nickname: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> nickname = _nickname</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>前两个例子在类体中使用<code>val</code>关键字声明了属性。如果属性用相应的构造方法参数来初始化，代码可以通过把<code>val</code>关键字加在参数前的方式来进行简化。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>(<span class=\"keyword\">val</span> _nickname: String)</span><br></pre></td></tr></table></figure>\n<p>我们也可以为构造方法参数声明一个默认值</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>(<span class=\"keyword\">val</span> _nickname: String, <span class=\"keyword\">val</span> isSubscribed: <span class=\"built_in\">Boolean</span> = <span class=\"literal\">true</span>)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>如果所有的构造方法都有默认值，编译器会生成一个额外的不带参数的构造方法来使用所有的默认值。</p>\n</blockquote>\n<p>如果你的类具有一个父类，主构造方法同样需要初始化父类。可以通过在基类列表的父类引用中提供父类构造方法参数的方式来做到这一点。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">open</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span></span>(<span class=\"keyword\">val</span> nickName: Stirng) &#123; ...... &#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TwitterUser</span></span>(nickName: String): User(nickName) &#123; ...... &#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"次构造函数\"><a href=\"#次构造函数\" class=\"headerlink\" title=\"次构造函数\"></a>次构造函数</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">open</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">View</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: Context) &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: Context, attr: AttributeSet) &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: context, attr: AttributeSet, defStyle: <span class=\"built_in\">Int</span>): <span class=\"keyword\">this</span>(ctx, attr) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyButton</span>: <span class=\"type\">View &#123;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">constructor</span> (ctx: Context): <span class=\"keyword\">super</span>(ctx) &#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(ctx: Context, attr: AttributeSet): <span class=\"keyword\">super</span>(ctx, attr) &#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"类的实例\"><a href=\"#类的实例\" class=\"headerlink\" title=\"类的实例\"></a>类的实例</h4><p>要创建一个类的实例，只需要直接调用构造方法，不需要使用<code>new</code>关键字：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> alice = User(<span class=\"string\">\"Alice\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> bob = User(<span class=\"string\">\"Bob\"</span>, <span class=\"literal\">false</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"匿名对象\"><a href=\"#匿名对象\" class=\"headerlink\" title=\"匿名对象\"></a>匿名对象</h4><p>使用<code>object</code>关键字创建匿名对象</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">button.setOnClickListener(<span class=\"keyword\">object</span> : View.OnClickListener &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">onClick</span><span class=\"params\">(v: <span class=\"type\">View</span>?)</span></span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>创建单独的类(不继承，不实现接口)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> pair = <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> first = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> second = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">println(<span class=\"string\">\"<span class=\"subst\">$&#123;pair.first&#125;</span> <span class=\"subst\">$&#123;pair.second&#125;</span>\"</span>) <span class=\"comment\">// 1 a</span></span><br></pre></td></tr></table></figure>\n<p>注意：匿名对象使用<code>public</code>修改符，那么匿名对象赋值的函数或属性的实际类型会是匿名对象声明的超类型，如果没声明超类型，会是<code>Any</code>。如下图，因为属性<code>pair</code>是用<code>public</code>，所以它的类型是<code>Any</code>，这样就访问不到里面的<code>first</code>和<code>second</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pair</span></span>() &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getPair</span><span class=\"params\">()</span></span> = <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> first = <span class=\"number\">1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> second = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">val</span> pair = <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">val</span> first = <span class=\"number\">1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> second = <span class=\"string\">\"a\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">get</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\tgetPair().first</span><br><span class=\"line\">\t\t<span class=\"comment\">// pair.first 这里会报错，因为属性pair是用public修饰的</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"静态成员与方法\"><a href=\"#静态成员与方法\" class=\"headerlink\" title=\"静态成员与方法\"></a>静态成员与方法</h3><p>kotlin没有<code>static</code>关键字，需要使用<code>object</code>来代替</p>\n<p>java</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    static String TAG = <span class=\"string\">\"\"</span>; </span><br><span class=\"line\">    static void getName() &#123;&#125;</span><br><span class=\"line\">    void getAge() &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// User.TAG</span></span><br><span class=\"line\"><span class=\"comment\">// User.getName()</span></span><br><span class=\"line\"><span class=\"comment\">// new User().getAge()</span></span><br></pre></td></tr></table></figure>\n<p>kotlin</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;    </span><br><span class=\"line\">    <span class=\"keyword\">companion</span> <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> TAG = <span class=\"string\">\"\"</span>    </span><br><span class=\"line\">    \t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getName</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getAge</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// User.TAG</span></span><br><span class=\"line\"><span class=\"comment\">// User.getName()</span></span><br><span class=\"line\"><span class=\"comment\">// User().getAge()</span></span><br></pre></td></tr></table></figure>\n<p>使用<code>companion object</code>包裹的代码，都是静态的，<code>java</code>代码调用时，需要加<code>companion</code>关键字</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// java</span></span><br><span class=\"line\">User.companion.TAG</span><br></pre></td></tr></table></figure>\n<p>还有一种，使用<code>object</code> 关键修饰类，这样类里的所有成员和方法都是静态的</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">object</span> User &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> TAG = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getName</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// User.TAG</span></span><br><span class=\"line\"><span class=\"comment\">// User.getName()</span></span><br><span class=\"line\"><span class=\"comment\">// User.getAge()</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"使用companion-object实现单例模式\"><a href=\"#使用companion-object实现单例模式\" class=\"headerlink\" title=\"使用companion object实现单例模式\"></a>使用<code>companion object</code>实现单例模式</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SDKManager</span> <span class=\"keyword\">private</span> <span class=\"keyword\">constructor</span></span>() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">object</span> SingletonHolder &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> instance = SDKManager()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">companion</span> <span class=\"keyword\">object</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">val</span> instance = SingletonHolder.instance</span><br><span class=\"line\">        <span class=\"comment\">// or</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">get</span><span class=\"params\">()</span></span> = SingletonHolder.instance</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">SDKManager.instance</span><br><span class=\"line\">SDKManager.<span class=\"keyword\">get</span>()</span><br></pre></td></tr></table></figure>\n<h3 id=\"内部类和嵌套类：默认是嵌套类\"><a href=\"#内部类和嵌套类：默认是嵌套类\" class=\"headerlink\" title=\"内部类和嵌套类：默认是嵌套类\"></a>内部类和嵌套类：默认是嵌套类</h3><p><strong>嵌套类不持有外部类的引用，而内部类持有</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">类A在别一个类B中声明</th>\n<th style=\"text-align:center\">在Java中</th>\n<th style=\"text-align:center\">在Kotlin中</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">嵌套类(不存储外部类的引用)</td>\n<td style=\"text-align:center\">static class A</td>\n<td style=\"text-align:center\">class A</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">内部类(存储外部类的引用)</td>\n<td style=\"text-align:center\">class A</td>\n<td style=\"text-align:center\">inner class A</td>\n</tr>\n</tbody>\n</table>\n<p><strong>kotlin引用外部类实例</strong></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Outer</span> </span>&#123;</span><br><span class=\"line\">    inner <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Inner</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getOuterReference</span><span class=\"params\">()</span></span> = <span class=\"keyword\">this</span><span class=\"symbol\">@Outer</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Kotlin详解集合与操作符","date":"2018-03-14T02:06:08.000Z","_content":"\n[TOC]\n\n### 前言\n\nkotlin的集合分为不可变集合和可变集合\n\nKotlin 的 `List<out T>` 只提供只读操作如 `size`、`get`等的接口。和 Java 类似，它继承自 `Collection<T>` 进而继承自 `Iterable<T>`。改变 list 的方法是由 `MutableList<T>` 加入的。这一模式同样适用于 `Set<out T>/MutableSet<T>` 及 `Map<K, out V>/MutableMap<K, V>`。详见下表\n\n| 不可变     | 可变              |\n| :--------- | ----------------- |\n| Iterable   | MutableIterable   |\n| Collection | MutableCollection |\n| List       | MutableList       |\n| Set        | MutableSet        |\n| Map        | MutableMap        |\n\n`List`和`Set`的基本用法\n\n```kotlin\nval numbers: MutableList<Int> = mutableListOf(1, 2, 3)\nval readOnlyView: List<Int> = numbers\nprintln(numbers)        // 输出 \"[1, 2, 3]\"\nnumbers.add(4)\nprintln(readOnlyView)   // 输出 \"[1, 2, 3, 4]\"\nreadOnlyView.clear()    // -> 不能编译\n\nval strings = hashSetOf(\"a\", \"b\", \"c\", \"c\")\nassert(strings.size == 3)\n```\n\n### 总数操作符\n\n**any**\n\n只要有一个元素符合判断条件，则返回`true`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.any { it % 2 == 0} // true\nlist.any { it > 10 } // false\n```\n\n**all**\n\n只有全部的元素符合判断条件，则返回`true`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.all { it < 10 } // true\nlist.all { it % 2 == 0} // false\n```\n\n**count**\n\n返回符合判断条件的元素总数\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.count { it % 2 == 0 } // 3\n```\n\n**fold**\n\n给定一个初始值，在初始值的基础上，通过给定的函数来累计所有元素。\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.fold(4) { total, next -> total + next } // 4+1+2+3+4+5+6 = 25\nlist.fold(4) { total, next -> total * next } // 4*1*2*3*4*5*6 = 2880\n```\n\n**foldRight**\n\n与`fold`一样，只是顺序是从最后一项到第一项\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.foldRight(4) { total, next -> total + next } // 25\n```\n\n**forEach**\n\n遍历的所有的元素，并执行给定的操作\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.forEach { println(it) }\n```\n\n**forEachIndexed**\n\n与`forEach`类似，但是我们同时可以得到元素的`index`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.forEachIndexed { (index, value) -> println(\"position $index contains a $value\") }\n```\n\n**max/min**\n\n返回最大/最小的一项，如果没有则返回`null`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.max() // 6\nlist.min() // 1\n```\n\n**maxBy/minBy**\n\n根据给定的函数返回最大/最小的一项，如果没有则返回`null`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.maxBy { -it } // 1\nlist.minBy { -it } // 6\n```\n\n**none**\n\n如果没有任何元素与给定的函数匹配，则返回`true`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.none { it % 7 == 0 } // true\n```\n\n**reduce**\n\n和`fold`一样，但是没有一个初始值。通过给定的函数来累计所有元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.reduce { total, next -> total + next } // 21\n```\n\n**reduceRight**\n\n和`reduce`一样，但是顺序是从最后一项到第一项\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.reduceRight { total, next -> total + next } // 21\n```\n\n**sum**\n\n返回所有元素的和\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.sum() // 21\n```\n\n**sumBy**\n\n返回所有元素通过给定的函数转换之后的数据总和\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.sumBy { it % 2 } // 3\nlist.sumBy { it + 1 } // 27\n```\n\n### 过滤操作符\n\n**drop**\n\n返回包括去掉前`n`个元素的所有元素的列表\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.drop(4) // listOf(5, 6)\n```\n\n**dropWhile**\n\n这个函数有点难理解，我们需要结合一下源码来看：\n\n```kotlin\npublic inline fun <T> Iterable<T>.dropWhile(predicate: (T) -> Boolean): List<T> {\n    var yielding = false\n    val list = ArrayList<T>()\n    for (item in this)\n        if (yielding)\n            list.add(item)\n        else if (!predicate(item)) {\n            list.add(item)\n            yielding = true\n        }\n    return list\n}\n```\n调用`dropWhile`时，先遍历集合，如果集合中的元素不符合`predicate`函数的规则，则从当前元素开始，所有元素依次添加到新集合`list`并返回，如果集合中的元素都符合规则，则一个都不添加。我们以下面的例子来分析：\n\n```kotlin\nval list1 = listOf(1, 2, 3, 4, 5, 6)\nlist1.dropWhile { it < 3 } // listOf(3, 4, 5, 6)\n```\n\n在上面的例子中，我们定义的函数规则是当前元素要小于3`{it < 3}`，当集合遍历到`3`时，因为3是不小于3的，不符合函数的规则，所以从`3`开始，往后的元素都被添加到了新集合中。\n\n再来看一个例子，我们把集合中的`6`放到最前面\n\n```kotlin\nval list2 = listOf(6, 1, 2, 3, 4, 5)\nlist2.dropWhile { it < 3} // listOf(6, 1, 2, 3, 4, 5)\n```\n\n遍历集合时，因为第一个元素是`6`，不符合`{it < 3}`，所要`6`及之后的元素都被添加到了新集合中\n\n**dropLastWhile**\n\n返回根据给定函数从最后一项开始去掉指定元素的列表\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.dropLastWhile { it > 4 } // listOf(1, 2, 3, 4)\n```\n\n**filter**\n\n返回符合给定条件的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.filter { it % 2 == 0 } // listOf(2, 4, 6)\nlist.filter { it < 3 } // listOf(1, 2)\n```\n\n**filterNot**\n\n返回所有不符合给定函数条件的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.filterNot { it % 2 == 0} // listOf(1, 3, 5)\n```\n\n**filterNotNull**\n\n返回集合中非`null`的函数\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, null)\nprintln(list.filterNotNull()) // listOf[1, 2, 3, 4, 5]\n```\n\n**slice**\n\n返回指定区域的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.slice(0..3) // listOf(1, 2, 3, 4)\nlist.slice(listOf(1, 3, 4)) // listOf(2, 4, 5)\n```\n\n> `(0..3)`：表示取出第0个到第3个之间的元素\n>\n> `listOf(1, 3, 4)`：表示取出下标为1、3、4的元素\n\n**take**\n\n返回从第一个开始的n个元素(返回前n个元素)\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.take(2) // listOf[1, 2]\n```\n\n**takeLast**\n\n返回从最后一个开始的n个元素(返回后n个元素)\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.take(2) // listOf[5, 6]\n```\n\n**takeWhile**\n\n返回从第一个开始符合给定函数条件的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.takeWhile { it < 3 } // listOf[1, 2]\n```\n\n### 映射操作符\n\n**flatMap**\n\n遍历所有的元素，为每个元素创建一个集合，最后把所有的集合放在一个集合中。\n\n什么意思呢，就是你可以把每一个元素转化成一个新的`list`，最后这些`list`会合并成一个大的`list`。我们通过代码来分析：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.flatMap { listOf('a' + it) } // listOf(b, c, d, e, f, g)\n```\n\n上面的例子中，我们通过函数`listOf('a'+ it)`把每一个元素都转换成了新的list。因为我们有6个元素，所以会生成6个list`(listOf(b)、listOf(c)、listOf(d)、listOf(e)、listOf(f)和listOf(g))`，最后会遍历这6个`list`，把这6个`list`中的每一项添加到一个新的`list`中。当然你也可以为`listOf('a' + it)`添加多个元素，看下面的例子：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.flatMap { listOf(it, 'a' + it) } // listOf(1, b, 2, c, 3, d, 4, e, 5, f, 6, g)\n```\n\n**groupBy**\n\n返回一个根据给定函数分组后的map，把函数的返回值作为`key`，符合条件的所有元素作为`value`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\n// 返回为 mapOf(\"odd\" to listOf(1, 3, 5), \"even\" to listOf(2, 4, 6)}\nlist.groupBy { if (it % 2 ==0) \"even\" else \"odd\" } \n```\n\n**map**\n\n返回一个每一个元素根据给定的函数转换所组成的List(把元素列表中的每一项进行相应计算或转成其它你想要的任何格式)。\n\n把元素中的每一项乘2：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.map { it * 2 } // listOf(2, 4, 6, 8, 10, 12)\n```\n\n把元素中的每一项转成字母：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.map { 'a' + it } // listOf(b, c, d, e, f, g)\n```\n\n**mapIndexed**\n\n和`map`一样，但是我们可以同时得到元素的`index`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.mapIndexed { index, it -> index + it } // listOf(1, 3, 5, 7, 9, 11)\n```\n\n**mapNotNull**\n\n和`map`一样，但是会过滤掉为`null`的元素\n\n```kotlin\nclass Person(val name: String? = null)\nval list = listOf(Person(), Person(\"Alice\"))\n// map\nlist.map { it.name } // listOf(null, \"Alice\")\n// mapNotNull\nlist.mapNotNull { it.name } // listOf(\"Alice\")\n```\n\n### 元素操作符\n\n**contains**\n\n如果的元素可以在集合中找到，则返回true\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.contains(2) // true\n```\n\n**elementAt**\n\n返回给定index对应的元素，如果index数组越界则会抛出`IndexOutOfBoundsException`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.elementAt(1) // 2\n```\n\n**elementAtOrElse**\n\n返回给定index对应的元素，如果index数组越界则会返回给定函数的返回值，函数中的参数为给定的index。如下图所示：`it`为传入的10\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.elementAtOrElse(10, { 2 * it }) // 20\n```\n\n**elementAtOrNull**\n\n返回给定index对应的元素，如果index数组越界则会返回null\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.elementAtOrNull(10) // null\n```\n\n**first**\n\n返回符合给定函数条件的第一个元素，如果没有符合抛出`java.util.NoSuchElementException`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.first() // 1\nlist.first { it % 2 == 0 } // 2\n```\n\n**firstOrNull**\n\n返回符合给定函数条件的第一个元素，如果没有符合则返回null\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.firstOrNull() // 1\nlist.firstOrNull { it % 7 == 0 }) // null\n```\n\n**indexOf**\n\n返回指定元素的第一个index，如果不存在，则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.indexOf(4) // 3\n```\n\n**indexOfFirst**\n\n返回第一个符合给定函数条件的元素的index，如果没有符合则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.indexOfFirst { it % 2 == 0 } // 1\n```\n\n**indexOfLast**\n\n返回最后一个符合给定函数条件的元素的index，如果没有符合则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.indexOfLast { it % 2 == 0 } // 5\n```\n\n**last**\n\n返回符合给定函数条件的最后一个元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.last { it % 2 == 0 } // 6\n```\n\n**lastIndexOf**\n\n返回的指定元素的最后一个index，如果不存在，则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.lastIndexOf(2) // 1\nlist.lastIndexOf(7) // -1\n```\n\n**single/singleOrNull**\n\n返回符合给定函数的单个元素，如果没有符合或者超过一个，`single`抛出异常，`singleOrNull`返回`null`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.single { it % 5 == 0 } // 5\nlist.single { it % 2 == 0 } // java.lang.IllegalArgumentException\nlist.singleOrNull { it % 2 == 0 } // null\n```\n\n### 生产操作符\n\n**partition**\n\n把一个集合通过给定的函数分为两个集合，符合条件的作为一个，不符合的作为另一个\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.partition { it % 2 == 0 } // Pair(listOf(2, 4, 6), listOf(1, 3, 5))\n```\n\n**plus**\n\n使用`+`号操作符把两个集合合并到一个集合中\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist + listOf(7, 8 ) // listOf(1, 2, 3, 4, 5, 6, 7, 8)\n```\n\n**zip(返回值 List<Pair<T, R>>)**\n\n返回由`Pair`组成的List，每个`Pair`由两个集合中相同index的元素组成。这个返回的List的大小是由最小的那个集合决定\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.zip(listOf(7, 8)) // listOf(Pair(1, 7), Pair(2, 8))\n```\n\n**unzip**\n\n从包含`Pair`的List中生成包含List的`Pair` 。有点拗口，看代码\n\n```kotlin\nval list = listOf(Pair(5, 7), Pair(6, 8))\nlist.unzip() // Pair(listOf(5, 6), listOf(7, 8))\n```\n\n看上面的代码，还是有点难理解，我们需要结合源码来看\n\n```kotlin\npublic fun <T, R> Iterable<Pair<T, R>>.unzip(): Pair<List<T>, List<R>> {\n    val expectedSize = collectionSizeOrDefault(10)\n    val listT = ArrayList<T>(expectedSize)\n    val listR = ArrayList<R>(expectedSize)\n    for (pair in this) {\n        listT.add(pair.first)\n        listR.add(pair.second)\n    }\n    return listT to listR\n}\n```\n\n`unzip`方法中，会定义两个集合，一个集合会添加`list`元素`Pair(5,7), Pair(6,8)`的`first`，出就是`5、6`，另一个集合会添加`second`，也就是`7、8`\n\n### 顺序操作符\n\n**reversed**\n\n返回一个倒序的list\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.reversed() // listOf(6, 5, 4, 3, 2, 1)\n```\n\n**sorted**\n\n把list进行生序排列\n\n```kotlin\nval list = listOf(1, 3, 2, 5, 4, 6)\nlist.sorted() // listOf(1, 2, 3, 4, 5, 6)\n```\n\n**sortedBy**\n\n把不符合条件的元素按照在集合中之前的顺序放在集合的最前面，把符合条件的元素依次放在后面\n\n```kotlin\nval list = listOf(7, 6, 3, 2, 5, 4, 1)\nlist.sortedBy { it > 2 } // listOf(2, 1, 7, 6, 3, 5, 4)\n```\n\n看代码，因为`2,1`不符合条件，所以把`2,1`按之前的顺序放到最前面，`7,6,3,5,4`仿照之前的顺序依次放到后面\n\n**sortedDescending**\n\n把list进行降序排列\n\n```kotlin\nval list = listOf(7, 4, 3, 1, 5, 6, 2)\nlist.sortedDescending() // listOf(7, 6, 5, 4, 3, 2, 1)\n```\n\n**sortedByDescending**\n\n和`sortedBy`类似，只不过是把符合条件的放在集合的前面，不符合的放在集合的后面\n\n```kotlin\nval list = listOf(7, 4, 3, 1, 5, 6, 2)\nlist.sortedByDescending { it > 3 } // listOf(7, 4, 5, 6, 3, 1, 2)\n```\n\n> 参考: 《kotlin-for-android-developers》《kotlin in action》\n\n","source":"_posts/android/kotlin-collections.md","raw":"---\ntitle: Kotlin详解集合与操作符\ndate: 2018-03-14 10:06:08\ntags: [android, kotlin]\n---\n\n[TOC]\n\n### 前言\n\nkotlin的集合分为不可变集合和可变集合\n\nKotlin 的 `List<out T>` 只提供只读操作如 `size`、`get`等的接口。和 Java 类似，它继承自 `Collection<T>` 进而继承自 `Iterable<T>`。改变 list 的方法是由 `MutableList<T>` 加入的。这一模式同样适用于 `Set<out T>/MutableSet<T>` 及 `Map<K, out V>/MutableMap<K, V>`。详见下表\n\n| 不可变     | 可变              |\n| :--------- | ----------------- |\n| Iterable   | MutableIterable   |\n| Collection | MutableCollection |\n| List       | MutableList       |\n| Set        | MutableSet        |\n| Map        | MutableMap        |\n\n`List`和`Set`的基本用法\n\n```kotlin\nval numbers: MutableList<Int> = mutableListOf(1, 2, 3)\nval readOnlyView: List<Int> = numbers\nprintln(numbers)        // 输出 \"[1, 2, 3]\"\nnumbers.add(4)\nprintln(readOnlyView)   // 输出 \"[1, 2, 3, 4]\"\nreadOnlyView.clear()    // -> 不能编译\n\nval strings = hashSetOf(\"a\", \"b\", \"c\", \"c\")\nassert(strings.size == 3)\n```\n\n### 总数操作符\n\n**any**\n\n只要有一个元素符合判断条件，则返回`true`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.any { it % 2 == 0} // true\nlist.any { it > 10 } // false\n```\n\n**all**\n\n只有全部的元素符合判断条件，则返回`true`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.all { it < 10 } // true\nlist.all { it % 2 == 0} // false\n```\n\n**count**\n\n返回符合判断条件的元素总数\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.count { it % 2 == 0 } // 3\n```\n\n**fold**\n\n给定一个初始值，在初始值的基础上，通过给定的函数来累计所有元素。\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.fold(4) { total, next -> total + next } // 4+1+2+3+4+5+6 = 25\nlist.fold(4) { total, next -> total * next } // 4*1*2*3*4*5*6 = 2880\n```\n\n**foldRight**\n\n与`fold`一样，只是顺序是从最后一项到第一项\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.foldRight(4) { total, next -> total + next } // 25\n```\n\n**forEach**\n\n遍历的所有的元素，并执行给定的操作\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.forEach { println(it) }\n```\n\n**forEachIndexed**\n\n与`forEach`类似，但是我们同时可以得到元素的`index`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.forEachIndexed { (index, value) -> println(\"position $index contains a $value\") }\n```\n\n**max/min**\n\n返回最大/最小的一项，如果没有则返回`null`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.max() // 6\nlist.min() // 1\n```\n\n**maxBy/minBy**\n\n根据给定的函数返回最大/最小的一项，如果没有则返回`null`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.maxBy { -it } // 1\nlist.minBy { -it } // 6\n```\n\n**none**\n\n如果没有任何元素与给定的函数匹配，则返回`true`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.none { it % 7 == 0 } // true\n```\n\n**reduce**\n\n和`fold`一样，但是没有一个初始值。通过给定的函数来累计所有元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.reduce { total, next -> total + next } // 21\n```\n\n**reduceRight**\n\n和`reduce`一样，但是顺序是从最后一项到第一项\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.reduceRight { total, next -> total + next } // 21\n```\n\n**sum**\n\n返回所有元素的和\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.sum() // 21\n```\n\n**sumBy**\n\n返回所有元素通过给定的函数转换之后的数据总和\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.sumBy { it % 2 } // 3\nlist.sumBy { it + 1 } // 27\n```\n\n### 过滤操作符\n\n**drop**\n\n返回包括去掉前`n`个元素的所有元素的列表\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.drop(4) // listOf(5, 6)\n```\n\n**dropWhile**\n\n这个函数有点难理解，我们需要结合一下源码来看：\n\n```kotlin\npublic inline fun <T> Iterable<T>.dropWhile(predicate: (T) -> Boolean): List<T> {\n    var yielding = false\n    val list = ArrayList<T>()\n    for (item in this)\n        if (yielding)\n            list.add(item)\n        else if (!predicate(item)) {\n            list.add(item)\n            yielding = true\n        }\n    return list\n}\n```\n调用`dropWhile`时，先遍历集合，如果集合中的元素不符合`predicate`函数的规则，则从当前元素开始，所有元素依次添加到新集合`list`并返回，如果集合中的元素都符合规则，则一个都不添加。我们以下面的例子来分析：\n\n```kotlin\nval list1 = listOf(1, 2, 3, 4, 5, 6)\nlist1.dropWhile { it < 3 } // listOf(3, 4, 5, 6)\n```\n\n在上面的例子中，我们定义的函数规则是当前元素要小于3`{it < 3}`，当集合遍历到`3`时，因为3是不小于3的，不符合函数的规则，所以从`3`开始，往后的元素都被添加到了新集合中。\n\n再来看一个例子，我们把集合中的`6`放到最前面\n\n```kotlin\nval list2 = listOf(6, 1, 2, 3, 4, 5)\nlist2.dropWhile { it < 3} // listOf(6, 1, 2, 3, 4, 5)\n```\n\n遍历集合时，因为第一个元素是`6`，不符合`{it < 3}`，所要`6`及之后的元素都被添加到了新集合中\n\n**dropLastWhile**\n\n返回根据给定函数从最后一项开始去掉指定元素的列表\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.dropLastWhile { it > 4 } // listOf(1, 2, 3, 4)\n```\n\n**filter**\n\n返回符合给定条件的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.filter { it % 2 == 0 } // listOf(2, 4, 6)\nlist.filter { it < 3 } // listOf(1, 2)\n```\n\n**filterNot**\n\n返回所有不符合给定函数条件的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.filterNot { it % 2 == 0} // listOf(1, 3, 5)\n```\n\n**filterNotNull**\n\n返回集合中非`null`的函数\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, null)\nprintln(list.filterNotNull()) // listOf[1, 2, 3, 4, 5]\n```\n\n**slice**\n\n返回指定区域的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.slice(0..3) // listOf(1, 2, 3, 4)\nlist.slice(listOf(1, 3, 4)) // listOf(2, 4, 5)\n```\n\n> `(0..3)`：表示取出第0个到第3个之间的元素\n>\n> `listOf(1, 3, 4)`：表示取出下标为1、3、4的元素\n\n**take**\n\n返回从第一个开始的n个元素(返回前n个元素)\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.take(2) // listOf[1, 2]\n```\n\n**takeLast**\n\n返回从最后一个开始的n个元素(返回后n个元素)\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.take(2) // listOf[5, 6]\n```\n\n**takeWhile**\n\n返回从第一个开始符合给定函数条件的元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.takeWhile { it < 3 } // listOf[1, 2]\n```\n\n### 映射操作符\n\n**flatMap**\n\n遍历所有的元素，为每个元素创建一个集合，最后把所有的集合放在一个集合中。\n\n什么意思呢，就是你可以把每一个元素转化成一个新的`list`，最后这些`list`会合并成一个大的`list`。我们通过代码来分析：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.flatMap { listOf('a' + it) } // listOf(b, c, d, e, f, g)\n```\n\n上面的例子中，我们通过函数`listOf('a'+ it)`把每一个元素都转换成了新的list。因为我们有6个元素，所以会生成6个list`(listOf(b)、listOf(c)、listOf(d)、listOf(e)、listOf(f)和listOf(g))`，最后会遍历这6个`list`，把这6个`list`中的每一项添加到一个新的`list`中。当然你也可以为`listOf('a' + it)`添加多个元素，看下面的例子：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.flatMap { listOf(it, 'a' + it) } // listOf(1, b, 2, c, 3, d, 4, e, 5, f, 6, g)\n```\n\n**groupBy**\n\n返回一个根据给定函数分组后的map，把函数的返回值作为`key`，符合条件的所有元素作为`value`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\n// 返回为 mapOf(\"odd\" to listOf(1, 3, 5), \"even\" to listOf(2, 4, 6)}\nlist.groupBy { if (it % 2 ==0) \"even\" else \"odd\" } \n```\n\n**map**\n\n返回一个每一个元素根据给定的函数转换所组成的List(把元素列表中的每一项进行相应计算或转成其它你想要的任何格式)。\n\n把元素中的每一项乘2：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.map { it * 2 } // listOf(2, 4, 6, 8, 10, 12)\n```\n\n把元素中的每一项转成字母：\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.map { 'a' + it } // listOf(b, c, d, e, f, g)\n```\n\n**mapIndexed**\n\n和`map`一样，但是我们可以同时得到元素的`index`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.mapIndexed { index, it -> index + it } // listOf(1, 3, 5, 7, 9, 11)\n```\n\n**mapNotNull**\n\n和`map`一样，但是会过滤掉为`null`的元素\n\n```kotlin\nclass Person(val name: String? = null)\nval list = listOf(Person(), Person(\"Alice\"))\n// map\nlist.map { it.name } // listOf(null, \"Alice\")\n// mapNotNull\nlist.mapNotNull { it.name } // listOf(\"Alice\")\n```\n\n### 元素操作符\n\n**contains**\n\n如果的元素可以在集合中找到，则返回true\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.contains(2) // true\n```\n\n**elementAt**\n\n返回给定index对应的元素，如果index数组越界则会抛出`IndexOutOfBoundsException`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.elementAt(1) // 2\n```\n\n**elementAtOrElse**\n\n返回给定index对应的元素，如果index数组越界则会返回给定函数的返回值，函数中的参数为给定的index。如下图所示：`it`为传入的10\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.elementAtOrElse(10, { 2 * it }) // 20\n```\n\n**elementAtOrNull**\n\n返回给定index对应的元素，如果index数组越界则会返回null\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.elementAtOrNull(10) // null\n```\n\n**first**\n\n返回符合给定函数条件的第一个元素，如果没有符合抛出`java.util.NoSuchElementException`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.first() // 1\nlist.first { it % 2 == 0 } // 2\n```\n\n**firstOrNull**\n\n返回符合给定函数条件的第一个元素，如果没有符合则返回null\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.firstOrNull() // 1\nlist.firstOrNull { it % 7 == 0 }) // null\n```\n\n**indexOf**\n\n返回指定元素的第一个index，如果不存在，则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.indexOf(4) // 3\n```\n\n**indexOfFirst**\n\n返回第一个符合给定函数条件的元素的index，如果没有符合则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.indexOfFirst { it % 2 == 0 } // 1\n```\n\n**indexOfLast**\n\n返回最后一个符合给定函数条件的元素的index，如果没有符合则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.indexOfLast { it % 2 == 0 } // 5\n```\n\n**last**\n\n返回符合给定函数条件的最后一个元素\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.last { it % 2 == 0 } // 6\n```\n\n**lastIndexOf**\n\n返回的指定元素的最后一个index，如果不存在，则返回`-1`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.lastIndexOf(2) // 1\nlist.lastIndexOf(7) // -1\n```\n\n**single/singleOrNull**\n\n返回符合给定函数的单个元素，如果没有符合或者超过一个，`single`抛出异常，`singleOrNull`返回`null`\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.single { it % 5 == 0 } // 5\nlist.single { it % 2 == 0 } // java.lang.IllegalArgumentException\nlist.singleOrNull { it % 2 == 0 } // null\n```\n\n### 生产操作符\n\n**partition**\n\n把一个集合通过给定的函数分为两个集合，符合条件的作为一个，不符合的作为另一个\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.partition { it % 2 == 0 } // Pair(listOf(2, 4, 6), listOf(1, 3, 5))\n```\n\n**plus**\n\n使用`+`号操作符把两个集合合并到一个集合中\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist + listOf(7, 8 ) // listOf(1, 2, 3, 4, 5, 6, 7, 8)\n```\n\n**zip(返回值 List<Pair<T, R>>)**\n\n返回由`Pair`组成的List，每个`Pair`由两个集合中相同index的元素组成。这个返回的List的大小是由最小的那个集合决定\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.zip(listOf(7, 8)) // listOf(Pair(1, 7), Pair(2, 8))\n```\n\n**unzip**\n\n从包含`Pair`的List中生成包含List的`Pair` 。有点拗口，看代码\n\n```kotlin\nval list = listOf(Pair(5, 7), Pair(6, 8))\nlist.unzip() // Pair(listOf(5, 6), listOf(7, 8))\n```\n\n看上面的代码，还是有点难理解，我们需要结合源码来看\n\n```kotlin\npublic fun <T, R> Iterable<Pair<T, R>>.unzip(): Pair<List<T>, List<R>> {\n    val expectedSize = collectionSizeOrDefault(10)\n    val listT = ArrayList<T>(expectedSize)\n    val listR = ArrayList<R>(expectedSize)\n    for (pair in this) {\n        listT.add(pair.first)\n        listR.add(pair.second)\n    }\n    return listT to listR\n}\n```\n\n`unzip`方法中，会定义两个集合，一个集合会添加`list`元素`Pair(5,7), Pair(6,8)`的`first`，出就是`5、6`，另一个集合会添加`second`，也就是`7、8`\n\n### 顺序操作符\n\n**reversed**\n\n返回一个倒序的list\n\n```kotlin\nval list = listOf(1, 2, 3, 4, 5, 6)\nlist.reversed() // listOf(6, 5, 4, 3, 2, 1)\n```\n\n**sorted**\n\n把list进行生序排列\n\n```kotlin\nval list = listOf(1, 3, 2, 5, 4, 6)\nlist.sorted() // listOf(1, 2, 3, 4, 5, 6)\n```\n\n**sortedBy**\n\n把不符合条件的元素按照在集合中之前的顺序放在集合的最前面，把符合条件的元素依次放在后面\n\n```kotlin\nval list = listOf(7, 6, 3, 2, 5, 4, 1)\nlist.sortedBy { it > 2 } // listOf(2, 1, 7, 6, 3, 5, 4)\n```\n\n看代码，因为`2,1`不符合条件，所以把`2,1`按之前的顺序放到最前面，`7,6,3,5,4`仿照之前的顺序依次放到后面\n\n**sortedDescending**\n\n把list进行降序排列\n\n```kotlin\nval list = listOf(7, 4, 3, 1, 5, 6, 2)\nlist.sortedDescending() // listOf(7, 6, 5, 4, 3, 2, 1)\n```\n\n**sortedByDescending**\n\n和`sortedBy`类似，只不过是把符合条件的放在集合的前面，不符合的放在集合的后面\n\n```kotlin\nval list = listOf(7, 4, 3, 1, 5, 6, 2)\nlist.sortedByDescending { it > 3 } // listOf(7, 4, 5, 6, 3, 1, 2)\n```\n\n> 参考: 《kotlin-for-android-developers》《kotlin in action》\n\n","slug":"android/kotlin-collections","published":1,"updated":"2018-05-20T13:04:25.682Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61eq001fizcbwn4ib49p","content":"<p>[TOC]</p>\n<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>kotlin的集合分为不可变集合和可变集合</p>\n<p>Kotlin 的 <code>List&lt;out T&gt;</code> 只提供只读操作如 <code>size</code>、<code>get</code>等的接口。和 Java 类似，它继承自 <code>Collection&lt;T&gt;</code> 进而继承自 <code>Iterable&lt;T&gt;</code>。改变 list 的方法是由 <code>MutableList&lt;T&gt;</code> 加入的。这一模式同样适用于 <code>Set&lt;out T&gt;/MutableSet&lt;T&gt;</code> 及 <code>Map&lt;K, out V&gt;/MutableMap&lt;K, V&gt;</code>。详见下表</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">不可变</th>\n<th>可变</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Iterable</td>\n<td>MutableIterable</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Collection</td>\n<td>MutableCollection</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">List</td>\n<td>MutableList</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Set</td>\n<td>MutableSet</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Map</td>\n<td>MutableMap</td>\n</tr>\n</tbody>\n</table>\n<p><code>List</code>和<code>Set</code>的基本用法</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> numbers: MutableList&lt;<span class=\"built_in\">Int</span>&gt; = mutableListOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> readOnlyView: List&lt;<span class=\"built_in\">Int</span>&gt; = numbers</span><br><span class=\"line\">println(numbers)        <span class=\"comment\">// 输出 \"[1, 2, 3]\"</span></span><br><span class=\"line\">numbers.add(<span class=\"number\">4</span>)</span><br><span class=\"line\">println(readOnlyView)   <span class=\"comment\">// 输出 \"[1, 2, 3, 4]\"</span></span><br><span class=\"line\">readOnlyView.clear()    <span class=\"comment\">// -&gt; 不能编译</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> strings = hashSetOf(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>, <span class=\"string\">\"c\"</span>)</span><br><span class=\"line\">assert(strings.size == <span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"总数操作符\"><a href=\"#总数操作符\" class=\"headerlink\" title=\"总数操作符\"></a>总数操作符</h3><p><strong>any</strong></p>\n<p>只要有一个元素符合判断条件，则返回<code>true</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.any &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span>&#125; <span class=\"comment\">// true</span></span><br><span class=\"line\">list.any &#123; it &gt; <span class=\"number\">10</span> &#125; <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<p><strong>all</strong></p>\n<p>只有全部的元素符合判断条件，则返回<code>true</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.all &#123; it &lt; <span class=\"number\">10</span> &#125; <span class=\"comment\">// true</span></span><br><span class=\"line\">list.all &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span>&#125; <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<p><strong>count</strong></p>\n<p>返回符合判断条件的元素总数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.count &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<p><strong>fold</strong></p>\n<p>给定一个初始值，在初始值的基础上，通过给定的函数来累计所有元素。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.fold(<span class=\"number\">4</span>) &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 4+1+2+3+4+5+6 = 25</span></span><br><span class=\"line\">list.fold(<span class=\"number\">4</span>) &#123; total, next -&gt; total * next &#125; <span class=\"comment\">// 4*1*2*3*4*5*6 = 2880</span></span><br></pre></td></tr></table></figure>\n<p><strong>foldRight</strong></p>\n<p>与<code>fold</code>一样，只是顺序是从最后一项到第一项</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.foldRight(<span class=\"number\">4</span>) &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 25</span></span><br></pre></td></tr></table></figure>\n<p><strong>forEach</strong></p>\n<p>遍历的所有的元素，并执行给定的操作</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.forEach &#123; println(it) &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>forEachIndexed</strong></p>\n<p>与<code>forEach</code>类似，但是我们同时可以得到元素的<code>index</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.forEachIndexed &#123; (index, value) -&gt; println(<span class=\"string\">\"position <span class=\"variable\">$index</span> contains a <span class=\"variable\">$value</span>\"</span>) &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>max/min</strong></p>\n<p>返回最大/最小的一项，如果没有则返回<code>null</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.max() <span class=\"comment\">// 6</span></span><br><span class=\"line\">list.min() <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n<p><strong>maxBy/minBy</strong></p>\n<p>根据给定的函数返回最大/最小的一项，如果没有则返回<code>null</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.maxBy &#123; -it &#125; <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.minBy &#123; -it &#125; <span class=\"comment\">// 6</span></span><br></pre></td></tr></table></figure>\n<p><strong>none</strong></p>\n<p>如果没有任何元素与给定的函数匹配，则返回<code>true</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.none &#123; it % <span class=\"number\">7</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<p><strong>reduce</strong></p>\n<p>和<code>fold</code>一样，但是没有一个初始值。通过给定的函数来累计所有元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.reduce &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 21</span></span><br></pre></td></tr></table></figure>\n<p><strong>reduceRight</strong></p>\n<p>和<code>reduce</code>一样，但是顺序是从最后一项到第一项</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.reduceRight &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 21</span></span><br></pre></td></tr></table></figure>\n<p><strong>sum</strong></p>\n<p>返回所有元素的和</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.sum() <span class=\"comment\">// 21</span></span><br></pre></td></tr></table></figure>\n<p><strong>sumBy</strong></p>\n<p>返回所有元素通过给定的函数转换之后的数据总和</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.sumBy &#123; it % <span class=\"number\">2</span> &#125; <span class=\"comment\">// 3</span></span><br><span class=\"line\">list.sumBy &#123; it + <span class=\"number\">1</span> &#125; <span class=\"comment\">// 27</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"过滤操作符\"><a href=\"#过滤操作符\" class=\"headerlink\" title=\"过滤操作符\"></a>过滤操作符</h3><p><strong>drop</strong></p>\n<p>返回包括去掉前<code>n</code>个元素的所有元素的列表</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.drop(<span class=\"number\">4</span>) <span class=\"comment\">// listOf(5, 6)</span></span><br></pre></td></tr></table></figure>\n<p><strong>dropWhile</strong></p>\n<p>这个函数有点难理解，我们需要结合一下源码来看：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">inline</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T&gt;</span> Iterable<span class=\"type\">&lt;T&gt;</span>.<span class=\"title\">dropWhile</span><span class=\"params\">(predicate: (<span class=\"type\">T</span>)</span></span> -&gt; <span class=\"built_in\">Boolean</span>): List&lt;T&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> yielding = <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"keyword\">val</span> list = ArrayList&lt;T&gt;()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (item <span class=\"keyword\">in</span> <span class=\"keyword\">this</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (yielding)</span><br><span class=\"line\">            list.add(item)</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!predicate(item)) &#123;</span><br><span class=\"line\">            list.add(item)</span><br><span class=\"line\">            yielding = <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>调用<code>dropWhile</code>时，先遍历集合，如果集合中的元素不符合<code>predicate</code>函数的规则，则从当前元素开始，所有元素依次添加到新集合<code>list</code>并返回，如果集合中的元素都符合规则，则一个都不添加。我们以下面的例子来分析：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list1 = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list1.dropWhile &#123; it &lt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf(3, 4, 5, 6)</span></span><br></pre></td></tr></table></figure>\n<p>在上面的例子中，我们定义的函数规则是当前元素要小于3<code>{it &lt; 3}</code>，当集合遍历到<code>3</code>时，因为3是不小于3的，不符合函数的规则，所以从<code>3</code>开始，往后的元素都被添加到了新集合中。</p>\n<p>再来看一个例子，我们把集合中的<code>6</code>放到最前面</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list2 = listOf(<span class=\"number\">6</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">list2.dropWhile &#123; it &lt; <span class=\"number\">3</span>&#125; <span class=\"comment\">// listOf(6, 1, 2, 3, 4, 5)</span></span><br></pre></td></tr></table></figure>\n<p>遍历集合时，因为第一个元素是<code>6</code>，不符合<code>{it &lt; 3}</code>，所要<code>6</code>及之后的元素都被添加到了新集合中</p>\n<p><strong>dropLastWhile</strong></p>\n<p>返回根据给定函数从最后一项开始去掉指定元素的列表</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.dropLastWhile &#123; it &gt; <span class=\"number\">4</span> &#125; <span class=\"comment\">// listOf(1, 2, 3, 4)</span></span><br></pre></td></tr></table></figure>\n<p><strong>filter</strong></p>\n<p>返回符合给定条件的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.filter &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// listOf(2, 4, 6)</span></span><br><span class=\"line\">list.filter &#123; it &lt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf(1, 2)</span></span><br></pre></td></tr></table></figure>\n<p><strong>filterNot</strong></p>\n<p>返回所有不符合给定函数条件的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.filterNot &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span>&#125; <span class=\"comment\">// listOf(1, 3, 5)</span></span><br></pre></td></tr></table></figure>\n<p><strong>filterNotNull</strong></p>\n<p>返回集合中非<code>null</code>的函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"literal\">null</span>)</span><br><span class=\"line\">println(list.filterNotNull()) <span class=\"comment\">// listOf[1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>\n<p><strong>slice</strong></p>\n<p>返回指定区域的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.slice(<span class=\"number\">0.</span><span class=\"number\">.3</span>) <span class=\"comment\">// listOf(1, 2, 3, 4)</span></span><br><span class=\"line\">list.slice(listOf(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>)) <span class=\"comment\">// listOf(2, 4, 5)</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>(0..3)</code>：表示取出第0个到第3个之间的元素</p>\n<p><code>listOf(1, 3, 4)</code>：表示取出下标为1、3、4的元素</p>\n</blockquote>\n<p><strong>take</strong></p>\n<p>返回从第一个开始的n个元素(返回前n个元素)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.take(<span class=\"number\">2</span>) <span class=\"comment\">// listOf[1, 2]</span></span><br></pre></td></tr></table></figure>\n<p><strong>takeLast</strong></p>\n<p>返回从最后一个开始的n个元素(返回后n个元素)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.take(<span class=\"number\">2</span>) <span class=\"comment\">// listOf[5, 6]</span></span><br></pre></td></tr></table></figure>\n<p><strong>takeWhile</strong></p>\n<p>返回从第一个开始符合给定函数条件的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.takeWhile &#123; it &lt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf[1, 2]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"映射操作符\"><a href=\"#映射操作符\" class=\"headerlink\" title=\"映射操作符\"></a>映射操作符</h3><p><strong>flatMap</strong></p>\n<p>遍历所有的元素，为每个元素创建一个集合，最后把所有的集合放在一个集合中。</p>\n<p>什么意思呢，就是你可以把每一个元素转化成一个新的<code>list</code>，最后这些<code>list</code>会合并成一个大的<code>list</code>。我们通过代码来分析：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.flatMap &#123; listOf(<span class=\"string\">'a'</span> + it) &#125; <span class=\"comment\">// listOf(b, c, d, e, f, g)</span></span><br></pre></td></tr></table></figure>\n<p>上面的例子中，我们通过函数<code>listOf(&#39;a&#39;+ it)</code>把每一个元素都转换成了新的list。因为我们有6个元素，所以会生成6个list<code>(listOf(b)、listOf(c)、listOf(d)、listOf(e)、listOf(f)和listOf(g))</code>，最后会遍历这6个<code>list</code>，把这6个<code>list</code>中的每一项添加到一个新的<code>list</code>中。当然你也可以为<code>listOf(&#39;a&#39; + it)</code>添加多个元素，看下面的例子：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.flatMap &#123; listOf(it, <span class=\"string\">'a'</span> + it) &#125; <span class=\"comment\">// listOf(1, b, 2, c, 3, d, 4, e, 5, f, 6, g)</span></span><br></pre></td></tr></table></figure>\n<p><strong>groupBy</strong></p>\n<p>返回一个根据给定函数分组后的map，把函数的返回值作为<code>key</code>，符合条件的所有元素作为<code>value</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\"><span class=\"comment\">// 返回为 mapOf(\"odd\" to listOf(1, 3, 5), \"even\" to listOf(2, 4, 6)&#125;</span></span><br><span class=\"line\">list.groupBy &#123; <span class=\"keyword\">if</span> (it % <span class=\"number\">2</span> ==<span class=\"number\">0</span>) <span class=\"string\">\"even\"</span> <span class=\"keyword\">else</span> <span class=\"string\">\"odd\"</span> &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>map</strong></p>\n<p>返回一个每一个元素根据给定的函数转换所组成的List(把元素列表中的每一项进行相应计算或转成其它你想要的任何格式)。</p>\n<p>把元素中的每一项乘2：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.map &#123; it * <span class=\"number\">2</span> &#125; <span class=\"comment\">// listOf(2, 4, 6, 8, 10, 12)</span></span><br></pre></td></tr></table></figure>\n<p>把元素中的每一项转成字母：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.map &#123; <span class=\"string\">'a'</span> + it &#125; <span class=\"comment\">// listOf(b, c, d, e, f, g)</span></span><br></pre></td></tr></table></figure>\n<p><strong>mapIndexed</strong></p>\n<p>和<code>map</code>一样，但是我们可以同时得到元素的<code>index</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.mapIndexed &#123; index, it -&gt; index + it &#125; <span class=\"comment\">// listOf(1, 3, 5, 7, 9, 11)</span></span><br></pre></td></tr></table></figure>\n<p><strong>mapNotNull</strong></p>\n<p>和<code>map</code>一样，但是会过滤掉为<code>null</code>的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String? = <span class=\"literal\">null</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(Person(), Person(<span class=\"string\">\"Alice\"</span>))</span><br><span class=\"line\"><span class=\"comment\">// map</span></span><br><span class=\"line\">list.map &#123; it.name &#125; <span class=\"comment\">// listOf(null, \"Alice\")</span></span><br><span class=\"line\"><span class=\"comment\">// mapNotNull</span></span><br><span class=\"line\">list.mapNotNull &#123; it.name &#125; <span class=\"comment\">// listOf(\"Alice\")</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"元素操作符\"><a href=\"#元素操作符\" class=\"headerlink\" title=\"元素操作符\"></a>元素操作符</h3><p><strong>contains</strong></p>\n<p>如果的元素可以在集合中找到，则返回true</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.contains(<span class=\"number\">2</span>) <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<p><strong>elementAt</strong></p>\n<p>返回给定index对应的元素，如果index数组越界则会抛出<code>IndexOutOfBoundsException</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.elementAt(<span class=\"number\">1</span>) <span class=\"comment\">// 2</span></span><br></pre></td></tr></table></figure>\n<p><strong>elementAtOrElse</strong></p>\n<p>返回给定index对应的元素，如果index数组越界则会返回给定函数的返回值，函数中的参数为给定的index。如下图所示：<code>it</code>为传入的10</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.elementAtOrElse(<span class=\"number\">10</span>, &#123; <span class=\"number\">2</span> * it &#125;) <span class=\"comment\">// 20</span></span><br></pre></td></tr></table></figure>\n<p><strong>elementAtOrNull</strong></p>\n<p>返回给定index对应的元素，如果index数组越界则会返回null</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.elementAtOrNull(<span class=\"number\">10</span>) <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<p><strong>first</strong></p>\n<p>返回符合给定函数条件的第一个元素，如果没有符合抛出<code>java.util.NoSuchElementException</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.first() <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.first &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 2</span></span><br></pre></td></tr></table></figure>\n<p><strong>firstOrNull</strong></p>\n<p>返回符合给定函数条件的第一个元素，如果没有符合则返回null</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.firstOrNull() <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.firstOrNull &#123; it % <span class=\"number\">7</span> == <span class=\"number\">0</span> &#125;) <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<p><strong>indexOf</strong></p>\n<p>返回指定元素的第一个index，如果不存在，则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.indexOf(<span class=\"number\">4</span>) <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<p><strong>indexOfFirst</strong></p>\n<p>返回第一个符合给定函数条件的元素的index，如果没有符合则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.indexOfFirst &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n<p><strong>indexOfLast</strong></p>\n<p>返回最后一个符合给定函数条件的元素的index，如果没有符合则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.indexOfLast &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<p><strong>last</strong></p>\n<p>返回符合给定函数条件的最后一个元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.last &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 6</span></span><br></pre></td></tr></table></figure>\n<p><strong>lastIndexOf</strong></p>\n<p>返回的指定元素的最后一个index，如果不存在，则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.lastIndexOf(<span class=\"number\">2</span>) <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.lastIndexOf(<span class=\"number\">7</span>) <span class=\"comment\">// -1</span></span><br></pre></td></tr></table></figure>\n<p><strong>single/singleOrNull</strong></p>\n<p>返回符合给定函数的单个元素，如果没有符合或者超过一个，<code>single</code>抛出异常，<code>singleOrNull</code>返回<code>null</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.single &#123; it % <span class=\"number\">5</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 5</span></span><br><span class=\"line\">list.single &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// java.lang.IllegalArgumentException</span></span><br><span class=\"line\">list.singleOrNull &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"生产操作符\"><a href=\"#生产操作符\" class=\"headerlink\" title=\"生产操作符\"></a>生产操作符</h3><p><strong>partition</strong></p>\n<p>把一个集合通过给定的函数分为两个集合，符合条件的作为一个，不符合的作为另一个</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.partition &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// Pair(listOf(2, 4, 6), listOf(1, 3, 5))</span></span><br></pre></td></tr></table></figure>\n<p><strong>plus</strong></p>\n<p>使用<code>+</code>号操作符把两个集合合并到一个集合中</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list + listOf(<span class=\"number\">7</span>, <span class=\"number\">8</span> ) <span class=\"comment\">// listOf(1, 2, 3, 4, 5, 6, 7, 8)</span></span><br></pre></td></tr></table></figure>\n<p><strong>zip(返回值 List&lt;Pair<t, r=\"\">&gt;)</t,></strong></p>\n<p>返回由<code>Pair</code>组成的List，每个<code>Pair</code>由两个集合中相同index的元素组成。这个返回的List的大小是由最小的那个集合决定</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.zip(listOf(<span class=\"number\">7</span>, <span class=\"number\">8</span>)) <span class=\"comment\">// listOf(Pair(1, 7), Pair(2, 8))</span></span><br></pre></td></tr></table></figure>\n<p><strong>unzip</strong></p>\n<p>从包含<code>Pair</code>的List中生成包含List的<code>Pair</code> 。有点拗口，看代码</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(Pair(<span class=\"number\">5</span>, <span class=\"number\">7</span>), Pair(<span class=\"number\">6</span>, <span class=\"number\">8</span>))</span><br><span class=\"line\">list.unzip() <span class=\"comment\">// Pair(listOf(5, 6), listOf(7, 8))</span></span><br></pre></td></tr></table></figure>\n<p>看上面的代码，还是有点难理解，我们需要结合源码来看</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T, R&gt;</span> Iterable<span class=\"type\">&lt;Pair&lt;T, R&gt;</span>&gt;.<span class=\"title\">unzip</span><span class=\"params\">()</span></span>: Pair&lt;List&lt;T&gt;, List&lt;R&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> expectedSize = collectionSizeOrDefault(<span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">val</span> listT = ArrayList&lt;T&gt;(expectedSize)</span><br><span class=\"line\">    <span class=\"keyword\">val</span> listR = ArrayList&lt;R&gt;(expectedSize)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (pair <span class=\"keyword\">in</span> <span class=\"keyword\">this</span>) &#123;</span><br><span class=\"line\">        listT.add(pair.first)</span><br><span class=\"line\">        listR.add(pair.second)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> listT to listR</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>unzip</code>方法中，会定义两个集合，一个集合会添加<code>list</code>元素<code>Pair(5,7), Pair(6,8)</code>的<code>first</code>，出就是<code>5、6</code>，另一个集合会添加<code>second</code>，也就是<code>7、8</code></p>\n<h3 id=\"顺序操作符\"><a href=\"#顺序操作符\" class=\"headerlink\" title=\"顺序操作符\"></a>顺序操作符</h3><p><strong>reversed</strong></p>\n<p>返回一个倒序的list</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.reversed() <span class=\"comment\">// listOf(6, 5, 4, 3, 2, 1)</span></span><br></pre></td></tr></table></figure>\n<p><strong>sorted</strong></p>\n<p>把list进行生序排列</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.sorted() <span class=\"comment\">// listOf(1, 2, 3, 4, 5, 6)</span></span><br></pre></td></tr></table></figure>\n<p><strong>sortedBy</strong></p>\n<p>把不符合条件的元素按照在集合中之前的顺序放在集合的最前面，把符合条件的元素依次放在后面</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">7</span>, <span class=\"number\">6</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">list.sortedBy &#123; it &gt; <span class=\"number\">2</span> &#125; <span class=\"comment\">// listOf(2, 1, 7, 6, 3, 5, 4)</span></span><br></pre></td></tr></table></figure>\n<p>看代码，因为<code>2,1</code>不符合条件，所以把<code>2,1</code>按之前的顺序放到最前面，<code>7,6,3,5,4</code>仿照之前的顺序依次放到后面</p>\n<p><strong>sortedDescending</strong></p>\n<p>把list进行降序排列</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">7</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">list.sortedDescending() <span class=\"comment\">// listOf(7, 6, 5, 4, 3, 2, 1)</span></span><br></pre></td></tr></table></figure>\n<p><strong>sortedByDescending</strong></p>\n<p>和<code>sortedBy</code>类似，只不过是把符合条件的放在集合的前面，不符合的放在集合的后面</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">7</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">list.sortedByDescending &#123; it &gt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf(7, 4, 5, 6, 3, 1, 2)</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>参考: 《kotlin-for-android-developers》《kotlin in action》</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<p>[TOC]</p>\n<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>kotlin的集合分为不可变集合和可变集合</p>\n<p>Kotlin 的 <code>List&lt;out T&gt;</code> 只提供只读操作如 <code>size</code>、<code>get</code>等的接口。和 Java 类似，它继承自 <code>Collection&lt;T&gt;</code> 进而继承自 <code>Iterable&lt;T&gt;</code>。改变 list 的方法是由 <code>MutableList&lt;T&gt;</code> 加入的。这一模式同样适用于 <code>Set&lt;out T&gt;/MutableSet&lt;T&gt;</code> 及 <code>Map&lt;K, out V&gt;/MutableMap&lt;K, V&gt;</code>。详见下表</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">不可变</th>\n<th>可变</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">Iterable</td>\n<td>MutableIterable</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Collection</td>\n<td>MutableCollection</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">List</td>\n<td>MutableList</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Set</td>\n<td>MutableSet</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">Map</td>\n<td>MutableMap</td>\n</tr>\n</tbody>\n</table>\n<p><code>List</code>和<code>Set</code>的基本用法</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> numbers: MutableList&lt;<span class=\"built_in\">Int</span>&gt; = mutableListOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> readOnlyView: List&lt;<span class=\"built_in\">Int</span>&gt; = numbers</span><br><span class=\"line\">println(numbers)        <span class=\"comment\">// 输出 \"[1, 2, 3]\"</span></span><br><span class=\"line\">numbers.add(<span class=\"number\">4</span>)</span><br><span class=\"line\">println(readOnlyView)   <span class=\"comment\">// 输出 \"[1, 2, 3, 4]\"</span></span><br><span class=\"line\">readOnlyView.clear()    <span class=\"comment\">// -&gt; 不能编译</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> strings = hashSetOf(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>, <span class=\"string\">\"c\"</span>)</span><br><span class=\"line\">assert(strings.size == <span class=\"number\">3</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"总数操作符\"><a href=\"#总数操作符\" class=\"headerlink\" title=\"总数操作符\"></a>总数操作符</h3><p><strong>any</strong></p>\n<p>只要有一个元素符合判断条件，则返回<code>true</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.any &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span>&#125; <span class=\"comment\">// true</span></span><br><span class=\"line\">list.any &#123; it &gt; <span class=\"number\">10</span> &#125; <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<p><strong>all</strong></p>\n<p>只有全部的元素符合判断条件，则返回<code>true</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.all &#123; it &lt; <span class=\"number\">10</span> &#125; <span class=\"comment\">// true</span></span><br><span class=\"line\">list.all &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span>&#125; <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<p><strong>count</strong></p>\n<p>返回符合判断条件的元素总数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.count &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<p><strong>fold</strong></p>\n<p>给定一个初始值，在初始值的基础上，通过给定的函数来累计所有元素。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.fold(<span class=\"number\">4</span>) &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 4+1+2+3+4+5+6 = 25</span></span><br><span class=\"line\">list.fold(<span class=\"number\">4</span>) &#123; total, next -&gt; total * next &#125; <span class=\"comment\">// 4*1*2*3*4*5*6 = 2880</span></span><br></pre></td></tr></table></figure>\n<p><strong>foldRight</strong></p>\n<p>与<code>fold</code>一样，只是顺序是从最后一项到第一项</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.foldRight(<span class=\"number\">4</span>) &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 25</span></span><br></pre></td></tr></table></figure>\n<p><strong>forEach</strong></p>\n<p>遍历的所有的元素，并执行给定的操作</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.forEach &#123; println(it) &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>forEachIndexed</strong></p>\n<p>与<code>forEach</code>类似，但是我们同时可以得到元素的<code>index</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.forEachIndexed &#123; (index, value) -&gt; println(<span class=\"string\">\"position <span class=\"variable\">$index</span> contains a <span class=\"variable\">$value</span>\"</span>) &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>max/min</strong></p>\n<p>返回最大/最小的一项，如果没有则返回<code>null</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.max() <span class=\"comment\">// 6</span></span><br><span class=\"line\">list.min() <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n<p><strong>maxBy/minBy</strong></p>\n<p>根据给定的函数返回最大/最小的一项，如果没有则返回<code>null</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.maxBy &#123; -it &#125; <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.minBy &#123; -it &#125; <span class=\"comment\">// 6</span></span><br></pre></td></tr></table></figure>\n<p><strong>none</strong></p>\n<p>如果没有任何元素与给定的函数匹配，则返回<code>true</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.none &#123; it % <span class=\"number\">7</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<p><strong>reduce</strong></p>\n<p>和<code>fold</code>一样，但是没有一个初始值。通过给定的函数来累计所有元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.reduce &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 21</span></span><br></pre></td></tr></table></figure>\n<p><strong>reduceRight</strong></p>\n<p>和<code>reduce</code>一样，但是顺序是从最后一项到第一项</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.reduceRight &#123; total, next -&gt; total + next &#125; <span class=\"comment\">// 21</span></span><br></pre></td></tr></table></figure>\n<p><strong>sum</strong></p>\n<p>返回所有元素的和</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.sum() <span class=\"comment\">// 21</span></span><br></pre></td></tr></table></figure>\n<p><strong>sumBy</strong></p>\n<p>返回所有元素通过给定的函数转换之后的数据总和</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.sumBy &#123; it % <span class=\"number\">2</span> &#125; <span class=\"comment\">// 3</span></span><br><span class=\"line\">list.sumBy &#123; it + <span class=\"number\">1</span> &#125; <span class=\"comment\">// 27</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"过滤操作符\"><a href=\"#过滤操作符\" class=\"headerlink\" title=\"过滤操作符\"></a>过滤操作符</h3><p><strong>drop</strong></p>\n<p>返回包括去掉前<code>n</code>个元素的所有元素的列表</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.drop(<span class=\"number\">4</span>) <span class=\"comment\">// listOf(5, 6)</span></span><br></pre></td></tr></table></figure>\n<p><strong>dropWhile</strong></p>\n<p>这个函数有点难理解，我们需要结合一下源码来看：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">inline</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T&gt;</span> Iterable<span class=\"type\">&lt;T&gt;</span>.<span class=\"title\">dropWhile</span><span class=\"params\">(predicate: (<span class=\"type\">T</span>)</span></span> -&gt; <span class=\"built_in\">Boolean</span>): List&lt;T&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> yielding = <span class=\"literal\">false</span></span><br><span class=\"line\">    <span class=\"keyword\">val</span> list = ArrayList&lt;T&gt;()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (item <span class=\"keyword\">in</span> <span class=\"keyword\">this</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (yielding)</span><br><span class=\"line\">            list.add(item)</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!predicate(item)) &#123;</span><br><span class=\"line\">            list.add(item)</span><br><span class=\"line\">            yielding = <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> list</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>调用<code>dropWhile</code>时，先遍历集合，如果集合中的元素不符合<code>predicate</code>函数的规则，则从当前元素开始，所有元素依次添加到新集合<code>list</code>并返回，如果集合中的元素都符合规则，则一个都不添加。我们以下面的例子来分析：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list1 = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list1.dropWhile &#123; it &lt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf(3, 4, 5, 6)</span></span><br></pre></td></tr></table></figure>\n<p>在上面的例子中，我们定义的函数规则是当前元素要小于3<code>{it &lt; 3}</code>，当集合遍历到<code>3</code>时，因为3是不小于3的，不符合函数的规则，所以从<code>3</code>开始，往后的元素都被添加到了新集合中。</p>\n<p>再来看一个例子，我们把集合中的<code>6</code>放到最前面</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list2 = listOf(<span class=\"number\">6</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">list2.dropWhile &#123; it &lt; <span class=\"number\">3</span>&#125; <span class=\"comment\">// listOf(6, 1, 2, 3, 4, 5)</span></span><br></pre></td></tr></table></figure>\n<p>遍历集合时，因为第一个元素是<code>6</code>，不符合<code>{it &lt; 3}</code>，所要<code>6</code>及之后的元素都被添加到了新集合中</p>\n<p><strong>dropLastWhile</strong></p>\n<p>返回根据给定函数从最后一项开始去掉指定元素的列表</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.dropLastWhile &#123; it &gt; <span class=\"number\">4</span> &#125; <span class=\"comment\">// listOf(1, 2, 3, 4)</span></span><br></pre></td></tr></table></figure>\n<p><strong>filter</strong></p>\n<p>返回符合给定条件的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.filter &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// listOf(2, 4, 6)</span></span><br><span class=\"line\">list.filter &#123; it &lt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf(1, 2)</span></span><br></pre></td></tr></table></figure>\n<p><strong>filterNot</strong></p>\n<p>返回所有不符合给定函数条件的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.filterNot &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span>&#125; <span class=\"comment\">// listOf(1, 3, 5)</span></span><br></pre></td></tr></table></figure>\n<p><strong>filterNotNull</strong></p>\n<p>返回集合中非<code>null</code>的函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"literal\">null</span>)</span><br><span class=\"line\">println(list.filterNotNull()) <span class=\"comment\">// listOf[1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>\n<p><strong>slice</strong></p>\n<p>返回指定区域的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.slice(<span class=\"number\">0.</span><span class=\"number\">.3</span>) <span class=\"comment\">// listOf(1, 2, 3, 4)</span></span><br><span class=\"line\">list.slice(listOf(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>)) <span class=\"comment\">// listOf(2, 4, 5)</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>(0..3)</code>：表示取出第0个到第3个之间的元素</p>\n<p><code>listOf(1, 3, 4)</code>：表示取出下标为1、3、4的元素</p>\n</blockquote>\n<p><strong>take</strong></p>\n<p>返回从第一个开始的n个元素(返回前n个元素)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.take(<span class=\"number\">2</span>) <span class=\"comment\">// listOf[1, 2]</span></span><br></pre></td></tr></table></figure>\n<p><strong>takeLast</strong></p>\n<p>返回从最后一个开始的n个元素(返回后n个元素)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.take(<span class=\"number\">2</span>) <span class=\"comment\">// listOf[5, 6]</span></span><br></pre></td></tr></table></figure>\n<p><strong>takeWhile</strong></p>\n<p>返回从第一个开始符合给定函数条件的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.takeWhile &#123; it &lt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf[1, 2]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"映射操作符\"><a href=\"#映射操作符\" class=\"headerlink\" title=\"映射操作符\"></a>映射操作符</h3><p><strong>flatMap</strong></p>\n<p>遍历所有的元素，为每个元素创建一个集合，最后把所有的集合放在一个集合中。</p>\n<p>什么意思呢，就是你可以把每一个元素转化成一个新的<code>list</code>，最后这些<code>list</code>会合并成一个大的<code>list</code>。我们通过代码来分析：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.flatMap &#123; listOf(<span class=\"string\">'a'</span> + it) &#125; <span class=\"comment\">// listOf(b, c, d, e, f, g)</span></span><br></pre></td></tr></table></figure>\n<p>上面的例子中，我们通过函数<code>listOf(&#39;a&#39;+ it)</code>把每一个元素都转换成了新的list。因为我们有6个元素，所以会生成6个list<code>(listOf(b)、listOf(c)、listOf(d)、listOf(e)、listOf(f)和listOf(g))</code>，最后会遍历这6个<code>list</code>，把这6个<code>list</code>中的每一项添加到一个新的<code>list</code>中。当然你也可以为<code>listOf(&#39;a&#39; + it)</code>添加多个元素，看下面的例子：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.flatMap &#123; listOf(it, <span class=\"string\">'a'</span> + it) &#125; <span class=\"comment\">// listOf(1, b, 2, c, 3, d, 4, e, 5, f, 6, g)</span></span><br></pre></td></tr></table></figure>\n<p><strong>groupBy</strong></p>\n<p>返回一个根据给定函数分组后的map，把函数的返回值作为<code>key</code>，符合条件的所有元素作为<code>value</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\"><span class=\"comment\">// 返回为 mapOf(\"odd\" to listOf(1, 3, 5), \"even\" to listOf(2, 4, 6)&#125;</span></span><br><span class=\"line\">list.groupBy &#123; <span class=\"keyword\">if</span> (it % <span class=\"number\">2</span> ==<span class=\"number\">0</span>) <span class=\"string\">\"even\"</span> <span class=\"keyword\">else</span> <span class=\"string\">\"odd\"</span> &#125;</span><br></pre></td></tr></table></figure>\n<p><strong>map</strong></p>\n<p>返回一个每一个元素根据给定的函数转换所组成的List(把元素列表中的每一项进行相应计算或转成其它你想要的任何格式)。</p>\n<p>把元素中的每一项乘2：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.map &#123; it * <span class=\"number\">2</span> &#125; <span class=\"comment\">// listOf(2, 4, 6, 8, 10, 12)</span></span><br></pre></td></tr></table></figure>\n<p>把元素中的每一项转成字母：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.map &#123; <span class=\"string\">'a'</span> + it &#125; <span class=\"comment\">// listOf(b, c, d, e, f, g)</span></span><br></pre></td></tr></table></figure>\n<p><strong>mapIndexed</strong></p>\n<p>和<code>map</code>一样，但是我们可以同时得到元素的<code>index</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.mapIndexed &#123; index, it -&gt; index + it &#125; <span class=\"comment\">// listOf(1, 3, 5, 7, 9, 11)</span></span><br></pre></td></tr></table></figure>\n<p><strong>mapNotNull</strong></p>\n<p>和<code>map</code>一样，但是会过滤掉为<code>null</code>的元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String? = <span class=\"literal\">null</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(Person(), Person(<span class=\"string\">\"Alice\"</span>))</span><br><span class=\"line\"><span class=\"comment\">// map</span></span><br><span class=\"line\">list.map &#123; it.name &#125; <span class=\"comment\">// listOf(null, \"Alice\")</span></span><br><span class=\"line\"><span class=\"comment\">// mapNotNull</span></span><br><span class=\"line\">list.mapNotNull &#123; it.name &#125; <span class=\"comment\">// listOf(\"Alice\")</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"元素操作符\"><a href=\"#元素操作符\" class=\"headerlink\" title=\"元素操作符\"></a>元素操作符</h3><p><strong>contains</strong></p>\n<p>如果的元素可以在集合中找到，则返回true</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.contains(<span class=\"number\">2</span>) <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<p><strong>elementAt</strong></p>\n<p>返回给定index对应的元素，如果index数组越界则会抛出<code>IndexOutOfBoundsException</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.elementAt(<span class=\"number\">1</span>) <span class=\"comment\">// 2</span></span><br></pre></td></tr></table></figure>\n<p><strong>elementAtOrElse</strong></p>\n<p>返回给定index对应的元素，如果index数组越界则会返回给定函数的返回值，函数中的参数为给定的index。如下图所示：<code>it</code>为传入的10</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.elementAtOrElse(<span class=\"number\">10</span>, &#123; <span class=\"number\">2</span> * it &#125;) <span class=\"comment\">// 20</span></span><br></pre></td></tr></table></figure>\n<p><strong>elementAtOrNull</strong></p>\n<p>返回给定index对应的元素，如果index数组越界则会返回null</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.elementAtOrNull(<span class=\"number\">10</span>) <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<p><strong>first</strong></p>\n<p>返回符合给定函数条件的第一个元素，如果没有符合抛出<code>java.util.NoSuchElementException</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.first() <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.first &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 2</span></span><br></pre></td></tr></table></figure>\n<p><strong>firstOrNull</strong></p>\n<p>返回符合给定函数条件的第一个元素，如果没有符合则返回null</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.firstOrNull() <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.firstOrNull &#123; it % <span class=\"number\">7</span> == <span class=\"number\">0</span> &#125;) <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<p><strong>indexOf</strong></p>\n<p>返回指定元素的第一个index，如果不存在，则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.indexOf(<span class=\"number\">4</span>) <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<p><strong>indexOfFirst</strong></p>\n<p>返回第一个符合给定函数条件的元素的index，如果没有符合则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.indexOfFirst &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 1</span></span><br></pre></td></tr></table></figure>\n<p><strong>indexOfLast</strong></p>\n<p>返回最后一个符合给定函数条件的元素的index，如果没有符合则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.indexOfLast &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 5</span></span><br></pre></td></tr></table></figure>\n<p><strong>last</strong></p>\n<p>返回符合给定函数条件的最后一个元素</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.last &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 6</span></span><br></pre></td></tr></table></figure>\n<p><strong>lastIndexOf</strong></p>\n<p>返回的指定元素的最后一个index，如果不存在，则返回<code>-1</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.lastIndexOf(<span class=\"number\">2</span>) <span class=\"comment\">// 1</span></span><br><span class=\"line\">list.lastIndexOf(<span class=\"number\">7</span>) <span class=\"comment\">// -1</span></span><br></pre></td></tr></table></figure>\n<p><strong>single/singleOrNull</strong></p>\n<p>返回符合给定函数的单个元素，如果没有符合或者超过一个，<code>single</code>抛出异常，<code>singleOrNull</code>返回<code>null</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.single &#123; it % <span class=\"number\">5</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// 5</span></span><br><span class=\"line\">list.single &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// java.lang.IllegalArgumentException</span></span><br><span class=\"line\">list.singleOrNull &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"生产操作符\"><a href=\"#生产操作符\" class=\"headerlink\" title=\"生产操作符\"></a>生产操作符</h3><p><strong>partition</strong></p>\n<p>把一个集合通过给定的函数分为两个集合，符合条件的作为一个，不符合的作为另一个</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.partition &#123; it % <span class=\"number\">2</span> == <span class=\"number\">0</span> &#125; <span class=\"comment\">// Pair(listOf(2, 4, 6), listOf(1, 3, 5))</span></span><br></pre></td></tr></table></figure>\n<p><strong>plus</strong></p>\n<p>使用<code>+</code>号操作符把两个集合合并到一个集合中</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list + listOf(<span class=\"number\">7</span>, <span class=\"number\">8</span> ) <span class=\"comment\">// listOf(1, 2, 3, 4, 5, 6, 7, 8)</span></span><br></pre></td></tr></table></figure>\n<p><strong>zip(返回值 List&lt;Pair<t, r=\"\">&gt;)</t,></strong></p>\n<p>返回由<code>Pair</code>组成的List，每个<code>Pair</code>由两个集合中相同index的元素组成。这个返回的List的大小是由最小的那个集合决定</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.zip(listOf(<span class=\"number\">7</span>, <span class=\"number\">8</span>)) <span class=\"comment\">// listOf(Pair(1, 7), Pair(2, 8))</span></span><br></pre></td></tr></table></figure>\n<p><strong>unzip</strong></p>\n<p>从包含<code>Pair</code>的List中生成包含List的<code>Pair</code> 。有点拗口，看代码</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(Pair(<span class=\"number\">5</span>, <span class=\"number\">7</span>), Pair(<span class=\"number\">6</span>, <span class=\"number\">8</span>))</span><br><span class=\"line\">list.unzip() <span class=\"comment\">// Pair(listOf(5, 6), listOf(7, 8))</span></span><br></pre></td></tr></table></figure>\n<p>看上面的代码，还是有点难理解，我们需要结合源码来看</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T, R&gt;</span> Iterable<span class=\"type\">&lt;Pair&lt;T, R&gt;</span>&gt;.<span class=\"title\">unzip</span><span class=\"params\">()</span></span>: Pair&lt;List&lt;T&gt;, List&lt;R&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> expectedSize = collectionSizeOrDefault(<span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">val</span> listT = ArrayList&lt;T&gt;(expectedSize)</span><br><span class=\"line\">    <span class=\"keyword\">val</span> listR = ArrayList&lt;R&gt;(expectedSize)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (pair <span class=\"keyword\">in</span> <span class=\"keyword\">this</span>) &#123;</span><br><span class=\"line\">        listT.add(pair.first)</span><br><span class=\"line\">        listR.add(pair.second)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> listT to listR</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>unzip</code>方法中，会定义两个集合，一个集合会添加<code>list</code>元素<code>Pair(5,7), Pair(6,8)</code>的<code>first</code>，出就是<code>5、6</code>，另一个集合会添加<code>second</code>，也就是<code>7、8</code></p>\n<h3 id=\"顺序操作符\"><a href=\"#顺序操作符\" class=\"headerlink\" title=\"顺序操作符\"></a>顺序操作符</h3><p><strong>reversed</strong></p>\n<p>返回一个倒序的list</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.reversed() <span class=\"comment\">// listOf(6, 5, 4, 3, 2, 1)</span></span><br></pre></td></tr></table></figure>\n<p><strong>sorted</strong></p>\n<p>把list进行生序排列</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">list.sorted() <span class=\"comment\">// listOf(1, 2, 3, 4, 5, 6)</span></span><br></pre></td></tr></table></figure>\n<p><strong>sortedBy</strong></p>\n<p>把不符合条件的元素按照在集合中之前的顺序放在集合的最前面，把符合条件的元素依次放在后面</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">7</span>, <span class=\"number\">6</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">list.sortedBy &#123; it &gt; <span class=\"number\">2</span> &#125; <span class=\"comment\">// listOf(2, 1, 7, 6, 3, 5, 4)</span></span><br></pre></td></tr></table></figure>\n<p>看代码，因为<code>2,1</code>不符合条件，所以把<code>2,1</code>按之前的顺序放到最前面，<code>7,6,3,5,4</code>仿照之前的顺序依次放到后面</p>\n<p><strong>sortedDescending</strong></p>\n<p>把list进行降序排列</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">7</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">list.sortedDescending() <span class=\"comment\">// listOf(7, 6, 5, 4, 3, 2, 1)</span></span><br></pre></td></tr></table></figure>\n<p><strong>sortedByDescending</strong></p>\n<p>和<code>sortedBy</code>类似，只不过是把符合条件的放在集合的前面，不符合的放在集合的后面</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">7</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">list.sortedByDescending &#123; it &gt; <span class=\"number\">3</span> &#125; <span class=\"comment\">// listOf(7, 4, 5, 6, 3, 1, 2)</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>参考: 《kotlin-for-android-developers》《kotlin in action》</p>\n</blockquote>\n"},{"title":"Kotlin委托","date":"2018-03-09T03:15:35.000Z","_content":"\n\n\n### 类委托\n\n创建一个类`Derived`，实例`Base`接口，并将其所有公共方法委托给指定的对象。\n\n```kotlin\ninterface Base {\n    fun print()\n}\n\nclass BaseImpl(val x: Int) : Base {\n    override fun print() { print(x) }\n}\n\nclass Derived(b: Base) : Base by b\n\nfun main(args: Array<String) {\n    val b = BaseImpl(10)\n    Derived(b).print() // prints 10\n}\n```\n\n`Derived`超类列表中的`by-`子句表明，`b`将会在`Derived`对象的内部存储， 并且编译器将生成转发给 `b` 的所有 `Base` 的方法。\n\n注意：`override`标注的方法会取代委托对象中的实现。如果你在`Derived`中添加了`override fun print() { print(\"abc\") }`，程序会输入`abc`而不是`10`。\n\n<!--more-->\n\n### 委托属性\n\nkotlin库提供了如下常见的属性类型\n\n- lazy properties(延迟属性):  该值只在首次访问时计算;\n- observable properties(可观察属性):  监听器会收到该属性变化时的通知;\n- 把属性存储在`map`中, 而不是每个属性都使用单独字段存储.\n\n为了涵盖这些(或其他)情况，Kotlin支持委托的属性：\n\n```kotlin\nclass Foo {\n    var p: String by Delegate()\n}\n```\n\n语法：`val/var <property name>: <Type> by <expression>`，使用`by`关键字来实现委托。\n\n按照约定，Delegate类必须具有`getValue`和（`setValue` — 对于var属性)方法。编译器创建一个隐藏的辅助属性，并使用委托对象的实例进行实始化，初始属性`p`会委托给该实例。对应的`get()`、`set()`会调用实例的`getValue()`和`setValue`方法。它们可以是成员函数，也可以是扩展函数。为了让例子看起来更简洁，这里我们省略掉了参数：\n\n下面是演化过程\n\n```kotlin\nclass Delegate {\n    operator fun getValue(thisRef: Any?, property: KProperty<*>): String {\n        return \"$thisRef, thank you for delegating '${property.name}' to me!\"\n    }\n \n    operator fun setValue(thisRef: Any?, property: KProperty<*>, value: String) {\n        println(\"$value has been assigned to '${property.name}' in $thisRef.\")\n    }\n}\nclass Foo {\n    private val delegate = Delegate()\n    val p: String\n    \tset(value: String) = delegate.setValue(..., value)\n    \tget() = delegate.getValue(...)\n}\n\n==>\n\nclass Foo {\n    var p: String by Delegate()\n}\n\nval foo = Foo()\nval oldValue = foo.p\nfoo.p = newValue\n```\n\n#### 使用委托属性：惰性初始化和\"by lazy()\"\n\n我们有一个耗时的方法`loadEmails`，用来从数据库检索电子邮件，我们希望只有在首次访问时才加载，并且只加载一次，我们可以使用下面的方法：\n\n```kotlin\nfun loadEmails(person: Person): List<Email> {\n    println(\"load emails for ${person.name}\")\n    return listOf(/*...*/)\n}\nclass Person(val name: String) {\n    private var _emails: List<Email>? = null\n    \n    val emails: List<Email>\n        get() {\n            if (_emails == null) {\n                _emails = loadEmails(this)\n            }\n            return _emails\n        }\n}\nval p = Person(\"Alice\")\np.emails // Load emails for Alice --> 第一次访问会加载邮件\np.emails\n```\n\n这个代码有点啰唆，且这个实现不是线程安全的。Kotlin提代了更好的解决方案\n\n```kotlin\nclass Person(val name: String) {\n    val emails by lazy { loadEmails(this) }\n}\n```\n\n`lazy`函数返回一个对象，该对象具有一个名为`getValue`且签名正确的方法，因此可以把它与`by`关键字一起使用来创建一个委托属性。`lazy`的参数是一个`lambda`，可以调用它来初始化这个值。默认情况下，`lazy`函数是线程安全的，如里需要，可以设置其他选项来告诉它要使用哪个锁，或者完全避开同步，如果该类永远不会在多线程环境中使用\n\n#### 实例委托属性\n\n```kotlin\nclass Person(val name: String, age: Int, salary: Int): PropertyChangeAware() {\n    var age: Int by Delegates.observable(0) {\n        prop, old, new ->\n        println(\"$old -> $new\")\n    }\n    var name: String by Delegates.observable(\"<no name>\") {\n        prop, old, new ->\n        println(\"$old -> $new\")\n    }\n}\n```\n\n如果你想能够截获一个赋值并做一些条件判断，可以使用`vetoable`代替`observable`\n\n```kotlin\nclass Person(val name: String, age: Int, salary: Int): PropertyChangeAware() {\n    var age: Int by Delegates.observable(0) {\n        prop, old, new ->\n        new > old\n    }\n}\n```\n\n**把属性储存在Map中**\n\n```kotlin\nclass Person(val map: Map<String, Any?) {\n    val name: String by map\n    val age: Int by map\n}\n\n// 属性的名称自动用作map中的键\nval person = Person(mapOf(\"name\" to \"John Doe\", \"age\" to 25))\nperson.name\nperson.age\n```\n\n这也适用于`var`属性，只需把`map`换成`mutableMap`\n\n```kotlin\nclass Person(val map: mutableMap<String, Any?) {\n    var name: String by map\n    var age: Int by map\n}\n```\n\n","source":"_posts/android/kotlin-delegation.md","raw":"---\ntitle: Kotlin委托\ndate: 2018-03-09 11:15:35\ntags: [android, kotlin]\n---\n\n\n\n### 类委托\n\n创建一个类`Derived`，实例`Base`接口，并将其所有公共方法委托给指定的对象。\n\n```kotlin\ninterface Base {\n    fun print()\n}\n\nclass BaseImpl(val x: Int) : Base {\n    override fun print() { print(x) }\n}\n\nclass Derived(b: Base) : Base by b\n\nfun main(args: Array<String) {\n    val b = BaseImpl(10)\n    Derived(b).print() // prints 10\n}\n```\n\n`Derived`超类列表中的`by-`子句表明，`b`将会在`Derived`对象的内部存储， 并且编译器将生成转发给 `b` 的所有 `Base` 的方法。\n\n注意：`override`标注的方法会取代委托对象中的实现。如果你在`Derived`中添加了`override fun print() { print(\"abc\") }`，程序会输入`abc`而不是`10`。\n\n<!--more-->\n\n### 委托属性\n\nkotlin库提供了如下常见的属性类型\n\n- lazy properties(延迟属性):  该值只在首次访问时计算;\n- observable properties(可观察属性):  监听器会收到该属性变化时的通知;\n- 把属性存储在`map`中, 而不是每个属性都使用单独字段存储.\n\n为了涵盖这些(或其他)情况，Kotlin支持委托的属性：\n\n```kotlin\nclass Foo {\n    var p: String by Delegate()\n}\n```\n\n语法：`val/var <property name>: <Type> by <expression>`，使用`by`关键字来实现委托。\n\n按照约定，Delegate类必须具有`getValue`和（`setValue` — 对于var属性)方法。编译器创建一个隐藏的辅助属性，并使用委托对象的实例进行实始化，初始属性`p`会委托给该实例。对应的`get()`、`set()`会调用实例的`getValue()`和`setValue`方法。它们可以是成员函数，也可以是扩展函数。为了让例子看起来更简洁，这里我们省略掉了参数：\n\n下面是演化过程\n\n```kotlin\nclass Delegate {\n    operator fun getValue(thisRef: Any?, property: KProperty<*>): String {\n        return \"$thisRef, thank you for delegating '${property.name}' to me!\"\n    }\n \n    operator fun setValue(thisRef: Any?, property: KProperty<*>, value: String) {\n        println(\"$value has been assigned to '${property.name}' in $thisRef.\")\n    }\n}\nclass Foo {\n    private val delegate = Delegate()\n    val p: String\n    \tset(value: String) = delegate.setValue(..., value)\n    \tget() = delegate.getValue(...)\n}\n\n==>\n\nclass Foo {\n    var p: String by Delegate()\n}\n\nval foo = Foo()\nval oldValue = foo.p\nfoo.p = newValue\n```\n\n#### 使用委托属性：惰性初始化和\"by lazy()\"\n\n我们有一个耗时的方法`loadEmails`，用来从数据库检索电子邮件，我们希望只有在首次访问时才加载，并且只加载一次，我们可以使用下面的方法：\n\n```kotlin\nfun loadEmails(person: Person): List<Email> {\n    println(\"load emails for ${person.name}\")\n    return listOf(/*...*/)\n}\nclass Person(val name: String) {\n    private var _emails: List<Email>? = null\n    \n    val emails: List<Email>\n        get() {\n            if (_emails == null) {\n                _emails = loadEmails(this)\n            }\n            return _emails\n        }\n}\nval p = Person(\"Alice\")\np.emails // Load emails for Alice --> 第一次访问会加载邮件\np.emails\n```\n\n这个代码有点啰唆，且这个实现不是线程安全的。Kotlin提代了更好的解决方案\n\n```kotlin\nclass Person(val name: String) {\n    val emails by lazy { loadEmails(this) }\n}\n```\n\n`lazy`函数返回一个对象，该对象具有一个名为`getValue`且签名正确的方法，因此可以把它与`by`关键字一起使用来创建一个委托属性。`lazy`的参数是一个`lambda`，可以调用它来初始化这个值。默认情况下，`lazy`函数是线程安全的，如里需要，可以设置其他选项来告诉它要使用哪个锁，或者完全避开同步，如果该类永远不会在多线程环境中使用\n\n#### 实例委托属性\n\n```kotlin\nclass Person(val name: String, age: Int, salary: Int): PropertyChangeAware() {\n    var age: Int by Delegates.observable(0) {\n        prop, old, new ->\n        println(\"$old -> $new\")\n    }\n    var name: String by Delegates.observable(\"<no name>\") {\n        prop, old, new ->\n        println(\"$old -> $new\")\n    }\n}\n```\n\n如果你想能够截获一个赋值并做一些条件判断，可以使用`vetoable`代替`observable`\n\n```kotlin\nclass Person(val name: String, age: Int, salary: Int): PropertyChangeAware() {\n    var age: Int by Delegates.observable(0) {\n        prop, old, new ->\n        new > old\n    }\n}\n```\n\n**把属性储存在Map中**\n\n```kotlin\nclass Person(val map: Map<String, Any?) {\n    val name: String by map\n    val age: Int by map\n}\n\n// 属性的名称自动用作map中的键\nval person = Person(mapOf(\"name\" to \"John Doe\", \"age\" to 25))\nperson.name\nperson.age\n```\n\n这也适用于`var`属性，只需把`map`换成`mutableMap`\n\n```kotlin\nclass Person(val map: mutableMap<String, Any?) {\n    var name: String by map\n    var age: Int by map\n}\n```\n\n","slug":"android/kotlin-delegation","published":1,"updated":"2018-05-20T13:04:25.682Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61er001hizcbhpr99ohs","content":"<h3 id=\"类委托\"><a href=\"#类委托\" class=\"headerlink\" title=\"类委托\"></a>类委托</h3><p>创建一个类<code>Derived</code>，实例<code>Base</code>接口，并将其所有公共方法委托给指定的对象。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Base</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">print</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseImpl</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>) : Base &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">print</span><span class=\"params\">()</span></span> &#123; print(x) &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Derived</span></span>(b: Base) : Base <span class=\"keyword\">by</span> b</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> b = BaseImpl(<span class=\"number\">10</span>)</span><br><span class=\"line\">    Derived(b).print() <span class=\"comment\">// prints 10</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Derived</code>超类列表中的<code>by-</code>子句表明，<code>b</code>将会在<code>Derived</code>对象的内部存储， 并且编译器将生成转发给 <code>b</code> 的所有 <code>Base</code> 的方法。</p>\n<p>注意：<code>override</code>标注的方法会取代委托对象中的实现。如果你在<code>Derived</code>中添加了<code>override fun print() { print(&quot;abc&quot;) }</code>，程序会输入<code>abc</code>而不是<code>10</code>。</p>\n<a id=\"more\"></a>\n<h3 id=\"委托属性\"><a href=\"#委托属性\" class=\"headerlink\" title=\"委托属性\"></a>委托属性</h3><p>kotlin库提供了如下常见的属性类型</p>\n<ul>\n<li>lazy properties(延迟属性):  该值只在首次访问时计算;</li>\n<li>observable properties(可观察属性):  监听器会收到该属性变化时的通知;</li>\n<li>把属性存储在<code>map</code>中, 而不是每个属性都使用单独字段存储.</li>\n</ul>\n<p>为了涵盖这些(或其他)情况，Kotlin支持委托的属性：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p: String <span class=\"keyword\">by</span> Delegate()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>语法：<code>val/var &lt;property name&gt;: &lt;Type&gt; by &lt;expression&gt;</code>，使用<code>by</code>关键字来实现委托。</p>\n<p>按照约定，Delegate类必须具有<code>getValue</code>和（<code>setValue</code> — 对于var属性)方法。编译器创建一个隐藏的辅助属性，并使用委托对象的实例进行实始化，初始属性<code>p</code>会委托给该实例。对应的<code>get()</code>、<code>set()</code>会调用实例的<code>getValue()</code>和<code>setValue</code>方法。它们可以是成员函数，也可以是扩展函数。为了让例子看起来更简洁，这里我们省略掉了参数：</p>\n<p>下面是演化过程</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Delegate</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getValue</span><span class=\"params\">(thisRef: <span class=\"type\">Any</span>?, property: <span class=\"type\">KProperty</span>&lt;*&gt;)</span></span>: String &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"variable\">$thisRef</span>, thank you for delegating '<span class=\"subst\">$&#123;property.name&#125;</span>' to me!\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">setValue</span><span class=\"params\">(thisRef: <span class=\"type\">Any</span>?, property: <span class=\"type\">KProperty</span>&lt;*&gt;, value: <span class=\"type\">String</span>)</span></span> &#123;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$value</span> has been assigned to '<span class=\"subst\">$&#123;property.name&#125;</span>' in <span class=\"variable\">$thisRef</span>.\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">val</span> delegate = Delegate()</span><br><span class=\"line\">    <span class=\"keyword\">val</span> p: String</span><br><span class=\"line\">    \t<span class=\"keyword\">set</span>(value: String) = delegate.setValue(..., value)</span><br><span class=\"line\">    \t<span class=\"keyword\">get</span>() = delegate.getValue(...)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p: String <span class=\"keyword\">by</span> Delegate()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> foo = Foo()</span><br><span class=\"line\"><span class=\"keyword\">val</span> oldValue = foo.p</span><br><span class=\"line\">foo.p = newValue</span><br></pre></td></tr></table></figure>\n<h4 id=\"使用委托属性：惰性初始化和”by-lazy-”\"><a href=\"#使用委托属性：惰性初始化和”by-lazy-”\" class=\"headerlink\" title=\"使用委托属性：惰性初始化和”by lazy()”\"></a>使用委托属性：惰性初始化和”by lazy()”</h4><p>我们有一个耗时的方法<code>loadEmails</code>，用来从数据库检索电子邮件，我们希望只有在首次访问时才加载，并且只加载一次，我们可以使用下面的方法：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">loadEmails</span><span class=\"params\">(person: <span class=\"type\">Person</span>)</span></span>: List&lt;Email&gt; &#123;</span><br><span class=\"line\">    println(<span class=\"string\">\"load emails for <span class=\"subst\">$&#123;person.name&#125;</span>\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> listOf(<span class=\"comment\">/*...*/</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> _emails: List&lt;Email&gt;? = <span class=\"literal\">null</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">val</span> emails: List&lt;Email&gt;</span><br><span class=\"line\">        <span class=\"keyword\">get</span>() &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (_emails == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                _emails = loadEmails(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> _emails</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p = Person(<span class=\"string\">\"Alice\"</span>)</span><br><span class=\"line\">p.emails <span class=\"comment\">// Load emails for Alice --&gt; 第一次访问会加载邮件</span></span><br><span class=\"line\">p.emails</span><br></pre></td></tr></table></figure>\n<p>这个代码有点啰唆，且这个实现不是线程安全的。Kotlin提代了更好的解决方案</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> emails <span class=\"keyword\">by</span> lazy &#123; loadEmails(<span class=\"keyword\">this</span>) &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>lazy</code>函数返回一个对象，该对象具有一个名为<code>getValue</code>且签名正确的方法，因此可以把它与<code>by</code>关键字一起使用来创建一个委托属性。<code>lazy</code>的参数是一个<code>lambda</code>，可以调用它来初始化这个值。默认情况下，<code>lazy</code>函数是线程安全的，如里需要，可以设置其他选项来告诉它要使用哪个锁，或者完全避开同步，如果该类永远不会在多线程环境中使用</p>\n<h4 id=\"实例委托属性\"><a href=\"#实例委托属性\" class=\"headerlink\" title=\"实例委托属性\"></a>实例委托属性</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String, age: <span class=\"built_in\">Int</span>, salary: <span class=\"built_in\">Int</span>): PropertyChangeAware() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> Delegates.observable(<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        prop, old, new -&gt;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$old</span> -&gt; <span class=\"variable\">$new</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: String <span class=\"keyword\">by</span> Delegates.observable(<span class=\"string\">\"&lt;no name&gt;\"</span>) &#123;</span><br><span class=\"line\">        prop, old, new -&gt;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$old</span> -&gt; <span class=\"variable\">$new</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>如果你想能够截获一个赋值并做一些条件判断，可以使用<code>vetoable</code>代替<code>observable</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String, age: <span class=\"built_in\">Int</span>, salary: <span class=\"built_in\">Int</span>): PropertyChangeAware() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> Delegates.observable(<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        prop, old, new -&gt;</span><br><span class=\"line\">        new &gt; old</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>把属性储存在Map中</strong></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> map: Map&lt;String, Any?) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> name: String <span class=\"keyword\">by</span> map</span><br><span class=\"line\">    <span class=\"keyword\">val</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> map</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 属性的名称自动用作map中的键</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> person = Person(mapOf(<span class=\"string\">\"name\"</span> to <span class=\"string\">\"John Doe\"</span>, <span class=\"string\">\"age\"</span> to <span class=\"number\">25</span>))</span><br><span class=\"line\">person.name</span><br><span class=\"line\">person.age</span><br></pre></td></tr></table></figure>\n<p>这也适用于<code>var</code>属性，只需把<code>map</code>换成<code>mutableMap</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> map: mutableMap&lt;String, Any?) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: String <span class=\"keyword\">by</span> map</span><br><span class=\"line\">    <span class=\"keyword\">var</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> map</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h3 id=\"类委托\"><a href=\"#类委托\" class=\"headerlink\" title=\"类委托\"></a>类委托</h3><p>创建一个类<code>Derived</code>，实例<code>Base</code>接口，并将其所有公共方法委托给指定的对象。</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Base</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">print</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BaseImpl</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>) : Base &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">print</span><span class=\"params\">()</span></span> &#123; print(x) &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Derived</span></span>(b: Base) : Base <span class=\"keyword\">by</span> b</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> b = BaseImpl(<span class=\"number\">10</span>)</span><br><span class=\"line\">    Derived(b).print() <span class=\"comment\">// prints 10</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>Derived</code>超类列表中的<code>by-</code>子句表明，<code>b</code>将会在<code>Derived</code>对象的内部存储， 并且编译器将生成转发给 <code>b</code> 的所有 <code>Base</code> 的方法。</p>\n<p>注意：<code>override</code>标注的方法会取代委托对象中的实现。如果你在<code>Derived</code>中添加了<code>override fun print() { print(&quot;abc&quot;) }</code>，程序会输入<code>abc</code>而不是<code>10</code>。</p>","more":"<h3 id=\"委托属性\"><a href=\"#委托属性\" class=\"headerlink\" title=\"委托属性\"></a>委托属性</h3><p>kotlin库提供了如下常见的属性类型</p>\n<ul>\n<li>lazy properties(延迟属性):  该值只在首次访问时计算;</li>\n<li>observable properties(可观察属性):  监听器会收到该属性变化时的通知;</li>\n<li>把属性存储在<code>map</code>中, 而不是每个属性都使用单独字段存储.</li>\n</ul>\n<p>为了涵盖这些(或其他)情况，Kotlin支持委托的属性：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p: String <span class=\"keyword\">by</span> Delegate()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>语法：<code>val/var &lt;property name&gt;: &lt;Type&gt; by &lt;expression&gt;</code>，使用<code>by</code>关键字来实现委托。</p>\n<p>按照约定，Delegate类必须具有<code>getValue</code>和（<code>setValue</code> — 对于var属性)方法。编译器创建一个隐藏的辅助属性，并使用委托对象的实例进行实始化，初始属性<code>p</code>会委托给该实例。对应的<code>get()</code>、<code>set()</code>会调用实例的<code>getValue()</code>和<code>setValue</code>方法。它们可以是成员函数，也可以是扩展函数。为了让例子看起来更简洁，这里我们省略掉了参数：</p>\n<p>下面是演化过程</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Delegate</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getValue</span><span class=\"params\">(thisRef: <span class=\"type\">Any</span>?, property: <span class=\"type\">KProperty</span>&lt;*&gt;)</span></span>: String &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"variable\">$thisRef</span>, thank you for delegating '<span class=\"subst\">$&#123;property.name&#125;</span>' to me!\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">setValue</span><span class=\"params\">(thisRef: <span class=\"type\">Any</span>?, property: <span class=\"type\">KProperty</span>&lt;*&gt;, value: <span class=\"type\">String</span>)</span></span> &#123;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$value</span> has been assigned to '<span class=\"subst\">$&#123;property.name&#125;</span>' in <span class=\"variable\">$thisRef</span>.\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">val</span> delegate = Delegate()</span><br><span class=\"line\">    <span class=\"keyword\">val</span> p: String</span><br><span class=\"line\">    \t<span class=\"keyword\">set</span>(value: String) = delegate.setValue(..., value)</span><br><span class=\"line\">    \t<span class=\"keyword\">get</span>() = delegate.getValue(...)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> p: String <span class=\"keyword\">by</span> Delegate()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> foo = Foo()</span><br><span class=\"line\"><span class=\"keyword\">val</span> oldValue = foo.p</span><br><span class=\"line\">foo.p = newValue</span><br></pre></td></tr></table></figure>\n<h4 id=\"使用委托属性：惰性初始化和”by-lazy-”\"><a href=\"#使用委托属性：惰性初始化和”by-lazy-”\" class=\"headerlink\" title=\"使用委托属性：惰性初始化和”by lazy()”\"></a>使用委托属性：惰性初始化和”by lazy()”</h4><p>我们有一个耗时的方法<code>loadEmails</code>，用来从数据库检索电子邮件，我们希望只有在首次访问时才加载，并且只加载一次，我们可以使用下面的方法：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">loadEmails</span><span class=\"params\">(person: <span class=\"type\">Person</span>)</span></span>: List&lt;Email&gt; &#123;</span><br><span class=\"line\">    println(<span class=\"string\">\"load emails for <span class=\"subst\">$&#123;person.name&#125;</span>\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> listOf(<span class=\"comment\">/*...*/</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> _emails: List&lt;Email&gt;? = <span class=\"literal\">null</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">val</span> emails: List&lt;Email&gt;</span><br><span class=\"line\">        <span class=\"keyword\">get</span>() &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (_emails == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                _emails = loadEmails(<span class=\"keyword\">this</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> _emails</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p = Person(<span class=\"string\">\"Alice\"</span>)</span><br><span class=\"line\">p.emails <span class=\"comment\">// Load emails for Alice --&gt; 第一次访问会加载邮件</span></span><br><span class=\"line\">p.emails</span><br></pre></td></tr></table></figure>\n<p>这个代码有点啰唆，且这个实现不是线程安全的。Kotlin提代了更好的解决方案</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> emails <span class=\"keyword\">by</span> lazy &#123; loadEmails(<span class=\"keyword\">this</span>) &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>lazy</code>函数返回一个对象，该对象具有一个名为<code>getValue</code>且签名正确的方法，因此可以把它与<code>by</code>关键字一起使用来创建一个委托属性。<code>lazy</code>的参数是一个<code>lambda</code>，可以调用它来初始化这个值。默认情况下，<code>lazy</code>函数是线程安全的，如里需要，可以设置其他选项来告诉它要使用哪个锁，或者完全避开同步，如果该类永远不会在多线程环境中使用</p>\n<h4 id=\"实例委托属性\"><a href=\"#实例委托属性\" class=\"headerlink\" title=\"实例委托属性\"></a>实例委托属性</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String, age: <span class=\"built_in\">Int</span>, salary: <span class=\"built_in\">Int</span>): PropertyChangeAware() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> Delegates.observable(<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        prop, old, new -&gt;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$old</span> -&gt; <span class=\"variable\">$new</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: String <span class=\"keyword\">by</span> Delegates.observable(<span class=\"string\">\"&lt;no name&gt;\"</span>) &#123;</span><br><span class=\"line\">        prop, old, new -&gt;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$old</span> -&gt; <span class=\"variable\">$new</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>如果你想能够截获一个赋值并做一些条件判断，可以使用<code>vetoable</code>代替<code>observable</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> name: String, age: <span class=\"built_in\">Int</span>, salary: <span class=\"built_in\">Int</span>): PropertyChangeAware() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> Delegates.observable(<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        prop, old, new -&gt;</span><br><span class=\"line\">        new &gt; old</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>把属性储存在Map中</strong></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> map: Map&lt;String, Any?) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> name: String <span class=\"keyword\">by</span> map</span><br><span class=\"line\">    <span class=\"keyword\">val</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> map</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 属性的名称自动用作map中的键</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> person = Person(mapOf(<span class=\"string\">\"name\"</span> to <span class=\"string\">\"John Doe\"</span>, <span class=\"string\">\"age\"</span> to <span class=\"number\">25</span>))</span><br><span class=\"line\">person.name</span><br><span class=\"line\">person.age</span><br></pre></td></tr></table></figure>\n<p>这也适用于<code>var</code>属性，只需把<code>map</code>换成<code>mutableMap</code></p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> map: mutableMap&lt;String, Any?) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> name: String <span class=\"keyword\">by</span> map</span><br><span class=\"line\">    <span class=\"keyword\">var</span> age: <span class=\"built_in\">Int</span> <span class=\"keyword\">by</span> map</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Kotlin扩展","date":"2018-03-13T03:36:48.000Z","_content":"","source":"_posts/android/kotlin-extensions.md","raw":"---\ntitle: Kotlin扩展\ndate: 2018-03-13 11:36:48\ntags:\n---\n","slug":"android/kotlin-extensions","published":1,"updated":"2018-05-20T13:04:25.683Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61es001jizcbzwjoue8h","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Kotlin操作符重载","date":"2018-03-02T08:42:35.000Z","_content":"\n### 操作符重载\n\n#### 一元操作符\n\n| 表达式   | 对应函数       |\n| -------- | -------------- |\n| +a       | a.unaryPlus()  |\n| -a       | a.unaryMinus() |\n| !a       | a.not()        |\n| ++a, a++ | a.inc()        |\n| --a, a-- | a.dec()        |\n\n<!--more-->\n\n示例：\n\n```kotlin\ndata class Point(val x: Int, val y: Int)\noperator fun Point.unaryMinus() = Point(-x, -y)\noperator fun Point.inc() = Point(x + 1, y + 1)\nvar p = Point(10, 20)\nprintln(-p) // Point(x=10, y=-20)\nprintln(++p) // Point(x=11, y=21)\n```\n\n#### 二元操作符\n\n| 表达式 | 对应函数                 |\n| ------ | ------------------------ |\n| a + b  | a.plus(b)                |\n| a - b  | a.minus(b)               |\n| a * b  | a.times(b)               |\n| a / b  | a.div(b)                 |\n| a % b  | a.rem(b)、a.mod(b)(弃用) |\n| a..b   | a.rangeTo(b)             |\n\n示例：\n\n```kotlin\ndata class Point(val x: Int, val y: Int) {\n    operator fun plus(other: Point): Point {\n        return Point(x + other.x, y + other.y)\n    }\n}\nval p1 = Point(10, 20)\nval p2 = Point(30, 40)\nprintln(p1 + p2) // Point(x=40, y=60)\n```\n\n#### 没有用于位运算的特殊运算符\n\n- shl — 带符号左移\n- shr — 带符号右移\n- ushr — 无符号右移\n- and — 按位与\n- or — 按位或\n- xor — 按位异或\n- inv — 按位取反\n\n示例：\n\n```kotlin\n// kotlin\nval num = 1 shl 4\nprintln(num) // 16\n==>\n// java\nint num = 1 << 4\n```\n\n#### in操作符\n\n| 表达式  | 对应函数       |\n| ------- | -------------- |\n| a in b  | b.contains(a)  |\n| a !in b | !b.contains(a) |\n\n示例：\n\n```kotlin\ndata class Rectangle(val upperLeft: Point, val lowerRight: Point)\noperator fun Rectangle.contains(p: Point): Boolean {\n    return p.x in upperLeft.x until lowerRight.x &&\n    \tp.y in upperLeft.y until lowerRight.y\n}\nval rect = Rectangle(Point(10, 20), Point(50, 50))\nprintln(Point(20, 30) in rect) // true\n```\n\n#### 下标访问操作符(通过下标来访问元素：`get` 和 `set`)\n\n| 表达式               | 对应函数                |\n| -------------------- | ----------------------- |\n| a[i]                 | a.get(i)                |\n| a[i, j]              | a.get(i, j)             |\n| a[i_1, …, i-n]       | a.get( i_1, ..., i_n)   |\n| a[i] = b             | a.set(i, b)             |\n| a[i, j] = b          | a.set(i, j, b)          |\n| a[i_1, ..., i_n] = b | a.set(i_1, ..., i_n, b) |\n\n示例：\n\n```kotlin\n// 一维\noperator fun Point.get(index: Int): Int {\n    return when(index) {\n        0 -> x\n        1 -> y\n        else -> throw IndexOutOfBoundsException(\"Invalid coordinate $index\")\n    }\n}\n\nval p = Point(10, 20)\nprintln(p[1]) // 20\n\n// 二维\ndata class MutablePoint(var x: Int, var y: Int)\noperator fun MutablePoint.set(index: Int, value: Int) {\n    when(index) {\n        0 -> x = value\n        1 -> y = value\n        else -> \n        \tthrow IndexOutOfBoundsException(\"Invalid coordinate $index\")\n    }\n}\nval p = MutablePoint(10, 20)\np[1] = 42\nprintln(p) // MutablePoint(x=10, y=42)\n```\n\n#### 调用操作符(invoke)\n\n| 表达式         | 对应函数              |\n| -------------- | --------------------- |\n| a()            | a.invoke()            |\n| a(i)           | a.invoke(i)           |\n| a(i, j)        | a.invoke(i, j)        |\n| a(i_i, …, i_n) | a.invoke(i_1, …, i_n) |\n\n圆括号转换为调用带有适当数量参数的 `invoke`\n\n示例：\n\n```kotlin\nclass Greeter(val greeting: String) {\n    operator fun invoke(name: String) {\n        println(\"$greeting, $name!\")\n    }\n}\n\nval bavarianGreeter = Greeter(\"Servus\") \nbavarianGreeter(\"Dmitry\") // Servus, Dmitry!\n==>\nval bavarianGreeter = Greeter(\"Servus\")(\"Dmitry\") // Servus, Dmitry!\n```\n\n可以通过重写`invoke`实例工厂模式\n\n```kotlin\nobject Any {\n\toperator fun invoke(name: String): String {\n\t\treturn name\n\t}\n\t\n\toperator fun invoke(number: Int): Int {\n\t\treturn number\n\t}\n}\nval string = Any(\"Hello World!\");\nval int = Any(\"1\");\nprintln(\"$string, $int\") // Hello World! 1\n```\n\n#### 复合赋值运算符\n\n| 表达式 | 对应函数                               |\n| ------ | -------------------------------------- |\n| a += b | a.plusAssign(b)                        |\n| a -= b | a.minusAssign(b)                       |\n| a *= b | a.timesAssign(b)                       |\n| a /= b | a.divAssign(b)                         |\n| a %= b | a.remAssign(b),  a.modAssign(b) (弃用) |\n\n示例：\n\n```kotlin\noperator fun <T> MutableCollection<T>.plusAssign(element: T) {\n\tthis.add(element)\n}\nval list = arrayListOf(1, 2)\nlist += 3\nval newList = list + listOf(4, 5)\nprintln(list) // [1, 2, 3]\nprintln(newList) // [1, 2, 3, 4, 5]\n```\n\n#### 比较运算符(equals)\n\n| 表达式 | 对应函数                         |\n| ------ | -------------------------------- |\n| a == b | a?.equals(b)  ?:  (b === null)   |\n| a != b | !(a?.equals(b))  ?:  (b ===null) |\n\n(等式校验 `==` 被转换为`equals`函数的调用，以及`null`的校验)\n\n*注意*：`===` 和 `!==`（同一性检查）不可重载，因此不存在对他们的约定。\n\n这个 `==` 操作符有些特殊：它被翻译成一个复杂的表达式，用于筛选 `null` 值。 `null == null` 总是 true，对于非空的 `x`，`x == null` 总是 false 而不会调用 `x.equals()`。\n\n示例：\n\n```kotlin\nclass Point(val x: Int, val y: Int) {\n    override fun equals(obj: Any?): Boolean {\n        if (obj === this) return true\n        if (obj !is Point) return false\n        return obj.x == x && obj.y == y\n    }\n}\nprintln(Point(10, 20) == Point(10, 20)) // true\nprintln(Point(10, 20) != Point(5, 5)) // true\nprintln(null == Point(1, 2)) // false\n```\n\n#### 比较操作符(compareTo)\n\n| 表达式 | 对应函数            |\n| ------ | ------------------- |\n| a > b  | a.compareTo(b) > 0  |\n| a < b  | a.compareTo(b) < 0  |\n| a >= b | a.compareTo(b) >= 0 |\n| a <= b | a.compareTo(b) <= 0 |\n\n所有的比较都转换为对 `compareTo` 的调用，这个函数需要返回 `Int` 值\n\n示例：\n\n```kotlin\nclass Person(val firstName: String, val lastName: String): Comparable<Person> {\n    override fun compareTo(other: Person): Int {\n        return compareValuesBy(this, other, Person::lastName, Person::firstName)\n    }\n}\nval p1 = Person(\"Alice\", \"Smith\")\nval p2 = Person(\"Bob\", \"Johnson\")\nprintln(p1 < p2) // false\n```\n\n> 参考资料：\n>\n> [Kotlin in Action](https://www.manning.com/books/kotlin-in-action)\n>\n> [Operator overloading](http://kotlinlang.org/docs/reference/operator-overloading.html#assignments)\n\n","source":"_posts/android/kotlin-operator.md","raw":"---\ntitle: Kotlin操作符重载\ndate: 2018-03-02 16:42:35\ntags: [android, kotlin]\n---\n\n### 操作符重载\n\n#### 一元操作符\n\n| 表达式   | 对应函数       |\n| -------- | -------------- |\n| +a       | a.unaryPlus()  |\n| -a       | a.unaryMinus() |\n| !a       | a.not()        |\n| ++a, a++ | a.inc()        |\n| --a, a-- | a.dec()        |\n\n<!--more-->\n\n示例：\n\n```kotlin\ndata class Point(val x: Int, val y: Int)\noperator fun Point.unaryMinus() = Point(-x, -y)\noperator fun Point.inc() = Point(x + 1, y + 1)\nvar p = Point(10, 20)\nprintln(-p) // Point(x=10, y=-20)\nprintln(++p) // Point(x=11, y=21)\n```\n\n#### 二元操作符\n\n| 表达式 | 对应函数                 |\n| ------ | ------------------------ |\n| a + b  | a.plus(b)                |\n| a - b  | a.minus(b)               |\n| a * b  | a.times(b)               |\n| a / b  | a.div(b)                 |\n| a % b  | a.rem(b)、a.mod(b)(弃用) |\n| a..b   | a.rangeTo(b)             |\n\n示例：\n\n```kotlin\ndata class Point(val x: Int, val y: Int) {\n    operator fun plus(other: Point): Point {\n        return Point(x + other.x, y + other.y)\n    }\n}\nval p1 = Point(10, 20)\nval p2 = Point(30, 40)\nprintln(p1 + p2) // Point(x=40, y=60)\n```\n\n#### 没有用于位运算的特殊运算符\n\n- shl — 带符号左移\n- shr — 带符号右移\n- ushr — 无符号右移\n- and — 按位与\n- or — 按位或\n- xor — 按位异或\n- inv — 按位取反\n\n示例：\n\n```kotlin\n// kotlin\nval num = 1 shl 4\nprintln(num) // 16\n==>\n// java\nint num = 1 << 4\n```\n\n#### in操作符\n\n| 表达式  | 对应函数       |\n| ------- | -------------- |\n| a in b  | b.contains(a)  |\n| a !in b | !b.contains(a) |\n\n示例：\n\n```kotlin\ndata class Rectangle(val upperLeft: Point, val lowerRight: Point)\noperator fun Rectangle.contains(p: Point): Boolean {\n    return p.x in upperLeft.x until lowerRight.x &&\n    \tp.y in upperLeft.y until lowerRight.y\n}\nval rect = Rectangle(Point(10, 20), Point(50, 50))\nprintln(Point(20, 30) in rect) // true\n```\n\n#### 下标访问操作符(通过下标来访问元素：`get` 和 `set`)\n\n| 表达式               | 对应函数                |\n| -------------------- | ----------------------- |\n| a[i]                 | a.get(i)                |\n| a[i, j]              | a.get(i, j)             |\n| a[i_1, …, i-n]       | a.get( i_1, ..., i_n)   |\n| a[i] = b             | a.set(i, b)             |\n| a[i, j] = b          | a.set(i, j, b)          |\n| a[i_1, ..., i_n] = b | a.set(i_1, ..., i_n, b) |\n\n示例：\n\n```kotlin\n// 一维\noperator fun Point.get(index: Int): Int {\n    return when(index) {\n        0 -> x\n        1 -> y\n        else -> throw IndexOutOfBoundsException(\"Invalid coordinate $index\")\n    }\n}\n\nval p = Point(10, 20)\nprintln(p[1]) // 20\n\n// 二维\ndata class MutablePoint(var x: Int, var y: Int)\noperator fun MutablePoint.set(index: Int, value: Int) {\n    when(index) {\n        0 -> x = value\n        1 -> y = value\n        else -> \n        \tthrow IndexOutOfBoundsException(\"Invalid coordinate $index\")\n    }\n}\nval p = MutablePoint(10, 20)\np[1] = 42\nprintln(p) // MutablePoint(x=10, y=42)\n```\n\n#### 调用操作符(invoke)\n\n| 表达式         | 对应函数              |\n| -------------- | --------------------- |\n| a()            | a.invoke()            |\n| a(i)           | a.invoke(i)           |\n| a(i, j)        | a.invoke(i, j)        |\n| a(i_i, …, i_n) | a.invoke(i_1, …, i_n) |\n\n圆括号转换为调用带有适当数量参数的 `invoke`\n\n示例：\n\n```kotlin\nclass Greeter(val greeting: String) {\n    operator fun invoke(name: String) {\n        println(\"$greeting, $name!\")\n    }\n}\n\nval bavarianGreeter = Greeter(\"Servus\") \nbavarianGreeter(\"Dmitry\") // Servus, Dmitry!\n==>\nval bavarianGreeter = Greeter(\"Servus\")(\"Dmitry\") // Servus, Dmitry!\n```\n\n可以通过重写`invoke`实例工厂模式\n\n```kotlin\nobject Any {\n\toperator fun invoke(name: String): String {\n\t\treturn name\n\t}\n\t\n\toperator fun invoke(number: Int): Int {\n\t\treturn number\n\t}\n}\nval string = Any(\"Hello World!\");\nval int = Any(\"1\");\nprintln(\"$string, $int\") // Hello World! 1\n```\n\n#### 复合赋值运算符\n\n| 表达式 | 对应函数                               |\n| ------ | -------------------------------------- |\n| a += b | a.plusAssign(b)                        |\n| a -= b | a.minusAssign(b)                       |\n| a *= b | a.timesAssign(b)                       |\n| a /= b | a.divAssign(b)                         |\n| a %= b | a.remAssign(b),  a.modAssign(b) (弃用) |\n\n示例：\n\n```kotlin\noperator fun <T> MutableCollection<T>.plusAssign(element: T) {\n\tthis.add(element)\n}\nval list = arrayListOf(1, 2)\nlist += 3\nval newList = list + listOf(4, 5)\nprintln(list) // [1, 2, 3]\nprintln(newList) // [1, 2, 3, 4, 5]\n```\n\n#### 比较运算符(equals)\n\n| 表达式 | 对应函数                         |\n| ------ | -------------------------------- |\n| a == b | a?.equals(b)  ?:  (b === null)   |\n| a != b | !(a?.equals(b))  ?:  (b ===null) |\n\n(等式校验 `==` 被转换为`equals`函数的调用，以及`null`的校验)\n\n*注意*：`===` 和 `!==`（同一性检查）不可重载，因此不存在对他们的约定。\n\n这个 `==` 操作符有些特殊：它被翻译成一个复杂的表达式，用于筛选 `null` 值。 `null == null` 总是 true，对于非空的 `x`，`x == null` 总是 false 而不会调用 `x.equals()`。\n\n示例：\n\n```kotlin\nclass Point(val x: Int, val y: Int) {\n    override fun equals(obj: Any?): Boolean {\n        if (obj === this) return true\n        if (obj !is Point) return false\n        return obj.x == x && obj.y == y\n    }\n}\nprintln(Point(10, 20) == Point(10, 20)) // true\nprintln(Point(10, 20) != Point(5, 5)) // true\nprintln(null == Point(1, 2)) // false\n```\n\n#### 比较操作符(compareTo)\n\n| 表达式 | 对应函数            |\n| ------ | ------------------- |\n| a > b  | a.compareTo(b) > 0  |\n| a < b  | a.compareTo(b) < 0  |\n| a >= b | a.compareTo(b) >= 0 |\n| a <= b | a.compareTo(b) <= 0 |\n\n所有的比较都转换为对 `compareTo` 的调用，这个函数需要返回 `Int` 值\n\n示例：\n\n```kotlin\nclass Person(val firstName: String, val lastName: String): Comparable<Person> {\n    override fun compareTo(other: Person): Int {\n        return compareValuesBy(this, other, Person::lastName, Person::firstName)\n    }\n}\nval p1 = Person(\"Alice\", \"Smith\")\nval p2 = Person(\"Bob\", \"Johnson\")\nprintln(p1 < p2) // false\n```\n\n> 参考资料：\n>\n> [Kotlin in Action](https://www.manning.com/books/kotlin-in-action)\n>\n> [Operator overloading](http://kotlinlang.org/docs/reference/operator-overloading.html#assignments)\n\n","slug":"android/kotlin-operator","published":1,"updated":"2018-05-20T13:04:25.683Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61et001mizcbsryh9zjz","content":"<h3 id=\"操作符重载\"><a href=\"#操作符重载\" class=\"headerlink\" title=\"操作符重载\"></a>操作符重载</h3><h4 id=\"一元操作符\"><a href=\"#一元操作符\" class=\"headerlink\" title=\"一元操作符\"></a>一元操作符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>+a</td>\n<td>a.unaryPlus()</td>\n</tr>\n<tr>\n<td>-a</td>\n<td>a.unaryMinus()</td>\n</tr>\n<tr>\n<td>!a</td>\n<td>a.not()</td>\n</tr>\n<tr>\n<td>++a, a++</td>\n<td>a.inc()</td>\n</tr>\n<tr>\n<td>–a, a–</td>\n<td>a.dec()</td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">val</span> y: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Point.<span class=\"title\">unaryMinus</span><span class=\"params\">()</span></span> = Point(-x, -y)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Point.<span class=\"title\">inc</span><span class=\"params\">()</span></span> = Point(x + <span class=\"number\">1</span>, y + <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> p = Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">println(-p) <span class=\"comment\">// Point(x=10, y=-20)</span></span><br><span class=\"line\">println(++p) <span class=\"comment\">// Point(x=11, y=21)</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"二元操作符\"><a href=\"#二元操作符\" class=\"headerlink\" title=\"二元操作符\"></a>二元操作符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a + b</td>\n<td>a.plus(b)</td>\n</tr>\n<tr>\n<td>a - b</td>\n<td>a.minus(b)</td>\n</tr>\n<tr>\n<td>a * b</td>\n<td>a.times(b)</td>\n</tr>\n<tr>\n<td>a / b</td>\n<td>a.div(b)</td>\n</tr>\n<tr>\n<td>a % b</td>\n<td>a.rem(b)、a.mod(b)(弃用)</td>\n</tr>\n<tr>\n<td>a..b</td>\n<td>a.rangeTo(b)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">val</span> y: <span class=\"built_in\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">plus</span><span class=\"params\">(other: <span class=\"type\">Point</span>)</span></span>: Point &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Point(x + other.x, y + other.y)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p1 = Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> p2 = Point(<span class=\"number\">30</span>, <span class=\"number\">40</span>)</span><br><span class=\"line\">println(p1 + p2) <span class=\"comment\">// Point(x=40, y=60)</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"没有用于位运算的特殊运算符\"><a href=\"#没有用于位运算的特殊运算符\" class=\"headerlink\" title=\"没有用于位运算的特殊运算符\"></a>没有用于位运算的特殊运算符</h4><ul>\n<li>shl — 带符号左移</li>\n<li>shr — 带符号右移</li>\n<li>ushr — 无符号右移</li>\n<li>and — 按位与</li>\n<li>or — 按位或</li>\n<li>xor — 按位异或</li>\n<li>inv — 按位取反</li>\n</ul>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// kotlin</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> num = <span class=\"number\">1</span> shl <span class=\"number\">4</span></span><br><span class=\"line\">println(num) <span class=\"comment\">// 16</span></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"comment\">// java</span></span><br><span class=\"line\">int num = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"in操作符\"><a href=\"#in操作符\" class=\"headerlink\" title=\"in操作符\"></a>in操作符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a in b</td>\n<td>b.contains(a)</td>\n</tr>\n<tr>\n<td>a !in b</td>\n<td>!b.contains(a)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Rectangle</span></span>(<span class=\"keyword\">val</span> upperLeft: Point, <span class=\"keyword\">val</span> lowerRight: Point)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Rectangle.<span class=\"title\">contains</span><span class=\"params\">(p: <span class=\"type\">Point</span>)</span></span>: <span class=\"built_in\">Boolean</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.x <span class=\"keyword\">in</span> upperLeft.x until lowerRight.x &amp;&amp;</span><br><span class=\"line\">    \tp.y <span class=\"keyword\">in</span> upperLeft.y until lowerRight.y</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> rect = Rectangle(Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>), Point(<span class=\"number\">50</span>, <span class=\"number\">50</span>))</span><br><span class=\"line\">println(Point(<span class=\"number\">20</span>, <span class=\"number\">30</span>) <span class=\"keyword\">in</span> rect) <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"下标访问操作符-通过下标来访问元素：get-和-set\"><a href=\"#下标访问操作符-通过下标来访问元素：get-和-set\" class=\"headerlink\" title=\"下标访问操作符(通过下标来访问元素：get 和 set)\"></a>下标访问操作符(通过下标来访问元素：<code>get</code> 和 <code>set</code>)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a[i]</td>\n<td>a.get(i)</td>\n</tr>\n<tr>\n<td>a[i, j]</td>\n<td>a.get(i, j)</td>\n</tr>\n<tr>\n<td>a[i_1, …, i-n]</td>\n<td>a.get( i_1, …, i_n)</td>\n</tr>\n<tr>\n<td>a[i] = b</td>\n<td>a.set(i, b)</td>\n</tr>\n<tr>\n<td>a[i, j] = b</td>\n<td>a.set(i, j, b)</td>\n</tr>\n<tr>\n<td>a[i_1, …, i_n] = b</td>\n<td>a.set(i_1, …, i_n, b)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 一维</span></span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Point.<span class=\"title\">get</span><span class=\"params\">(index: <span class=\"type\">Int</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">when</span>(index) &#123;</span><br><span class=\"line\">        <span class=\"number\">0</span> -&gt; x</span><br><span class=\"line\">        <span class=\"number\">1</span> -&gt; y</span><br><span class=\"line\">        <span class=\"keyword\">else</span> -&gt; <span class=\"keyword\">throw</span> IndexOutOfBoundsException(<span class=\"string\">\"Invalid coordinate <span class=\"variable\">$index</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> p = Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">println(p[<span class=\"number\">1</span>]) <span class=\"comment\">// 20</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 二维</span></span><br><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MutablePoint</span></span>(<span class=\"keyword\">var</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">var</span> y: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> MutablePoint.<span class=\"title\">set</span><span class=\"params\">(index: <span class=\"type\">Int</span>, value: <span class=\"type\">Int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">when</span>(index) &#123;</span><br><span class=\"line\">        <span class=\"number\">0</span> -&gt; x = value</span><br><span class=\"line\">        <span class=\"number\">1</span> -&gt; y = value</span><br><span class=\"line\">        <span class=\"keyword\">else</span> -&gt; </span><br><span class=\"line\">        \t<span class=\"keyword\">throw</span> IndexOutOfBoundsException(<span class=\"string\">\"Invalid coordinate <span class=\"variable\">$index</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p = MutablePoint(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">p[<span class=\"number\">1</span>] = <span class=\"number\">42</span></span><br><span class=\"line\">println(p) <span class=\"comment\">// MutablePoint(x=10, y=42)</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"调用操作符-invoke\"><a href=\"#调用操作符-invoke\" class=\"headerlink\" title=\"调用操作符(invoke)\"></a>调用操作符(invoke)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a()</td>\n<td>a.invoke()</td>\n</tr>\n<tr>\n<td>a(i)</td>\n<td>a.invoke(i)</td>\n</tr>\n<tr>\n<td>a(i, j)</td>\n<td>a.invoke(i, j)</td>\n</tr>\n<tr>\n<td>a(i_i, …, i_n)</td>\n<td>a.invoke(i_1, …, i_n)</td>\n</tr>\n</tbody>\n</table>\n<p>圆括号转换为调用带有适当数量参数的 <code>invoke</code></p>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Greeter</span></span>(<span class=\"keyword\">val</span> greeting: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">invoke</span><span class=\"params\">(name: <span class=\"type\">String</span>)</span></span> &#123;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$greeting</span>, <span class=\"variable\">$name</span>!\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> bavarianGreeter = Greeter(<span class=\"string\">\"Servus\"</span>) </span><br><span class=\"line\">bavarianGreeter(<span class=\"string\">\"Dmitry\"</span>) <span class=\"comment\">// Servus, Dmitry!</span></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">val</span> bavarianGreeter = Greeter(<span class=\"string\">\"Servus\"</span>)(<span class=\"string\">\"Dmitry\"</span>) <span class=\"comment\">// Servus, Dmitry!</span></span><br></pre></td></tr></table></figure>\n<p>可以通过重写<code>invoke</code>实例工厂模式</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">object</span> Any &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">invoke</span><span class=\"params\">(name: <span class=\"type\">String</span>)</span></span>: String &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> name</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">invoke</span><span class=\"params\">(number: <span class=\"type\">Int</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> number</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> string = Any(<span class=\"string\">\"Hello World!\"</span>);</span><br><span class=\"line\"><span class=\"keyword\">val</span> int = Any(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">println(<span class=\"string\">\"<span class=\"variable\">$string</span>, <span class=\"variable\">$int</span>\"</span>) <span class=\"comment\">// Hello World! 1</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"复合赋值运算符\"><a href=\"#复合赋值运算符\" class=\"headerlink\" title=\"复合赋值运算符\"></a>复合赋值运算符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a += b</td>\n<td>a.plusAssign(b)</td>\n</tr>\n<tr>\n<td>a -= b</td>\n<td>a.minusAssign(b)</td>\n</tr>\n<tr>\n<td>a *= b</td>\n<td>a.timesAssign(b)</td>\n</tr>\n<tr>\n<td>a /= b</td>\n<td>a.divAssign(b)</td>\n</tr>\n<tr>\n<td>a %= b</td>\n<td>a.remAssign(b),  a.modAssign(b) (弃用)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T&gt;</span> MutableCollection<span class=\"type\">&lt;T&gt;</span>.<span class=\"title\">plusAssign</span><span class=\"params\">(element: <span class=\"type\">T</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.add(element)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> list = arrayListOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">list += <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> newList = list + listOf(<span class=\"number\">4</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">println(list) <span class=\"comment\">// [1, 2, 3]</span></span><br><span class=\"line\">println(newList) <span class=\"comment\">// [1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"比较运算符-equals\"><a href=\"#比较运算符-equals\" class=\"headerlink\" title=\"比较运算符(equals)\"></a>比较运算符(equals)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a == b</td>\n<td>a?.equals(b)  ?:  (b === null)</td>\n</tr>\n<tr>\n<td>a != b</td>\n<td>!(a?.equals(b))  ?:  (b ===null)</td>\n</tr>\n</tbody>\n</table>\n<p>(等式校验 <code>==</code> 被转换为<code>equals</code>函数的调用，以及<code>null</code>的校验)</p>\n<p><em>注意</em>：<code>===</code> 和 <code>!==</code>（同一性检查）不可重载，因此不存在对他们的约定。</p>\n<p>这个 <code>==</code> 操作符有些特殊：它被翻译成一个复杂的表达式，用于筛选 <code>null</code> 值。 <code>null == null</code> 总是 true，对于非空的 <code>x</code>，<code>x == null</code> 总是 false 而不会调用 <code>x.equals()</code>。</p>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">val</span> y: <span class=\"built_in\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">equals</span><span class=\"params\">(obj: <span class=\"type\">Any</span>?)</span></span>: <span class=\"built_in\">Boolean</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (obj === <span class=\"keyword\">this</span>) <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (obj !<span class=\"keyword\">is</span> Point) <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> obj.x == x &amp;&amp; obj.y == y</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">println(Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>) == Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)) <span class=\"comment\">// true</span></span><br><span class=\"line\">println(Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>) != Point(<span class=\"number\">5</span>, <span class=\"number\">5</span>)) <span class=\"comment\">// true</span></span><br><span class=\"line\">println(<span class=\"literal\">null</span> == Point(<span class=\"number\">1</span>, <span class=\"number\">2</span>)) <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"比较操作符-compareTo\"><a href=\"#比较操作符-compareTo\" class=\"headerlink\" title=\"比较操作符(compareTo)\"></a>比较操作符(compareTo)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a &gt; b</td>\n<td>a.compareTo(b) &gt; 0</td>\n</tr>\n<tr>\n<td>a &lt; b</td>\n<td>a.compareTo(b) &lt; 0</td>\n</tr>\n<tr>\n<td>a &gt;= b</td>\n<td>a.compareTo(b) &gt;= 0</td>\n</tr>\n<tr>\n<td>a &lt;= b</td>\n<td>a.compareTo(b) &lt;= 0</td>\n</tr>\n</tbody>\n</table>\n<p>所有的比较都转换为对 <code>compareTo</code> 的调用，这个函数需要返回 <code>Int</code> 值</p>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> firstName: String, <span class=\"keyword\">val</span> lastName: String): Comparable&lt;Person&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">compareTo</span><span class=\"params\">(other: <span class=\"type\">Person</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> compareValuesBy(<span class=\"keyword\">this</span>, other, Person::lastName, Person::firstName)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p1 = Person(<span class=\"string\">\"Alice\"</span>, <span class=\"string\">\"Smith\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> p2 = Person(<span class=\"string\">\"Bob\"</span>, <span class=\"string\">\"Johnson\"</span>)</span><br><span class=\"line\">println(p1 &lt; p2) <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>参考资料：</p>\n<p><a href=\"https://www.manning.com/books/kotlin-in-action\" target=\"_blank\" rel=\"noopener\">Kotlin in Action</a></p>\n<p><a href=\"http://kotlinlang.org/docs/reference/operator-overloading.html#assignments\" target=\"_blank\" rel=\"noopener\">Operator overloading</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<h3 id=\"操作符重载\"><a href=\"#操作符重载\" class=\"headerlink\" title=\"操作符重载\"></a>操作符重载</h3><h4 id=\"一元操作符\"><a href=\"#一元操作符\" class=\"headerlink\" title=\"一元操作符\"></a>一元操作符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>+a</td>\n<td>a.unaryPlus()</td>\n</tr>\n<tr>\n<td>-a</td>\n<td>a.unaryMinus()</td>\n</tr>\n<tr>\n<td>!a</td>\n<td>a.not()</td>\n</tr>\n<tr>\n<td>++a, a++</td>\n<td>a.inc()</td>\n</tr>\n<tr>\n<td>–a, a–</td>\n<td>a.dec()</td>\n</tr>\n</tbody>\n</table>","more":"<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">val</span> y: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Point.<span class=\"title\">unaryMinus</span><span class=\"params\">()</span></span> = Point(-x, -y)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Point.<span class=\"title\">inc</span><span class=\"params\">()</span></span> = Point(x + <span class=\"number\">1</span>, y + <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> p = Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">println(-p) <span class=\"comment\">// Point(x=10, y=-20)</span></span><br><span class=\"line\">println(++p) <span class=\"comment\">// Point(x=11, y=21)</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"二元操作符\"><a href=\"#二元操作符\" class=\"headerlink\" title=\"二元操作符\"></a>二元操作符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a + b</td>\n<td>a.plus(b)</td>\n</tr>\n<tr>\n<td>a - b</td>\n<td>a.minus(b)</td>\n</tr>\n<tr>\n<td>a * b</td>\n<td>a.times(b)</td>\n</tr>\n<tr>\n<td>a / b</td>\n<td>a.div(b)</td>\n</tr>\n<tr>\n<td>a % b</td>\n<td>a.rem(b)、a.mod(b)(弃用)</td>\n</tr>\n<tr>\n<td>a..b</td>\n<td>a.rangeTo(b)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">val</span> y: <span class=\"built_in\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">plus</span><span class=\"params\">(other: <span class=\"type\">Point</span>)</span></span>: Point &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Point(x + other.x, y + other.y)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p1 = Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> p2 = Point(<span class=\"number\">30</span>, <span class=\"number\">40</span>)</span><br><span class=\"line\">println(p1 + p2) <span class=\"comment\">// Point(x=40, y=60)</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"没有用于位运算的特殊运算符\"><a href=\"#没有用于位运算的特殊运算符\" class=\"headerlink\" title=\"没有用于位运算的特殊运算符\"></a>没有用于位运算的特殊运算符</h4><ul>\n<li>shl — 带符号左移</li>\n<li>shr — 带符号右移</li>\n<li>ushr — 无符号右移</li>\n<li>and — 按位与</li>\n<li>or — 按位或</li>\n<li>xor — 按位异或</li>\n<li>inv — 按位取反</li>\n</ul>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// kotlin</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> num = <span class=\"number\">1</span> shl <span class=\"number\">4</span></span><br><span class=\"line\">println(num) <span class=\"comment\">// 16</span></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"comment\">// java</span></span><br><span class=\"line\">int num = <span class=\"number\">1</span> &lt;&lt; <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"in操作符\"><a href=\"#in操作符\" class=\"headerlink\" title=\"in操作符\"></a>in操作符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a in b</td>\n<td>b.contains(a)</td>\n</tr>\n<tr>\n<td>a !in b</td>\n<td>!b.contains(a)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Rectangle</span></span>(<span class=\"keyword\">val</span> upperLeft: Point, <span class=\"keyword\">val</span> lowerRight: Point)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Rectangle.<span class=\"title\">contains</span><span class=\"params\">(p: <span class=\"type\">Point</span>)</span></span>: <span class=\"built_in\">Boolean</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> p.x <span class=\"keyword\">in</span> upperLeft.x until lowerRight.x &amp;&amp;</span><br><span class=\"line\">    \tp.y <span class=\"keyword\">in</span> upperLeft.y until lowerRight.y</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> rect = Rectangle(Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>), Point(<span class=\"number\">50</span>, <span class=\"number\">50</span>))</span><br><span class=\"line\">println(Point(<span class=\"number\">20</span>, <span class=\"number\">30</span>) <span class=\"keyword\">in</span> rect) <span class=\"comment\">// true</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"下标访问操作符-通过下标来访问元素：get-和-set\"><a href=\"#下标访问操作符-通过下标来访问元素：get-和-set\" class=\"headerlink\" title=\"下标访问操作符(通过下标来访问元素：get 和 set)\"></a>下标访问操作符(通过下标来访问元素：<code>get</code> 和 <code>set</code>)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a[i]</td>\n<td>a.get(i)</td>\n</tr>\n<tr>\n<td>a[i, j]</td>\n<td>a.get(i, j)</td>\n</tr>\n<tr>\n<td>a[i_1, …, i-n]</td>\n<td>a.get( i_1, …, i_n)</td>\n</tr>\n<tr>\n<td>a[i] = b</td>\n<td>a.set(i, b)</td>\n</tr>\n<tr>\n<td>a[i, j] = b</td>\n<td>a.set(i, j, b)</td>\n</tr>\n<tr>\n<td>a[i_1, …, i_n] = b</td>\n<td>a.set(i_1, …, i_n, b)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 一维</span></span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> Point.<span class=\"title\">get</span><span class=\"params\">(index: <span class=\"type\">Int</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">when</span>(index) &#123;</span><br><span class=\"line\">        <span class=\"number\">0</span> -&gt; x</span><br><span class=\"line\">        <span class=\"number\">1</span> -&gt; y</span><br><span class=\"line\">        <span class=\"keyword\">else</span> -&gt; <span class=\"keyword\">throw</span> IndexOutOfBoundsException(<span class=\"string\">\"Invalid coordinate <span class=\"variable\">$index</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> p = Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">println(p[<span class=\"number\">1</span>]) <span class=\"comment\">// 20</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 二维</span></span><br><span class=\"line\"><span class=\"keyword\">data</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MutablePoint</span></span>(<span class=\"keyword\">var</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">var</span> y: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> MutablePoint.<span class=\"title\">set</span><span class=\"params\">(index: <span class=\"type\">Int</span>, value: <span class=\"type\">Int</span>)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">when</span>(index) &#123;</span><br><span class=\"line\">        <span class=\"number\">0</span> -&gt; x = value</span><br><span class=\"line\">        <span class=\"number\">1</span> -&gt; y = value</span><br><span class=\"line\">        <span class=\"keyword\">else</span> -&gt; </span><br><span class=\"line\">        \t<span class=\"keyword\">throw</span> IndexOutOfBoundsException(<span class=\"string\">\"Invalid coordinate <span class=\"variable\">$index</span>\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p = MutablePoint(<span class=\"number\">10</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">p[<span class=\"number\">1</span>] = <span class=\"number\">42</span></span><br><span class=\"line\">println(p) <span class=\"comment\">// MutablePoint(x=10, y=42)</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"调用操作符-invoke\"><a href=\"#调用操作符-invoke\" class=\"headerlink\" title=\"调用操作符(invoke)\"></a>调用操作符(invoke)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a()</td>\n<td>a.invoke()</td>\n</tr>\n<tr>\n<td>a(i)</td>\n<td>a.invoke(i)</td>\n</tr>\n<tr>\n<td>a(i, j)</td>\n<td>a.invoke(i, j)</td>\n</tr>\n<tr>\n<td>a(i_i, …, i_n)</td>\n<td>a.invoke(i_1, …, i_n)</td>\n</tr>\n</tbody>\n</table>\n<p>圆括号转换为调用带有适当数量参数的 <code>invoke</code></p>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Greeter</span></span>(<span class=\"keyword\">val</span> greeting: String) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">invoke</span><span class=\"params\">(name: <span class=\"type\">String</span>)</span></span> &#123;</span><br><span class=\"line\">        println(<span class=\"string\">\"<span class=\"variable\">$greeting</span>, <span class=\"variable\">$name</span>!\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> bavarianGreeter = Greeter(<span class=\"string\">\"Servus\"</span>) </span><br><span class=\"line\">bavarianGreeter(<span class=\"string\">\"Dmitry\"</span>) <span class=\"comment\">// Servus, Dmitry!</span></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">val</span> bavarianGreeter = Greeter(<span class=\"string\">\"Servus\"</span>)(<span class=\"string\">\"Dmitry\"</span>) <span class=\"comment\">// Servus, Dmitry!</span></span><br></pre></td></tr></table></figure>\n<p>可以通过重写<code>invoke</code>实例工厂模式</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">object</span> Any &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">invoke</span><span class=\"params\">(name: <span class=\"type\">String</span>)</span></span>: String &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> name</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">invoke</span><span class=\"params\">(number: <span class=\"type\">Int</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> number</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> string = Any(<span class=\"string\">\"Hello World!\"</span>);</span><br><span class=\"line\"><span class=\"keyword\">val</span> int = Any(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">println(<span class=\"string\">\"<span class=\"variable\">$string</span>, <span class=\"variable\">$int</span>\"</span>) <span class=\"comment\">// Hello World! 1</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"复合赋值运算符\"><a href=\"#复合赋值运算符\" class=\"headerlink\" title=\"复合赋值运算符\"></a>复合赋值运算符</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a += b</td>\n<td>a.plusAssign(b)</td>\n</tr>\n<tr>\n<td>a -= b</td>\n<td>a.minusAssign(b)</td>\n</tr>\n<tr>\n<td>a *= b</td>\n<td>a.timesAssign(b)</td>\n</tr>\n<tr>\n<td>a /= b</td>\n<td>a.divAssign(b)</td>\n</tr>\n<tr>\n<td>a %= b</td>\n<td>a.remAssign(b),  a.modAssign(b) (弃用)</td>\n</tr>\n</tbody>\n</table>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">operator</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T&gt;</span> MutableCollection<span class=\"type\">&lt;T&gt;</span>.<span class=\"title\">plusAssign</span><span class=\"params\">(element: <span class=\"type\">T</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">this</span>.add(element)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> list = arrayListOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">list += <span class=\"number\">3</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> newList = list + listOf(<span class=\"number\">4</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">println(list) <span class=\"comment\">// [1, 2, 3]</span></span><br><span class=\"line\">println(newList) <span class=\"comment\">// [1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"比较运算符-equals\"><a href=\"#比较运算符-equals\" class=\"headerlink\" title=\"比较运算符(equals)\"></a>比较运算符(equals)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a == b</td>\n<td>a?.equals(b)  ?:  (b === null)</td>\n</tr>\n<tr>\n<td>a != b</td>\n<td>!(a?.equals(b))  ?:  (b ===null)</td>\n</tr>\n</tbody>\n</table>\n<p>(等式校验 <code>==</code> 被转换为<code>equals</code>函数的调用，以及<code>null</code>的校验)</p>\n<p><em>注意</em>：<code>===</code> 和 <code>!==</code>（同一性检查）不可重载，因此不存在对他们的约定。</p>\n<p>这个 <code>==</code> 操作符有些特殊：它被翻译成一个复杂的表达式，用于筛选 <code>null</code> 值。 <code>null == null</code> 总是 true，对于非空的 <code>x</code>，<code>x == null</code> 总是 false 而不会调用 <code>x.equals()</code>。</p>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">val</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">val</span> y: <span class=\"built_in\">Int</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">equals</span><span class=\"params\">(obj: <span class=\"type\">Any</span>?)</span></span>: <span class=\"built_in\">Boolean</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (obj === <span class=\"keyword\">this</span>) <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (obj !<span class=\"keyword\">is</span> Point) <span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> obj.x == x &amp;&amp; obj.y == y</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">println(Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>) == Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>)) <span class=\"comment\">// true</span></span><br><span class=\"line\">println(Point(<span class=\"number\">10</span>, <span class=\"number\">20</span>) != Point(<span class=\"number\">5</span>, <span class=\"number\">5</span>)) <span class=\"comment\">// true</span></span><br><span class=\"line\">println(<span class=\"literal\">null</span> == Point(<span class=\"number\">1</span>, <span class=\"number\">2</span>)) <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"比较操作符-compareTo\"><a href=\"#比较操作符-compareTo\" class=\"headerlink\" title=\"比较操作符(compareTo)\"></a>比较操作符(compareTo)</h4><table>\n<thead>\n<tr>\n<th>表达式</th>\n<th>对应函数</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a &gt; b</td>\n<td>a.compareTo(b) &gt; 0</td>\n</tr>\n<tr>\n<td>a &lt; b</td>\n<td>a.compareTo(b) &lt; 0</td>\n</tr>\n<tr>\n<td>a &gt;= b</td>\n<td>a.compareTo(b) &gt;= 0</td>\n</tr>\n<tr>\n<td>a &lt;= b</td>\n<td>a.compareTo(b) &lt;= 0</td>\n</tr>\n</tbody>\n</table>\n<p>所有的比较都转换为对 <code>compareTo</code> 的调用，这个函数需要返回 <code>Int</code> 值</p>\n<p>示例：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span>(<span class=\"keyword\">val</span> firstName: String, <span class=\"keyword\">val</span> lastName: String): Comparable&lt;Person&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">compareTo</span><span class=\"params\">(other: <span class=\"type\">Person</span>)</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> compareValuesBy(<span class=\"keyword\">this</span>, other, Person::lastName, Person::firstName)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">val</span> p1 = Person(<span class=\"string\">\"Alice\"</span>, <span class=\"string\">\"Smith\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">val</span> p2 = Person(<span class=\"string\">\"Bob\"</span>, <span class=\"string\">\"Johnson\"</span>)</span><br><span class=\"line\">println(p1 &lt; p2) <span class=\"comment\">// false</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>参考资料：</p>\n<p><a href=\"https://www.manning.com/books/kotlin-in-action\" target=\"_blank\" rel=\"noopener\">Kotlin in Action</a></p>\n<p><a href=\"http://kotlinlang.org/docs/reference/operator-overloading.html#assignments\" target=\"_blank\" rel=\"noopener\">Operator overloading</a></p>\n</blockquote>"},{"title":"Kotlin区间","date":"2018-03-08T08:46:47.000Z","_content":"\n### 区间\n\n#### rangeTo\n\n`..`操作符实际上调用的是`rangeTo`函数，一般与`in`和`in`联用 \n\n```\nstart..end -> start.rangeTo(end)\n```\n\n整型区间（`IntRange`、 `LongRange`、 `CharRange`）可以迭代。 编译器会无额外开销的将它们转换为类似 Java 的基于索引的 *for*-循环\n\n<!--more-->\n\n#### in(闭区间)\n\n```kotlin\n// 1..5 范围是闭区间 [1,5]\nif (i in 1..5) ==> if (i >= 1 && i <=5)\nif (i !in 1..5) ==> if (i <= 1 && i >=5)\n```\n\n#### downTo\n\n```kotlin\n// 正序\nfor (i in 1..5) \n\n// 倒序\nfor (i in 5..1) // 不支持这种写法，什么都不输出\n==>\nfor (i in 5 downTo 1)\n```\n\n#### step\n\n```kotlin\n// 正序\nfor (i in 1..5 step 2) ==> for (i = 1; i<=5 ; i+=2)\n//倒序\nfor (i in downTo 5 step 2) ==> for (i = 5;i >= 1;i-=2)\n```\n\n#### until(左闭右开区间)\n\n```kotlin\n// 1 until 5 范围是闭区间 [1,5)\nfor (i in 1 until 5) println(i)\n// 1234\n```\n\n#### reversed\n\n```kotlin\nval list = listOf(1, 2, 3)\nprintln(list.reversed()) // [3, 2, 1]\n```\n\n#### last\n\n返回数列的 `last` 值可能与原始数列的 `last` 值不同，以便保持不变式 `(last - first) % step == 0` 成立\n\n```kotlin\n(1..12 step 2).last == 11  // 值为 [1, 3, 5, 7, 9, 11] 的数列\n(1..12 step 3).last == 10  // 值为 [1, 4, 7, 10] 的数列\n(1..12 step 4).last == 9   // 值为 [1, 5, 9] 的数列\n```\n\n","source":"_posts/android/kotlin-ranges.md","raw":"---\ntitle: Kotlin区间\ndate: 2018-03-08 16:46:47\ntags: [android, kotlin]\n---\n\n### 区间\n\n#### rangeTo\n\n`..`操作符实际上调用的是`rangeTo`函数，一般与`in`和`in`联用 \n\n```\nstart..end -> start.rangeTo(end)\n```\n\n整型区间（`IntRange`、 `LongRange`、 `CharRange`）可以迭代。 编译器会无额外开销的将它们转换为类似 Java 的基于索引的 *for*-循环\n\n<!--more-->\n\n#### in(闭区间)\n\n```kotlin\n// 1..5 范围是闭区间 [1,5]\nif (i in 1..5) ==> if (i >= 1 && i <=5)\nif (i !in 1..5) ==> if (i <= 1 && i >=5)\n```\n\n#### downTo\n\n```kotlin\n// 正序\nfor (i in 1..5) \n\n// 倒序\nfor (i in 5..1) // 不支持这种写法，什么都不输出\n==>\nfor (i in 5 downTo 1)\n```\n\n#### step\n\n```kotlin\n// 正序\nfor (i in 1..5 step 2) ==> for (i = 1; i<=5 ; i+=2)\n//倒序\nfor (i in downTo 5 step 2) ==> for (i = 5;i >= 1;i-=2)\n```\n\n#### until(左闭右开区间)\n\n```kotlin\n// 1 until 5 范围是闭区间 [1,5)\nfor (i in 1 until 5) println(i)\n// 1234\n```\n\n#### reversed\n\n```kotlin\nval list = listOf(1, 2, 3)\nprintln(list.reversed()) // [3, 2, 1]\n```\n\n#### last\n\n返回数列的 `last` 值可能与原始数列的 `last` 值不同，以便保持不变式 `(last - first) % step == 0` 成立\n\n```kotlin\n(1..12 step 2).last == 11  // 值为 [1, 3, 5, 7, 9, 11] 的数列\n(1..12 step 3).last == 10  // 值为 [1, 4, 7, 10] 的数列\n(1..12 step 4).last == 9   // 值为 [1, 5, 9] 的数列\n```\n\n","slug":"android/kotlin-ranges","published":1,"updated":"2018-05-20T13:04:25.683Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61eu001oizcb3excwnt0","content":"<h3 id=\"区间\"><a href=\"#区间\" class=\"headerlink\" title=\"区间\"></a>区间</h3><h4 id=\"rangeTo\"><a href=\"#rangeTo\" class=\"headerlink\" title=\"rangeTo\"></a>rangeTo</h4><p><code>..</code>操作符实际上调用的是<code>rangeTo</code>函数，一般与<code>in</code>和<code>in</code>联用 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start..end -&gt; start.rangeTo(end)</span><br></pre></td></tr></table></figure>\n<p>整型区间（<code>IntRange</code>、 <code>LongRange</code>、 <code>CharRange</code>）可以迭代。 编译器会无额外开销的将它们转换为类似 Java 的基于索引的 <em>for</em>-循环</p>\n<a id=\"more\"></a>\n<h4 id=\"in-闭区间\"><a href=\"#in-闭区间\" class=\"headerlink\" title=\"in(闭区间)\"></a>in(闭区间)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1..5 范围是闭区间 [1,5]</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span>) ==&gt; <span class=\"keyword\">if</span> (i &gt;= <span class=\"number\">1</span> &amp;&amp; i &lt;=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> (i !<span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span>) ==&gt; <span class=\"keyword\">if</span> (i &lt;= <span class=\"number\">1</span> &amp;&amp; i &gt;=<span class=\"number\">5</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"downTo\"><a href=\"#downTo\" class=\"headerlink\" title=\"downTo\"></a>downTo</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 正序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span>) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 倒序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">5.</span><span class=\"number\">.1</span>) <span class=\"comment\">// 不支持这种写法，什么都不输出</span></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">5</span> downTo <span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"step\"><a href=\"#step\" class=\"headerlink\" title=\"step\"></a>step</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 正序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span> step <span class=\"number\">2</span>) ==&gt; <span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i&lt;=<span class=\"number\">5</span> ; i+=<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\">//倒序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> downTo <span class=\"number\">5</span> step <span class=\"number\">2</span>) ==&gt; <span class=\"keyword\">for</span> (i = <span class=\"number\">5</span>;i &gt;= <span class=\"number\">1</span>;i-=<span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"until-左闭右开区间\"><a href=\"#until-左闭右开区间\" class=\"headerlink\" title=\"until(左闭右开区间)\"></a>until(左闭右开区间)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1 until 5 范围是闭区间 [1,5)</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1</span> until <span class=\"number\">5</span>) println(i)</span><br><span class=\"line\"><span class=\"comment\">// 1234</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"reversed\"><a href=\"#reversed\" class=\"headerlink\" title=\"reversed\"></a>reversed</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">println(list.reversed()) <span class=\"comment\">// [3, 2, 1]</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"last\"><a href=\"#last\" class=\"headerlink\" title=\"last\"></a>last</h4><p>返回数列的 <code>last</code> 值可能与原始数列的 <code>last</code> 值不同，以便保持不变式 <code>(last - first) % step == 0</code> 成立</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1.</span><span class=\"number\">.12</span> step <span class=\"number\">2</span>).last == <span class=\"number\">11</span>  <span class=\"comment\">// 值为 [1, 3, 5, 7, 9, 11] 的数列</span></span><br><span class=\"line\">(<span class=\"number\">1.</span><span class=\"number\">.12</span> step <span class=\"number\">3</span>).last == <span class=\"number\">10</span>  <span class=\"comment\">// 值为 [1, 4, 7, 10] 的数列</span></span><br><span class=\"line\">(<span class=\"number\">1.</span><span class=\"number\">.12</span> step <span class=\"number\">4</span>).last == <span class=\"number\">9</span>   <span class=\"comment\">// 值为 [1, 5, 9] 的数列</span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h3 id=\"区间\"><a href=\"#区间\" class=\"headerlink\" title=\"区间\"></a>区间</h3><h4 id=\"rangeTo\"><a href=\"#rangeTo\" class=\"headerlink\" title=\"rangeTo\"></a>rangeTo</h4><p><code>..</code>操作符实际上调用的是<code>rangeTo</code>函数，一般与<code>in</code>和<code>in</code>联用 </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">start..end -&gt; start.rangeTo(end)</span><br></pre></td></tr></table></figure>\n<p>整型区间（<code>IntRange</code>、 <code>LongRange</code>、 <code>CharRange</code>）可以迭代。 编译器会无额外开销的将它们转换为类似 Java 的基于索引的 <em>for</em>-循环</p>","more":"<h4 id=\"in-闭区间\"><a href=\"#in-闭区间\" class=\"headerlink\" title=\"in(闭区间)\"></a>in(闭区间)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1..5 范围是闭区间 [1,5]</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span>) ==&gt; <span class=\"keyword\">if</span> (i &gt;= <span class=\"number\">1</span> &amp;&amp; i &lt;=<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"keyword\">if</span> (i !<span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span>) ==&gt; <span class=\"keyword\">if</span> (i &lt;= <span class=\"number\">1</span> &amp;&amp; i &gt;=<span class=\"number\">5</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"downTo\"><a href=\"#downTo\" class=\"headerlink\" title=\"downTo\"></a>downTo</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 正序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span>) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 倒序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">5.</span><span class=\"number\">.1</span>) <span class=\"comment\">// 不支持这种写法，什么都不输出</span></span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">5</span> downTo <span class=\"number\">1</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"step\"><a href=\"#step\" class=\"headerlink\" title=\"step\"></a>step</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 正序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1.</span><span class=\"number\">.5</span> step <span class=\"number\">2</span>) ==&gt; <span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i&lt;=<span class=\"number\">5</span> ; i+=<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\">//倒序</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> downTo <span class=\"number\">5</span> step <span class=\"number\">2</span>) ==&gt; <span class=\"keyword\">for</span> (i = <span class=\"number\">5</span>;i &gt;= <span class=\"number\">1</span>;i-=<span class=\"number\">2</span>)</span><br></pre></td></tr></table></figure>\n<h4 id=\"until-左闭右开区间\"><a href=\"#until-左闭右开区间\" class=\"headerlink\" title=\"until(左闭右开区间)\"></a>until(左闭右开区间)</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 1 until 5 范围是闭区间 [1,5)</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i <span class=\"keyword\">in</span> <span class=\"number\">1</span> until <span class=\"number\">5</span>) println(i)</span><br><span class=\"line\"><span class=\"comment\">// 1234</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"reversed\"><a href=\"#reversed\" class=\"headerlink\" title=\"reversed\"></a>reversed</h4><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> list = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">println(list.reversed()) <span class=\"comment\">// [3, 2, 1]</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"last\"><a href=\"#last\" class=\"headerlink\" title=\"last\"></a>last</h4><p>返回数列的 <code>last</code> 值可能与原始数列的 <code>last</code> 值不同，以便保持不变式 <code>(last - first) % step == 0</code> 成立</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">1.</span><span class=\"number\">.12</span> step <span class=\"number\">2</span>).last == <span class=\"number\">11</span>  <span class=\"comment\">// 值为 [1, 3, 5, 7, 9, 11] 的数列</span></span><br><span class=\"line\">(<span class=\"number\">1.</span><span class=\"number\">.12</span> step <span class=\"number\">3</span>).last == <span class=\"number\">10</span>  <span class=\"comment\">// 值为 [1, 4, 7, 10] 的数列</span></span><br><span class=\"line\">(<span class=\"number\">1.</span><span class=\"number\">.12</span> step <span class=\"number\">4</span>).last == <span class=\"number\">9</span>   <span class=\"comment\">// 值为 [1, 5, 9] 的数列</span></span><br></pre></td></tr></table></figure>"},{"title":"Kotlin反射","date":"2018-03-12T03:18:35.000Z","_content":"\n### 反射\n\n在`Java`平台，使用反向功能需要单独的Jar包`(kotlin-reflect.jar)`。使用`Android Studio`开发`Kotlin`项目，会自动引入`kotlin-reflect.jar`\n\n### 类引用\n\n最基本的反射功能是获取kotlin类的运行时引用\n\n以下示例为`Java`、`Kotlin`的实现\n\nJava\n\n```java\nClass<?> myClass = MyClass.class;\nClass<?> myClass = Class.forName(\"packageName.MyClass\")\n```\n\nkotlin(如果调用的类是java类，需要添加`.java`后缀)\n\n```kotlin\n// 引用kotlin类\nval c = MyClass::class\n// 引用java类\nval c = MyClass::class.java\n```\n\n### 绑定的类引用\n\n我们可以使用`::class`语法获取对象的精确类的引用\n\n```kotlin\nopen class Fruit()\nclass Apple: Fruit()\nval fruit: Fruit = Apple()\nprintln(\"fruit type is ${fruit::class.qualifiedName}\") // fruit type is Apple\n```\n\n### 函数引用\n\n可以通过下面的方式获取到函数\n\n```kotlin\nclass Point(var x: Int, var y: Int) {\n\tfun getPointX(): Int {\n\t\treturn x\n\t}\n\n\tfun printPointY() {\n\t\tprintln(y)\n\t}\n}\n\n// 第一种：可以使用::操作符获取函数\nval getX = Point::getPointX\nval getY = Point::printPointY\nval p = Point(1, 2)\nprintln(getX.invoke(p))\ngetY.invoke(Point(3, 4))\n\n// 第二种：使用Java的反射方式\nval getX = Point::class.java.getMethod(\"getPointX\")\nprint(getX.invoke(Point(2, 3)))\n```\n\n我们可以使用`::`操作符把一个函数作为值传递给另一个函数\n\n```kotlin\nfun isOdd(x: Int) = x % 2 != 0\nval numbers = listOf(1, 2, 3)\nprintln(numbers.filter(::isOdd)) // 输出 [1, 3]\n```\n\n这里 `::isOdd` 是函数类型 `(Int) -> Boolean` 的一个值\n\n`::`也可以用于重载函数\n\n```kotlin\nfun isOdd(x: Int) = x % 2 != 0\nfun isOdd(s: String) = s == \"brillig\" || s == \"slithy\" || s == \"tove\"\n\nval numbers = listOf(1, 2, 3)\nprintln(numbers.filter(::isOdd)) // refers to isOdd(x: Int)\n```\n\n或者，你也可以赋值给变量\n\n```kotlin\nval predicate: (String) -> Boolean = ::isOdd   // 引用到 isOdd(x: String)\n```\n\n如果我们需要使用一个类的成员，或者一个扩展函数，它需要是限定的。例如：`String::toCharArray`为`String`类提供的扩展函数:`String.() -> CharArray`\n\n### 函数组合\n\n考虑下面的函数\n\n```kotlin\nfun <A, B, C> compose(f: (B) -> C, g: (A) -> B): (A) -> C {\n    return { x -> f(g(x)) }\n}\n```\n\n它返回传递给它的两个函数的组合：`compose(f, g) = f(g(*))`。现在你可以这样调用它\n\n```kotlin\nfun length(s: String) = s.length\n\nval oddLength = compose(::isOdd, ::length)\nval strings = listOf(\"a\", \"ab\", \"abc\")\n\nprintln(strings.filter(oddLength)) // Prints \"[a, abc]\"\n```\n\n### 属性引用\n\n我们可以使用`::`来访问属性\n\n```kotlin\nval x = 1\nvar y = 1\n\nfun main(args: Array<String>) {\n    println(::x.get()) // prints \"1\"\n    println(::x.name)  // prints \"x\"\n    \n    ::y.set(2)\n    println(y) // 输出 \"2\"\n}\n```\n\n> 对于`val`，表达式`::x`返回`KProperty<Int>`类型的值，我们可以使用`get()`来取值，也可以直接使用`name`来取值。\n>\n> 对于`var`，表达式`::y`返回 `KMutableProperty`类型的值，提供`get()/set()`供我们调用\n\n在没有参数的函数中，也可以使用属性引用：\n\n```kotlin\nval strs = listOf(\"a\", \"bc\", \"def\")\nprintln(strs.map(String::length)) // prints [1, 2, 3]\n```\n\n访问类的成员属性\n\n```kotlin\nclass A(val p: Int)\n\nfun main(args: Array<String>) {\n    val prop = A::p\n    println(prop.get(A(1))) // prints \"1\"\n}\n```\n\n对于扩展属性\n\n```kotlin\nval String.lastChar: Char\n    get() = this[length - 1]\n\nfun main(args: Array<String>) {\n    println(String::lastChar.get(\"abc\")) // prints \"c\"\n}\n```\n\n### 与Java反射的互操作性\n\n 例如，要查找一个用作 Kotlin 属性 getter 的 幕后字段或 Java方法，可以这样写\n\n```kotlin\nimport kotlin.reflect.jvm.*\n \nclass A(val p: Int)\n \nfun main(args: Array<String>) {\n    println(A::p.javaGetter) // prints \"public final int A.getP()\"\n    println(A::p.javaField)  // prints \"private final int A.p\"\n}\n```\n\n获取对应于`Java`的`Kotlin`类，使用`.kotlin`扩展属性\n\n```kotlin\nfun getKClass(o: Any): KClass<Any> = o.javaClass.kotlin\n```\n\n### 构造函数引用\n\n可以使用`::`操作符来引用构造函数\n\n```kotlin\nclass Foo\n\nfun function(factory: () -> Foo) {\n    val x: Foo = factory()\n}\n\nfunction(::Foo)\n```\n\n### 绑定函数和属性引用\n\n您可以引用特定对象的实例方法:\n\n```kotlin\nval numberRegex = \"\\\\d+\".toRegex()\nprintln(numberRegex.matches(\"29\")) // prints \"true\"\n \nval isNumber = numberRegex::matches\nprintln(isNumber(\"29\")) // prints \"true\"\n\nval strings = listOf(\"abc\", \"124\", \"a70\")\nprintln(strings.filter(numberRegex::matches)) // 输出“[124]”\n```\n\n你也可以进行赋值操作\n\n```kotlin\nval isNumber: (CharSequence) -> Boolean = numberRegex::matches\nval matches: (Regex, CharSequence) -> Boolean = Regex::matches\n```\n\n属性引用也可以被绑定:\n\n```kotlin\nval prop = \"abc\"::length\nprintln(prop.get())   // prints \"3\"\n```\n\n无需显式指定 `this` 作为接收者：`this::foo` 与 `::foo` 是等价的。","source":"_posts/android/kotlin-reflection.md","raw":"---\ntitle: Kotlin反射\ndate: 2018-03-12 11:18:35\ntags: [android, kotlin]\n---\n\n### 反射\n\n在`Java`平台，使用反向功能需要单独的Jar包`(kotlin-reflect.jar)`。使用`Android Studio`开发`Kotlin`项目，会自动引入`kotlin-reflect.jar`\n\n### 类引用\n\n最基本的反射功能是获取kotlin类的运行时引用\n\n以下示例为`Java`、`Kotlin`的实现\n\nJava\n\n```java\nClass<?> myClass = MyClass.class;\nClass<?> myClass = Class.forName(\"packageName.MyClass\")\n```\n\nkotlin(如果调用的类是java类，需要添加`.java`后缀)\n\n```kotlin\n// 引用kotlin类\nval c = MyClass::class\n// 引用java类\nval c = MyClass::class.java\n```\n\n### 绑定的类引用\n\n我们可以使用`::class`语法获取对象的精确类的引用\n\n```kotlin\nopen class Fruit()\nclass Apple: Fruit()\nval fruit: Fruit = Apple()\nprintln(\"fruit type is ${fruit::class.qualifiedName}\") // fruit type is Apple\n```\n\n### 函数引用\n\n可以通过下面的方式获取到函数\n\n```kotlin\nclass Point(var x: Int, var y: Int) {\n\tfun getPointX(): Int {\n\t\treturn x\n\t}\n\n\tfun printPointY() {\n\t\tprintln(y)\n\t}\n}\n\n// 第一种：可以使用::操作符获取函数\nval getX = Point::getPointX\nval getY = Point::printPointY\nval p = Point(1, 2)\nprintln(getX.invoke(p))\ngetY.invoke(Point(3, 4))\n\n// 第二种：使用Java的反射方式\nval getX = Point::class.java.getMethod(\"getPointX\")\nprint(getX.invoke(Point(2, 3)))\n```\n\n我们可以使用`::`操作符把一个函数作为值传递给另一个函数\n\n```kotlin\nfun isOdd(x: Int) = x % 2 != 0\nval numbers = listOf(1, 2, 3)\nprintln(numbers.filter(::isOdd)) // 输出 [1, 3]\n```\n\n这里 `::isOdd` 是函数类型 `(Int) -> Boolean` 的一个值\n\n`::`也可以用于重载函数\n\n```kotlin\nfun isOdd(x: Int) = x % 2 != 0\nfun isOdd(s: String) = s == \"brillig\" || s == \"slithy\" || s == \"tove\"\n\nval numbers = listOf(1, 2, 3)\nprintln(numbers.filter(::isOdd)) // refers to isOdd(x: Int)\n```\n\n或者，你也可以赋值给变量\n\n```kotlin\nval predicate: (String) -> Boolean = ::isOdd   // 引用到 isOdd(x: String)\n```\n\n如果我们需要使用一个类的成员，或者一个扩展函数，它需要是限定的。例如：`String::toCharArray`为`String`类提供的扩展函数:`String.() -> CharArray`\n\n### 函数组合\n\n考虑下面的函数\n\n```kotlin\nfun <A, B, C> compose(f: (B) -> C, g: (A) -> B): (A) -> C {\n    return { x -> f(g(x)) }\n}\n```\n\n它返回传递给它的两个函数的组合：`compose(f, g) = f(g(*))`。现在你可以这样调用它\n\n```kotlin\nfun length(s: String) = s.length\n\nval oddLength = compose(::isOdd, ::length)\nval strings = listOf(\"a\", \"ab\", \"abc\")\n\nprintln(strings.filter(oddLength)) // Prints \"[a, abc]\"\n```\n\n### 属性引用\n\n我们可以使用`::`来访问属性\n\n```kotlin\nval x = 1\nvar y = 1\n\nfun main(args: Array<String>) {\n    println(::x.get()) // prints \"1\"\n    println(::x.name)  // prints \"x\"\n    \n    ::y.set(2)\n    println(y) // 输出 \"2\"\n}\n```\n\n> 对于`val`，表达式`::x`返回`KProperty<Int>`类型的值，我们可以使用`get()`来取值，也可以直接使用`name`来取值。\n>\n> 对于`var`，表达式`::y`返回 `KMutableProperty`类型的值，提供`get()/set()`供我们调用\n\n在没有参数的函数中，也可以使用属性引用：\n\n```kotlin\nval strs = listOf(\"a\", \"bc\", \"def\")\nprintln(strs.map(String::length)) // prints [1, 2, 3]\n```\n\n访问类的成员属性\n\n```kotlin\nclass A(val p: Int)\n\nfun main(args: Array<String>) {\n    val prop = A::p\n    println(prop.get(A(1))) // prints \"1\"\n}\n```\n\n对于扩展属性\n\n```kotlin\nval String.lastChar: Char\n    get() = this[length - 1]\n\nfun main(args: Array<String>) {\n    println(String::lastChar.get(\"abc\")) // prints \"c\"\n}\n```\n\n### 与Java反射的互操作性\n\n 例如，要查找一个用作 Kotlin 属性 getter 的 幕后字段或 Java方法，可以这样写\n\n```kotlin\nimport kotlin.reflect.jvm.*\n \nclass A(val p: Int)\n \nfun main(args: Array<String>) {\n    println(A::p.javaGetter) // prints \"public final int A.getP()\"\n    println(A::p.javaField)  // prints \"private final int A.p\"\n}\n```\n\n获取对应于`Java`的`Kotlin`类，使用`.kotlin`扩展属性\n\n```kotlin\nfun getKClass(o: Any): KClass<Any> = o.javaClass.kotlin\n```\n\n### 构造函数引用\n\n可以使用`::`操作符来引用构造函数\n\n```kotlin\nclass Foo\n\nfun function(factory: () -> Foo) {\n    val x: Foo = factory()\n}\n\nfunction(::Foo)\n```\n\n### 绑定函数和属性引用\n\n您可以引用特定对象的实例方法:\n\n```kotlin\nval numberRegex = \"\\\\d+\".toRegex()\nprintln(numberRegex.matches(\"29\")) // prints \"true\"\n \nval isNumber = numberRegex::matches\nprintln(isNumber(\"29\")) // prints \"true\"\n\nval strings = listOf(\"abc\", \"124\", \"a70\")\nprintln(strings.filter(numberRegex::matches)) // 输出“[124]”\n```\n\n你也可以进行赋值操作\n\n```kotlin\nval isNumber: (CharSequence) -> Boolean = numberRegex::matches\nval matches: (Regex, CharSequence) -> Boolean = Regex::matches\n```\n\n属性引用也可以被绑定:\n\n```kotlin\nval prop = \"abc\"::length\nprintln(prop.get())   // prints \"3\"\n```\n\n无需显式指定 `this` 作为接收者：`this::foo` 与 `::foo` 是等价的。","slug":"android/kotlin-reflection","published":1,"updated":"2018-05-20T13:04:25.683Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ev001rizcb12ww3sza","content":"<h3 id=\"反射\"><a href=\"#反射\" class=\"headerlink\" title=\"反射\"></a>反射</h3><p>在<code>Java</code>平台，使用反向功能需要单独的Jar包<code>(kotlin-reflect.jar)</code>。使用<code>Android Studio</code>开发<code>Kotlin</code>项目，会自动引入<code>kotlin-reflect.jar</code></p>\n<h3 id=\"类引用\"><a href=\"#类引用\" class=\"headerlink\" title=\"类引用\"></a>类引用</h3><p>最基本的反射功能是获取kotlin类的运行时引用</p>\n<p>以下示例为<code>Java</code>、<code>Kotlin</code>的实现</p>\n<p>Java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\">Class&lt;?&gt; myClass = Class.forName(<span class=\"string\">\"packageName.MyClass\"</span>)</span><br></pre></td></tr></table></figure>\n<p>kotlin(如果调用的类是java类，需要添加<code>.java</code>后缀)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 引用kotlin类</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> c = MyClass::<span class=\"class\"><span class=\"keyword\">class</span></span></span><br><span class=\"line\"><span class=\"comment\">// 引用java类</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> c = MyClass::<span class=\"class\"><span class=\"keyword\">class</span>.<span class=\"title\">java</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"绑定的类引用\"><a href=\"#绑定的类引用\" class=\"headerlink\" title=\"绑定的类引用\"></a>绑定的类引用</h3><p>我们可以使用<code>::class</code>语法获取对象的精确类的引用</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">open</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fruit</span></span>()</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Apple</span>: <span class=\"type\">Fruit</span></span>()</span><br><span class=\"line\"><span class=\"keyword\">val</span> fruit: Fruit = Apple()</span><br><span class=\"line\">println(<span class=\"string\">\"fruit type is <span class=\"subst\">$&#123;fruit::class.qualifiedName&#125;</span>\"</span>) <span class=\"comment\">// fruit type is Apple</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"函数引用\"><a href=\"#函数引用\" class=\"headerlink\" title=\"函数引用\"></a>函数引用</h3><p>可以通过下面的方式获取到函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">var</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">var</span> y: <span class=\"built_in\">Int</span>) &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getPointX</span><span class=\"params\">()</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> x</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">printPointY</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\tprintln(y)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第一种：可以使用::操作符获取函数</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> getX = Point::getPointX</span><br><span class=\"line\"><span class=\"keyword\">val</span> getY = Point::printPointY</span><br><span class=\"line\"><span class=\"keyword\">val</span> p = Point(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">println(getX.invoke(p))</span><br><span class=\"line\">getY.invoke(Point(<span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第二种：使用Java的反射方式</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> getX = Point::<span class=\"class\"><span class=\"keyword\">class</span>.<span class=\"title\">java</span>.<span class=\"title\">getMethod</span></span>(<span class=\"string\">\"getPointX\"</span>)</span><br><span class=\"line\">print(getX.invoke(Point(<span class=\"number\">2</span>, <span class=\"number\">3</span>)))</span><br></pre></td></tr></table></figure>\n<p>我们可以使用<code>::</code>操作符把一个函数作为值传递给另一个函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">isOdd</span><span class=\"params\">(x: <span class=\"type\">Int</span>)</span></span> = x % <span class=\"number\">2</span> != <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> numbers = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">println(numbers.filter(::isOdd)) <span class=\"comment\">// 输出 [1, 3]</span></span><br></pre></td></tr></table></figure>\n<p>这里 <code>::isOdd</code> 是函数类型 <code>(Int) -&gt; Boolean</code> 的一个值</p>\n<p><code>::</code>也可以用于重载函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">isOdd</span><span class=\"params\">(x: <span class=\"type\">Int</span>)</span></span> = x % <span class=\"number\">2</span> != <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">isOdd</span><span class=\"params\">(s: <span class=\"type\">String</span>)</span></span> = s == <span class=\"string\">\"brillig\"</span> || s == <span class=\"string\">\"slithy\"</span> || s == <span class=\"string\">\"tove\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> numbers = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">println(numbers.filter(::isOdd)) <span class=\"comment\">// refers to isOdd(x: Int)</span></span><br></pre></td></tr></table></figure>\n<p>或者，你也可以赋值给变量</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> predicate: (String) -&gt; <span class=\"built_in\">Boolean</span> = ::isOdd   <span class=\"comment\">// 引用到 isOdd(x: String)</span></span><br></pre></td></tr></table></figure>\n<p>如果我们需要使用一个类的成员，或者一个扩展函数，它需要是限定的。例如：<code>String::toCharArray</code>为<code>String</code>类提供的扩展函数:<code>String.() -&gt; CharArray</code></p>\n<h3 id=\"函数组合\"><a href=\"#函数组合\" class=\"headerlink\" title=\"函数组合\"></a>函数组合</h3><p>考虑下面的函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;A, B, C&gt;</span> <span class=\"title\">compose</span><span class=\"params\">(f: (<span class=\"type\">B</span>)</span></span> -&gt; C, g: (A) -&gt; B): (A) -&gt; C &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123; x -&gt; f(g(x)) &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>它返回传递给它的两个函数的组合：<code>compose(f, g) = f(g(*))</code>。现在你可以这样调用它</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">length</span><span class=\"params\">(s: <span class=\"type\">String</span>)</span></span> = s.length</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> oddLength = compose(::isOdd, ::length)</span><br><span class=\"line\"><span class=\"keyword\">val</span> strings = listOf(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"ab\"</span>, <span class=\"string\">\"abc\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">println(strings.filter(oddLength)) <span class=\"comment\">// Prints \"[a, abc]\"</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"属性引用\"><a href=\"#属性引用\" class=\"headerlink\" title=\"属性引用\"></a>属性引用</h3><p>我们可以使用<code>::</code>来访问属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> x = <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> y = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    println(::x.<span class=\"keyword\">get</span>()) <span class=\"comment\">// prints \"1\"</span></span><br><span class=\"line\">    println(::x.name)  <span class=\"comment\">// prints \"x\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    ::y.<span class=\"keyword\">set</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\">    println(y) <span class=\"comment\">// 输出 \"2\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>对于<code>val</code>，表达式<code>::x</code>返回<code>KProperty&lt;Int&gt;</code>类型的值，我们可以使用<code>get()</code>来取值，也可以直接使用<code>name</code>来取值。</p>\n<p>对于<code>var</code>，表达式<code>::y</code>返回 <code>KMutableProperty</code>类型的值，提供<code>get()/set()</code>供我们调用</p>\n</blockquote>\n<p>在没有参数的函数中，也可以使用属性引用：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> strs = listOf(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"bc\"</span>, <span class=\"string\">\"def\"</span>)</span><br><span class=\"line\">println(strs.map(String::length)) <span class=\"comment\">// prints [1, 2, 3]</span></span><br></pre></td></tr></table></figure>\n<p>访问类的成员属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>(<span class=\"keyword\">val</span> p: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> prop = A::p</span><br><span class=\"line\">    println(prop.<span class=\"keyword\">get</span>(A(<span class=\"number\">1</span>))) <span class=\"comment\">// prints \"1\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>对于扩展属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> String.lastChar: <span class=\"built_in\">Char</span></span><br><span class=\"line\">    <span class=\"keyword\">get</span>() = <span class=\"keyword\">this</span>[length - <span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    println(String::lastChar.<span class=\"keyword\">get</span>(<span class=\"string\">\"abc\"</span>)) <span class=\"comment\">// prints \"c\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"与Java反射的互操作性\"><a href=\"#与Java反射的互操作性\" class=\"headerlink\" title=\"与Java反射的互操作性\"></a>与Java反射的互操作性</h3><p> 例如，要查找一个用作 Kotlin 属性 getter 的 幕后字段或 Java方法，可以这样写</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> kotlin.reflect.jvm.*</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>(<span class=\"keyword\">val</span> p: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    println(A::p.javaGetter) <span class=\"comment\">// prints \"public final int A.getP()\"</span></span><br><span class=\"line\">    println(A::p.javaField)  <span class=\"comment\">// prints \"private final int A.p\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>获取对应于<code>Java</code>的<code>Kotlin</code>类，使用<code>.kotlin</code>扩展属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getKClass</span><span class=\"params\">(o: <span class=\"type\">Any</span>)</span></span>: KClass&lt;Any&gt; = o.javaClass.kotlin</span><br></pre></td></tr></table></figure>\n<h3 id=\"构造函数引用\"><a href=\"#构造函数引用\" class=\"headerlink\" title=\"构造函数引用\"></a>构造函数引用</h3><p>可以使用<code>::</code>操作符来引用构造函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">function</span><span class=\"params\">(factory: ()</span></span> -&gt; Foo) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> x: Foo = factory()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function(::Foo)</span><br></pre></td></tr></table></figure>\n<h3 id=\"绑定函数和属性引用\"><a href=\"#绑定函数和属性引用\" class=\"headerlink\" title=\"绑定函数和属性引用\"></a>绑定函数和属性引用</h3><p>您可以引用特定对象的实例方法:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> numberRegex = <span class=\"string\">\"\\\\d+\"</span>.toRegex()</span><br><span class=\"line\">println(numberRegex.matches(<span class=\"string\">\"29\"</span>)) <span class=\"comment\">// prints \"true\"</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">val</span> isNumber = numberRegex::matches</span><br><span class=\"line\">println(isNumber(<span class=\"string\">\"29\"</span>)) <span class=\"comment\">// prints \"true\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> strings = listOf(<span class=\"string\">\"abc\"</span>, <span class=\"string\">\"124\"</span>, <span class=\"string\">\"a70\"</span>)</span><br><span class=\"line\">println(strings.filter(numberRegex::matches)) <span class=\"comment\">// 输出“[124]”</span></span><br></pre></td></tr></table></figure>\n<p>你也可以进行赋值操作</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> isNumber: (CharSequence) -&gt; <span class=\"built_in\">Boolean</span> = numberRegex::matches</span><br><span class=\"line\"><span class=\"keyword\">val</span> matches: (Regex, CharSequence) -&gt; <span class=\"built_in\">Boolean</span> = Regex::matches</span><br></pre></td></tr></table></figure>\n<p>属性引用也可以被绑定:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> prop = <span class=\"string\">\"abc\"</span>::length</span><br><span class=\"line\">println(prop.<span class=\"keyword\">get</span>())   <span class=\"comment\">// prints \"3\"</span></span><br></pre></td></tr></table></figure>\n<p>无需显式指定 <code>this</code> 作为接收者：<code>this::foo</code> 与 <code>::foo</code> 是等价的。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"反射\"><a href=\"#反射\" class=\"headerlink\" title=\"反射\"></a>反射</h3><p>在<code>Java</code>平台，使用反向功能需要单独的Jar包<code>(kotlin-reflect.jar)</code>。使用<code>Android Studio</code>开发<code>Kotlin</code>项目，会自动引入<code>kotlin-reflect.jar</code></p>\n<h3 id=\"类引用\"><a href=\"#类引用\" class=\"headerlink\" title=\"类引用\"></a>类引用</h3><p>最基本的反射功能是获取kotlin类的运行时引用</p>\n<p>以下示例为<code>Java</code>、<code>Kotlin</code>的实现</p>\n<p>Java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\">Class&lt;?&gt; myClass = Class.forName(<span class=\"string\">\"packageName.MyClass\"</span>)</span><br></pre></td></tr></table></figure>\n<p>kotlin(如果调用的类是java类，需要添加<code>.java</code>后缀)</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 引用kotlin类</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> c = MyClass::<span class=\"class\"><span class=\"keyword\">class</span></span></span><br><span class=\"line\"><span class=\"comment\">// 引用java类</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> c = MyClass::<span class=\"class\"><span class=\"keyword\">class</span>.<span class=\"title\">java</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"绑定的类引用\"><a href=\"#绑定的类引用\" class=\"headerlink\" title=\"绑定的类引用\"></a>绑定的类引用</h3><p>我们可以使用<code>::class</code>语法获取对象的精确类的引用</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">open</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fruit</span></span>()</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Apple</span>: <span class=\"type\">Fruit</span></span>()</span><br><span class=\"line\"><span class=\"keyword\">val</span> fruit: Fruit = Apple()</span><br><span class=\"line\">println(<span class=\"string\">\"fruit type is <span class=\"subst\">$&#123;fruit::class.qualifiedName&#125;</span>\"</span>) <span class=\"comment\">// fruit type is Apple</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"函数引用\"><a href=\"#函数引用\" class=\"headerlink\" title=\"函数引用\"></a>函数引用</h3><p>可以通过下面的方式获取到函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span>(<span class=\"keyword\">var</span> x: <span class=\"built_in\">Int</span>, <span class=\"keyword\">var</span> y: <span class=\"built_in\">Int</span>) &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getPointX</span><span class=\"params\">()</span></span>: <span class=\"built_in\">Int</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> x</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">printPointY</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t\tprintln(y)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第一种：可以使用::操作符获取函数</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> getX = Point::getPointX</span><br><span class=\"line\"><span class=\"keyword\">val</span> getY = Point::printPointY</span><br><span class=\"line\"><span class=\"keyword\">val</span> p = Point(<span class=\"number\">1</span>, <span class=\"number\">2</span>)</span><br><span class=\"line\">println(getX.invoke(p))</span><br><span class=\"line\">getY.invoke(Point(<span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第二种：使用Java的反射方式</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> getX = Point::<span class=\"class\"><span class=\"keyword\">class</span>.<span class=\"title\">java</span>.<span class=\"title\">getMethod</span></span>(<span class=\"string\">\"getPointX\"</span>)</span><br><span class=\"line\">print(getX.invoke(Point(<span class=\"number\">2</span>, <span class=\"number\">3</span>)))</span><br></pre></td></tr></table></figure>\n<p>我们可以使用<code>::</code>操作符把一个函数作为值传递给另一个函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">isOdd</span><span class=\"params\">(x: <span class=\"type\">Int</span>)</span></span> = x % <span class=\"number\">2</span> != <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">val</span> numbers = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">println(numbers.filter(::isOdd)) <span class=\"comment\">// 输出 [1, 3]</span></span><br></pre></td></tr></table></figure>\n<p>这里 <code>::isOdd</code> 是函数类型 <code>(Int) -&gt; Boolean</code> 的一个值</p>\n<p><code>::</code>也可以用于重载函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">isOdd</span><span class=\"params\">(x: <span class=\"type\">Int</span>)</span></span> = x % <span class=\"number\">2</span> != <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">isOdd</span><span class=\"params\">(s: <span class=\"type\">String</span>)</span></span> = s == <span class=\"string\">\"brillig\"</span> || s == <span class=\"string\">\"slithy\"</span> || s == <span class=\"string\">\"tove\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> numbers = listOf(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\">println(numbers.filter(::isOdd)) <span class=\"comment\">// refers to isOdd(x: Int)</span></span><br></pre></td></tr></table></figure>\n<p>或者，你也可以赋值给变量</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> predicate: (String) -&gt; <span class=\"built_in\">Boolean</span> = ::isOdd   <span class=\"comment\">// 引用到 isOdd(x: String)</span></span><br></pre></td></tr></table></figure>\n<p>如果我们需要使用一个类的成员，或者一个扩展函数，它需要是限定的。例如：<code>String::toCharArray</code>为<code>String</code>类提供的扩展函数:<code>String.() -&gt; CharArray</code></p>\n<h3 id=\"函数组合\"><a href=\"#函数组合\" class=\"headerlink\" title=\"函数组合\"></a>函数组合</h3><p>考虑下面的函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;A, B, C&gt;</span> <span class=\"title\">compose</span><span class=\"params\">(f: (<span class=\"type\">B</span>)</span></span> -&gt; C, g: (A) -&gt; B): (A) -&gt; C &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123; x -&gt; f(g(x)) &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>它返回传递给它的两个函数的组合：<code>compose(f, g) = f(g(*))</code>。现在你可以这样调用它</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">length</span><span class=\"params\">(s: <span class=\"type\">String</span>)</span></span> = s.length</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> oddLength = compose(::isOdd, ::length)</span><br><span class=\"line\"><span class=\"keyword\">val</span> strings = listOf(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"ab\"</span>, <span class=\"string\">\"abc\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">println(strings.filter(oddLength)) <span class=\"comment\">// Prints \"[a, abc]\"</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"属性引用\"><a href=\"#属性引用\" class=\"headerlink\" title=\"属性引用\"></a>属性引用</h3><p>我们可以使用<code>::</code>来访问属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> x = <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> y = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    println(::x.<span class=\"keyword\">get</span>()) <span class=\"comment\">// prints \"1\"</span></span><br><span class=\"line\">    println(::x.name)  <span class=\"comment\">// prints \"x\"</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    ::y.<span class=\"keyword\">set</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\">    println(y) <span class=\"comment\">// 输出 \"2\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>对于<code>val</code>，表达式<code>::x</code>返回<code>KProperty&lt;Int&gt;</code>类型的值，我们可以使用<code>get()</code>来取值，也可以直接使用<code>name</code>来取值。</p>\n<p>对于<code>var</code>，表达式<code>::y</code>返回 <code>KMutableProperty</code>类型的值，提供<code>get()/set()</code>供我们调用</p>\n</blockquote>\n<p>在没有参数的函数中，也可以使用属性引用：</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> strs = listOf(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"bc\"</span>, <span class=\"string\">\"def\"</span>)</span><br><span class=\"line\">println(strs.map(String::length)) <span class=\"comment\">// prints [1, 2, 3]</span></span><br></pre></td></tr></table></figure>\n<p>访问类的成员属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>(<span class=\"keyword\">val</span> p: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> prop = A::p</span><br><span class=\"line\">    println(prop.<span class=\"keyword\">get</span>(A(<span class=\"number\">1</span>))) <span class=\"comment\">// prints \"1\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>对于扩展属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> String.lastChar: <span class=\"built_in\">Char</span></span><br><span class=\"line\">    <span class=\"keyword\">get</span>() = <span class=\"keyword\">this</span>[length - <span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    println(String::lastChar.<span class=\"keyword\">get</span>(<span class=\"string\">\"abc\"</span>)) <span class=\"comment\">// prints \"c\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"与Java反射的互操作性\"><a href=\"#与Java反射的互操作性\" class=\"headerlink\" title=\"与Java反射的互操作性\"></a>与Java反射的互操作性</h3><p> 例如，要查找一个用作 Kotlin 属性 getter 的 幕后字段或 Java方法，可以这样写</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> kotlin.reflect.jvm.*</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span>(<span class=\"keyword\">val</span> p: <span class=\"built_in\">Int</span>)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">main</span><span class=\"params\">(args: <span class=\"type\">Array</span>&lt;<span class=\"type\">String</span>&gt;)</span></span> &#123;</span><br><span class=\"line\">    println(A::p.javaGetter) <span class=\"comment\">// prints \"public final int A.getP()\"</span></span><br><span class=\"line\">    println(A::p.javaField)  <span class=\"comment\">// prints \"private final int A.p\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>获取对应于<code>Java</code>的<code>Kotlin</code>类，使用<code>.kotlin</code>扩展属性</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">getKClass</span><span class=\"params\">(o: <span class=\"type\">Any</span>)</span></span>: KClass&lt;Any&gt; = o.javaClass.kotlin</span><br></pre></td></tr></table></figure>\n<h3 id=\"构造函数引用\"><a href=\"#构造函数引用\" class=\"headerlink\" title=\"构造函数引用\"></a>构造函数引用</h3><p>可以使用<code>::</code>操作符来引用构造函数</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"title\">function</span><span class=\"params\">(factory: ()</span></span> -&gt; Foo) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">val</span> x: Foo = factory()</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function(::Foo)</span><br></pre></td></tr></table></figure>\n<h3 id=\"绑定函数和属性引用\"><a href=\"#绑定函数和属性引用\" class=\"headerlink\" title=\"绑定函数和属性引用\"></a>绑定函数和属性引用</h3><p>您可以引用特定对象的实例方法:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> numberRegex = <span class=\"string\">\"\\\\d+\"</span>.toRegex()</span><br><span class=\"line\">println(numberRegex.matches(<span class=\"string\">\"29\"</span>)) <span class=\"comment\">// prints \"true\"</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">val</span> isNumber = numberRegex::matches</span><br><span class=\"line\">println(isNumber(<span class=\"string\">\"29\"</span>)) <span class=\"comment\">// prints \"true\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">val</span> strings = listOf(<span class=\"string\">\"abc\"</span>, <span class=\"string\">\"124\"</span>, <span class=\"string\">\"a70\"</span>)</span><br><span class=\"line\">println(strings.filter(numberRegex::matches)) <span class=\"comment\">// 输出“[124]”</span></span><br></pre></td></tr></table></figure>\n<p>你也可以进行赋值操作</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> isNumber: (CharSequence) -&gt; <span class=\"built_in\">Boolean</span> = numberRegex::matches</span><br><span class=\"line\"><span class=\"keyword\">val</span> matches: (Regex, CharSequence) -&gt; <span class=\"built_in\">Boolean</span> = Regex::matches</span><br></pre></td></tr></table></figure>\n<p>属性引用也可以被绑定:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">val</span> prop = <span class=\"string\">\"abc\"</span>::length</span><br><span class=\"line\">println(prop.<span class=\"keyword\">get</span>())   <span class=\"comment\">// prints \"3\"</span></span><br></pre></td></tr></table></figure>\n<p>无需显式指定 <code>this</code> 作为接收者：<code>this::foo</code> 与 <code>::foo</code> 是等价的。</p>\n"},{"title":"kotlin-tips","date":"2018-03-19T11:38:52.000Z","_content":"\n```kotlin\nfun <T> test() : T {\n    when(T){      // this won't work perhaps T::something? \n        is Int -> { ........ \n                   \n==>\n                   \ninline fun <reified T> test() : T {\n  when (T::class) {\n    Int::class -> println(\"Int\")\n    else -> println(\"${T::class}\")\n```\n\n","source":"_posts/android/kotlin-tips.md","raw":"---\ntitle: kotlin-tips\ndate: 2018-03-19 19:38:52\ntags:\n---\n\n```kotlin\nfun <T> test() : T {\n    when(T){      // this won't work perhaps T::something? \n        is Int -> { ........ \n                   \n==>\n                   \ninline fun <reified T> test() : T {\n  when (T::class) {\n    Int::class -> println(\"Int\")\n    else -> println(\"${T::class}\")\n```\n\n","slug":"android/kotlin-tips","published":1,"updated":"2018-05-20T13:04:25.683Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ew001tizcbpzdv56b1","content":"<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T&gt;</span> <span class=\"title\">test</span><span class=\"params\">()</span></span> : T &#123;</span><br><span class=\"line\">    <span class=\"keyword\">when</span>(T)&#123;      <span class=\"comment\">// this won't work perhaps T::something? </span></span><br><span class=\"line\">        <span class=\"keyword\">is</span> <span class=\"built_in\">Int</span> -&gt; &#123; ........ </span><br><span class=\"line\">                   </span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">                   </span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;<span class=\"keyword\">reified</span> T&gt;</span> <span class=\"title\">test</span><span class=\"params\">()</span></span> : T &#123;</span><br><span class=\"line\">  <span class=\"keyword\">when</span> (T::<span class=\"class\"><span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">Int</span>::<span class=\"class\"><span class=\"keyword\">class</span> -&gt; <span class=\"title\">println</span></span>(<span class=\"string\">\"Int\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span> -&gt; println(<span class=\"string\">\"<span class=\"subst\">$&#123;T::class&#125;</span>\"</span>)</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;T&gt;</span> <span class=\"title\">test</span><span class=\"params\">()</span></span> : T &#123;</span><br><span class=\"line\">    <span class=\"keyword\">when</span>(T)&#123;      <span class=\"comment\">// this won't work perhaps T::something? </span></span><br><span class=\"line\">        <span class=\"keyword\">is</span> <span class=\"built_in\">Int</span> -&gt; &#123; ........ </span><br><span class=\"line\">                   </span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">                   </span><br><span class=\"line\"><span class=\"keyword\">inline</span> <span class=\"function\"><span class=\"keyword\">fun</span> <span class=\"type\">&lt;<span class=\"keyword\">reified</span> T&gt;</span> <span class=\"title\">test</span><span class=\"params\">()</span></span> : T &#123;</span><br><span class=\"line\">  <span class=\"keyword\">when</span> (T::<span class=\"class\"><span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">Int</span>::<span class=\"class\"><span class=\"keyword\">class</span> -&gt; <span class=\"title\">println</span></span>(<span class=\"string\">\"Int\"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">else</span> -&gt; println(<span class=\"string\">\"<span class=\"subst\">$&#123;T::class&#125;</span>\"</span>)</span><br></pre></td></tr></table></figure>\n"},{"title":"android-blogs","date":"2017-01-10T08:25:55.000Z","_content":"\n### Kotlin\n\n[Kotlin 资源大全 - 学 Kotlin 看这一篇教程就够了](https://juejin.im/post/591dd9f544d904006c9fbb96)\n\n[【学习笔记】区别Kotlin中的object和companion object关键字](http://liuqingwen.me/blog/2017/06/20/object-vs-companion-object-in-kotlin/)\n\n### Blogs\n\n------\n\n[带你全面了解Glide 4的用法](https://mp.weixin.qq.com/s?__biz=MzA5MzI3NjE2MA==&mid=2650242045&idx=1&sn=6250b01cb51387c546824e0a754ef153&chksm=88638a92bf140384df375e5424c04a21bbbd13fbd4b761c40fd556b83e3959fa900da4a33e0d&scene=38#wechat_redirect)\n\n[从零开始的Android新项目2 - Gradle篇](http://blog.zhaiyifan.cn/2016/03/14/android-new-project-from-0-p2/)\n\n[**贝塞尔风暴 － 超炫GABottleLoading效果**](https://gold.xitu.io/post/586d90d2ac502e00615c05d1)\n\n[Android APK反编译就这么简单 详解（附图）](http://blog.csdn.net/vipzjyno1/article/details/21039349/)\n\n[**APP淘宝，你为什么这么慢卡？**](http://www.jianshu.com/p/423b77c15af3)\n\n[**thinkSky1206**](https://github.com/thinkSky1206/android-blog)\n\n[Android — Smooth shared transitions in all android versions – Medium](https://medium.com/@Sserra90/android-smooth-shared-transitions-in-all-android-versions-9cd27fd3c80f#.gxof6c5lr)\n\n[nickbutcher/plaid: An Android app which provides design news & inspiration as well as being an example of implementing material design.](https://github.com/nickbutcher/plaid)\n\n[**五分钟带你看懂NestedScrolling嵌套滑动机制**](https://gold.xitu.io/post/581b1ba7bf22ec0068b61107)\n\n[**Android 自定义View合集**](http://www.jianshu.com/p/a5040fcfe8cb)\n\n[不要在Android的Application对象中缓存数据!](http://zmywly8866.github.io/2014/12/26/android-do-not-store-data-in-the-application-object.html)\n\n[这个项目碉堡了](https://gold.xitu.io/post/58948f1b0ce4630056f3a629)\n\n[Android7.0之拍照与图片裁剪适配](http://blog.csdn.net/yyh352091626/article/details/54908624)\n\n[Android性能优化系列之App启动优化](http://blog.csdn.net/u012124438/article/details/56340949)\n\n[Android application和activity标签详解](http://blog.csdn.net/self_study/article/details/54020909)\n\n[AndroidManifest.xml 最全详解](http://blog.csdn.net/u012486840/article/details/52468931)\n\n[自定义View Layout过程 - 最易懂的自定义View原理系列](http://blog.csdn.net/carson_ho/article/details/56011112)\n\n[**AndroidManifest--你真的理解了吗？**](http://www.jianshu.com/p/6ed30112d4a4)\n\n### View\n\n------\n\n[**那些你应该知道却不一定知道的——View坐标分析汇总**](http://blog.csdn.net/mr_immortalz/article/details/51168278)\n\n[召唤，光能使者--玩转PathMeasure](http://www.jianshu.com/p/4bb16cefca23)\n\n### Android\n\n------\n\n[Guides](https://github.com/codepath/android_guides/wiki#getting-started)\n\nTabLayout\n\nhttp://www.jianshu.com/p/2b2bb6be83a8\n\nAnima\n\nhttp://www.liujun.info/2017/04/25/Lottie库实现直播礼物动画/\n\n[5分钟搞定开机引导界面](https://juejin.im/post/590b4fa5128fe10058f9209a)\n\n[自定义Behavior的艺术探索-仿UC浏览器主页](http://www.jianshu.com/p/f7989a2a3ec2)\n\nhttp://ailoli.me/2017/05/03/Android粒子特效之-萤火虫飞舞效果/\n\n[Android轮播图控件的实现详解(附GitHub开源链接)](https://juejin.im/post/590b107c61ff4b00698dc2c0)\n\n[CoordinatorLayout介绍](https://juejin.im/post/590a860944d904006d8cfebb)\n\n[Android APK 瘦身 - JOOX Music项目实战](https://mp.weixin.qq.com/s/9IGYG6hNKL1V7N_p16p2Hg)\n\n[Android 翻页效果加苹果桌面应用抖动效果](https://juejin.im/post/5936b783a22b9d005806b9b7)\n\n[简单高效的实现Android App全局字体替换](http://www.jianshu.com/p/4e1e96fe6d26)\n\n[Android开发人员不得不收集的代码](http://rance935.com/blog/?p=152)\n\n[可能是最火的开源项目 —— Java 篇](https://my.oschina.net/editorial-story/blog/1525158?utm_source=tuicool&utm_medium=referral)\n\n[Aspect Oriented Programming in Android](https://fernandocejas.com/2014/08/03/aspect-oriented-programming-in-android/)\n\n[史上最详细仿QQ消息拖拽粘性效果](https://mp.weixin.qq.com/s?__biz=MzIwMzYwMTk1NA==&mid=2247486976&idx=1&sn=2567fc6ba788e064ad7f355bd4df4df7)\n\n[高级UI特效仿直播点赞效果—一个优美炫酷的点赞动画](https://juejin.im/post/59bf1a896fb9a00a67613628)\n\n[Debug 7.1.1源码一步步写Android换肤框架](http://www.jianshu.com/p/c8748fbf6f60)\n\n[MIUI 系统 BUG，Android 调用相机崩溃？将拍照适配方案进行到底！](https://mp.weixin.qq.com/s/dWF9wiJYQFyM0NHgDj4nyA)\n\nhttp://zhengxiaoyong.me/categories/\n\n[你最不想错过的 2017 早期 25 个 Android 开源库](https://juejin.im/post/59e5fc92f265da43283fee89)\n\n[Android开发：RecyclerView平滑流畅的滑动到指定位置](https://juejin.im/post/59e5f3a8518825579d131417)\n\n[Android 项目总结(一)：弧形ViewPager 和弧形HeaderView](https://juejin.im/post/59e363a26fb9a045055d29e6)\n\n[苹果核 - 一种动态为apk写入信息的方案](http://pingguohe.net/2016/03/21/Dynimac-write-infomation-into-apk.html)\n\n[Android学习文档和工具](https://github.com/foxleezh/AndroidDoc)\n\n[手把手教你写高质量Android技术博客，画图工具，录像工具，Markdown写法](https://juejin.im/post/59df34a5518825422c0ca6fc)\n\n[仿淘宝、京东拖拽商品详情(可嵌套ViewPager、ListView、WebView、FragmentTabhost)](https://juejin.im/post/5878dd72128fe1006bea57d8)\n\n[【开发利器】中国国内可用API合集](https://microzz.com/2017/02/03/API/)\n\n[当你只有一个设备的时候，如何做好屏幕适配](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484743&idx=1&sn=28a18c03d375a4f5761d6cf7429870ef&chksm=97851c66a0f29570fbb4922d06ac578aac8c0feae1b6bb81048380299219a5d2bf526d20a1f1&scene=21#wechat_redirect)\n\n[Android 源码，在线阅读更方便！！！](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484741&idx=1&sn=69215d5b524ffb352ad96b8301a91b8f&chksm=97851c64a0f295725d9177cd6ee4422330c9a2184cf842fe06db84fa5aadbf1e2189ba77ec00&scene=21#wechat_redirect)\n\n[Glide 这样用，更省内存！！！](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484787&idx=1&sn=655e94f3c18bc4af5f3184ab439412b7&chksm=97851c52a0f29544128ee2f485a7e30c83215d8e33d769910e375777abec01deae26ffb64ee9&scene=21#wechat_redirect)\n\n[View.post() 不靠谱的地方你知道吗？](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484729&idx=1&sn=bb1ba2f5b15ff77e9e6fe81b9aee4482&chksm=97851c18a0f2950eed481b700efa85d915eccaa8e7d61c5ab9498e7234f6822372968fcf1838&scene=21#wechat_redirect)\n\n[把倒计时做到极致](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484410&idx=1&sn=f324276767fe61f13aa0d5abf26a5c0d&chksm=97851adba0f293cd0d6e6a95b9beddbf5e764e11a30eb1a72be3e56534db84faac2614b41684&scene=21#wechat_redirect)\n\n[使用 Router 实现的模块化，如何优雅的回到主页面](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484485&idx=1&sn=35ee06bb53056c831d8973f0a6496f08&chksm=97851d64a0f2947220f8977dcc06ec810e56928018e96438cd9ca6ef7ce0b78b4c71ef89b9a0&scene=21#wechat_redirect)\n\n[Android：手把手教你构建 WebView 的缓存机制 & 资源预加载方案](https://juejin.im/post/59366700b123db0064396c1f)\n\n[自定义view系列之——Android贝塞尔曲线--基础篇](http://www.jianshu.com/p/3b2ac05ae3c7)\n\n[一篇文章，学会Git和Gitflow工作流](http://www.jianshu.com/p/84dd2da33c82)\n\n[Android 软键盘的显示和隐藏，这样操作就对了](https://juejin.im/post/5a2525396fb9a0451463e129)\n\n[Android 系统中，那些能大幅提高工作效率的 API 汇总（持续更新中...）](https://juejin.im/post/58c407ee44d90400698757d8)\n\n[Android 开发中，与屏幕有关的三个小众知识](https://juejin.im/post/5a287f16f265da43176a062e)\n\n[图解ConcurrentHashMap](https://juejin.im/post/5a2f2f7851882554b837823a)\n\n[AOP编程之AspectJ实战实现数据无痕埋点](https://mp.weixin.qq.com/s/neH9JXL5AYzjaAaxF-ZF-g)\n\n[2017下半年掘金日报优质文章合集：Android篇](https://juejin.im/post/5a430ac05188252b145b51ad)\n\n[堪比阿里插件的 Android Studio 插件集合(IDE通用)（下）](https://juejin.im/entry/59f13a1af265da4315232058?utm_medium=an&utm_source=weixinqun)\n\n[诡异的空指针](https://mp.weixin.qq.com/s/o_ZdrNosk7OZDS2s5Skvuw)\n\n[Android 开发，你遇上 Emoji 头疼吗?](https://juejin.im/post/5a45b38451882512d823076a)\n\n[如何避免使用onActivityResult，以提高代码可读性](https://juejin.im/post/5a4611786fb9a0451a76b565)\n\n[分享两个提高效率的AndroidStudio小技巧](https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&mid=2650825268&idx=1&sn=449a6d4a71872560fcb087f41e7ec7cc&chksm=80b7b6aab7c03fbc17a4cb6f1dd96ebfd99244c311fff2e3cb2cc613a3cfdfc1b0e12f71478a&scene=38#wechat_redirect)\n\n[Android ValueAnimator时长错乱或者不起作用的解决方法以及问题分析](https://blog.csdn.net/u011387817/article/details/78628956)\n\n[[译] 探索 Android Design Support Library v28 新增内容](https://tonnyl.github.io/2018/04/22/Translation-Exploring-the-v28-Android-Design-Support-Library-Additions/)\n\n[AspectJ在Android中的应用](http://www.goluck.top/2017/06/11/AspectJ在Android中的应用/)\n\n[Android小技巧 提升开发效率](https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&mid=2650825002&idx=1&sn=1ee33c018bc52408e99962c0515e0702&chksm=80b7b5b4b7c03ca2fbc02c18cb2524d23dc431a2edbc1a1b6dacb7250967202efedc00c3bfe5&scene=38#wechat_redirect)\n\n[Android Studio使用技巧系列教程（三）](https://blog.csdn.net/growth58/article/details/46787737)\n\n\n\n","source":"_posts/blogs/android-blogs.md","raw":"---\ntitle: android-blogs\ndate: 2017-01-10 16:25:55\ntags: blog\n---\n\n### Kotlin\n\n[Kotlin 资源大全 - 学 Kotlin 看这一篇教程就够了](https://juejin.im/post/591dd9f544d904006c9fbb96)\n\n[【学习笔记】区别Kotlin中的object和companion object关键字](http://liuqingwen.me/blog/2017/06/20/object-vs-companion-object-in-kotlin/)\n\n### Blogs\n\n------\n\n[带你全面了解Glide 4的用法](https://mp.weixin.qq.com/s?__biz=MzA5MzI3NjE2MA==&mid=2650242045&idx=1&sn=6250b01cb51387c546824e0a754ef153&chksm=88638a92bf140384df375e5424c04a21bbbd13fbd4b761c40fd556b83e3959fa900da4a33e0d&scene=38#wechat_redirect)\n\n[从零开始的Android新项目2 - Gradle篇](http://blog.zhaiyifan.cn/2016/03/14/android-new-project-from-0-p2/)\n\n[**贝塞尔风暴 － 超炫GABottleLoading效果**](https://gold.xitu.io/post/586d90d2ac502e00615c05d1)\n\n[Android APK反编译就这么简单 详解（附图）](http://blog.csdn.net/vipzjyno1/article/details/21039349/)\n\n[**APP淘宝，你为什么这么慢卡？**](http://www.jianshu.com/p/423b77c15af3)\n\n[**thinkSky1206**](https://github.com/thinkSky1206/android-blog)\n\n[Android — Smooth shared transitions in all android versions – Medium](https://medium.com/@Sserra90/android-smooth-shared-transitions-in-all-android-versions-9cd27fd3c80f#.gxof6c5lr)\n\n[nickbutcher/plaid: An Android app which provides design news & inspiration as well as being an example of implementing material design.](https://github.com/nickbutcher/plaid)\n\n[**五分钟带你看懂NestedScrolling嵌套滑动机制**](https://gold.xitu.io/post/581b1ba7bf22ec0068b61107)\n\n[**Android 自定义View合集**](http://www.jianshu.com/p/a5040fcfe8cb)\n\n[不要在Android的Application对象中缓存数据!](http://zmywly8866.github.io/2014/12/26/android-do-not-store-data-in-the-application-object.html)\n\n[这个项目碉堡了](https://gold.xitu.io/post/58948f1b0ce4630056f3a629)\n\n[Android7.0之拍照与图片裁剪适配](http://blog.csdn.net/yyh352091626/article/details/54908624)\n\n[Android性能优化系列之App启动优化](http://blog.csdn.net/u012124438/article/details/56340949)\n\n[Android application和activity标签详解](http://blog.csdn.net/self_study/article/details/54020909)\n\n[AndroidManifest.xml 最全详解](http://blog.csdn.net/u012486840/article/details/52468931)\n\n[自定义View Layout过程 - 最易懂的自定义View原理系列](http://blog.csdn.net/carson_ho/article/details/56011112)\n\n[**AndroidManifest--你真的理解了吗？**](http://www.jianshu.com/p/6ed30112d4a4)\n\n### View\n\n------\n\n[**那些你应该知道却不一定知道的——View坐标分析汇总**](http://blog.csdn.net/mr_immortalz/article/details/51168278)\n\n[召唤，光能使者--玩转PathMeasure](http://www.jianshu.com/p/4bb16cefca23)\n\n### Android\n\n------\n\n[Guides](https://github.com/codepath/android_guides/wiki#getting-started)\n\nTabLayout\n\nhttp://www.jianshu.com/p/2b2bb6be83a8\n\nAnima\n\nhttp://www.liujun.info/2017/04/25/Lottie库实现直播礼物动画/\n\n[5分钟搞定开机引导界面](https://juejin.im/post/590b4fa5128fe10058f9209a)\n\n[自定义Behavior的艺术探索-仿UC浏览器主页](http://www.jianshu.com/p/f7989a2a3ec2)\n\nhttp://ailoli.me/2017/05/03/Android粒子特效之-萤火虫飞舞效果/\n\n[Android轮播图控件的实现详解(附GitHub开源链接)](https://juejin.im/post/590b107c61ff4b00698dc2c0)\n\n[CoordinatorLayout介绍](https://juejin.im/post/590a860944d904006d8cfebb)\n\n[Android APK 瘦身 - JOOX Music项目实战](https://mp.weixin.qq.com/s/9IGYG6hNKL1V7N_p16p2Hg)\n\n[Android 翻页效果加苹果桌面应用抖动效果](https://juejin.im/post/5936b783a22b9d005806b9b7)\n\n[简单高效的实现Android App全局字体替换](http://www.jianshu.com/p/4e1e96fe6d26)\n\n[Android开发人员不得不收集的代码](http://rance935.com/blog/?p=152)\n\n[可能是最火的开源项目 —— Java 篇](https://my.oschina.net/editorial-story/blog/1525158?utm_source=tuicool&utm_medium=referral)\n\n[Aspect Oriented Programming in Android](https://fernandocejas.com/2014/08/03/aspect-oriented-programming-in-android/)\n\n[史上最详细仿QQ消息拖拽粘性效果](https://mp.weixin.qq.com/s?__biz=MzIwMzYwMTk1NA==&mid=2247486976&idx=1&sn=2567fc6ba788e064ad7f355bd4df4df7)\n\n[高级UI特效仿直播点赞效果—一个优美炫酷的点赞动画](https://juejin.im/post/59bf1a896fb9a00a67613628)\n\n[Debug 7.1.1源码一步步写Android换肤框架](http://www.jianshu.com/p/c8748fbf6f60)\n\n[MIUI 系统 BUG，Android 调用相机崩溃？将拍照适配方案进行到底！](https://mp.weixin.qq.com/s/dWF9wiJYQFyM0NHgDj4nyA)\n\nhttp://zhengxiaoyong.me/categories/\n\n[你最不想错过的 2017 早期 25 个 Android 开源库](https://juejin.im/post/59e5fc92f265da43283fee89)\n\n[Android开发：RecyclerView平滑流畅的滑动到指定位置](https://juejin.im/post/59e5f3a8518825579d131417)\n\n[Android 项目总结(一)：弧形ViewPager 和弧形HeaderView](https://juejin.im/post/59e363a26fb9a045055d29e6)\n\n[苹果核 - 一种动态为apk写入信息的方案](http://pingguohe.net/2016/03/21/Dynimac-write-infomation-into-apk.html)\n\n[Android学习文档和工具](https://github.com/foxleezh/AndroidDoc)\n\n[手把手教你写高质量Android技术博客，画图工具，录像工具，Markdown写法](https://juejin.im/post/59df34a5518825422c0ca6fc)\n\n[仿淘宝、京东拖拽商品详情(可嵌套ViewPager、ListView、WebView、FragmentTabhost)](https://juejin.im/post/5878dd72128fe1006bea57d8)\n\n[【开发利器】中国国内可用API合集](https://microzz.com/2017/02/03/API/)\n\n[当你只有一个设备的时候，如何做好屏幕适配](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484743&idx=1&sn=28a18c03d375a4f5761d6cf7429870ef&chksm=97851c66a0f29570fbb4922d06ac578aac8c0feae1b6bb81048380299219a5d2bf526d20a1f1&scene=21#wechat_redirect)\n\n[Android 源码，在线阅读更方便！！！](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484741&idx=1&sn=69215d5b524ffb352ad96b8301a91b8f&chksm=97851c64a0f295725d9177cd6ee4422330c9a2184cf842fe06db84fa5aadbf1e2189ba77ec00&scene=21#wechat_redirect)\n\n[Glide 这样用，更省内存！！！](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484787&idx=1&sn=655e94f3c18bc4af5f3184ab439412b7&chksm=97851c52a0f29544128ee2f485a7e30c83215d8e33d769910e375777abec01deae26ffb64ee9&scene=21#wechat_redirect)\n\n[View.post() 不靠谱的地方你知道吗？](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484729&idx=1&sn=bb1ba2f5b15ff77e9e6fe81b9aee4482&chksm=97851c18a0f2950eed481b700efa85d915eccaa8e7d61c5ab9498e7234f6822372968fcf1838&scene=21#wechat_redirect)\n\n[把倒计时做到极致](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484410&idx=1&sn=f324276767fe61f13aa0d5abf26a5c0d&chksm=97851adba0f293cd0d6e6a95b9beddbf5e764e11a30eb1a72be3e56534db84faac2614b41684&scene=21#wechat_redirect)\n\n[使用 Router 实现的模块化，如何优雅的回到主页面](https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&mid=2247484485&idx=1&sn=35ee06bb53056c831d8973f0a6496f08&chksm=97851d64a0f2947220f8977dcc06ec810e56928018e96438cd9ca6ef7ce0b78b4c71ef89b9a0&scene=21#wechat_redirect)\n\n[Android：手把手教你构建 WebView 的缓存机制 & 资源预加载方案](https://juejin.im/post/59366700b123db0064396c1f)\n\n[自定义view系列之——Android贝塞尔曲线--基础篇](http://www.jianshu.com/p/3b2ac05ae3c7)\n\n[一篇文章，学会Git和Gitflow工作流](http://www.jianshu.com/p/84dd2da33c82)\n\n[Android 软键盘的显示和隐藏，这样操作就对了](https://juejin.im/post/5a2525396fb9a0451463e129)\n\n[Android 系统中，那些能大幅提高工作效率的 API 汇总（持续更新中...）](https://juejin.im/post/58c407ee44d90400698757d8)\n\n[Android 开发中，与屏幕有关的三个小众知识](https://juejin.im/post/5a287f16f265da43176a062e)\n\n[图解ConcurrentHashMap](https://juejin.im/post/5a2f2f7851882554b837823a)\n\n[AOP编程之AspectJ实战实现数据无痕埋点](https://mp.weixin.qq.com/s/neH9JXL5AYzjaAaxF-ZF-g)\n\n[2017下半年掘金日报优质文章合集：Android篇](https://juejin.im/post/5a430ac05188252b145b51ad)\n\n[堪比阿里插件的 Android Studio 插件集合(IDE通用)（下）](https://juejin.im/entry/59f13a1af265da4315232058?utm_medium=an&utm_source=weixinqun)\n\n[诡异的空指针](https://mp.weixin.qq.com/s/o_ZdrNosk7OZDS2s5Skvuw)\n\n[Android 开发，你遇上 Emoji 头疼吗?](https://juejin.im/post/5a45b38451882512d823076a)\n\n[如何避免使用onActivityResult，以提高代码可读性](https://juejin.im/post/5a4611786fb9a0451a76b565)\n\n[分享两个提高效率的AndroidStudio小技巧](https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&mid=2650825268&idx=1&sn=449a6d4a71872560fcb087f41e7ec7cc&chksm=80b7b6aab7c03fbc17a4cb6f1dd96ebfd99244c311fff2e3cb2cc613a3cfdfc1b0e12f71478a&scene=38#wechat_redirect)\n\n[Android ValueAnimator时长错乱或者不起作用的解决方法以及问题分析](https://blog.csdn.net/u011387817/article/details/78628956)\n\n[[译] 探索 Android Design Support Library v28 新增内容](https://tonnyl.github.io/2018/04/22/Translation-Exploring-the-v28-Android-Design-Support-Library-Additions/)\n\n[AspectJ在Android中的应用](http://www.goluck.top/2017/06/11/AspectJ在Android中的应用/)\n\n[Android小技巧 提升开发效率](https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&mid=2650825002&idx=1&sn=1ee33c018bc52408e99962c0515e0702&chksm=80b7b5b4b7c03ca2fbc02c18cb2524d23dc431a2edbc1a1b6dacb7250967202efedc00c3bfe5&scene=38#wechat_redirect)\n\n[Android Studio使用技巧系列教程（三）](https://blog.csdn.net/growth58/article/details/46787737)\n\n\n\n","slug":"blogs/android-blogs","published":1,"updated":"2018-05-20T13:04:25.684Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ex001vizcb4uufqpp8","content":"<h3 id=\"Kotlin\"><a href=\"#Kotlin\" class=\"headerlink\" title=\"Kotlin\"></a>Kotlin</h3><p><a href=\"https://juejin.im/post/591dd9f544d904006c9fbb96\" target=\"_blank\" rel=\"noopener\">Kotlin 资源大全 - 学 Kotlin 看这一篇教程就够了</a></p>\n<p><a href=\"http://liuqingwen.me/blog/2017/06/20/object-vs-companion-object-in-kotlin/\" target=\"_blank\" rel=\"noopener\">【学习笔记】区别Kotlin中的object和companion object关键字</a></p>\n<h3 id=\"Blogs\"><a href=\"#Blogs\" class=\"headerlink\" title=\"Blogs\"></a>Blogs</h3><hr>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzA5MzI3NjE2MA==&amp;mid=2650242045&amp;idx=1&amp;sn=6250b01cb51387c546824e0a754ef153&amp;chksm=88638a92bf140384df375e5424c04a21bbbd13fbd4b761c40fd556b83e3959fa900da4a33e0d&amp;scene=38#wechat_redirect\" target=\"_blank\" rel=\"noopener\">带你全面了解Glide 4的用法</a></p>\n<p><a href=\"http://blog.zhaiyifan.cn/2016/03/14/android-new-project-from-0-p2/\" target=\"_blank\" rel=\"noopener\">从零开始的Android新项目2 - Gradle篇</a></p>\n<p><a href=\"https://gold.xitu.io/post/586d90d2ac502e00615c05d1\" target=\"_blank\" rel=\"noopener\"><strong>贝塞尔风暴 － 超炫GABottleLoading效果</strong></a></p>\n<p><a href=\"http://blog.csdn.net/vipzjyno1/article/details/21039349/\" target=\"_blank\" rel=\"noopener\">Android APK反编译就这么简单 详解（附图）</a></p>\n<p><a href=\"http://www.jianshu.com/p/423b77c15af3\" target=\"_blank\" rel=\"noopener\"><strong>APP淘宝，你为什么这么慢卡？</strong></a></p>\n<p><a href=\"https://github.com/thinkSky1206/android-blog\" target=\"_blank\" rel=\"noopener\"><strong>thinkSky1206</strong></a></p>\n<p><a href=\"https://medium.com/@Sserra90/android-smooth-shared-transitions-in-all-android-versions-9cd27fd3c80f#.gxof6c5lr\" target=\"_blank\" rel=\"noopener\">Android — Smooth shared transitions in all android versions – Medium</a></p>\n<p><a href=\"https://github.com/nickbutcher/plaid\" target=\"_blank\" rel=\"noopener\">nickbutcher/plaid: An Android app which provides design news &amp; inspiration as well as being an example of implementing material design.</a></p>\n<p><a href=\"https://gold.xitu.io/post/581b1ba7bf22ec0068b61107\" target=\"_blank\" rel=\"noopener\"><strong>五分钟带你看懂NestedScrolling嵌套滑动机制</strong></a></p>\n<p><a href=\"http://www.jianshu.com/p/a5040fcfe8cb\" target=\"_blank\" rel=\"noopener\"><strong>Android 自定义View合集</strong></a></p>\n<p><a href=\"http://zmywly8866.github.io/2014/12/26/android-do-not-store-data-in-the-application-object.html\" target=\"_blank\" rel=\"noopener\">不要在Android的Application对象中缓存数据!</a></p>\n<p><a href=\"https://gold.xitu.io/post/58948f1b0ce4630056f3a629\" target=\"_blank\" rel=\"noopener\">这个项目碉堡了</a></p>\n<p><a href=\"http://blog.csdn.net/yyh352091626/article/details/54908624\" target=\"_blank\" rel=\"noopener\">Android7.0之拍照与图片裁剪适配</a></p>\n<p><a href=\"http://blog.csdn.net/u012124438/article/details/56340949\" target=\"_blank\" rel=\"noopener\">Android性能优化系列之App启动优化</a></p>\n<p><a href=\"http://blog.csdn.net/self_study/article/details/54020909\" target=\"_blank\" rel=\"noopener\">Android application和activity标签详解</a></p>\n<p><a href=\"http://blog.csdn.net/u012486840/article/details/52468931\" target=\"_blank\" rel=\"noopener\">AndroidManifest.xml 最全详解</a></p>\n<p><a href=\"http://blog.csdn.net/carson_ho/article/details/56011112\" target=\"_blank\" rel=\"noopener\">自定义View Layout过程 - 最易懂的自定义View原理系列</a></p>\n<p><a href=\"http://www.jianshu.com/p/6ed30112d4a4\" target=\"_blank\" rel=\"noopener\"><strong>AndroidManifest–你真的理解了吗？</strong></a></p>\n<h3 id=\"View\"><a href=\"#View\" class=\"headerlink\" title=\"View\"></a>View</h3><hr>\n<p><a href=\"http://blog.csdn.net/mr_immortalz/article/details/51168278\" target=\"_blank\" rel=\"noopener\"><strong>那些你应该知道却不一定知道的——View坐标分析汇总</strong></a></p>\n<p><a href=\"http://www.jianshu.com/p/4bb16cefca23\" target=\"_blank\" rel=\"noopener\">召唤，光能使者–玩转PathMeasure</a></p>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><hr>\n<p><a href=\"https://github.com/codepath/android_guides/wiki#getting-started\" target=\"_blank\" rel=\"noopener\">Guides</a></p>\n<p>TabLayout</p>\n<p><a href=\"http://www.jianshu.com/p/2b2bb6be83a8\" target=\"_blank\" rel=\"noopener\">http://www.jianshu.com/p/2b2bb6be83a8</a></p>\n<p>Anima</p>\n<p><a href=\"http://www.liujun.info/2017/04/25/Lottie库实现直播礼物动画/\" target=\"_blank\" rel=\"noopener\">http://www.liujun.info/2017/04/25/Lottie库实现直播礼物动画/</a></p>\n<p><a href=\"https://juejin.im/post/590b4fa5128fe10058f9209a\" target=\"_blank\" rel=\"noopener\">5分钟搞定开机引导界面</a></p>\n<p><a href=\"http://www.jianshu.com/p/f7989a2a3ec2\" target=\"_blank\" rel=\"noopener\">自定义Behavior的艺术探索-仿UC浏览器主页</a></p>\n<p><a href=\"http://ailoli.me/2017/05/03/Android粒子特效之-萤火虫飞舞效果/\" target=\"_blank\" rel=\"noopener\">http://ailoli.me/2017/05/03/Android粒子特效之-萤火虫飞舞效果/</a></p>\n<p><a href=\"https://juejin.im/post/590b107c61ff4b00698dc2c0\" target=\"_blank\" rel=\"noopener\">Android轮播图控件的实现详解(附GitHub开源链接)</a></p>\n<p><a href=\"https://juejin.im/post/590a860944d904006d8cfebb\" target=\"_blank\" rel=\"noopener\">CoordinatorLayout介绍</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/9IGYG6hNKL1V7N_p16p2Hg\" target=\"_blank\" rel=\"noopener\">Android APK 瘦身 - JOOX Music项目实战</a></p>\n<p><a href=\"https://juejin.im/post/5936b783a22b9d005806b9b7\" target=\"_blank\" rel=\"noopener\">Android 翻页效果加苹果桌面应用抖动效果</a></p>\n<p><a href=\"http://www.jianshu.com/p/4e1e96fe6d26\" target=\"_blank\" rel=\"noopener\">简单高效的实现Android App全局字体替换</a></p>\n<p><a href=\"http://rance935.com/blog/?p=152\" target=\"_blank\" rel=\"noopener\">Android开发人员不得不收集的代码</a></p>\n<p><a href=\"https://my.oschina.net/editorial-story/blog/1525158?utm_source=tuicool&amp;utm_medium=referral\" target=\"_blank\" rel=\"noopener\">可能是最火的开源项目 —— Java 篇</a></p>\n<p><a href=\"https://fernandocejas.com/2014/08/03/aspect-oriented-programming-in-android/\" target=\"_blank\" rel=\"noopener\">Aspect Oriented Programming in Android</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIwMzYwMTk1NA==&amp;mid=2247486976&amp;idx=1&amp;sn=2567fc6ba788e064ad7f355bd4df4df7\" target=\"_blank\" rel=\"noopener\">史上最详细仿QQ消息拖拽粘性效果</a></p>\n<p><a href=\"https://juejin.im/post/59bf1a896fb9a00a67613628\" target=\"_blank\" rel=\"noopener\">高级UI特效仿直播点赞效果—一个优美炫酷的点赞动画</a></p>\n<p><a href=\"http://www.jianshu.com/p/c8748fbf6f60\" target=\"_blank\" rel=\"noopener\">Debug 7.1.1源码一步步写Android换肤框架</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/dWF9wiJYQFyM0NHgDj4nyA\" target=\"_blank\" rel=\"noopener\">MIUI 系统 BUG，Android 调用相机崩溃？将拍照适配方案进行到底！</a></p>\n<p><a href=\"http://zhengxiaoyong.me/categories/\" target=\"_blank\" rel=\"noopener\">http://zhengxiaoyong.me/categories/</a></p>\n<p><a href=\"https://juejin.im/post/59e5fc92f265da43283fee89\" target=\"_blank\" rel=\"noopener\">你最不想错过的 2017 早期 25 个 Android 开源库</a></p>\n<p><a href=\"https://juejin.im/post/59e5f3a8518825579d131417\" target=\"_blank\" rel=\"noopener\">Android开发：RecyclerView平滑流畅的滑动到指定位置</a></p>\n<p><a href=\"https://juejin.im/post/59e363a26fb9a045055d29e6\" target=\"_blank\" rel=\"noopener\">Android 项目总结(一)：弧形ViewPager 和弧形HeaderView</a></p>\n<p><a href=\"http://pingguohe.net/2016/03/21/Dynimac-write-infomation-into-apk.html\" target=\"_blank\" rel=\"noopener\">苹果核 - 一种动态为apk写入信息的方案</a></p>\n<p><a href=\"https://github.com/foxleezh/AndroidDoc\" target=\"_blank\" rel=\"noopener\">Android学习文档和工具</a></p>\n<p><a href=\"https://juejin.im/post/59df34a5518825422c0ca6fc\" target=\"_blank\" rel=\"noopener\">手把手教你写高质量Android技术博客，画图工具，录像工具，Markdown写法</a></p>\n<p><a href=\"https://juejin.im/post/5878dd72128fe1006bea57d8\" target=\"_blank\" rel=\"noopener\">仿淘宝、京东拖拽商品详情(可嵌套ViewPager、ListView、WebView、FragmentTabhost)</a></p>\n<p><a href=\"https://microzz.com/2017/02/03/API/\" target=\"_blank\" rel=\"noopener\">【开发利器】中国国内可用API合集</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484743&amp;idx=1&amp;sn=28a18c03d375a4f5761d6cf7429870ef&amp;chksm=97851c66a0f29570fbb4922d06ac578aac8c0feae1b6bb81048380299219a5d2bf526d20a1f1&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">当你只有一个设备的时候，如何做好屏幕适配</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484741&amp;idx=1&amp;sn=69215d5b524ffb352ad96b8301a91b8f&amp;chksm=97851c64a0f295725d9177cd6ee4422330c9a2184cf842fe06db84fa5aadbf1e2189ba77ec00&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Android 源码，在线阅读更方便！！！</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484787&amp;idx=1&amp;sn=655e94f3c18bc4af5f3184ab439412b7&amp;chksm=97851c52a0f29544128ee2f485a7e30c83215d8e33d769910e375777abec01deae26ffb64ee9&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Glide 这样用，更省内存！！！</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484729&amp;idx=1&amp;sn=bb1ba2f5b15ff77e9e6fe81b9aee4482&amp;chksm=97851c18a0f2950eed481b700efa85d915eccaa8e7d61c5ab9498e7234f6822372968fcf1838&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">View.post() 不靠谱的地方你知道吗？</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484410&amp;idx=1&amp;sn=f324276767fe61f13aa0d5abf26a5c0d&amp;chksm=97851adba0f293cd0d6e6a95b9beddbf5e764e11a30eb1a72be3e56534db84faac2614b41684&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">把倒计时做到极致</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484485&amp;idx=1&amp;sn=35ee06bb53056c831d8973f0a6496f08&amp;chksm=97851d64a0f2947220f8977dcc06ec810e56928018e96438cd9ca6ef7ce0b78b4c71ef89b9a0&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">使用 Router 实现的模块化，如何优雅的回到主页面</a></p>\n<p><a href=\"https://juejin.im/post/59366700b123db0064396c1f\" target=\"_blank\" rel=\"noopener\">Android：手把手教你构建 WebView 的缓存机制 &amp; 资源预加载方案</a></p>\n<p><a href=\"http://www.jianshu.com/p/3b2ac05ae3c7\" target=\"_blank\" rel=\"noopener\">自定义view系列之——Android贝塞尔曲线–基础篇</a></p>\n<p><a href=\"http://www.jianshu.com/p/84dd2da33c82\" target=\"_blank\" rel=\"noopener\">一篇文章，学会Git和Gitflow工作流</a></p>\n<p><a href=\"https://juejin.im/post/5a2525396fb9a0451463e129\" target=\"_blank\" rel=\"noopener\">Android 软键盘的显示和隐藏，这样操作就对了</a></p>\n<p><a href=\"https://juejin.im/post/58c407ee44d90400698757d8\" target=\"_blank\" rel=\"noopener\">Android 系统中，那些能大幅提高工作效率的 API 汇总（持续更新中…）</a></p>\n<p><a href=\"https://juejin.im/post/5a287f16f265da43176a062e\" target=\"_blank\" rel=\"noopener\">Android 开发中，与屏幕有关的三个小众知识</a></p>\n<p><a href=\"https://juejin.im/post/5a2f2f7851882554b837823a\" target=\"_blank\" rel=\"noopener\">图解ConcurrentHashMap</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/neH9JXL5AYzjaAaxF-ZF-g\" target=\"_blank\" rel=\"noopener\">AOP编程之AspectJ实战实现数据无痕埋点</a></p>\n<p><a href=\"https://juejin.im/post/5a430ac05188252b145b51ad\" target=\"_blank\" rel=\"noopener\">2017下半年掘金日报优质文章合集：Android篇</a></p>\n<p><a href=\"https://juejin.im/entry/59f13a1af265da4315232058?utm_medium=an&amp;utm_source=weixinqun\" target=\"_blank\" rel=\"noopener\">堪比阿里插件的 Android Studio 插件集合(IDE通用)（下）</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/o_ZdrNosk7OZDS2s5Skvuw\" target=\"_blank\" rel=\"noopener\">诡异的空指针</a></p>\n<p><a href=\"https://juejin.im/post/5a45b38451882512d823076a\" target=\"_blank\" rel=\"noopener\">Android 开发，你遇上 Emoji 头疼吗?</a></p>\n<p><a href=\"https://juejin.im/post/5a4611786fb9a0451a76b565\" target=\"_blank\" rel=\"noopener\">如何避免使用onActivityResult，以提高代码可读性</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650825268&amp;idx=1&amp;sn=449a6d4a71872560fcb087f41e7ec7cc&amp;chksm=80b7b6aab7c03fbc17a4cb6f1dd96ebfd99244c311fff2e3cb2cc613a3cfdfc1b0e12f71478a&amp;scene=38#wechat_redirect\" target=\"_blank\" rel=\"noopener\">分享两个提高效率的AndroidStudio小技巧</a></p>\n<p><a href=\"https://blog.csdn.net/u011387817/article/details/78628956\" target=\"_blank\" rel=\"noopener\">Android ValueAnimator时长错乱或者不起作用的解决方法以及问题分析</a></p>\n<p><a href=\"https://tonnyl.github.io/2018/04/22/Translation-Exploring-the-v28-Android-Design-Support-Library-Additions/\" target=\"_blank\" rel=\"noopener\">[译] 探索 Android Design Support Library v28 新增内容</a></p>\n<p><a href=\"http://www.goluck.top/2017/06/11/AspectJ在Android中的应用/\" target=\"_blank\" rel=\"noopener\">AspectJ在Android中的应用</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650825002&amp;idx=1&amp;sn=1ee33c018bc52408e99962c0515e0702&amp;chksm=80b7b5b4b7c03ca2fbc02c18cb2524d23dc431a2edbc1a1b6dacb7250967202efedc00c3bfe5&amp;scene=38#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Android小技巧 提升开发效率</a></p>\n<p><a href=\"https://blog.csdn.net/growth58/article/details/46787737\" target=\"_blank\" rel=\"noopener\">Android Studio使用技巧系列教程（三）</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Kotlin\"><a href=\"#Kotlin\" class=\"headerlink\" title=\"Kotlin\"></a>Kotlin</h3><p><a href=\"https://juejin.im/post/591dd9f544d904006c9fbb96\" target=\"_blank\" rel=\"noopener\">Kotlin 资源大全 - 学 Kotlin 看这一篇教程就够了</a></p>\n<p><a href=\"http://liuqingwen.me/blog/2017/06/20/object-vs-companion-object-in-kotlin/\" target=\"_blank\" rel=\"noopener\">【学习笔记】区别Kotlin中的object和companion object关键字</a></p>\n<h3 id=\"Blogs\"><a href=\"#Blogs\" class=\"headerlink\" title=\"Blogs\"></a>Blogs</h3><hr>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzA5MzI3NjE2MA==&amp;mid=2650242045&amp;idx=1&amp;sn=6250b01cb51387c546824e0a754ef153&amp;chksm=88638a92bf140384df375e5424c04a21bbbd13fbd4b761c40fd556b83e3959fa900da4a33e0d&amp;scene=38#wechat_redirect\" target=\"_blank\" rel=\"noopener\">带你全面了解Glide 4的用法</a></p>\n<p><a href=\"http://blog.zhaiyifan.cn/2016/03/14/android-new-project-from-0-p2/\" target=\"_blank\" rel=\"noopener\">从零开始的Android新项目2 - Gradle篇</a></p>\n<p><a href=\"https://gold.xitu.io/post/586d90d2ac502e00615c05d1\" target=\"_blank\" rel=\"noopener\"><strong>贝塞尔风暴 － 超炫GABottleLoading效果</strong></a></p>\n<p><a href=\"http://blog.csdn.net/vipzjyno1/article/details/21039349/\" target=\"_blank\" rel=\"noopener\">Android APK反编译就这么简单 详解（附图）</a></p>\n<p><a href=\"http://www.jianshu.com/p/423b77c15af3\" target=\"_blank\" rel=\"noopener\"><strong>APP淘宝，你为什么这么慢卡？</strong></a></p>\n<p><a href=\"https://github.com/thinkSky1206/android-blog\" target=\"_blank\" rel=\"noopener\"><strong>thinkSky1206</strong></a></p>\n<p><a href=\"https://medium.com/@Sserra90/android-smooth-shared-transitions-in-all-android-versions-9cd27fd3c80f#.gxof6c5lr\" target=\"_blank\" rel=\"noopener\">Android — Smooth shared transitions in all android versions – Medium</a></p>\n<p><a href=\"https://github.com/nickbutcher/plaid\" target=\"_blank\" rel=\"noopener\">nickbutcher/plaid: An Android app which provides design news &amp; inspiration as well as being an example of implementing material design.</a></p>\n<p><a href=\"https://gold.xitu.io/post/581b1ba7bf22ec0068b61107\" target=\"_blank\" rel=\"noopener\"><strong>五分钟带你看懂NestedScrolling嵌套滑动机制</strong></a></p>\n<p><a href=\"http://www.jianshu.com/p/a5040fcfe8cb\" target=\"_blank\" rel=\"noopener\"><strong>Android 自定义View合集</strong></a></p>\n<p><a href=\"http://zmywly8866.github.io/2014/12/26/android-do-not-store-data-in-the-application-object.html\" target=\"_blank\" rel=\"noopener\">不要在Android的Application对象中缓存数据!</a></p>\n<p><a href=\"https://gold.xitu.io/post/58948f1b0ce4630056f3a629\" target=\"_blank\" rel=\"noopener\">这个项目碉堡了</a></p>\n<p><a href=\"http://blog.csdn.net/yyh352091626/article/details/54908624\" target=\"_blank\" rel=\"noopener\">Android7.0之拍照与图片裁剪适配</a></p>\n<p><a href=\"http://blog.csdn.net/u012124438/article/details/56340949\" target=\"_blank\" rel=\"noopener\">Android性能优化系列之App启动优化</a></p>\n<p><a href=\"http://blog.csdn.net/self_study/article/details/54020909\" target=\"_blank\" rel=\"noopener\">Android application和activity标签详解</a></p>\n<p><a href=\"http://blog.csdn.net/u012486840/article/details/52468931\" target=\"_blank\" rel=\"noopener\">AndroidManifest.xml 最全详解</a></p>\n<p><a href=\"http://blog.csdn.net/carson_ho/article/details/56011112\" target=\"_blank\" rel=\"noopener\">自定义View Layout过程 - 最易懂的自定义View原理系列</a></p>\n<p><a href=\"http://www.jianshu.com/p/6ed30112d4a4\" target=\"_blank\" rel=\"noopener\"><strong>AndroidManifest–你真的理解了吗？</strong></a></p>\n<h3 id=\"View\"><a href=\"#View\" class=\"headerlink\" title=\"View\"></a>View</h3><hr>\n<p><a href=\"http://blog.csdn.net/mr_immortalz/article/details/51168278\" target=\"_blank\" rel=\"noopener\"><strong>那些你应该知道却不一定知道的——View坐标分析汇总</strong></a></p>\n<p><a href=\"http://www.jianshu.com/p/4bb16cefca23\" target=\"_blank\" rel=\"noopener\">召唤，光能使者–玩转PathMeasure</a></p>\n<h3 id=\"Android\"><a href=\"#Android\" class=\"headerlink\" title=\"Android\"></a>Android</h3><hr>\n<p><a href=\"https://github.com/codepath/android_guides/wiki#getting-started\" target=\"_blank\" rel=\"noopener\">Guides</a></p>\n<p>TabLayout</p>\n<p><a href=\"http://www.jianshu.com/p/2b2bb6be83a8\" target=\"_blank\" rel=\"noopener\">http://www.jianshu.com/p/2b2bb6be83a8</a></p>\n<p>Anima</p>\n<p><a href=\"http://www.liujun.info/2017/04/25/Lottie库实现直播礼物动画/\" target=\"_blank\" rel=\"noopener\">http://www.liujun.info/2017/04/25/Lottie库实现直播礼物动画/</a></p>\n<p><a href=\"https://juejin.im/post/590b4fa5128fe10058f9209a\" target=\"_blank\" rel=\"noopener\">5分钟搞定开机引导界面</a></p>\n<p><a href=\"http://www.jianshu.com/p/f7989a2a3ec2\" target=\"_blank\" rel=\"noopener\">自定义Behavior的艺术探索-仿UC浏览器主页</a></p>\n<p><a href=\"http://ailoli.me/2017/05/03/Android粒子特效之-萤火虫飞舞效果/\" target=\"_blank\" rel=\"noopener\">http://ailoli.me/2017/05/03/Android粒子特效之-萤火虫飞舞效果/</a></p>\n<p><a href=\"https://juejin.im/post/590b107c61ff4b00698dc2c0\" target=\"_blank\" rel=\"noopener\">Android轮播图控件的实现详解(附GitHub开源链接)</a></p>\n<p><a href=\"https://juejin.im/post/590a860944d904006d8cfebb\" target=\"_blank\" rel=\"noopener\">CoordinatorLayout介绍</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/9IGYG6hNKL1V7N_p16p2Hg\" target=\"_blank\" rel=\"noopener\">Android APK 瘦身 - JOOX Music项目实战</a></p>\n<p><a href=\"https://juejin.im/post/5936b783a22b9d005806b9b7\" target=\"_blank\" rel=\"noopener\">Android 翻页效果加苹果桌面应用抖动效果</a></p>\n<p><a href=\"http://www.jianshu.com/p/4e1e96fe6d26\" target=\"_blank\" rel=\"noopener\">简单高效的实现Android App全局字体替换</a></p>\n<p><a href=\"http://rance935.com/blog/?p=152\" target=\"_blank\" rel=\"noopener\">Android开发人员不得不收集的代码</a></p>\n<p><a href=\"https://my.oschina.net/editorial-story/blog/1525158?utm_source=tuicool&amp;utm_medium=referral\" target=\"_blank\" rel=\"noopener\">可能是最火的开源项目 —— Java 篇</a></p>\n<p><a href=\"https://fernandocejas.com/2014/08/03/aspect-oriented-programming-in-android/\" target=\"_blank\" rel=\"noopener\">Aspect Oriented Programming in Android</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIwMzYwMTk1NA==&amp;mid=2247486976&amp;idx=1&amp;sn=2567fc6ba788e064ad7f355bd4df4df7\" target=\"_blank\" rel=\"noopener\">史上最详细仿QQ消息拖拽粘性效果</a></p>\n<p><a href=\"https://juejin.im/post/59bf1a896fb9a00a67613628\" target=\"_blank\" rel=\"noopener\">高级UI特效仿直播点赞效果—一个优美炫酷的点赞动画</a></p>\n<p><a href=\"http://www.jianshu.com/p/c8748fbf6f60\" target=\"_blank\" rel=\"noopener\">Debug 7.1.1源码一步步写Android换肤框架</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/dWF9wiJYQFyM0NHgDj4nyA\" target=\"_blank\" rel=\"noopener\">MIUI 系统 BUG，Android 调用相机崩溃？将拍照适配方案进行到底！</a></p>\n<p><a href=\"http://zhengxiaoyong.me/categories/\" target=\"_blank\" rel=\"noopener\">http://zhengxiaoyong.me/categories/</a></p>\n<p><a href=\"https://juejin.im/post/59e5fc92f265da43283fee89\" target=\"_blank\" rel=\"noopener\">你最不想错过的 2017 早期 25 个 Android 开源库</a></p>\n<p><a href=\"https://juejin.im/post/59e5f3a8518825579d131417\" target=\"_blank\" rel=\"noopener\">Android开发：RecyclerView平滑流畅的滑动到指定位置</a></p>\n<p><a href=\"https://juejin.im/post/59e363a26fb9a045055d29e6\" target=\"_blank\" rel=\"noopener\">Android 项目总结(一)：弧形ViewPager 和弧形HeaderView</a></p>\n<p><a href=\"http://pingguohe.net/2016/03/21/Dynimac-write-infomation-into-apk.html\" target=\"_blank\" rel=\"noopener\">苹果核 - 一种动态为apk写入信息的方案</a></p>\n<p><a href=\"https://github.com/foxleezh/AndroidDoc\" target=\"_blank\" rel=\"noopener\">Android学习文档和工具</a></p>\n<p><a href=\"https://juejin.im/post/59df34a5518825422c0ca6fc\" target=\"_blank\" rel=\"noopener\">手把手教你写高质量Android技术博客，画图工具，录像工具，Markdown写法</a></p>\n<p><a href=\"https://juejin.im/post/5878dd72128fe1006bea57d8\" target=\"_blank\" rel=\"noopener\">仿淘宝、京东拖拽商品详情(可嵌套ViewPager、ListView、WebView、FragmentTabhost)</a></p>\n<p><a href=\"https://microzz.com/2017/02/03/API/\" target=\"_blank\" rel=\"noopener\">【开发利器】中国国内可用API合集</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484743&amp;idx=1&amp;sn=28a18c03d375a4f5761d6cf7429870ef&amp;chksm=97851c66a0f29570fbb4922d06ac578aac8c0feae1b6bb81048380299219a5d2bf526d20a1f1&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">当你只有一个设备的时候，如何做好屏幕适配</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484741&amp;idx=1&amp;sn=69215d5b524ffb352ad96b8301a91b8f&amp;chksm=97851c64a0f295725d9177cd6ee4422330c9a2184cf842fe06db84fa5aadbf1e2189ba77ec00&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Android 源码，在线阅读更方便！！！</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484787&amp;idx=1&amp;sn=655e94f3c18bc4af5f3184ab439412b7&amp;chksm=97851c52a0f29544128ee2f485a7e30c83215d8e33d769910e375777abec01deae26ffb64ee9&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Glide 这样用，更省内存！！！</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484729&amp;idx=1&amp;sn=bb1ba2f5b15ff77e9e6fe81b9aee4482&amp;chksm=97851c18a0f2950eed481b700efa85d915eccaa8e7d61c5ab9498e7234f6822372968fcf1838&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">View.post() 不靠谱的地方你知道吗？</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484410&amp;idx=1&amp;sn=f324276767fe61f13aa0d5abf26a5c0d&amp;chksm=97851adba0f293cd0d6e6a95b9beddbf5e764e11a30eb1a72be3e56534db84faac2614b41684&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">把倒计时做到极致</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIxNjc0ODExMA==&amp;mid=2247484485&amp;idx=1&amp;sn=35ee06bb53056c831d8973f0a6496f08&amp;chksm=97851d64a0f2947220f8977dcc06ec810e56928018e96438cd9ca6ef7ce0b78b4c71ef89b9a0&amp;scene=21#wechat_redirect\" target=\"_blank\" rel=\"noopener\">使用 Router 实现的模块化，如何优雅的回到主页面</a></p>\n<p><a href=\"https://juejin.im/post/59366700b123db0064396c1f\" target=\"_blank\" rel=\"noopener\">Android：手把手教你构建 WebView 的缓存机制 &amp; 资源预加载方案</a></p>\n<p><a href=\"http://www.jianshu.com/p/3b2ac05ae3c7\" target=\"_blank\" rel=\"noopener\">自定义view系列之——Android贝塞尔曲线–基础篇</a></p>\n<p><a href=\"http://www.jianshu.com/p/84dd2da33c82\" target=\"_blank\" rel=\"noopener\">一篇文章，学会Git和Gitflow工作流</a></p>\n<p><a href=\"https://juejin.im/post/5a2525396fb9a0451463e129\" target=\"_blank\" rel=\"noopener\">Android 软键盘的显示和隐藏，这样操作就对了</a></p>\n<p><a href=\"https://juejin.im/post/58c407ee44d90400698757d8\" target=\"_blank\" rel=\"noopener\">Android 系统中，那些能大幅提高工作效率的 API 汇总（持续更新中…）</a></p>\n<p><a href=\"https://juejin.im/post/5a287f16f265da43176a062e\" target=\"_blank\" rel=\"noopener\">Android 开发中，与屏幕有关的三个小众知识</a></p>\n<p><a href=\"https://juejin.im/post/5a2f2f7851882554b837823a\" target=\"_blank\" rel=\"noopener\">图解ConcurrentHashMap</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/neH9JXL5AYzjaAaxF-ZF-g\" target=\"_blank\" rel=\"noopener\">AOP编程之AspectJ实战实现数据无痕埋点</a></p>\n<p><a href=\"https://juejin.im/post/5a430ac05188252b145b51ad\" target=\"_blank\" rel=\"noopener\">2017下半年掘金日报优质文章合集：Android篇</a></p>\n<p><a href=\"https://juejin.im/entry/59f13a1af265da4315232058?utm_medium=an&amp;utm_source=weixinqun\" target=\"_blank\" rel=\"noopener\">堪比阿里插件的 Android Studio 插件集合(IDE通用)（下）</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s/o_ZdrNosk7OZDS2s5Skvuw\" target=\"_blank\" rel=\"noopener\">诡异的空指针</a></p>\n<p><a href=\"https://juejin.im/post/5a45b38451882512d823076a\" target=\"_blank\" rel=\"noopener\">Android 开发，你遇上 Emoji 头疼吗?</a></p>\n<p><a href=\"https://juejin.im/post/5a4611786fb9a0451a76b565\" target=\"_blank\" rel=\"noopener\">如何避免使用onActivityResult，以提高代码可读性</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650825268&amp;idx=1&amp;sn=449a6d4a71872560fcb087f41e7ec7cc&amp;chksm=80b7b6aab7c03fbc17a4cb6f1dd96ebfd99244c311fff2e3cb2cc613a3cfdfc1b0e12f71478a&amp;scene=38#wechat_redirect\" target=\"_blank\" rel=\"noopener\">分享两个提高效率的AndroidStudio小技巧</a></p>\n<p><a href=\"https://blog.csdn.net/u011387817/article/details/78628956\" target=\"_blank\" rel=\"noopener\">Android ValueAnimator时长错乱或者不起作用的解决方法以及问题分析</a></p>\n<p><a href=\"https://tonnyl.github.io/2018/04/22/Translation-Exploring-the-v28-Android-Design-Support-Library-Additions/\" target=\"_blank\" rel=\"noopener\">[译] 探索 Android Design Support Library v28 新增内容</a></p>\n<p><a href=\"http://www.goluck.top/2017/06/11/AspectJ在Android中的应用/\" target=\"_blank\" rel=\"noopener\">AspectJ在Android中的应用</a></p>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzAxMTI4MTkwNQ==&amp;mid=2650825002&amp;idx=1&amp;sn=1ee33c018bc52408e99962c0515e0702&amp;chksm=80b7b5b4b7c03ca2fbc02c18cb2524d23dc431a2edbc1a1b6dacb7250967202efedc00c3bfe5&amp;scene=38#wechat_redirect\" target=\"_blank\" rel=\"noopener\">Android小技巧 提升开发效率</a></p>\n<p><a href=\"https://blog.csdn.net/growth58/article/details/46787737\" target=\"_blank\" rel=\"noopener\">Android Studio使用技巧系列教程（三）</a></p>\n"},{"title":"blogs","date":"2017-01-10T08:12:44.000Z","_content":"\n### 简书\n\n------\n\n[milter](http://www.jianshu.com/u/511ba5d71aef)\n\n### CSDN\n\n------\n\n[CGD精讲(Swift3)](http://blog.csdn.net/Hello_Hwc/article/details/54293280?winzoom=1)\n\nhttp://www.jianshu.com/p/929f8a56eef6\n\nhttp://home.duiba.com.cn/docs.html ","source":"_posts/blogs/blogs.md","raw":"---\ntitle: blogs\ndate: 2017-01-10 16:12:44\ntags: blog\n---\n\n### 简书\n\n------\n\n[milter](http://www.jianshu.com/u/511ba5d71aef)\n\n### CSDN\n\n------\n\n[CGD精讲(Swift3)](http://blog.csdn.net/Hello_Hwc/article/details/54293280?winzoom=1)\n\nhttp://www.jianshu.com/p/929f8a56eef6\n\nhttp://home.duiba.com.cn/docs.html ","slug":"blogs/blogs","published":1,"updated":"2018-05-20T13:04:25.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ey001xizcb7rkersga","content":"<h3 id=\"简书\"><a href=\"#简书\" class=\"headerlink\" title=\"简书\"></a>简书</h3><hr>\n<p><a href=\"http://www.jianshu.com/u/511ba5d71aef\" target=\"_blank\" rel=\"noopener\">milter</a></p>\n<h3 id=\"CSDN\"><a href=\"#CSDN\" class=\"headerlink\" title=\"CSDN\"></a>CSDN</h3><hr>\n<p><a href=\"http://blog.csdn.net/Hello_Hwc/article/details/54293280?winzoom=1\" target=\"_blank\" rel=\"noopener\">CGD精讲(Swift3)</a></p>\n<p><a href=\"http://www.jianshu.com/p/929f8a56eef6\" target=\"_blank\" rel=\"noopener\">http://www.jianshu.com/p/929f8a56eef6</a></p>\n<p><a href=\"http://home.duiba.com.cn/docs.html\" target=\"_blank\" rel=\"noopener\">http://home.duiba.com.cn/docs.html</a> </p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"简书\"><a href=\"#简书\" class=\"headerlink\" title=\"简书\"></a>简书</h3><hr>\n<p><a href=\"http://www.jianshu.com/u/511ba5d71aef\" target=\"_blank\" rel=\"noopener\">milter</a></p>\n<h3 id=\"CSDN\"><a href=\"#CSDN\" class=\"headerlink\" title=\"CSDN\"></a>CSDN</h3><hr>\n<p><a href=\"http://blog.csdn.net/Hello_Hwc/article/details/54293280?winzoom=1\" target=\"_blank\" rel=\"noopener\">CGD精讲(Swift3)</a></p>\n<p><a href=\"http://www.jianshu.com/p/929f8a56eef6\" target=\"_blank\" rel=\"noopener\">http://www.jianshu.com/p/929f8a56eef6</a></p>\n<p><a href=\"http://home.duiba.com.cn/docs.html\" target=\"_blank\" rel=\"noopener\">http://home.duiba.com.cn/docs.html</a> </p>\n"},{"title":"js-blogs","date":"2017-01-10T08:33:54.000Z","_content":"\n[**微信小程序 加载 HTML 标签**](https://github.com/ZCLegendary/WXNews/tree/master/wxParse)\n","source":"_posts/blogs/js-blogs.md","raw":"---\ntitle: js-blogs\ndate: 2017-01-10 16:33:54\ntags: blog\n---\n\n[**微信小程序 加载 HTML 标签**](https://github.com/ZCLegendary/WXNews/tree/master/wxParse)\n","slug":"blogs/js-blogs","published":1,"updated":"2018-01-31T09:35:37.814Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ez0020izcbtorpuayg","content":"<p><a href=\"https://github.com/ZCLegendary/WXNews/tree/master/wxParse\" target=\"_blank\" rel=\"noopener\"><strong>微信小程序 加载 HTML 标签</strong></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://github.com/ZCLegendary/WXNews/tree/master/wxParse\" target=\"_blank\" rel=\"noopener\"><strong>微信小程序 加载 HTML 标签</strong></a></p>\n"},{"title":"css-background","date":"2017-07-12T03:34:23.000Z","_content":"\n#### 本章包含以下内容\n\n- background-size\n- background-origin\n\n<!-- More -->\n\n**浏览器支持**\n\n|                   | IE 9 + | Firefox 3.5 | Chrome | Safari | Opera |\n| ----------------- | ------ | ----------- | ------ | ------ | ----- |\n| background-size   | YES    | YES         | YES    | YES    | YES   |\n| background-origin | YES    | YES         | YES    | YES    | YES   |\n\nInternet Explorer 9+、Firefox、Chrome、Safari 以及 Opera 支持新的背景属性。\n\n#### CSS3 background-size 属性\n\nbackgrond-size 属性规定背景图片的尺寸。您能够以像素或百分比规定尺寸。如果以百分比规定尺寸，那么尺寸相对于父元素的宽度和高度。\n\n**例1：**\n\n调整背景图片的大小：\n\n```javascript\ndiv {\n  background:url(bg_flower.gif);\n  -moz-background-size:63px 100px; /* 老版本的 Firefox */\n  background-size:63px 100px;\n  background-repeat:no-repeat;\n}\n```\n\n**例2：**\n\n对背景图片进行拉伸，使其完成填充内容区域：\n\n```javascript\ndiv {\n  background:url(bg_flower.gif);\n  -moz-background-size:40% 100%; /* 老版本的 Firefox */\n  background-size:40% 100%;\n  background-repeat:no-repeat;\n}\n```\n\n#### CSS3 background-origin 属性\n\nbackground-origin 属性规定背景图片的定位区域。\n\n背景图片可以放置于 content-box、padding-box 或 border-box 区域。\n\n![background-origin](../../img/css/background-origin.png)\n\n**实例**\n\n在 content-box中定位背景图片\n\n```javascript\ndiv {\n  background:url(bg_flower.gif);\n  background-repeat:no-repeat;\n  background-size:100% 100%;\n  -webkit-background-origin:content-box; /* Safari */\n  background-origin:content-box;\n}\n```\n\n#### CSS3 多重背景图片\n\nCSS3 允许您为元素使用多个背景图像。\n\n**实例**\n\n为 body 元素设置两幅背景图片：\n\n```javascript\nbody { \n\tbackground-image:url(bg_flower.gif),url(bg_flower_2.gif);\n}\n```\n\n#### 新的背景属性\n\n| 属性                | 描述           | CSS  |\n| ----------------- | ------------ | ---- |\n| background-clip   | 规定背景的绘制区域。   | 3    |\n| background-origin | 规定背景图片的定位区域。 | 3    |\n| background-size   | 规定背景图片的尺寸。   | 3    |\n\n**background-clip**\n\n规定背景的绘制区域：\n\n```javascript\ndiv {\n  background-color:yellow;\n  background-clip:content-box;\n}\n```\n\n语法\n\n```javascript\n// 默认border-box\nbackground-clip: border-box|padding-box|content-box;\n```\n\n| 值           | 描述          |\n| ----------- | ----------- |\n| border-box  | 背景被裁剪到边框盒   |\n| padding-box | 背景被裁剪到内边距框。 |\n| content-box | 背景被裁剪到内容框。  |","source":"_posts/fe/css-background.md","raw":"---\ntitle: css-background\ndate: 2017-07-12 11:34:23\ntags: fe\n---\n\n#### 本章包含以下内容\n\n- background-size\n- background-origin\n\n<!-- More -->\n\n**浏览器支持**\n\n|                   | IE 9 + | Firefox 3.5 | Chrome | Safari | Opera |\n| ----------------- | ------ | ----------- | ------ | ------ | ----- |\n| background-size   | YES    | YES         | YES    | YES    | YES   |\n| background-origin | YES    | YES         | YES    | YES    | YES   |\n\nInternet Explorer 9+、Firefox、Chrome、Safari 以及 Opera 支持新的背景属性。\n\n#### CSS3 background-size 属性\n\nbackgrond-size 属性规定背景图片的尺寸。您能够以像素或百分比规定尺寸。如果以百分比规定尺寸，那么尺寸相对于父元素的宽度和高度。\n\n**例1：**\n\n调整背景图片的大小：\n\n```javascript\ndiv {\n  background:url(bg_flower.gif);\n  -moz-background-size:63px 100px; /* 老版本的 Firefox */\n  background-size:63px 100px;\n  background-repeat:no-repeat;\n}\n```\n\n**例2：**\n\n对背景图片进行拉伸，使其完成填充内容区域：\n\n```javascript\ndiv {\n  background:url(bg_flower.gif);\n  -moz-background-size:40% 100%; /* 老版本的 Firefox */\n  background-size:40% 100%;\n  background-repeat:no-repeat;\n}\n```\n\n#### CSS3 background-origin 属性\n\nbackground-origin 属性规定背景图片的定位区域。\n\n背景图片可以放置于 content-box、padding-box 或 border-box 区域。\n\n![background-origin](../../img/css/background-origin.png)\n\n**实例**\n\n在 content-box中定位背景图片\n\n```javascript\ndiv {\n  background:url(bg_flower.gif);\n  background-repeat:no-repeat;\n  background-size:100% 100%;\n  -webkit-background-origin:content-box; /* Safari */\n  background-origin:content-box;\n}\n```\n\n#### CSS3 多重背景图片\n\nCSS3 允许您为元素使用多个背景图像。\n\n**实例**\n\n为 body 元素设置两幅背景图片：\n\n```javascript\nbody { \n\tbackground-image:url(bg_flower.gif),url(bg_flower_2.gif);\n}\n```\n\n#### 新的背景属性\n\n| 属性                | 描述           | CSS  |\n| ----------------- | ------------ | ---- |\n| background-clip   | 规定背景的绘制区域。   | 3    |\n| background-origin | 规定背景图片的定位区域。 | 3    |\n| background-size   | 规定背景图片的尺寸。   | 3    |\n\n**background-clip**\n\n规定背景的绘制区域：\n\n```javascript\ndiv {\n  background-color:yellow;\n  background-clip:content-box;\n}\n```\n\n语法\n\n```javascript\n// 默认border-box\nbackground-clip: border-box|padding-box|content-box;\n```\n\n| 值           | 描述          |\n| ----------- | ----------- |\n| border-box  | 背景被裁剪到边框盒   |\n| padding-box | 背景被裁剪到内边距框。 |\n| content-box | 背景被裁剪到内容框。  |","slug":"fe/css-background","published":1,"updated":"2018-01-31T09:35:37.814Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f00022izcb0sqgzoko","content":"<h4 id=\"本章包含以下内容\"><a href=\"#本章包含以下内容\" class=\"headerlink\" title=\"本章包含以下内容\"></a>本章包含以下内容</h4><ul>\n<li>background-size</li>\n<li>background-origin</li>\n</ul>\n<a id=\"more\"></a>\n<p><strong>浏览器支持</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>IE 9 +</th>\n<th>Firefox 3.5</th>\n<th>Chrome</th>\n<th>Safari</th>\n<th>Opera</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>background-size</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>background-origin</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n</tbody>\n</table>\n<p>Internet Explorer 9+、Firefox、Chrome、Safari 以及 Opera 支持新的背景属性。</p>\n<h4 id=\"CSS3-background-size-属性\"><a href=\"#CSS3-background-size-属性\" class=\"headerlink\" title=\"CSS3 background-size 属性\"></a>CSS3 background-size 属性</h4><p>backgrond-size 属性规定背景图片的尺寸。您能够以像素或百分比规定尺寸。如果以百分比规定尺寸，那么尺寸相对于父元素的宽度和高度。</p>\n<p><strong>例1：</strong></p>\n<p>调整背景图片的大小：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background:url(bg_flower.gif);</span><br><span class=\"line\">  -moz-background-size:<span class=\"number\">63</span>px <span class=\"number\">100</span>px; <span class=\"comment\">/* 老版本的 Firefox */</span></span><br><span class=\"line\">  background-size:<span class=\"number\">63</span>px <span class=\"number\">100</span>px;</span><br><span class=\"line\">  background-repeat:no-repeat;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>例2：</strong></p>\n<p>对背景图片进行拉伸，使其完成填充内容区域：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background:url(bg_flower.gif);</span><br><span class=\"line\">  -moz-background-size:<span class=\"number\">40</span>% <span class=\"number\">100</span>%; <span class=\"comment\">/* 老版本的 Firefox */</span></span><br><span class=\"line\">  background-size:<span class=\"number\">40</span>% <span class=\"number\">100</span>%;</span><br><span class=\"line\">  background-repeat:no-repeat;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"CSS3-background-origin-属性\"><a href=\"#CSS3-background-origin-属性\" class=\"headerlink\" title=\"CSS3 background-origin 属性\"></a>CSS3 background-origin 属性</h4><p>background-origin 属性规定背景图片的定位区域。</p>\n<p>背景图片可以放置于 content-box、padding-box 或 border-box 区域。</p>\n<p><img src=\"../../img/css/background-origin.png\" alt=\"background-origin\"></p>\n<p><strong>实例</strong></p>\n<p>在 content-box中定位背景图片</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background:url(bg_flower.gif);</span><br><span class=\"line\">  background-repeat:no-repeat;</span><br><span class=\"line\">  background-size:<span class=\"number\">100</span>% <span class=\"number\">100</span>%;</span><br><span class=\"line\">  -webkit-background-origin:content-box; <span class=\"comment\">/* Safari */</span></span><br><span class=\"line\">  background-origin:content-box;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"CSS3-多重背景图片\"><a href=\"#CSS3-多重背景图片\" class=\"headerlink\" title=\"CSS3 多重背景图片\"></a>CSS3 多重背景图片</h4><p>CSS3 允许您为元素使用多个背景图像。</p>\n<p><strong>实例</strong></p>\n<p>为 body 元素设置两幅背景图片：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">body &#123; </span><br><span class=\"line\">\tbackground-image:url(bg_flower.gif),url(bg_flower_2.gif);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"新的背景属性\"><a href=\"#新的背景属性\" class=\"headerlink\" title=\"新的背景属性\"></a>新的背景属性</h4><table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>CSS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>background-clip</td>\n<td>规定背景的绘制区域。</td>\n<td>3</td>\n</tr>\n<tr>\n<td>background-origin</td>\n<td>规定背景图片的定位区域。</td>\n<td>3</td>\n</tr>\n<tr>\n<td>background-size</td>\n<td>规定背景图片的尺寸。</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p><strong>background-clip</strong></p>\n<p>规定背景的绘制区域：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background-color:yellow;</span><br><span class=\"line\">  background-clip:content-box;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>语法</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 默认border-box</span></span><br><span class=\"line\">background-clip: border-box|padding-box|content-box;</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>border-box</td>\n<td>背景被裁剪到边框盒</td>\n</tr>\n<tr>\n<td>padding-box</td>\n<td>背景被裁剪到内边距框。</td>\n</tr>\n<tr>\n<td>content-box</td>\n<td>背景被裁剪到内容框。</td>\n</tr>\n</tbody>\n</table>\n","site":{"data":{}},"excerpt":"<h4 id=\"本章包含以下内容\"><a href=\"#本章包含以下内容\" class=\"headerlink\" title=\"本章包含以下内容\"></a>本章包含以下内容</h4><ul>\n<li>background-size</li>\n<li>background-origin</li>\n</ul>","more":"<p><strong>浏览器支持</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>IE 9 +</th>\n<th>Firefox 3.5</th>\n<th>Chrome</th>\n<th>Safari</th>\n<th>Opera</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>background-size</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>background-origin</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n</tbody>\n</table>\n<p>Internet Explorer 9+、Firefox、Chrome、Safari 以及 Opera 支持新的背景属性。</p>\n<h4 id=\"CSS3-background-size-属性\"><a href=\"#CSS3-background-size-属性\" class=\"headerlink\" title=\"CSS3 background-size 属性\"></a>CSS3 background-size 属性</h4><p>backgrond-size 属性规定背景图片的尺寸。您能够以像素或百分比规定尺寸。如果以百分比规定尺寸，那么尺寸相对于父元素的宽度和高度。</p>\n<p><strong>例1：</strong></p>\n<p>调整背景图片的大小：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background:url(bg_flower.gif);</span><br><span class=\"line\">  -moz-background-size:<span class=\"number\">63</span>px <span class=\"number\">100</span>px; <span class=\"comment\">/* 老版本的 Firefox */</span></span><br><span class=\"line\">  background-size:<span class=\"number\">63</span>px <span class=\"number\">100</span>px;</span><br><span class=\"line\">  background-repeat:no-repeat;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>例2：</strong></p>\n<p>对背景图片进行拉伸，使其完成填充内容区域：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background:url(bg_flower.gif);</span><br><span class=\"line\">  -moz-background-size:<span class=\"number\">40</span>% <span class=\"number\">100</span>%; <span class=\"comment\">/* 老版本的 Firefox */</span></span><br><span class=\"line\">  background-size:<span class=\"number\">40</span>% <span class=\"number\">100</span>%;</span><br><span class=\"line\">  background-repeat:no-repeat;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"CSS3-background-origin-属性\"><a href=\"#CSS3-background-origin-属性\" class=\"headerlink\" title=\"CSS3 background-origin 属性\"></a>CSS3 background-origin 属性</h4><p>background-origin 属性规定背景图片的定位区域。</p>\n<p>背景图片可以放置于 content-box、padding-box 或 border-box 区域。</p>\n<p><img src=\"../../img/css/background-origin.png\" alt=\"background-origin\"></p>\n<p><strong>实例</strong></p>\n<p>在 content-box中定位背景图片</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background:url(bg_flower.gif);</span><br><span class=\"line\">  background-repeat:no-repeat;</span><br><span class=\"line\">  background-size:<span class=\"number\">100</span>% <span class=\"number\">100</span>%;</span><br><span class=\"line\">  -webkit-background-origin:content-box; <span class=\"comment\">/* Safari */</span></span><br><span class=\"line\">  background-origin:content-box;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"CSS3-多重背景图片\"><a href=\"#CSS3-多重背景图片\" class=\"headerlink\" title=\"CSS3 多重背景图片\"></a>CSS3 多重背景图片</h4><p>CSS3 允许您为元素使用多个背景图像。</p>\n<p><strong>实例</strong></p>\n<p>为 body 元素设置两幅背景图片：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">body &#123; </span><br><span class=\"line\">\tbackground-image:url(bg_flower.gif),url(bg_flower_2.gif);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"新的背景属性\"><a href=\"#新的背景属性\" class=\"headerlink\" title=\"新的背景属性\"></a>新的背景属性</h4><table>\n<thead>\n<tr>\n<th>属性</th>\n<th>描述</th>\n<th>CSS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>background-clip</td>\n<td>规定背景的绘制区域。</td>\n<td>3</td>\n</tr>\n<tr>\n<td>background-origin</td>\n<td>规定背景图片的定位区域。</td>\n<td>3</td>\n</tr>\n<tr>\n<td>background-size</td>\n<td>规定背景图片的尺寸。</td>\n<td>3</td>\n</tr>\n</tbody>\n</table>\n<p><strong>background-clip</strong></p>\n<p>规定背景的绘制区域：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">div &#123;</span><br><span class=\"line\">  background-color:yellow;</span><br><span class=\"line\">  background-clip:content-box;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>语法</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 默认border-box</span></span><br><span class=\"line\">background-clip: border-box|padding-box|content-box;</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>border-box</td>\n<td>背景被裁剪到边框盒</td>\n</tr>\n<tr>\n<td>padding-box</td>\n<td>背景被裁剪到内边距框。</td>\n</tr>\n<tr>\n<td>content-box</td>\n<td>背景被裁剪到内容框。</td>\n</tr>\n</tbody>\n</table>"},{"title":"program-blog","date":"2018-03-30T07:49:15.000Z","_content":"\n[程序员的艺术：排序算法舞蹈 ](http://www.apkbus.com/android-64790-1-1.html)\n\n[51VOA美国之音](http://www.51voa.com)\n\n[如何使用Android MediaStore裁剪大图片](https://www.linuxidc.com/Linux/2012-11/73939.htm)\n\n[Android KEYCODE列表](http://blog.sina.com.cn/s/blog_6cefa84101014mqp.html)","source":"_posts/blogs/program-blog.md","raw":"---\ntitle: program-blog\ndate: 2018-03-30 15:49:15\ntags: blog\n---\n\n[程序员的艺术：排序算法舞蹈 ](http://www.apkbus.com/android-64790-1-1.html)\n\n[51VOA美国之音](http://www.51voa.com)\n\n[如何使用Android MediaStore裁剪大图片](https://www.linuxidc.com/Linux/2012-11/73939.htm)\n\n[Android KEYCODE列表](http://blog.sina.com.cn/s/blog_6cefa84101014mqp.html)","slug":"blogs/program-blog","published":1,"updated":"2018-05-20T13:04:25.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f10024izcb0d8g6qqf","content":"<p><a href=\"http://www.apkbus.com/android-64790-1-1.html\" target=\"_blank\" rel=\"noopener\">程序员的艺术：排序算法舞蹈 </a></p>\n<p><a href=\"http://www.51voa.com\" target=\"_blank\" rel=\"noopener\">51VOA美国之音</a></p>\n<p><a href=\"https://www.linuxidc.com/Linux/2012-11/73939.htm\" target=\"_blank\" rel=\"noopener\">如何使用Android MediaStore裁剪大图片</a></p>\n<p><a href=\"http://blog.sina.com.cn/s/blog_6cefa84101014mqp.html\" target=\"_blank\" rel=\"noopener\">Android KEYCODE列表</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"http://www.apkbus.com/android-64790-1-1.html\" target=\"_blank\" rel=\"noopener\">程序员的艺术：排序算法舞蹈 </a></p>\n<p><a href=\"http://www.51voa.com\" target=\"_blank\" rel=\"noopener\">51VOA美国之音</a></p>\n<p><a href=\"https://www.linuxidc.com/Linux/2012-11/73939.htm\" target=\"_blank\" rel=\"noopener\">如何使用Android MediaStore裁剪大图片</a></p>\n<p><a href=\"http://blog.sina.com.cn/s/blog_6cefa84101014mqp.html\" target=\"_blank\" rel=\"noopener\">Android KEYCODE列表</a></p>\n"},{"title":"css-border","date":"2017-07-11T09:28:04.000Z","_content":"\n#### 本章主要包含以下内容\n\n```\n边框>内阴影>背景图片>背景颜色>外阴影\n```\n\n- border-radius\n- box-shadow\n- border-image\n\n<!-- More -->\n\n**浏览器支持**\n\n|               | IE 9 + | Firefox 3.5 | Chrome | Safari | Opera |\n| ------------- | ------ | ----------- | ------ | ------ | ----- |\n| border-radius | YES    | YES         | YES    | YES    | YES   |\n| box-shadow    | YES    | YES         | YES    | YES    | YES   |\n| border-image  | NO     | YES         | YES    | YES    | YES   |\n\n> Internet Explorer 9+ 支持 border-radius 和 box-shadow 属性。\n>\n> Firefox、Chrome 以及 Safari 支持所有新的边框属性。\n>\n> 注释：对于 border-image，Safari 5 以及更老的版本需要前缀 -webkit-。\n>\n> Opera 支持 border-radius 和 box-shadow 属性，但是对于 border-image 需要前缀 -o-。\n\n为了兼容各主流浏览器并支持这些主流浏览器的较低版本，在基于Webkit的Chrome和Safari等浏览器上使用box-shadow属性时，我们需要将属性的名称写成-webkit-box-shadow的形式。Firefox浏览器则需要写成-moz-box-shadow的形式。\n\n```javascript\n.box-radius {  \n    //Firefox4.0-  \n    -moz-box-radius: 25px;  \n\n    //Safariand Google chrome10.0-  \n    -webkit-box-radius:25px;  \n\n    //Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  \n    box-radius:  25px;  // 角度\n  \tborder: 2px solid; // 边框\n}\n.box-shadow {  \n         //Firefox4.0-  \n         -moz-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  \n  \n         //Safariand Google chrome10.0-  \n         -webkit-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  \n  \n         //Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  \n         box-shadow:  投影方式 X轴偏移量 Y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色;  \n}  \n```\n\n#### border-radius （用于为元素添加圆角边框!）\n\n**定义和用法**\n\nborder-radius 属性是一个简写属性，用于设置四个 `border-*-radius  ` 属性。\n\n| 默认值           | 0                                 |\n| ------------- | --------------------------------- |\n| 继承性           | no                                |\n| 版本            | CSS3                              |\n| JavaScript语法： | *object*.style.borderRadius=\"5px\" |\n\n**语法**\n\n```javascript\nborder-radius: 1-4 length|% / 1-4 length|%;\n```\n\n**注释**：按此顺序设置每个 radii 的四个值。如果省略 bottom-left，则与 top-right 相同。如果省略 bottom-right，则与 top-left 相同。如果省略 top-right，则与 top-left 相同。\n\n| 值      | 描述          |\n| ------ | ----------- |\n| length | 定义圆角的形状     |\n| %      | 以百分比定义圆角的形状 |\n\n**例1：**\n\n```javascript\nborder-radius: 2em;\n```\n\n等价于\n\n```javascript\nborder-top-left-radius: 2em;\nborder-top-right-radius: 2em;\nborder-bottom-right-radius: 2em;\nborder-bottom-left-radius: 2em;\n```\n\n**例2**\n\n```javascript\nborder-radius: 2em 1em 4em / 0.5em 3em;\n```\n\n等价于：\n\n```javascript\nborder-top-left-radius: 2em 0.5em;\nborder-top-right-radius: 1em 3em;\nborder-bottom-right-radius: 4em 0.5em;\nborder-bottom-left-radius: 1em 3em;\n```\n\n#### box-shadow\n\n> box-shadow: 投影方式 x轴偏移量 y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色\n>\n> 阴影类型：此参数可选。如不设值，默认投影方式是外阴影；如取其唯一值“inset”，其投影为内阴影；\n>\n> X-offset:阴影水平偏移量，其值可以是正负值。如果值为正值，则阴影在对象的右边，其值为负值时，阴影在对象的左边\n>\n> Y-offset:阴影垂直偏移量，其值也可以是正负值。如果为正值，阴影在对象的底部，其值为负值时，阴影在对象的顶部；\n>\n> 阴影模糊半径：此参数可选，，但其值只能是为正值，如果其值为0时，表示阴影不具有模糊效果，其值越大阴影的边缘就越模糊；\n>\n> 阴影扩展半径：此参数可选，其值可以是正负值，如果值为正，则整个阴影都延展扩大，反之值为负值时，则缩小；\n>\n> 阴影颜色：此参数可选。如不设定颜色，浏览器会取默认色，但各浏览器默认取色不一致，特别是在webkit内核下的safari和chrome浏览器下表现为透明色，在Firefox/Opera下表现为黑色（已验证），建议不要省略此参数。\n\n#### border-image （属性允许您规定用于边框的图片！）\n\n```javascript\n.box-image {  \n    //Firefox4.0-  \n    -moz-box-image:  url(border.png) 30 30 round;  \n\n    //Safariand Google chrome10.0-  \n    -webkit-box-image:  url(border.png) 30 30 round; \n  \n  \t// Opera\n    -o-border-image: url(border.png) 30 30 round\n\n    box-image: url(border.png) 30 30 round;  // 角度\n}\n```","source":"_posts/fe/css-border.md","raw":"---\ntitle: css-border\ndate: 2017-07-11 17:28:04\ntags: fe\n---\n\n#### 本章主要包含以下内容\n\n```\n边框>内阴影>背景图片>背景颜色>外阴影\n```\n\n- border-radius\n- box-shadow\n- border-image\n\n<!-- More -->\n\n**浏览器支持**\n\n|               | IE 9 + | Firefox 3.5 | Chrome | Safari | Opera |\n| ------------- | ------ | ----------- | ------ | ------ | ----- |\n| border-radius | YES    | YES         | YES    | YES    | YES   |\n| box-shadow    | YES    | YES         | YES    | YES    | YES   |\n| border-image  | NO     | YES         | YES    | YES    | YES   |\n\n> Internet Explorer 9+ 支持 border-radius 和 box-shadow 属性。\n>\n> Firefox、Chrome 以及 Safari 支持所有新的边框属性。\n>\n> 注释：对于 border-image，Safari 5 以及更老的版本需要前缀 -webkit-。\n>\n> Opera 支持 border-radius 和 box-shadow 属性，但是对于 border-image 需要前缀 -o-。\n\n为了兼容各主流浏览器并支持这些主流浏览器的较低版本，在基于Webkit的Chrome和Safari等浏览器上使用box-shadow属性时，我们需要将属性的名称写成-webkit-box-shadow的形式。Firefox浏览器则需要写成-moz-box-shadow的形式。\n\n```javascript\n.box-radius {  \n    //Firefox4.0-  \n    -moz-box-radius: 25px;  \n\n    //Safariand Google chrome10.0-  \n    -webkit-box-radius:25px;  \n\n    //Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  \n    box-radius:  25px;  // 角度\n  \tborder: 2px solid; // 边框\n}\n.box-shadow {  \n         //Firefox4.0-  \n         -moz-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  \n  \n         //Safariand Google chrome10.0-  \n         -webkit-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  \n  \n         //Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  \n         box-shadow:  投影方式 X轴偏移量 Y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色;  \n}  \n```\n\n#### border-radius （用于为元素添加圆角边框!）\n\n**定义和用法**\n\nborder-radius 属性是一个简写属性，用于设置四个 `border-*-radius  ` 属性。\n\n| 默认值           | 0                                 |\n| ------------- | --------------------------------- |\n| 继承性           | no                                |\n| 版本            | CSS3                              |\n| JavaScript语法： | *object*.style.borderRadius=\"5px\" |\n\n**语法**\n\n```javascript\nborder-radius: 1-4 length|% / 1-4 length|%;\n```\n\n**注释**：按此顺序设置每个 radii 的四个值。如果省略 bottom-left，则与 top-right 相同。如果省略 bottom-right，则与 top-left 相同。如果省略 top-right，则与 top-left 相同。\n\n| 值      | 描述          |\n| ------ | ----------- |\n| length | 定义圆角的形状     |\n| %      | 以百分比定义圆角的形状 |\n\n**例1：**\n\n```javascript\nborder-radius: 2em;\n```\n\n等价于\n\n```javascript\nborder-top-left-radius: 2em;\nborder-top-right-radius: 2em;\nborder-bottom-right-radius: 2em;\nborder-bottom-left-radius: 2em;\n```\n\n**例2**\n\n```javascript\nborder-radius: 2em 1em 4em / 0.5em 3em;\n```\n\n等价于：\n\n```javascript\nborder-top-left-radius: 2em 0.5em;\nborder-top-right-radius: 1em 3em;\nborder-bottom-right-radius: 4em 0.5em;\nborder-bottom-left-radius: 1em 3em;\n```\n\n#### box-shadow\n\n> box-shadow: 投影方式 x轴偏移量 y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色\n>\n> 阴影类型：此参数可选。如不设值，默认投影方式是外阴影；如取其唯一值“inset”，其投影为内阴影；\n>\n> X-offset:阴影水平偏移量，其值可以是正负值。如果值为正值，则阴影在对象的右边，其值为负值时，阴影在对象的左边\n>\n> Y-offset:阴影垂直偏移量，其值也可以是正负值。如果为正值，阴影在对象的底部，其值为负值时，阴影在对象的顶部；\n>\n> 阴影模糊半径：此参数可选，，但其值只能是为正值，如果其值为0时，表示阴影不具有模糊效果，其值越大阴影的边缘就越模糊；\n>\n> 阴影扩展半径：此参数可选，其值可以是正负值，如果值为正，则整个阴影都延展扩大，反之值为负值时，则缩小；\n>\n> 阴影颜色：此参数可选。如不设定颜色，浏览器会取默认色，但各浏览器默认取色不一致，特别是在webkit内核下的safari和chrome浏览器下表现为透明色，在Firefox/Opera下表现为黑色（已验证），建议不要省略此参数。\n\n#### border-image （属性允许您规定用于边框的图片！）\n\n```javascript\n.box-image {  \n    //Firefox4.0-  \n    -moz-box-image:  url(border.png) 30 30 round;  \n\n    //Safariand Google chrome10.0-  \n    -webkit-box-image:  url(border.png) 30 30 round; \n  \n  \t// Opera\n    -o-border-image: url(border.png) 30 30 round\n\n    box-image: url(border.png) 30 30 round;  // 角度\n}\n```","slug":"fe/css-border","published":1,"updated":"2018-01-31T09:35:37.815Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f20027izcbeedlehr0","content":"<h4 id=\"本章主要包含以下内容\"><a href=\"#本章主要包含以下内容\" class=\"headerlink\" title=\"本章主要包含以下内容\"></a>本章主要包含以下内容</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">边框&gt;内阴影&gt;背景图片&gt;背景颜色&gt;外阴影</span><br></pre></td></tr></table></figure>\n<ul>\n<li>border-radius</li>\n<li>box-shadow</li>\n<li>border-image</li>\n</ul>\n<a id=\"more\"></a>\n<p><strong>浏览器支持</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>IE 9 +</th>\n<th>Firefox 3.5</th>\n<th>Chrome</th>\n<th>Safari</th>\n<th>Opera</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>border-radius</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>box-shadow</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>border-image</td>\n<td>NO</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>Internet Explorer 9+ 支持 border-radius 和 box-shadow 属性。</p>\n<p>Firefox、Chrome 以及 Safari 支持所有新的边框属性。</p>\n<p>注释：对于 border-image，Safari 5 以及更老的版本需要前缀 -webkit-。</p>\n<p>Opera 支持 border-radius 和 box-shadow 属性，但是对于 border-image 需要前缀 -o-。</p>\n</blockquote>\n<p>为了兼容各主流浏览器并支持这些主流浏览器的较低版本，在基于Webkit的Chrome和Safari等浏览器上使用box-shadow属性时，我们需要将属性的名称写成-webkit-box-shadow的形式。Firefox浏览器则需要写成-moz-box-shadow的形式。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.box-radius &#123;  </span><br><span class=\"line\">    <span class=\"comment\">//Firefox4.0-  </span></span><br><span class=\"line\">    -moz-box-radius: <span class=\"number\">25</span>px;  </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Safariand Google chrome10.0-  </span></span><br><span class=\"line\">    -webkit-box-radius:<span class=\"number\">25</span>px;  </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  </span></span><br><span class=\"line\">    box-radius:  <span class=\"number\">25</span>px;  <span class=\"comment\">// 角度</span></span><br><span class=\"line\">  \tborder: <span class=\"number\">2</span>px solid; <span class=\"comment\">// 边框</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.box-shadow &#123;  </span><br><span class=\"line\">         <span class=\"comment\">//Firefox4.0-  </span></span><br><span class=\"line\">         -moz-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  </span><br><span class=\"line\">  </span><br><span class=\"line\">         <span class=\"comment\">//Safariand Google chrome10.0-  </span></span><br><span class=\"line\">         -webkit-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  </span><br><span class=\"line\">  </span><br><span class=\"line\">         <span class=\"comment\">//Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  </span></span><br><span class=\"line\">         box-shadow:  投影方式 X轴偏移量 Y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"border-radius-（用于为元素添加圆角边框-）\"><a href=\"#border-radius-（用于为元素添加圆角边框-）\" class=\"headerlink\" title=\"border-radius （用于为元素添加圆角边框!）\"></a>border-radius （用于为元素添加圆角边框!）</h4><p><strong>定义和用法</strong></p>\n<p>border-radius 属性是一个简写属性，用于设置四个 <code>border-*-radius</code> 属性。</p>\n<table>\n<thead>\n<tr>\n<th>默认值</th>\n<th>0</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>继承性</td>\n<td>no</td>\n</tr>\n<tr>\n<td>版本</td>\n<td>CSS3</td>\n</tr>\n<tr>\n<td>JavaScript语法：</td>\n<td><em>object</em>.style.borderRadius=”5px”</td>\n</tr>\n</tbody>\n</table>\n<p><strong>语法</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-radius: <span class=\"number\">1</span><span class=\"number\">-4</span> length|% <span class=\"regexp\">/ 1-4 length|%;</span></span><br></pre></td></tr></table></figure>\n<p><strong>注释</strong>：按此顺序设置每个 radii 的四个值。如果省略 bottom-left，则与 top-right 相同。如果省略 bottom-right，则与 top-left 相同。如果省略 top-right，则与 top-left 相同。</p>\n<table>\n<thead>\n<tr>\n<th>值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>length</td>\n<td>定义圆角的形状</td>\n</tr>\n<tr>\n<td>%</td>\n<td>以百分比定义圆角的形状</td>\n</tr>\n</tbody>\n</table>\n<p><strong>例1：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-radius: <span class=\"number\">2</span>em;</span><br></pre></td></tr></table></figure>\n<p>等价于</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-top-left-radius: <span class=\"number\">2</span>em;</span><br><span class=\"line\">border-top-right-radius: <span class=\"number\">2</span>em;</span><br><span class=\"line\">border-bottom-right-radius: <span class=\"number\">2</span>em;</span><br><span class=\"line\">border-bottom-left-radius: <span class=\"number\">2</span>em;</span><br></pre></td></tr></table></figure>\n<p><strong>例2</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-radius: <span class=\"number\">2</span>em <span class=\"number\">1</span>em <span class=\"number\">4</span>em / <span class=\"number\">0.5</span>em <span class=\"number\">3</span>em;</span><br></pre></td></tr></table></figure>\n<p>等价于：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-top-left-radius: <span class=\"number\">2</span>em <span class=\"number\">0.5</span>em;</span><br><span class=\"line\">border-top-right-radius: <span class=\"number\">1</span>em <span class=\"number\">3</span>em;</span><br><span class=\"line\">border-bottom-right-radius: <span class=\"number\">4</span>em <span class=\"number\">0.5</span>em;</span><br><span class=\"line\">border-bottom-left-radius: <span class=\"number\">1</span>em <span class=\"number\">3</span>em;</span><br></pre></td></tr></table></figure>\n<h4 id=\"box-shadow\"><a href=\"#box-shadow\" class=\"headerlink\" title=\"box-shadow\"></a>box-shadow</h4><blockquote>\n<p>box-shadow: 投影方式 x轴偏移量 y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色</p>\n<p>阴影类型：此参数可选。如不设值，默认投影方式是外阴影；如取其唯一值“inset”，其投影为内阴影；</p>\n<p>X-offset:阴影水平偏移量，其值可以是正负值。如果值为正值，则阴影在对象的右边，其值为负值时，阴影在对象的左边</p>\n<p>Y-offset:阴影垂直偏移量，其值也可以是正负值。如果为正值，阴影在对象的底部，其值为负值时，阴影在对象的顶部；</p>\n<p>阴影模糊半径：此参数可选，，但其值只能是为正值，如果其值为0时，表示阴影不具有模糊效果，其值越大阴影的边缘就越模糊；</p>\n<p>阴影扩展半径：此参数可选，其值可以是正负值，如果值为正，则整个阴影都延展扩大，反之值为负值时，则缩小；</p>\n<p>阴影颜色：此参数可选。如不设定颜色，浏览器会取默认色，但各浏览器默认取色不一致，特别是在webkit内核下的safari和chrome浏览器下表现为透明色，在Firefox/Opera下表现为黑色（已验证），建议不要省略此参数。</p>\n</blockquote>\n<h4 id=\"border-image-（属性允许您规定用于边框的图片！）\"><a href=\"#border-image-（属性允许您规定用于边框的图片！）\" class=\"headerlink\" title=\"border-image （属性允许您规定用于边框的图片！）\"></a>border-image （属性允许您规定用于边框的图片！）</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.box-image &#123;  </span><br><span class=\"line\">    <span class=\"comment\">//Firefox4.0-  </span></span><br><span class=\"line\">    -moz-box-image:  url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round;  </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Safariand Google chrome10.0-  </span></span><br><span class=\"line\">    -webkit-box-image:  url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round; </span><br><span class=\"line\">  </span><br><span class=\"line\">  \t<span class=\"comment\">// Opera</span></span><br><span class=\"line\">    -o-border-image: url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round</span><br><span class=\"line\"></span><br><span class=\"line\">    box-image: url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round;  <span class=\"comment\">// 角度</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h4 id=\"本章主要包含以下内容\"><a href=\"#本章主要包含以下内容\" class=\"headerlink\" title=\"本章主要包含以下内容\"></a>本章主要包含以下内容</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">边框&gt;内阴影&gt;背景图片&gt;背景颜色&gt;外阴影</span><br></pre></td></tr></table></figure>\n<ul>\n<li>border-radius</li>\n<li>box-shadow</li>\n<li>border-image</li>\n</ul>","more":"<p><strong>浏览器支持</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>IE 9 +</th>\n<th>Firefox 3.5</th>\n<th>Chrome</th>\n<th>Safari</th>\n<th>Opera</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>border-radius</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>box-shadow</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n<tr>\n<td>border-image</td>\n<td>NO</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n<td>YES</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>Internet Explorer 9+ 支持 border-radius 和 box-shadow 属性。</p>\n<p>Firefox、Chrome 以及 Safari 支持所有新的边框属性。</p>\n<p>注释：对于 border-image，Safari 5 以及更老的版本需要前缀 -webkit-。</p>\n<p>Opera 支持 border-radius 和 box-shadow 属性，但是对于 border-image 需要前缀 -o-。</p>\n</blockquote>\n<p>为了兼容各主流浏览器并支持这些主流浏览器的较低版本，在基于Webkit的Chrome和Safari等浏览器上使用box-shadow属性时，我们需要将属性的名称写成-webkit-box-shadow的形式。Firefox浏览器则需要写成-moz-box-shadow的形式。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.box-radius &#123;  </span><br><span class=\"line\">    <span class=\"comment\">//Firefox4.0-  </span></span><br><span class=\"line\">    -moz-box-radius: <span class=\"number\">25</span>px;  </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Safariand Google chrome10.0-  </span></span><br><span class=\"line\">    -webkit-box-radius:<span class=\"number\">25</span>px;  </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  </span></span><br><span class=\"line\">    box-radius:  <span class=\"number\">25</span>px;  <span class=\"comment\">// 角度</span></span><br><span class=\"line\">  \tborder: <span class=\"number\">2</span>px solid; <span class=\"comment\">// 边框</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.box-shadow &#123;  </span><br><span class=\"line\">         <span class=\"comment\">//Firefox4.0-  </span></span><br><span class=\"line\">         -moz-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  </span><br><span class=\"line\">  </span><br><span class=\"line\">         <span class=\"comment\">//Safariand Google chrome10.0-  </span></span><br><span class=\"line\">         -webkit-box-shadow:投影方式 X轴偏移量 Y轴偏移量阴影模糊半径 阴影扩展半径 阴影颜色;  </span><br><span class=\"line\">  </span><br><span class=\"line\">         <span class=\"comment\">//Firefox4.0+、 Google chrome 10.0+ 、 Oprea10.5+ and IE9  </span></span><br><span class=\"line\">         box-shadow:  投影方式 X轴偏移量 Y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"border-radius-（用于为元素添加圆角边框-）\"><a href=\"#border-radius-（用于为元素添加圆角边框-）\" class=\"headerlink\" title=\"border-radius （用于为元素添加圆角边框!）\"></a>border-radius （用于为元素添加圆角边框!）</h4><p><strong>定义和用法</strong></p>\n<p>border-radius 属性是一个简写属性，用于设置四个 <code>border-*-radius</code> 属性。</p>\n<table>\n<thead>\n<tr>\n<th>默认值</th>\n<th>0</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>继承性</td>\n<td>no</td>\n</tr>\n<tr>\n<td>版本</td>\n<td>CSS3</td>\n</tr>\n<tr>\n<td>JavaScript语法：</td>\n<td><em>object</em>.style.borderRadius=”5px”</td>\n</tr>\n</tbody>\n</table>\n<p><strong>语法</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-radius: <span class=\"number\">1</span><span class=\"number\">-4</span> length|% <span class=\"regexp\">/ 1-4 length|%;</span></span><br></pre></td></tr></table></figure>\n<p><strong>注释</strong>：按此顺序设置每个 radii 的四个值。如果省略 bottom-left，则与 top-right 相同。如果省略 bottom-right，则与 top-left 相同。如果省略 top-right，则与 top-left 相同。</p>\n<table>\n<thead>\n<tr>\n<th>值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>length</td>\n<td>定义圆角的形状</td>\n</tr>\n<tr>\n<td>%</td>\n<td>以百分比定义圆角的形状</td>\n</tr>\n</tbody>\n</table>\n<p><strong>例1：</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-radius: <span class=\"number\">2</span>em;</span><br></pre></td></tr></table></figure>\n<p>等价于</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-top-left-radius: <span class=\"number\">2</span>em;</span><br><span class=\"line\">border-top-right-radius: <span class=\"number\">2</span>em;</span><br><span class=\"line\">border-bottom-right-radius: <span class=\"number\">2</span>em;</span><br><span class=\"line\">border-bottom-left-radius: <span class=\"number\">2</span>em;</span><br></pre></td></tr></table></figure>\n<p><strong>例2</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-radius: <span class=\"number\">2</span>em <span class=\"number\">1</span>em <span class=\"number\">4</span>em / <span class=\"number\">0.5</span>em <span class=\"number\">3</span>em;</span><br></pre></td></tr></table></figure>\n<p>等价于：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">border-top-left-radius: <span class=\"number\">2</span>em <span class=\"number\">0.5</span>em;</span><br><span class=\"line\">border-top-right-radius: <span class=\"number\">1</span>em <span class=\"number\">3</span>em;</span><br><span class=\"line\">border-bottom-right-radius: <span class=\"number\">4</span>em <span class=\"number\">0.5</span>em;</span><br><span class=\"line\">border-bottom-left-radius: <span class=\"number\">1</span>em <span class=\"number\">3</span>em;</span><br></pre></td></tr></table></figure>\n<h4 id=\"box-shadow\"><a href=\"#box-shadow\" class=\"headerlink\" title=\"box-shadow\"></a>box-shadow</h4><blockquote>\n<p>box-shadow: 投影方式 x轴偏移量 y轴偏移量 阴影模糊半径 阴影扩展半径 阴影颜色</p>\n<p>阴影类型：此参数可选。如不设值，默认投影方式是外阴影；如取其唯一值“inset”，其投影为内阴影；</p>\n<p>X-offset:阴影水平偏移量，其值可以是正负值。如果值为正值，则阴影在对象的右边，其值为负值时，阴影在对象的左边</p>\n<p>Y-offset:阴影垂直偏移量，其值也可以是正负值。如果为正值，阴影在对象的底部，其值为负值时，阴影在对象的顶部；</p>\n<p>阴影模糊半径：此参数可选，，但其值只能是为正值，如果其值为0时，表示阴影不具有模糊效果，其值越大阴影的边缘就越模糊；</p>\n<p>阴影扩展半径：此参数可选，其值可以是正负值，如果值为正，则整个阴影都延展扩大，反之值为负值时，则缩小；</p>\n<p>阴影颜色：此参数可选。如不设定颜色，浏览器会取默认色，但各浏览器默认取色不一致，特别是在webkit内核下的safari和chrome浏览器下表现为透明色，在Firefox/Opera下表现为黑色（已验证），建议不要省略此参数。</p>\n</blockquote>\n<h4 id=\"border-image-（属性允许您规定用于边框的图片！）\"><a href=\"#border-image-（属性允许您规定用于边框的图片！）\" class=\"headerlink\" title=\"border-image （属性允许您规定用于边框的图片！）\"></a>border-image （属性允许您规定用于边框的图片！）</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.box-image &#123;  </span><br><span class=\"line\">    <span class=\"comment\">//Firefox4.0-  </span></span><br><span class=\"line\">    -moz-box-image:  url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round;  </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//Safariand Google chrome10.0-  </span></span><br><span class=\"line\">    -webkit-box-image:  url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round; </span><br><span class=\"line\">  </span><br><span class=\"line\">  \t<span class=\"comment\">// Opera</span></span><br><span class=\"line\">    -o-border-image: url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round</span><br><span class=\"line\"></span><br><span class=\"line\">    box-image: url(border.png) <span class=\"number\">30</span> <span class=\"number\">30</span> round;  <span class=\"comment\">// 角度</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"react-native-text","date":"2016-08-22T08:47:44.000Z","_content":"\n### Text\n\n一个用于显示文本的React组件\n\n`Text`支持嵌套、样式和触摸事件\n\n### Props\n\n---\naccessible bool\n\nWhen set to true, indicates that the view is an accessibility element. The default value for a Text element is true.\n\n\nSee the Accessibility guide for more information.\n---\n\nellipsizeMode enum('head', 'middle', 'tail', 'clip')\n\nThis can be one of the following values:\n\nhead - The line is displayed so that the end fits in the container and the missing text at the beginning of the line is indicated by an ellipsis glyph. e.g., \"...wxyz\"\nmiddle - The line is displayed so that the beginning and end fit in the container and the missing text in the middle is indicated by an ellipsis glyph. \"ab...yz\"\ntail - The line is displayed so that the beginning fits in the container and the missing text at the end of the line is indicated by an ellipsis glyph. e.g., \"abcd...\"\nclip - Lines are not drawn past the edge of the text container.\nThe default is tail.\n\nnumberOfLines must be set in conjunction with this prop.\n\nclip is working only for iOS\nnumberOfLines number\n\nUsed to truncate the text with an ellipsis after computing the text layout, including line wrapping, such that the total number of lines does not exceed this number.\n\nThis prop is commonly used with ellipsizeMode.\n\nonLayout function\n\nInvoked on mount and layout changes with\n\n{nativeEvent: {layout: {x, y, width, height}}}\n\nonLongPress function\n\nThis function is called on long press.\n\ne.g., `onLongPress={this.increaseSize}>``\n\nonPress function\n\nThis function is called on press.\n\ne.g., `onPress={() => console.log('1st')}``\n","source":"_posts/fe/react-native-text.md","raw":"---\ntitle: react-native-text\ndate: 2016-08-22 16:47:44\ntags: fe\n---\n\n### Text\n\n一个用于显示文本的React组件\n\n`Text`支持嵌套、样式和触摸事件\n\n### Props\n\n---\naccessible bool\n\nWhen set to true, indicates that the view is an accessibility element. The default value for a Text element is true.\n\n\nSee the Accessibility guide for more information.\n---\n\nellipsizeMode enum('head', 'middle', 'tail', 'clip')\n\nThis can be one of the following values:\n\nhead - The line is displayed so that the end fits in the container and the missing text at the beginning of the line is indicated by an ellipsis glyph. e.g., \"...wxyz\"\nmiddle - The line is displayed so that the beginning and end fit in the container and the missing text in the middle is indicated by an ellipsis glyph. \"ab...yz\"\ntail - The line is displayed so that the beginning fits in the container and the missing text at the end of the line is indicated by an ellipsis glyph. e.g., \"abcd...\"\nclip - Lines are not drawn past the edge of the text container.\nThe default is tail.\n\nnumberOfLines must be set in conjunction with this prop.\n\nclip is working only for iOS\nnumberOfLines number\n\nUsed to truncate the text with an ellipsis after computing the text layout, including line wrapping, such that the total number of lines does not exceed this number.\n\nThis prop is commonly used with ellipsizeMode.\n\nonLayout function\n\nInvoked on mount and layout changes with\n\n{nativeEvent: {layout: {x, y, width, height}}}\n\nonLongPress function\n\nThis function is called on long press.\n\ne.g., `onLongPress={this.increaseSize}>``\n\nonPress function\n\nThis function is called on press.\n\ne.g., `onPress={() => console.log('1st')}``\n","slug":"fe/react-native-text","published":1,"updated":"2018-01-31T09:35:37.815Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f30029izcbihbh1boy","content":"<h3 id=\"Text\"><a href=\"#Text\" class=\"headerlink\" title=\"Text\"></a>Text</h3><p>一个用于显示文本的React组件</p>\n<p><code>Text</code>支持嵌套、样式和触摸事件</p>\n<h3 id=\"Props\"><a href=\"#Props\" class=\"headerlink\" title=\"Props\"></a>Props</h3><hr>\n<p>accessible bool</p>\n<p>When set to true, indicates that the view is an accessibility element. The default value for a Text element is true.</p>\n<h2 id=\"See-the-Accessibility-guide-for-more-information\"><a href=\"#See-the-Accessibility-guide-for-more-information\" class=\"headerlink\" title=\"See the Accessibility guide for more information.\"></a>See the Accessibility guide for more information.</h2><p>ellipsizeMode enum(‘head’, ‘middle’, ‘tail’, ‘clip’)</p>\n<p>This can be one of the following values:</p>\n<p>head - The line is displayed so that the end fits in the container and the missing text at the beginning of the line is indicated by an ellipsis glyph. e.g., “…wxyz”<br>middle - The line is displayed so that the beginning and end fit in the container and the missing text in the middle is indicated by an ellipsis glyph. “ab…yz”<br>tail - The line is displayed so that the beginning fits in the container and the missing text at the end of the line is indicated by an ellipsis glyph. e.g., “abcd…”<br>clip - Lines are not drawn past the edge of the text container.<br>The default is tail.</p>\n<p>numberOfLines must be set in conjunction with this prop.</p>\n<p>clip is working only for iOS<br>numberOfLines number</p>\n<p>Used to truncate the text with an ellipsis after computing the text layout, including line wrapping, such that the total number of lines does not exceed this number.</p>\n<p>This prop is commonly used with ellipsizeMode.</p>\n<p>onLayout function</p>\n<p>Invoked on mount and layout changes with</p>\n<p>{nativeEvent: {layout: {x, y, width, height}}}</p>\n<p>onLongPress function</p>\n<p>This function is called on long press.</p>\n<p>e.g., `onLongPress={this.increaseSize}&gt;``</p>\n<p>onPress function</p>\n<p>This function is called on press.</p>\n<p>e.g., `onPress={() =&gt; console.log(‘1st’)}``</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Text\"><a href=\"#Text\" class=\"headerlink\" title=\"Text\"></a>Text</h3><p>一个用于显示文本的React组件</p>\n<p><code>Text</code>支持嵌套、样式和触摸事件</p>\n<h3 id=\"Props\"><a href=\"#Props\" class=\"headerlink\" title=\"Props\"></a>Props</h3><hr>\n<p>accessible bool</p>\n<p>When set to true, indicates that the view is an accessibility element. The default value for a Text element is true.</p>\n<h2 id=\"See-the-Accessibility-guide-for-more-information\"><a href=\"#See-the-Accessibility-guide-for-more-information\" class=\"headerlink\" title=\"See the Accessibility guide for more information.\"></a>See the Accessibility guide for more information.</h2><p>ellipsizeMode enum(‘head’, ‘middle’, ‘tail’, ‘clip’)</p>\n<p>This can be one of the following values:</p>\n<p>head - The line is displayed so that the end fits in the container and the missing text at the beginning of the line is indicated by an ellipsis glyph. e.g., “…wxyz”<br>middle - The line is displayed so that the beginning and end fit in the container and the missing text in the middle is indicated by an ellipsis glyph. “ab…yz”<br>tail - The line is displayed so that the beginning fits in the container and the missing text at the end of the line is indicated by an ellipsis glyph. e.g., “abcd…”<br>clip - Lines are not drawn past the edge of the text container.<br>The default is tail.</p>\n<p>numberOfLines must be set in conjunction with this prop.</p>\n<p>clip is working only for iOS<br>numberOfLines number</p>\n<p>Used to truncate the text with an ellipsis after computing the text layout, including line wrapping, such that the total number of lines does not exceed this number.</p>\n<p>This prop is commonly used with ellipsizeMode.</p>\n<p>onLayout function</p>\n<p>Invoked on mount and layout changes with</p>\n<p>{nativeEvent: {layout: {x, y, width, height}}}</p>\n<p>onLongPress function</p>\n<p>This function is called on long press.</p>\n<p>e.g., `onLongPress={this.increaseSize}&gt;``</p>\n<p>onPress function</p>\n<p>This function is called on press.</p>\n<p>e.g., `onPress={() =&gt; console.log(‘1st’)}``</p>\n"},{"title":"react-native-flex","date":"2016-08-29T07:18:42.000Z","_content":"\n### 使用Flexbox布局\n\n我们在React Native中使用flexbox规则来指定某个组件的子元素的布局。Flexbox可以在不同屏幕尺寸上提供一致的布局结构。\n\n一般来说，使用`flexDirection`、`alignItems`、`justifyContent`三个样式属性就已经能满足大多数布局要求。\n\n#### Flex Direction\n\n在组件的`style`中指定`flexDirection`可以决定布局的**主轴**。子元素是应该沿着**水平轴**(row)方向排列，还是沿着**竖直轴**(column)方向排列呢？默认值是**竖直轴**(column)方向。\n\n#### Justify Content\n\n在组件的style中指定`justifyContent`可以决定其子元素沿着**主轴**的**排列方式**。子元素是应该靠近主轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：`flex-start`、`center`、`flex-end`、`space-around`以及`space-between`\n\n#### Align Items\n\n在组件的style中指定`alignItems`可以决定其子元素沿着**次轴**（与主轴垂直的轴，比如若主轴方向为row，则次轴方向为column）的排列方式。子元素是应该靠近次轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：`flex-start`、`center`、`flex-end`以及`stretch`。\n\n> 注意：要使stretch选项生效的话，子元素在次轴方向上不能有固定的尺寸\n","source":"_posts/fe/react-native-flex.md","raw":"---\ntitle: react-native-flex\ndate: 2016-08-29 15:18:42\ntags: fe\n---\n\n### 使用Flexbox布局\n\n我们在React Native中使用flexbox规则来指定某个组件的子元素的布局。Flexbox可以在不同屏幕尺寸上提供一致的布局结构。\n\n一般来说，使用`flexDirection`、`alignItems`、`justifyContent`三个样式属性就已经能满足大多数布局要求。\n\n#### Flex Direction\n\n在组件的`style`中指定`flexDirection`可以决定布局的**主轴**。子元素是应该沿着**水平轴**(row)方向排列，还是沿着**竖直轴**(column)方向排列呢？默认值是**竖直轴**(column)方向。\n\n#### Justify Content\n\n在组件的style中指定`justifyContent`可以决定其子元素沿着**主轴**的**排列方式**。子元素是应该靠近主轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：`flex-start`、`center`、`flex-end`、`space-around`以及`space-between`\n\n#### Align Items\n\n在组件的style中指定`alignItems`可以决定其子元素沿着**次轴**（与主轴垂直的轴，比如若主轴方向为row，则次轴方向为column）的排列方式。子元素是应该靠近次轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：`flex-start`、`center`、`flex-end`以及`stretch`。\n\n> 注意：要使stretch选项生效的话，子元素在次轴方向上不能有固定的尺寸\n","slug":"fe/react-native-flex","published":1,"updated":"2018-01-31T09:35:37.815Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f4002cizcbir9zp3um","content":"<h3 id=\"使用Flexbox布局\"><a href=\"#使用Flexbox布局\" class=\"headerlink\" title=\"使用Flexbox布局\"></a>使用Flexbox布局</h3><p>我们在React Native中使用flexbox规则来指定某个组件的子元素的布局。Flexbox可以在不同屏幕尺寸上提供一致的布局结构。</p>\n<p>一般来说，使用<code>flexDirection</code>、<code>alignItems</code>、<code>justifyContent</code>三个样式属性就已经能满足大多数布局要求。</p>\n<h4 id=\"Flex-Direction\"><a href=\"#Flex-Direction\" class=\"headerlink\" title=\"Flex Direction\"></a>Flex Direction</h4><p>在组件的<code>style</code>中指定<code>flexDirection</code>可以决定布局的<strong>主轴</strong>。子元素是应该沿着<strong>水平轴</strong>(row)方向排列，还是沿着<strong>竖直轴</strong>(column)方向排列呢？默认值是<strong>竖直轴</strong>(column)方向。</p>\n<h4 id=\"Justify-Content\"><a href=\"#Justify-Content\" class=\"headerlink\" title=\"Justify Content\"></a>Justify Content</h4><p>在组件的style中指定<code>justifyContent</code>可以决定其子元素沿着<strong>主轴</strong>的<strong>排列方式</strong>。子元素是应该靠近主轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：<code>flex-start</code>、<code>center</code>、<code>flex-end</code>、<code>space-around</code>以及<code>space-between</code></p>\n<h4 id=\"Align-Items\"><a href=\"#Align-Items\" class=\"headerlink\" title=\"Align Items\"></a>Align Items</h4><p>在组件的style中指定<code>alignItems</code>可以决定其子元素沿着<strong>次轴</strong>（与主轴垂直的轴，比如若主轴方向为row，则次轴方向为column）的排列方式。子元素是应该靠近次轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：<code>flex-start</code>、<code>center</code>、<code>flex-end</code>以及<code>stretch</code>。</p>\n<blockquote>\n<p>注意：要使stretch选项生效的话，子元素在次轴方向上不能有固定的尺寸</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"使用Flexbox布局\"><a href=\"#使用Flexbox布局\" class=\"headerlink\" title=\"使用Flexbox布局\"></a>使用Flexbox布局</h3><p>我们在React Native中使用flexbox规则来指定某个组件的子元素的布局。Flexbox可以在不同屏幕尺寸上提供一致的布局结构。</p>\n<p>一般来说，使用<code>flexDirection</code>、<code>alignItems</code>、<code>justifyContent</code>三个样式属性就已经能满足大多数布局要求。</p>\n<h4 id=\"Flex-Direction\"><a href=\"#Flex-Direction\" class=\"headerlink\" title=\"Flex Direction\"></a>Flex Direction</h4><p>在组件的<code>style</code>中指定<code>flexDirection</code>可以决定布局的<strong>主轴</strong>。子元素是应该沿着<strong>水平轴</strong>(row)方向排列，还是沿着<strong>竖直轴</strong>(column)方向排列呢？默认值是<strong>竖直轴</strong>(column)方向。</p>\n<h4 id=\"Justify-Content\"><a href=\"#Justify-Content\" class=\"headerlink\" title=\"Justify Content\"></a>Justify Content</h4><p>在组件的style中指定<code>justifyContent</code>可以决定其子元素沿着<strong>主轴</strong>的<strong>排列方式</strong>。子元素是应该靠近主轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：<code>flex-start</code>、<code>center</code>、<code>flex-end</code>、<code>space-around</code>以及<code>space-between</code></p>\n<h4 id=\"Align-Items\"><a href=\"#Align-Items\" class=\"headerlink\" title=\"Align Items\"></a>Align Items</h4><p>在组件的style中指定<code>alignItems</code>可以决定其子元素沿着<strong>次轴</strong>（与主轴垂直的轴，比如若主轴方向为row，则次轴方向为column）的排列方式。子元素是应该靠近次轴的起始端还是末尾段分布呢？亦或应该均匀分布？对应的这些可选项有：<code>flex-start</code>、<code>center</code>、<code>flex-end</code>以及<code>stretch</code>。</p>\n<blockquote>\n<p>注意：要使stretch选项生效的话，子元素在次轴方向上不能有固定的尺寸</p>\n</blockquote>\n"},{"title":"react-native-view","date":"2016-08-22T08:22:47.000Z","_content":"\n### View\n\n最基本的构建UI视图的容器，`View` 支持flexbox、style、一些触摸事件和访问性控制，`View`直接映射到`native`视图，不管在什么平台，不管它是UIView，<div>，android.view，等等...\n\n`View`设计成嵌套其它视图，可以有0到任何类型的children\n\n> View的设计初衷是和StyleSheet搭配使用，这样可以使代码更清晰并且获得更高的性能。尽管内联样式也同样可以使用\n\n### 合成触摸事件\n\n### Props\n\n#### style\n\n`backfaceVisibility` ReactPropTypes.oneOf(['visible', 'hidden'])\n`backgroundColor` color\n`borderBottomColor` color\n`borderBottomLeftRadius` ReactPropTypes.number\n`borderBottomRightRadius` ReactPropTypes.number\n`borderBottomWidth` ReactPropTypes.number\n`borderColor` color\n`borderLeftColor` color\n`borderLeftWidth` ReactPropTypes.number\n`borderRadius` ReactPropTypes.number\n`borderRightColor` color\n`borderRightWidth` ReactPropTypes.number\n`borderStyle` ReactPropTypes.oneOf(['solid', 'dotted', 'dashed'])\n`borderTopColor` color\n`borderTopLeftRadius` ReactPropTypes.number\n`borderTopRightRadius` ReactPropTypes.number\n`borderTopWidth` ReactPropTypes.number\n`borderWidth` ReactPropTypes.number\n`opacity` ReactPropTypes.number\n`overflow` ReactPropTypes.oneOf(['visible', 'hidden'])\n","source":"_posts/fe/react-native-view.md","raw":"---\ntitle: react-native-view\ndate: 2016-08-22 16:22:47\ntags: fe\n---\n\n### View\n\n最基本的构建UI视图的容器，`View` 支持flexbox、style、一些触摸事件和访问性控制，`View`直接映射到`native`视图，不管在什么平台，不管它是UIView，<div>，android.view，等等...\n\n`View`设计成嵌套其它视图，可以有0到任何类型的children\n\n> View的设计初衷是和StyleSheet搭配使用，这样可以使代码更清晰并且获得更高的性能。尽管内联样式也同样可以使用\n\n### 合成触摸事件\n\n### Props\n\n#### style\n\n`backfaceVisibility` ReactPropTypes.oneOf(['visible', 'hidden'])\n`backgroundColor` color\n`borderBottomColor` color\n`borderBottomLeftRadius` ReactPropTypes.number\n`borderBottomRightRadius` ReactPropTypes.number\n`borderBottomWidth` ReactPropTypes.number\n`borderColor` color\n`borderLeftColor` color\n`borderLeftWidth` ReactPropTypes.number\n`borderRadius` ReactPropTypes.number\n`borderRightColor` color\n`borderRightWidth` ReactPropTypes.number\n`borderStyle` ReactPropTypes.oneOf(['solid', 'dotted', 'dashed'])\n`borderTopColor` color\n`borderTopLeftRadius` ReactPropTypes.number\n`borderTopRightRadius` ReactPropTypes.number\n`borderTopWidth` ReactPropTypes.number\n`borderWidth` ReactPropTypes.number\n`opacity` ReactPropTypes.number\n`overflow` ReactPropTypes.oneOf(['visible', 'hidden'])\n","slug":"fe/react-native-view","published":1,"updated":"2018-01-31T09:35:37.815Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f5002eizcbha4suxg7","content":"<h3 id=\"View\"><a href=\"#View\" class=\"headerlink\" title=\"View\"></a>View</h3><p>最基本的构建UI视图的容器，<code>View</code> 支持flexbox、style、一些触摸事件和访问性控制，<code>View</code>直接映射到<code>native</code>视图，不管在什么平台，不管它是UIView，<div>，android.view，等等…</div></p>\n<p><code>View</code>设计成嵌套其它视图，可以有0到任何类型的children</p>\n<blockquote>\n<p>View的设计初衷是和StyleSheet搭配使用，这样可以使代码更清晰并且获得更高的性能。尽管内联样式也同样可以使用</p>\n</blockquote>\n<h3 id=\"合成触摸事件\"><a href=\"#合成触摸事件\" class=\"headerlink\" title=\"合成触摸事件\"></a>合成触摸事件</h3><h3 id=\"Props\"><a href=\"#Props\" class=\"headerlink\" title=\"Props\"></a>Props</h3><h4 id=\"style\"><a href=\"#style\" class=\"headerlink\" title=\"style\"></a>style</h4><p><code>backfaceVisibility</code> ReactPropTypes.oneOf([‘visible’, ‘hidden’])<br><code>backgroundColor</code> color<br><code>borderBottomColor</code> color<br><code>borderBottomLeftRadius</code> ReactPropTypes.number<br><code>borderBottomRightRadius</code> ReactPropTypes.number<br><code>borderBottomWidth</code> ReactPropTypes.number<br><code>borderColor</code> color<br><code>borderLeftColor</code> color<br><code>borderLeftWidth</code> ReactPropTypes.number<br><code>borderRadius</code> ReactPropTypes.number<br><code>borderRightColor</code> color<br><code>borderRightWidth</code> ReactPropTypes.number<br><code>borderStyle</code> ReactPropTypes.oneOf([‘solid’, ‘dotted’, ‘dashed’])<br><code>borderTopColor</code> color<br><code>borderTopLeftRadius</code> ReactPropTypes.number<br><code>borderTopRightRadius</code> ReactPropTypes.number<br><code>borderTopWidth</code> ReactPropTypes.number<br><code>borderWidth</code> ReactPropTypes.number<br><code>opacity</code> ReactPropTypes.number<br><code>overflow</code> ReactPropTypes.oneOf([‘visible’, ‘hidden’])</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"View\"><a href=\"#View\" class=\"headerlink\" title=\"View\"></a>View</h3><p>最基本的构建UI视图的容器，<code>View</code> 支持flexbox、style、一些触摸事件和访问性控制，<code>View</code>直接映射到<code>native</code>视图，不管在什么平台，不管它是UIView，<div>，android.view，等等…</div></p>\n<p><code>View</code>设计成嵌套其它视图，可以有0到任何类型的children</p>\n<blockquote>\n<p>View的设计初衷是和StyleSheet搭配使用，这样可以使代码更清晰并且获得更高的性能。尽管内联样式也同样可以使用</p>\n</blockquote>\n<h3 id=\"合成触摸事件\"><a href=\"#合成触摸事件\" class=\"headerlink\" title=\"合成触摸事件\"></a>合成触摸事件</h3><h3 id=\"Props\"><a href=\"#Props\" class=\"headerlink\" title=\"Props\"></a>Props</h3><h4 id=\"style\"><a href=\"#style\" class=\"headerlink\" title=\"style\"></a>style</h4><p><code>backfaceVisibility</code> ReactPropTypes.oneOf([‘visible’, ‘hidden’])<br><code>backgroundColor</code> color<br><code>borderBottomColor</code> color<br><code>borderBottomLeftRadius</code> ReactPropTypes.number<br><code>borderBottomRightRadius</code> ReactPropTypes.number<br><code>borderBottomWidth</code> ReactPropTypes.number<br><code>borderColor</code> color<br><code>borderLeftColor</code> color<br><code>borderLeftWidth</code> ReactPropTypes.number<br><code>borderRadius</code> ReactPropTypes.number<br><code>borderRightColor</code> color<br><code>borderRightWidth</code> ReactPropTypes.number<br><code>borderStyle</code> ReactPropTypes.oneOf([‘solid’, ‘dotted’, ‘dashed’])<br><code>borderTopColor</code> color<br><code>borderTopLeftRadius</code> ReactPropTypes.number<br><code>borderTopRightRadius</code> ReactPropTypes.number<br><code>borderTopWidth</code> ReactPropTypes.number<br><code>borderWidth</code> ReactPropTypes.number<br><code>opacity</code> ReactPropTypes.number<br><code>overflow</code> ReactPropTypes.oneOf([‘visible’, ‘hidden’])</p>\n"},{"title":"正则表达式","date":"2016-05-23T13:36:57.000Z","_content":"\n# 概述\n\n> 熟练地掌握正则表达式，能够使你的开发效率得到极大的提升。\n\n下面来梳理了一下常用的正则表达式\n\n1. 校验密码强度\n\n   密码的强度必须是包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间\n\n   ```java\n   ^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$\n   ```\n\n2. 校验中文\n\n   字符串仅能是中文。\n\n   ```java\n   ^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$\n   ```\n\n3. 由数字、26个英文字母或下划线组成的字符串\n\n   ```java\n   ^\\\\w+$\n   ```\n\n4. 校验E-Mail地址\n\n   同密码一样，下面是E-mail地址合规性的正则检查语句。\n\n   ```java\n   [\\\\w!#$%&'*+/=?^_`{|}~-]+(?:\\\\.[\\\\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\\\\w](?:[\\\\w-]*[\\\\w])?\n   ```\n\n5. 校验身份证号码\n\n   下面是身份证号码的正则校验。15或18位。\n\n   15位\n\n   ```java\n   ^[1-9]\\\\d{7}((0\\\\d)|(1[0-2]))(([0|1|2]\\\\d)|3[0-1])\\\\d{3}$\n   ```\n\n   18位\n\n   ```java\n   ^[1-9]\\\\d{5}[1-9]\\\\d{3}((0\\\\d)|(1[0-2]))(([0|1|2]\\\\d)|3[0-1])\\\\d{3}([0-9]|X)$\n   ```\n\n6. 校验日期\n\n   \"yyyy-mm-dd\"格式的日期校验，已考虑平闰年。\n\n   ```java\n   ^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$\n   ```\n\n7. 校验金额\n\n   金额校验，精确到2位小数\n\n   ```java\n   ^[0-9]+(.[0-9]{2})?$\n   ```\n\n8. 校验手机号\n\n   下面是国内 13、15、18开头的手机号正则表达式。（可根据目前国内收集号扩展前两位开头号码）\n\n   ```java\n   ^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\\\d{8}$\n   ```\n\n9. 提取URL链接\n\n   下面的这个表达式可以筛选出一段文本中的URL\n\n   ```java\n   ^(f|ht){1}(tp|tps):\\\\/\\\\/([\\\\w-]+\\\\.)+[\\\\w-]+(\\\\/[\\\\w- ./?%&=]*)?\n   ```\n","source":"_posts/fe/regular-expression.md","raw":"---\ntitle: 正则表达式\ndate: 2016-05-23 21:36:57\ntags: fe\n---\n\n# 概述\n\n> 熟练地掌握正则表达式，能够使你的开发效率得到极大的提升。\n\n下面来梳理了一下常用的正则表达式\n\n1. 校验密码强度\n\n   密码的强度必须是包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间\n\n   ```java\n   ^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$\n   ```\n\n2. 校验中文\n\n   字符串仅能是中文。\n\n   ```java\n   ^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$\n   ```\n\n3. 由数字、26个英文字母或下划线组成的字符串\n\n   ```java\n   ^\\\\w+$\n   ```\n\n4. 校验E-Mail地址\n\n   同密码一样，下面是E-mail地址合规性的正则检查语句。\n\n   ```java\n   [\\\\w!#$%&'*+/=?^_`{|}~-]+(?:\\\\.[\\\\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\\\\w](?:[\\\\w-]*[\\\\w])?\n   ```\n\n5. 校验身份证号码\n\n   下面是身份证号码的正则校验。15或18位。\n\n   15位\n\n   ```java\n   ^[1-9]\\\\d{7}((0\\\\d)|(1[0-2]))(([0|1|2]\\\\d)|3[0-1])\\\\d{3}$\n   ```\n\n   18位\n\n   ```java\n   ^[1-9]\\\\d{5}[1-9]\\\\d{3}((0\\\\d)|(1[0-2]))(([0|1|2]\\\\d)|3[0-1])\\\\d{3}([0-9]|X)$\n   ```\n\n6. 校验日期\n\n   \"yyyy-mm-dd\"格式的日期校验，已考虑平闰年。\n\n   ```java\n   ^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$\n   ```\n\n7. 校验金额\n\n   金额校验，精确到2位小数\n\n   ```java\n   ^[0-9]+(.[0-9]{2})?$\n   ```\n\n8. 校验手机号\n\n   下面是国内 13、15、18开头的手机号正则表达式。（可根据目前国内收集号扩展前两位开头号码）\n\n   ```java\n   ^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\\\d{8}$\n   ```\n\n9. 提取URL链接\n\n   下面的这个表达式可以筛选出一段文本中的URL\n\n   ```java\n   ^(f|ht){1}(tp|tps):\\\\/\\\\/([\\\\w-]+\\\\.)+[\\\\w-]+(\\\\/[\\\\w- ./?%&=]*)?\n   ```\n","slug":"fe/regular-expression","published":1,"updated":"2018-01-31T09:35:37.815Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f6002hizcb11is1mwn","content":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><blockquote>\n<p>熟练地掌握正则表达式，能够使你的开发效率得到极大的提升。</p>\n</blockquote>\n<p>下面来梳理了一下常用的正则表达式</p>\n<ol>\n<li><p>校验密码强度</p>\n<p>密码的强度必须是包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;<span class=\"number\">8</span>,<span class=\"number\">10</span>&#125;$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验中文</p>\n<p>字符串仅能是中文。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;<span class=\"number\">8</span>,<span class=\"number\">10</span>&#125;$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>由数字、26个英文字母或下划线组成的字符串</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^\\\\w+$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验E-Mail地址</p>\n<p>同密码一样，下面是E-mail地址合规性的正则检查语句。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[\\\\w!#$%&amp;'*+/=?^_`&#123;|&#125;~-]+(?:\\\\.[\\\\w!#$%&amp;'*+/=?^_`&#123;|&#125;~-]+)*@(?:[\\\\w](?:[\\\\w-]*[\\\\w])?</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验身份证号码</p>\n<p>下面是身份证号码的正则校验。15或18位。</p>\n<p>15位</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^[<span class=\"number\">1</span>-<span class=\"number\">9</span>]\\\\d&#123;<span class=\"number\">7</span>&#125;((<span class=\"number\">0</span>\\\\d)|(<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>]))(([<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>]\\\\d)|<span class=\"number\">3</span>[<span class=\"number\">0</span>-<span class=\"number\">1</span>])\\\\d&#123;<span class=\"number\">3</span>&#125;$</span><br></pre></td></tr></table></figure>\n<p>18位</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^[<span class=\"number\">1</span>-<span class=\"number\">9</span>]\\\\d&#123;<span class=\"number\">5</span>&#125;[<span class=\"number\">1</span>-<span class=\"number\">9</span>]\\\\d&#123;<span class=\"number\">3</span>&#125;((<span class=\"number\">0</span>\\\\d)|(<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>]))(([<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>]\\\\d)|<span class=\"number\">3</span>[<span class=\"number\">0</span>-<span class=\"number\">1</span>])\\\\d&#123;<span class=\"number\">3</span>&#125;([<span class=\"number\">0</span>-<span class=\"number\">9</span>]|X)$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验日期</p>\n<p>“yyyy-mm-dd”格式的日期校验，已考虑平闰年。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(?:(?!<span class=\"number\">0000</span>)[<span class=\"number\">0</span>-<span class=\"number\">9</span>]&#123;<span class=\"number\">4</span>&#125;-(?:(?:<span class=\"number\">0</span>[<span class=\"number\">1</span>-<span class=\"number\">9</span>]|<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>])-(?:<span class=\"number\">0</span>[<span class=\"number\">1</span>-<span class=\"number\">9</span>]|<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">9</span>]|<span class=\"number\">2</span>[<span class=\"number\">0</span>-<span class=\"number\">8</span>])|(?:<span class=\"number\">0</span>[<span class=\"number\">13</span>-<span class=\"number\">9</span>]|<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>])-(?:<span class=\"number\">29</span>|<span class=\"number\">30</span>)|(?:<span class=\"number\">0</span>[<span class=\"number\">13578</span>]|<span class=\"number\">1</span>[<span class=\"number\">02</span>])-<span class=\"number\">31</span>)|(?:[<span class=\"number\">0</span>-<span class=\"number\">9</span>]&#123;<span class=\"number\">2</span>&#125;(?:<span class=\"number\">0</span>[<span class=\"number\">48</span>]|[<span class=\"number\">2468</span>][<span class=\"number\">048</span>]|[<span class=\"number\">13579</span>][<span class=\"number\">26</span>])|(?:<span class=\"number\">0</span>[<span class=\"number\">48</span>]|[<span class=\"number\">2468</span>][<span class=\"number\">048</span>]|[<span class=\"number\">13579</span>][<span class=\"number\">26</span>])<span class=\"number\">00</span>)-<span class=\"number\">02</span>-<span class=\"number\">29</span>)$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验金额</p>\n<p>金额校验，精确到2位小数</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^[<span class=\"number\">0</span>-<span class=\"number\">9</span>]+(.[<span class=\"number\">0</span>-<span class=\"number\">9</span>]&#123;<span class=\"number\">2</span>&#125;)?$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验手机号</p>\n<p>下面是国内 13、15、18开头的手机号正则表达式。（可根据目前国内收集号扩展前两位开头号码）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(<span class=\"number\">13</span>[<span class=\"number\">0</span>-<span class=\"number\">9</span>]|<span class=\"number\">14</span>[<span class=\"number\">5</span>|<span class=\"number\">7</span>]|<span class=\"number\">15</span>[<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>|<span class=\"number\">3</span>|<span class=\"number\">5</span>|<span class=\"number\">6</span>|<span class=\"number\">7</span>|<span class=\"number\">8</span>|<span class=\"number\">9</span>]|<span class=\"number\">18</span>[<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>|<span class=\"number\">3</span>|<span class=\"number\">5</span>|<span class=\"number\">6</span>|<span class=\"number\">7</span>|<span class=\"number\">8</span>|<span class=\"number\">9</span>])\\\\d&#123;<span class=\"number\">8</span>&#125;$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>提取URL链接</p>\n<p>下面的这个表达式可以筛选出一段文本中的URL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(f|ht)&#123;<span class=\"number\">1</span>&#125;(tp|tps):\\\\/\\\\/([\\\\w-]+\\\\.)+[\\\\w-]+(\\\\/[\\\\w- ./?%&amp;=]*)?</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><blockquote>\n<p>熟练地掌握正则表达式，能够使你的开发效率得到极大的提升。</p>\n</blockquote>\n<p>下面来梳理了一下常用的正则表达式</p>\n<ol>\n<li><p>校验密码强度</p>\n<p>密码的强度必须是包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;<span class=\"number\">8</span>,<span class=\"number\">10</span>&#125;$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验中文</p>\n<p>字符串仅能是中文。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(?=.*\\\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;<span class=\"number\">8</span>,<span class=\"number\">10</span>&#125;$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>由数字、26个英文字母或下划线组成的字符串</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^\\\\w+$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验E-Mail地址</p>\n<p>同密码一样，下面是E-mail地址合规性的正则检查语句。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[\\\\w!#$%&amp;'*+/=?^_`&#123;|&#125;~-]+(?:\\\\.[\\\\w!#$%&amp;'*+/=?^_`&#123;|&#125;~-]+)*@(?:[\\\\w](?:[\\\\w-]*[\\\\w])?</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验身份证号码</p>\n<p>下面是身份证号码的正则校验。15或18位。</p>\n<p>15位</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^[<span class=\"number\">1</span>-<span class=\"number\">9</span>]\\\\d&#123;<span class=\"number\">7</span>&#125;((<span class=\"number\">0</span>\\\\d)|(<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>]))(([<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>]\\\\d)|<span class=\"number\">3</span>[<span class=\"number\">0</span>-<span class=\"number\">1</span>])\\\\d&#123;<span class=\"number\">3</span>&#125;$</span><br></pre></td></tr></table></figure>\n<p>18位</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^[<span class=\"number\">1</span>-<span class=\"number\">9</span>]\\\\d&#123;<span class=\"number\">5</span>&#125;[<span class=\"number\">1</span>-<span class=\"number\">9</span>]\\\\d&#123;<span class=\"number\">3</span>&#125;((<span class=\"number\">0</span>\\\\d)|(<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>]))(([<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>]\\\\d)|<span class=\"number\">3</span>[<span class=\"number\">0</span>-<span class=\"number\">1</span>])\\\\d&#123;<span class=\"number\">3</span>&#125;([<span class=\"number\">0</span>-<span class=\"number\">9</span>]|X)$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验日期</p>\n<p>“yyyy-mm-dd”格式的日期校验，已考虑平闰年。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(?:(?!<span class=\"number\">0000</span>)[<span class=\"number\">0</span>-<span class=\"number\">9</span>]&#123;<span class=\"number\">4</span>&#125;-(?:(?:<span class=\"number\">0</span>[<span class=\"number\">1</span>-<span class=\"number\">9</span>]|<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>])-(?:<span class=\"number\">0</span>[<span class=\"number\">1</span>-<span class=\"number\">9</span>]|<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">9</span>]|<span class=\"number\">2</span>[<span class=\"number\">0</span>-<span class=\"number\">8</span>])|(?:<span class=\"number\">0</span>[<span class=\"number\">13</span>-<span class=\"number\">9</span>]|<span class=\"number\">1</span>[<span class=\"number\">0</span>-<span class=\"number\">2</span>])-(?:<span class=\"number\">29</span>|<span class=\"number\">30</span>)|(?:<span class=\"number\">0</span>[<span class=\"number\">13578</span>]|<span class=\"number\">1</span>[<span class=\"number\">02</span>])-<span class=\"number\">31</span>)|(?:[<span class=\"number\">0</span>-<span class=\"number\">9</span>]&#123;<span class=\"number\">2</span>&#125;(?:<span class=\"number\">0</span>[<span class=\"number\">48</span>]|[<span class=\"number\">2468</span>][<span class=\"number\">048</span>]|[<span class=\"number\">13579</span>][<span class=\"number\">26</span>])|(?:<span class=\"number\">0</span>[<span class=\"number\">48</span>]|[<span class=\"number\">2468</span>][<span class=\"number\">048</span>]|[<span class=\"number\">13579</span>][<span class=\"number\">26</span>])<span class=\"number\">00</span>)-<span class=\"number\">02</span>-<span class=\"number\">29</span>)$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验金额</p>\n<p>金额校验，精确到2位小数</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^[<span class=\"number\">0</span>-<span class=\"number\">9</span>]+(.[<span class=\"number\">0</span>-<span class=\"number\">9</span>]&#123;<span class=\"number\">2</span>&#125;)?$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>校验手机号</p>\n<p>下面是国内 13、15、18开头的手机号正则表达式。（可根据目前国内收集号扩展前两位开头号码）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(<span class=\"number\">13</span>[<span class=\"number\">0</span>-<span class=\"number\">9</span>]|<span class=\"number\">14</span>[<span class=\"number\">5</span>|<span class=\"number\">7</span>]|<span class=\"number\">15</span>[<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>|<span class=\"number\">3</span>|<span class=\"number\">5</span>|<span class=\"number\">6</span>|<span class=\"number\">7</span>|<span class=\"number\">8</span>|<span class=\"number\">9</span>]|<span class=\"number\">18</span>[<span class=\"number\">0</span>|<span class=\"number\">1</span>|<span class=\"number\">2</span>|<span class=\"number\">3</span>|<span class=\"number\">5</span>|<span class=\"number\">6</span>|<span class=\"number\">7</span>|<span class=\"number\">8</span>|<span class=\"number\">9</span>])\\\\d&#123;<span class=\"number\">8</span>&#125;$</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>提取URL链接</p>\n<p>下面的这个表达式可以筛选出一段文本中的URL</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">^(f|ht)&#123;<span class=\"number\">1</span>&#125;(tp|tps):\\\\/\\\\/([\\\\w-]+\\\\.)+[\\\\w-]+(\\\\/[\\\\w- ./?%&amp;=]*)?</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n"},{"title":"flutter-started","date":"2018-03-09T08:56:03.000Z","_content":"","source":"_posts/flutter/flutter-started.md","raw":"---\ntitle: flutter-started\ndate: 2018-03-09 16:56:03\ntags:\n---\n","slug":"flutter/flutter-started","published":1,"updated":"2018-05-20T13:04:25.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f7002jizcbpc4qbstp","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Hexo错误集锦","date":"2018-01-30T02:38:13.000Z","_content":"\n使用Hexo部署的过程中报出以下错误。\n\n```python\nHexo: TypeError: Cannot set property 'lastIndex' of undefined\n```\n\n解决方法：打开主工程的配置文件_config.yml(非主题里面的配置文件)，找到`auto_detect`，设置为false即可 \n\n\n\nERROR Deployer not found: git\n\n```\nnpm install hexo-deployer-git --save\n```\n\nnpm i hexo-generator-json-content --save","source":"_posts/hole/hexo-error.md","raw":"---\ntitle: Hexo错误集锦\ndate: 2018-01-30 10:38:13\ntags: hole\n---\n\n使用Hexo部署的过程中报出以下错误。\n\n```python\nHexo: TypeError: Cannot set property 'lastIndex' of undefined\n```\n\n解决方法：打开主工程的配置文件_config.yml(非主题里面的配置文件)，找到`auto_detect`，设置为false即可 \n\n\n\nERROR Deployer not found: git\n\n```\nnpm install hexo-deployer-git --save\n```\n\nnpm i hexo-generator-json-content --save","slug":"hole/hexo-error","published":1,"updated":"2018-01-31T13:04:16.295Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f8002mizcbc11te4ck","content":"<p>使用Hexo部署的过程中报出以下错误。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hexo: TypeError: Cannot set property <span class=\"string\">'lastIndex'</span> of undefined</span><br></pre></td></tr></table></figure>\n<p>解决方法：打开主工程的配置文件_config.yml(非主题里面的配置文件)，找到<code>auto_detect</code>，设置为false即可 </p>\n<p>ERROR Deployer not found: git</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n<p>npm i hexo-generator-json-content –save</p>\n","site":{"data":{}},"excerpt":"","more":"<p>使用Hexo部署的过程中报出以下错误。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hexo: TypeError: Cannot set property <span class=\"string\">'lastIndex'</span> of undefined</span><br></pre></td></tr></table></figure>\n<p>解决方法：打开主工程的配置文件_config.yml(非主题里面的配置文件)，找到<code>auto_detect</code>，设置为false即可 </p>\n<p>ERROR Deployer not found: git</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n<p>npm i hexo-generator-json-content –save</p>\n"},{"title":"记一次Android端H5调用微信支付引发的坑","date":"2018-01-30T07:28:26.000Z","_content":"\n### 事件背景\n\n今天一位H5的同事过来找我们，说他们在H5里调用微信支付(不是通过jsapi调用)，到支付界面，点击返回键，会导致APP重新启动，把`webview`给关掉了\n\n### 事件原因分析\n\n经过我一顿猛操作，最后发现原来是`webview`设置`userAgent`引发的问题。\n\n因为H5的要求，我们会在`userAgent`里设置一些信息，这里以`abc`为例，我们把`abc`这个字符串设置到了`userAgent`里，同时在`AndroidManifest`的`activity`节点注册了`abc`的`scheme`\n\n```java\n// 设置userAgent\nwebSettings.setUserAgentString(ua + \" abc/\" + getVersionName());\n```\n\n```java\n// 设置scheme\n<intent-filter>\n  <data android:scheme=\"abc\" />\n  <action android:name=\"android.intent.action.VIEW\" />\n  <category android:name=\"android.intent.category.DEFAULT\" />\n  <category android:name=\"android.intent.category.BROWSABLE\" />\n</intent-filter>\n```\n\n这里设置之后，当点击微信支付的返回按钮后，发现微信会发起一个类似下面结构的`Intent`:\n\n```\nurl: abc://\naction: android.intent.action.VIEW\n```\n\n这里导致我们注册的`scheme`的`Activiy`会接收到，导致应用重启。\n\n### 解决办法\n\n通过我们的观察，发现`scheme`是区别大小写的，我们最后把`userAgent`的`abc`改成大写`ABC`就OK了","source":"_posts/hole/hole-android-js-wxpay.md","raw":"---\ntitle: 记一次Android端H5调用微信支付引发的坑\ndate: 2018-01-30 15:28:26\ntags: hole\n---\n\n### 事件背景\n\n今天一位H5的同事过来找我们，说他们在H5里调用微信支付(不是通过jsapi调用)，到支付界面，点击返回键，会导致APP重新启动，把`webview`给关掉了\n\n### 事件原因分析\n\n经过我一顿猛操作，最后发现原来是`webview`设置`userAgent`引发的问题。\n\n因为H5的要求，我们会在`userAgent`里设置一些信息，这里以`abc`为例，我们把`abc`这个字符串设置到了`userAgent`里，同时在`AndroidManifest`的`activity`节点注册了`abc`的`scheme`\n\n```java\n// 设置userAgent\nwebSettings.setUserAgentString(ua + \" abc/\" + getVersionName());\n```\n\n```java\n// 设置scheme\n<intent-filter>\n  <data android:scheme=\"abc\" />\n  <action android:name=\"android.intent.action.VIEW\" />\n  <category android:name=\"android.intent.category.DEFAULT\" />\n  <category android:name=\"android.intent.category.BROWSABLE\" />\n</intent-filter>\n```\n\n这里设置之后，当点击微信支付的返回按钮后，发现微信会发起一个类似下面结构的`Intent`:\n\n```\nurl: abc://\naction: android.intent.action.VIEW\n```\n\n这里导致我们注册的`scheme`的`Activiy`会接收到，导致应用重启。\n\n### 解决办法\n\n通过我们的观察，发现`scheme`是区别大小写的，我们最后把`userAgent`的`abc`改成大写`ABC`就OK了","slug":"hole/hole-android-js-wxpay","published":1,"updated":"2018-01-31T09:35:37.816Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61f9002oizcb9zudaxgf","content":"<h3 id=\"事件背景\"><a href=\"#事件背景\" class=\"headerlink\" title=\"事件背景\"></a>事件背景</h3><p>今天一位H5的同事过来找我们，说他们在H5里调用微信支付(不是通过jsapi调用)，到支付界面，点击返回键，会导致APP重新启动，把<code>webview</code>给关掉了</p>\n<h3 id=\"事件原因分析\"><a href=\"#事件原因分析\" class=\"headerlink\" title=\"事件原因分析\"></a>事件原因分析</h3><p>经过我一顿猛操作，最后发现原来是<code>webview</code>设置<code>userAgent</code>引发的问题。</p>\n<p>因为H5的要求，我们会在<code>userAgent</code>里设置一些信息，这里以<code>abc</code>为例，我们把<code>abc</code>这个字符串设置到了<code>userAgent</code>里，同时在<code>AndroidManifest</code>的<code>activity</code>节点注册了<code>abc</code>的<code>scheme</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 设置userAgent</span></span><br><span class=\"line\">webSettings.setUserAgentString(ua + <span class=\"string\">\" abc/\"</span> + getVersionName());</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 设置scheme</span></span><br><span class=\"line\">&lt;intent-filter&gt;</span><br><span class=\"line\">  &lt;data android:scheme=<span class=\"string\">\"abc\"</span> /&gt;</span><br><span class=\"line\">  &lt;action android:name=<span class=\"string\">\"android.intent.action.VIEW\"</span> /&gt;</span><br><span class=\"line\">  &lt;category android:name=<span class=\"string\">\"android.intent.category.DEFAULT\"</span> /&gt;</span><br><span class=\"line\">  &lt;category android:name=<span class=\"string\">\"android.intent.category.BROWSABLE\"</span> /&gt;</span><br><span class=\"line\">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>\n<p>这里设置之后，当点击微信支付的返回按钮后，发现微信会发起一个类似下面结构的<code>Intent</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">url: abc://</span><br><span class=\"line\">action: android.intent.action.VIEW</span><br></pre></td></tr></table></figure>\n<p>这里导致我们注册的<code>scheme</code>的<code>Activiy</code>会接收到，导致应用重启。</p>\n<h3 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h3><p>通过我们的观察，发现<code>scheme</code>是区别大小写的，我们最后把<code>userAgent</code>的<code>abc</code>改成大写<code>ABC</code>就OK了</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"事件背景\"><a href=\"#事件背景\" class=\"headerlink\" title=\"事件背景\"></a>事件背景</h3><p>今天一位H5的同事过来找我们，说他们在H5里调用微信支付(不是通过jsapi调用)，到支付界面，点击返回键，会导致APP重新启动，把<code>webview</code>给关掉了</p>\n<h3 id=\"事件原因分析\"><a href=\"#事件原因分析\" class=\"headerlink\" title=\"事件原因分析\"></a>事件原因分析</h3><p>经过我一顿猛操作，最后发现原来是<code>webview</code>设置<code>userAgent</code>引发的问题。</p>\n<p>因为H5的要求，我们会在<code>userAgent</code>里设置一些信息，这里以<code>abc</code>为例，我们把<code>abc</code>这个字符串设置到了<code>userAgent</code>里，同时在<code>AndroidManifest</code>的<code>activity</code>节点注册了<code>abc</code>的<code>scheme</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 设置userAgent</span></span><br><span class=\"line\">webSettings.setUserAgentString(ua + <span class=\"string\">\" abc/\"</span> + getVersionName());</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 设置scheme</span></span><br><span class=\"line\">&lt;intent-filter&gt;</span><br><span class=\"line\">  &lt;data android:scheme=<span class=\"string\">\"abc\"</span> /&gt;</span><br><span class=\"line\">  &lt;action android:name=<span class=\"string\">\"android.intent.action.VIEW\"</span> /&gt;</span><br><span class=\"line\">  &lt;category android:name=<span class=\"string\">\"android.intent.category.DEFAULT\"</span> /&gt;</span><br><span class=\"line\">  &lt;category android:name=<span class=\"string\">\"android.intent.category.BROWSABLE\"</span> /&gt;</span><br><span class=\"line\">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>\n<p>这里设置之后，当点击微信支付的返回按钮后，发现微信会发起一个类似下面结构的<code>Intent</code>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">url: abc://</span><br><span class=\"line\">action: android.intent.action.VIEW</span><br></pre></td></tr></table></figure>\n<p>这里导致我们注册的<code>scheme</code>的<code>Activiy</code>会接收到，导致应用重启。</p>\n<h3 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h3><p>通过我们的观察，发现<code>scheme</code>是区别大小写的，我们最后把<code>userAgent</code>的<code>abc</code>改成大写<code>ABC</code>就OK了</p>\n"},{"title":"android-gradle","date":"2018-02-07T02:20:42.000Z","_content":"\n**解决Kotlin和DataBinding冲突 Unresolved reference: databinding**\n\n在主工程的`build.gradle`文件添加下面一行\n\n```\ndependencies {\n    kapt \"com.android.databinding:compiler:3.0.0\"\n}\n```\n\n**Failed to open zip file**\n\n当我们编译项目时，有时会出现\n\n```\nError:Failed to open zip file.\nGradle's dependency cache may be corrupt (this sometimes occurs after a network connection timeout.)\nRe-download dependencies and sync project (requires network)\nRe-download dependencies and sync project (requires network)\n```\n\n<!-- More -->\n\n这时我们可以去http://services.gradle.org/distributions/ 下载新的`gradle`，下载完成后不要解压\n\n这里以`gradle-4.5.1-all`为例，找到`.gradle`的`dists`目录，这里以 `macos`为例：\n\n```\nFinder -> 前往文件夹 -> 输入~/.gradle -> wrapper -> dists\n```\n\n![hole-gradle-dists](/img/hole/hole-gradle-dists.jpg)\n\n**refreshing gradle project**\n\n有时间我们编译项目时，会卡在`refreshing gradle project`，参照上面，自行安装`gradle-xxx-all`的包\n\n**Error:All flavors must now belong to a named flavor dimension**\n\n在`defaultConfig`中加：`flavorDimensions 'default'`\n\n```groovy\nandroid {\n  defaultConfig {\n        multiDexEnabled = true\n        flavorDimensions 'default'\n  }\n}\n```\n\n**Unable to find a matching configuration**\n\n在`buildTypes`下的`config`加入`matchingFallbacks`\n\n```groovy\nbuildTypes {\n    release {\n       //...\n    }\n    debug {\n       //...\n    }\n    innerTest {\n        //...\n        matchingFallbacks = ['debug', 'release']\n    }\n}\n```\n\n**error style attribute not found @android:attr**\n\n去掉`@`符\n\n```java\n<style name=\"PopupAnimation\" parent=\"@android:Animation\">\n  <item name=\"@android:windowEnterAnimation\">@anim/push_bottom_in</item>\n  <item name=\"@android:windowExitAnimation\">@anim/push_bottom_out</item>\n</style>\n==>\n<style name=\"PopupAnimation\" parent=\"android:Animation\">\n  <item name=\"android:windowEnterAnimation\">@anim/push_bottom_in</item>\n  <item name=\"android:windowExitAnimation\">@anim/push_bottom_out</item>\n</style>\n```\n\n","source":"_posts/hole/android-gradle.md","raw":"---\ntitle: android-gradle\ndate: 2018-02-07 10:20:42\ntags: hole\n---\n\n**解决Kotlin和DataBinding冲突 Unresolved reference: databinding**\n\n在主工程的`build.gradle`文件添加下面一行\n\n```\ndependencies {\n    kapt \"com.android.databinding:compiler:3.0.0\"\n}\n```\n\n**Failed to open zip file**\n\n当我们编译项目时，有时会出现\n\n```\nError:Failed to open zip file.\nGradle's dependency cache may be corrupt (this sometimes occurs after a network connection timeout.)\nRe-download dependencies and sync project (requires network)\nRe-download dependencies and sync project (requires network)\n```\n\n<!-- More -->\n\n这时我们可以去http://services.gradle.org/distributions/ 下载新的`gradle`，下载完成后不要解压\n\n这里以`gradle-4.5.1-all`为例，找到`.gradle`的`dists`目录，这里以 `macos`为例：\n\n```\nFinder -> 前往文件夹 -> 输入~/.gradle -> wrapper -> dists\n```\n\n![hole-gradle-dists](/img/hole/hole-gradle-dists.jpg)\n\n**refreshing gradle project**\n\n有时间我们编译项目时，会卡在`refreshing gradle project`，参照上面，自行安装`gradle-xxx-all`的包\n\n**Error:All flavors must now belong to a named flavor dimension**\n\n在`defaultConfig`中加：`flavorDimensions 'default'`\n\n```groovy\nandroid {\n  defaultConfig {\n        multiDexEnabled = true\n        flavorDimensions 'default'\n  }\n}\n```\n\n**Unable to find a matching configuration**\n\n在`buildTypes`下的`config`加入`matchingFallbacks`\n\n```groovy\nbuildTypes {\n    release {\n       //...\n    }\n    debug {\n       //...\n    }\n    innerTest {\n        //...\n        matchingFallbacks = ['debug', 'release']\n    }\n}\n```\n\n**error style attribute not found @android:attr**\n\n去掉`@`符\n\n```java\n<style name=\"PopupAnimation\" parent=\"@android:Animation\">\n  <item name=\"@android:windowEnterAnimation\">@anim/push_bottom_in</item>\n  <item name=\"@android:windowExitAnimation\">@anim/push_bottom_out</item>\n</style>\n==>\n<style name=\"PopupAnimation\" parent=\"android:Animation\">\n  <item name=\"android:windowEnterAnimation\">@anim/push_bottom_in</item>\n  <item name=\"android:windowExitAnimation\">@anim/push_bottom_out</item>\n</style>\n```\n\n","slug":"hole/android-gradle","published":1,"updated":"2018-05-20T13:04:25.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fa002rizcb93e95qo6","content":"<p><strong>解决Kotlin和DataBinding冲突 Unresolved reference: databinding</strong></p>\n<p>在主工程的<code>build.gradle</code>文件添加下面一行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    kapt &quot;com.android.databinding:compiler:3.0.0&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Failed to open zip file</strong></p>\n<p>当我们编译项目时，有时会出现</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error:Failed to open zip file.</span><br><span class=\"line\">Gradle&apos;s dependency cache may be corrupt (this sometimes occurs after a network connection timeout.)</span><br><span class=\"line\">Re-download dependencies and sync project (requires network)</span><br><span class=\"line\">Re-download dependencies and sync project (requires network)</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>这时我们可以去<a href=\"http://services.gradle.org/distributions/\" target=\"_blank\" rel=\"noopener\">http://services.gradle.org/distributions/</a> 下载新的<code>gradle</code>，下载完成后不要解压</p>\n<p>这里以<code>gradle-4.5.1-all</code>为例，找到<code>.gradle</code>的<code>dists</code>目录，这里以 <code>macos</code>为例：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Finder -&gt; 前往文件夹 -&gt; 输入~/.gradle -&gt; wrapper -&gt; dists</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/hole/hole-gradle-dists.jpg\" alt=\"hole-gradle-dists\"></p>\n<p><strong>refreshing gradle project</strong></p>\n<p>有时间我们编译项目时，会卡在<code>refreshing gradle project</code>，参照上面，自行安装<code>gradle-xxx-all</code>的包</p>\n<p><strong>Error:All flavors must now belong to a named flavor dimension</strong></p>\n<p>在<code>defaultConfig</code>中加：<code>flavorDimensions &#39;default&#39;</code></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android &#123;</span><br><span class=\"line\">  defaultConfig &#123;</span><br><span class=\"line\">        multiDexEnabled = <span class=\"literal\">true</span></span><br><span class=\"line\">        flavorDimensions <span class=\"string\">'default'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Unable to find a matching configuration</strong></p>\n<p>在<code>buildTypes</code>下的<code>config</code>加入<code>matchingFallbacks</code></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buildTypes &#123;</span><br><span class=\"line\">    release &#123;</span><br><span class=\"line\">       <span class=\"comment\">//...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    debug &#123;</span><br><span class=\"line\">       <span class=\"comment\">//...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    innerTest &#123;</span><br><span class=\"line\">        <span class=\"comment\">//...</span></span><br><span class=\"line\">        matchingFallbacks = [<span class=\"string\">'debug'</span>, <span class=\"string\">'release'</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>error style attribute not found @android:attr</strong></p>\n<p>去掉<code>@</code>符</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style name=<span class=\"string\">\"PopupAnimation\"</span> parent=<span class=\"string\">\"@android:Animation\"</span>&gt;</span><br><span class=\"line\">  &lt;item name=\"@android:windowEnterAnimation\"&gt;@anim/push_bottom_in&lt;/item&gt;</span><br><span class=\"line\">  &lt;item name=\"@android:windowExitAnimation\"&gt;@anim/push_bottom_out&lt;/item&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">&lt;style name=<span class=\"string\">\"PopupAnimation\"</span> parent=<span class=\"string\">\"android:Animation\"</span>&gt;</span><br><span class=\"line\">  &lt;item name=\"android:windowEnterAnimation\"&gt;@anim/push_bottom_in&lt;/item&gt;</span><br><span class=\"line\">  &lt;item name=\"android:windowExitAnimation\"&gt;@anim/push_bottom_out&lt;/item&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<p><strong>解决Kotlin和DataBinding冲突 Unresolved reference: databinding</strong></p>\n<p>在主工程的<code>build.gradle</code>文件添加下面一行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    kapt &quot;com.android.databinding:compiler:3.0.0&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Failed to open zip file</strong></p>\n<p>当我们编译项目时，有时会出现</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Error:Failed to open zip file.</span><br><span class=\"line\">Gradle&apos;s dependency cache may be corrupt (this sometimes occurs after a network connection timeout.)</span><br><span class=\"line\">Re-download dependencies and sync project (requires network)</span><br><span class=\"line\">Re-download dependencies and sync project (requires network)</span><br></pre></td></tr></table></figure>","more":"<p>这时我们可以去<a href=\"http://services.gradle.org/distributions/\" target=\"_blank\" rel=\"noopener\">http://services.gradle.org/distributions/</a> 下载新的<code>gradle</code>，下载完成后不要解压</p>\n<p>这里以<code>gradle-4.5.1-all</code>为例，找到<code>.gradle</code>的<code>dists</code>目录，这里以 <code>macos</code>为例：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Finder -&gt; 前往文件夹 -&gt; 输入~/.gradle -&gt; wrapper -&gt; dists</span><br></pre></td></tr></table></figure>\n<p><img src=\"/img/hole/hole-gradle-dists.jpg\" alt=\"hole-gradle-dists\"></p>\n<p><strong>refreshing gradle project</strong></p>\n<p>有时间我们编译项目时，会卡在<code>refreshing gradle project</code>，参照上面，自行安装<code>gradle-xxx-all</code>的包</p>\n<p><strong>Error:All flavors must now belong to a named flavor dimension</strong></p>\n<p>在<code>defaultConfig</code>中加：<code>flavorDimensions &#39;default&#39;</code></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android &#123;</span><br><span class=\"line\">  defaultConfig &#123;</span><br><span class=\"line\">        multiDexEnabled = <span class=\"literal\">true</span></span><br><span class=\"line\">        flavorDimensions <span class=\"string\">'default'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Unable to find a matching configuration</strong></p>\n<p>在<code>buildTypes</code>下的<code>config</code>加入<code>matchingFallbacks</code></p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">buildTypes &#123;</span><br><span class=\"line\">    release &#123;</span><br><span class=\"line\">       <span class=\"comment\">//...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    debug &#123;</span><br><span class=\"line\">       <span class=\"comment\">//...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    innerTest &#123;</span><br><span class=\"line\">        <span class=\"comment\">//...</span></span><br><span class=\"line\">        matchingFallbacks = [<span class=\"string\">'debug'</span>, <span class=\"string\">'release'</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>error style attribute not found @android:attr</strong></p>\n<p>去掉<code>@</code>符</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style name=<span class=\"string\">\"PopupAnimation\"</span> parent=<span class=\"string\">\"@android:Animation\"</span>&gt;</span><br><span class=\"line\">  &lt;item name=\"@android:windowEnterAnimation\"&gt;@anim/push_bottom_in&lt;/item&gt;</span><br><span class=\"line\">  &lt;item name=\"@android:windowExitAnimation\"&gt;@anim/push_bottom_out&lt;/item&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">&lt;style name=<span class=\"string\">\"PopupAnimation\"</span> parent=<span class=\"string\">\"android:Animation\"</span>&gt;</span><br><span class=\"line\">  &lt;item name=\"android:windowEnterAnimation\"&gt;@anim/push_bottom_in&lt;/item&gt;</span><br><span class=\"line\">  &lt;item name=\"android:windowExitAnimation\"&gt;@anim/push_bottom_out&lt;/item&gt;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>"},{"title":"jenkins-android","date":"2017-07-07T03:37:13.000Z","_content":"\n之前用jenkins打包时，提示`Failed to find Build Tools revision xx.x.x` ，于是进入到`var/lib/jenkins/tools/android-sdk/tools/`下面，输入下面命令\n\n```java\nandroid list sdk -a\n```\n\n控制台没有反应，于是又试了下其他命令\n\n<!-- More -->\n\n```java\nandroid -h\n```\n\n也没反应，瞬间懵逼。于是想看看其它命令是不是也没反应，切换到platform-tools目录去执行 adb 命令：\n\n出现\"libc.so.6: version 'GLIBC_2.15' not found\"问题，才知道是由于glibc版本过低，升级glibc即可。\n\n参照：http://blog.csdn.net/hnhuangyiyang/article/details/50392997\n\n1.查看系统glibc支持的版本\n\n```java\nstrings /lib64/libc.so.6 |grep GLIBC  \n#查看当前glibc版本  \nll /lib64/libc.so.6   \nlrwxrwxrwx. 1 root root 12 Oct  9  2014 /lib64/libc.so.6 -> libc-2.12.so  \n```\n\n2.下载glibc源码包 (http://ftp.gnu.org/gnu/glibc/)\n\n```java\ncd /usr/src/  \nwget http://mirror.bjtu.edu.cn/gnu/glibc/glibc-2.15.tar.gz  \nwget http://mirror.bjtu.edu.cn/gnu/glibc/glibc-ports-2.15.tar.gz　　　　　　#glibc插件 \n```\n\n3.解压安装升级glibc\n\n```java\ntar zxvf glibc-2.15.tar.gz  \ntar zxvf glibc-ports-2.15.tar.gz  \nmv glibc-ports-2.15 glibc-2.15/ports  \nmkdir build  \ncd build  \n../glibc-2.15/configure  --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin  \nmake -j4  \nmake install\n```\n\n4.验证(查看系统glibc支持的版本)\n\n```java\nstrings /lib64/libc.so.6 |grep GLIBC \n```\n\n5.误删libc.so.6解决办法(命令行执行如下：)\n\n```java\n#LD_PRELOAD=/lib/libc-2.12.so ln -s /lib/libc-2.12.so lib/libc.so.6 \n```\n\n升级完glibc之后，android 命令终于有反应了，继续执行\n\n```\nandroid list sdk -a\n```\n\n卡住了，想了想应该是被墙的原因，还好androd命令提供了代理参数：\n\n```java\n--proxy-host //设置代理host\n--proxy-port //设置代理端口\n```\n\n网络找了找个国内的Android代理镜像服务器\n\n```java\nhttp://mirrors.neusoft.edu.cn 端口：80\n```\n\n接下来执行\n\n```java\nandroid list sdk --proxy-host mirrors.neusoft.edu.cn --proxy-port 80 -s --all\n```\n\n成功了\n\n```java\nPackages available for installation or update: 184\n   1- Android SDK Tools, revision 25.2.5\n   2- Android SDK Platform-tools, revision 26\n   3- Android SDK Build-tools, revision 26\n   4- Android SDK Build-tools, revision 25.0.3\n   5- Android SDK Build-tools, revision 25.0.2\n   6- Android SDK Build-tools, revision 25.0.1\n   7- Android SDK Build-tools, revision 25\n   8- Android SDK Build-tools, revision 24.0.3\n   9- Android SDK Build-tools, revision 24.0.2\n  10- Android SDK Build-tools, revision 24.0.1\n  11- Android SDK Build-tools, revision 24\n```\n\n接下来执行下载sdk命令\n\n```java\n// --filter 3后面的数字3对面上面列表的项，这时表示下载 (3- Android SDK Build-tools, revision 26)\nandroid update sdk --no-ui --filter 3 --proxy-host mirrors.neusoft.edu.cn --proxy-port 80 -s --all\n```\n\n安装的时候会提示是否接受`license`\n\n类似\n\n```\nDo you accept the license 'android-sdk-license-c81a61d9' [y/n]:\n```\n\n输入`y`之后开始下载，等待安装成功，又可以愉快的玩耍了","source":"_posts/hole/jenkins-android.md","raw":"---\ntitle: jenkins-android\ndate: 2017-07-07 11:37:13\ntags: hole\n---\n\n之前用jenkins打包时，提示`Failed to find Build Tools revision xx.x.x` ，于是进入到`var/lib/jenkins/tools/android-sdk/tools/`下面，输入下面命令\n\n```java\nandroid list sdk -a\n```\n\n控制台没有反应，于是又试了下其他命令\n\n<!-- More -->\n\n```java\nandroid -h\n```\n\n也没反应，瞬间懵逼。于是想看看其它命令是不是也没反应，切换到platform-tools目录去执行 adb 命令：\n\n出现\"libc.so.6: version 'GLIBC_2.15' not found\"问题，才知道是由于glibc版本过低，升级glibc即可。\n\n参照：http://blog.csdn.net/hnhuangyiyang/article/details/50392997\n\n1.查看系统glibc支持的版本\n\n```java\nstrings /lib64/libc.so.6 |grep GLIBC  \n#查看当前glibc版本  \nll /lib64/libc.so.6   \nlrwxrwxrwx. 1 root root 12 Oct  9  2014 /lib64/libc.so.6 -> libc-2.12.so  \n```\n\n2.下载glibc源码包 (http://ftp.gnu.org/gnu/glibc/)\n\n```java\ncd /usr/src/  \nwget http://mirror.bjtu.edu.cn/gnu/glibc/glibc-2.15.tar.gz  \nwget http://mirror.bjtu.edu.cn/gnu/glibc/glibc-ports-2.15.tar.gz　　　　　　#glibc插件 \n```\n\n3.解压安装升级glibc\n\n```java\ntar zxvf glibc-2.15.tar.gz  \ntar zxvf glibc-ports-2.15.tar.gz  \nmv glibc-ports-2.15 glibc-2.15/ports  \nmkdir build  \ncd build  \n../glibc-2.15/configure  --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin  \nmake -j4  \nmake install\n```\n\n4.验证(查看系统glibc支持的版本)\n\n```java\nstrings /lib64/libc.so.6 |grep GLIBC \n```\n\n5.误删libc.so.6解决办法(命令行执行如下：)\n\n```java\n#LD_PRELOAD=/lib/libc-2.12.so ln -s /lib/libc-2.12.so lib/libc.so.6 \n```\n\n升级完glibc之后，android 命令终于有反应了，继续执行\n\n```\nandroid list sdk -a\n```\n\n卡住了，想了想应该是被墙的原因，还好androd命令提供了代理参数：\n\n```java\n--proxy-host //设置代理host\n--proxy-port //设置代理端口\n```\n\n网络找了找个国内的Android代理镜像服务器\n\n```java\nhttp://mirrors.neusoft.edu.cn 端口：80\n```\n\n接下来执行\n\n```java\nandroid list sdk --proxy-host mirrors.neusoft.edu.cn --proxy-port 80 -s --all\n```\n\n成功了\n\n```java\nPackages available for installation or update: 184\n   1- Android SDK Tools, revision 25.2.5\n   2- Android SDK Platform-tools, revision 26\n   3- Android SDK Build-tools, revision 26\n   4- Android SDK Build-tools, revision 25.0.3\n   5- Android SDK Build-tools, revision 25.0.2\n   6- Android SDK Build-tools, revision 25.0.1\n   7- Android SDK Build-tools, revision 25\n   8- Android SDK Build-tools, revision 24.0.3\n   9- Android SDK Build-tools, revision 24.0.2\n  10- Android SDK Build-tools, revision 24.0.1\n  11- Android SDK Build-tools, revision 24\n```\n\n接下来执行下载sdk命令\n\n```java\n// --filter 3后面的数字3对面上面列表的项，这时表示下载 (3- Android SDK Build-tools, revision 26)\nandroid update sdk --no-ui --filter 3 --proxy-host mirrors.neusoft.edu.cn --proxy-port 80 -s --all\n```\n\n安装的时候会提示是否接受`license`\n\n类似\n\n```\nDo you accept the license 'android-sdk-license-c81a61d9' [y/n]:\n```\n\n输入`y`之后开始下载，等待安装成功，又可以愉快的玩耍了","slug":"hole/jenkins-android","published":1,"updated":"2018-01-31T09:35:37.816Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fb002tizcbpg0lec06","content":"<p>之前用jenkins打包时，提示<code>Failed to find Build Tools revision xx.x.x</code> ，于是进入到<code>var/lib/jenkins/tools/android-sdk/tools/</code>下面，输入下面命令</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android list sdk -a</span><br></pre></td></tr></table></figure>\n<p>控制台没有反应，于是又试了下其他命令</p>\n<a id=\"more\"></a>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android -h</span><br></pre></td></tr></table></figure>\n<p>也没反应，瞬间懵逼。于是想看看其它命令是不是也没反应，切换到platform-tools目录去执行 adb 命令：</p>\n<p>出现”libc.so.6: version ‘GLIBC_2.15’ not found”问题，才知道是由于glibc版本过低，升级glibc即可。</p>\n<p>参照：<a href=\"http://blog.csdn.net/hnhuangyiyang/article/details/50392997\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/hnhuangyiyang/article/details/50392997</a></p>\n<p>1.查看系统glibc支持的版本</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">strings /lib64/libc.so.6 |grep GLIBC  </span><br><span class=\"line\">#查看当前glibc版本  </span><br><span class=\"line\">ll /lib64/libc.so.6   </span><br><span class=\"line\">lrwxrwxrwx. <span class=\"number\">1</span> root root <span class=\"number\">12</span> Oct  <span class=\"number\">9</span>  <span class=\"number\">2014</span> /lib64/libc.so.6 -&gt; libc-<span class=\"number\">2.12</span>.so</span><br></pre></td></tr></table></figure>\n<p>2.下载glibc源码包 (<a href=\"http://ftp.gnu.org/gnu/glibc/\" target=\"_blank\" rel=\"noopener\">http://ftp.gnu.org/gnu/glibc/</a>)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /usr/src/  </span><br><span class=\"line\">wget http:<span class=\"comment\">//mirror.bjtu.edu.cn/gnu/glibc/glibc-2.15.tar.gz  </span></span><br><span class=\"line\">wget http:<span class=\"comment\">//mirror.bjtu.edu.cn/gnu/glibc/glibc-ports-2.15.tar.gz　　　　　　#glibc插件</span></span><br></pre></td></tr></table></figure>\n<p>3.解压安装升级glibc</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxvf glibc-<span class=\"number\">2.15</span>.tar.gz  </span><br><span class=\"line\">tar zxvf glibc-ports-<span class=\"number\">2.15</span>.tar.gz  </span><br><span class=\"line\">mv glibc-ports-<span class=\"number\">2.15</span> glibc-<span class=\"number\">2.15</span>/ports  </span><br><span class=\"line\">mkdir build  </span><br><span class=\"line\">cd build  </span><br><span class=\"line\">../glibc-<span class=\"number\">2.15</span>/configure  --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin  </span><br><span class=\"line\">make -j4  </span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n<p>4.验证(查看系统glibc支持的版本)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">strings /lib64/libc.so.6 |grep GLIBC</span><br></pre></td></tr></table></figure>\n<p>5.误删libc.so.6解决办法(命令行执行如下：)</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#LD_PRELOAD=/lib/libc-2.12.so ln -s /lib/libc-2.12.so lib/libc.so.6</span><br></pre></td></tr></table></figure>\n<p>升级完glibc之后，android 命令终于有反应了，继续执行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android list sdk -a</span><br></pre></td></tr></table></figure>\n<p>卡住了，想了想应该是被墙的原因，还好androd命令提供了代理参数：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">--proxy-host <span class=\"comment\">//设置代理host</span></span><br><span class=\"line\">--proxy-port <span class=\"comment\">//设置代理端口</span></span><br></pre></td></tr></table></figure>\n<p>网络找了找个国内的Android代理镜像服务器</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:<span class=\"comment\">//mirrors.neusoft.edu.cn 端口：80</span></span><br></pre></td></tr></table></figure>\n<p>接下来执行</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android list sdk --proxy-host mirrors.neusoft.edu.cn --proxy-port <span class=\"number\">80</span> -s --all</span><br></pre></td></tr></table></figure>\n<p>成功了</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Packages available <span class=\"keyword\">for</span> installation or update: <span class=\"number\">184</span></span><br><span class=\"line\">   <span class=\"number\">1</span>- Android SDK Tools, revision <span class=\"number\">25.2</span>.5</span><br><span class=\"line\">   <span class=\"number\">2</span>- Android SDK Platform-tools, revision <span class=\"number\">26</span></span><br><span class=\"line\">   <span class=\"number\">3</span>- Android SDK Build-tools, revision <span class=\"number\">26</span></span><br><span class=\"line\">   <span class=\"number\">4</span>- Android SDK Build-tools, revision <span class=\"number\">25.0</span>.3</span><br><span class=\"line\">   <span class=\"number\">5</span>- Android SDK Build-tools, revision <span class=\"number\">25.0</span>.2</span><br><span class=\"line\">   <span class=\"number\">6</span>- Android SDK Build-tools, revision <span class=\"number\">25.0</span>.1</span><br><span class=\"line\">   <span class=\"number\">7</span>- Android SDK Build-tools, revision <span class=\"number\">25</span></span><br><span class=\"line\">   <span class=\"number\">8</span>- Android SDK Build-tools, revision <span class=\"number\">24.0</span>.3</span><br><span class=\"line\">   <span class=\"number\">9</span>- Android SDK Build-tools, revision <span class=\"number\">24.0</span>.2</span><br><span class=\"line\">  <span class=\"number\">10</span>- Android SDK Build-tools, revision <span class=\"number\">24.0</span>.1</span><br><span class=\"line\">  <span class=\"number\">11</span>- Android SDK Build-tools, revision <span class=\"number\">24</span></span><br></pre></td></tr></table></figure>\n<p>接下来执行下载sdk命令</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// --filter 3后面的数字3对面上面列表的项，这时表示下载 (3- Android SDK Build-tools, revision 26)</span></span><br><span class=\"line\">android update sdk --no-ui --filter <span class=\"number\">3</span> --proxy-host mirrors.neusoft.edu.cn --proxy-port <span class=\"number\">80</span> -s --all</span><br></pre></td></tr></table></figure>\n<p>安装的时候会提示是否接受<code>license</code></p>\n<p>类似</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Do you accept the license &apos;android-sdk-license-c81a61d9&apos; [y/n]:</span><br></pre></td></tr></table></figure>\n<p>输入<code>y</code>之后开始下载，等待安装成功，又可以愉快的玩耍了</p>\n","site":{"data":{}},"excerpt":"<p>之前用jenkins打包时，提示<code>Failed to find Build Tools revision xx.x.x</code> ，于是进入到<code>var/lib/jenkins/tools/android-sdk/tools/</code>下面，输入下面命令</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android list sdk -a</span><br></pre></td></tr></table></figure>\n<p>控制台没有反应，于是又试了下其他命令</p>","more":"<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android -h</span><br></pre></td></tr></table></figure>\n<p>也没反应，瞬间懵逼。于是想看看其它命令是不是也没反应，切换到platform-tools目录去执行 adb 命令：</p>\n<p>出现”libc.so.6: version ‘GLIBC_2.15’ not found”问题，才知道是由于glibc版本过低，升级glibc即可。</p>\n<p>参照：<a href=\"http://blog.csdn.net/hnhuangyiyang/article/details/50392997\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/hnhuangyiyang/article/details/50392997</a></p>\n<p>1.查看系统glibc支持的版本</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">strings /lib64/libc.so.6 |grep GLIBC  </span><br><span class=\"line\">#查看当前glibc版本  </span><br><span class=\"line\">ll /lib64/libc.so.6   </span><br><span class=\"line\">lrwxrwxrwx. <span class=\"number\">1</span> root root <span class=\"number\">12</span> Oct  <span class=\"number\">9</span>  <span class=\"number\">2014</span> /lib64/libc.so.6 -&gt; libc-<span class=\"number\">2.12</span>.so</span><br></pre></td></tr></table></figure>\n<p>2.下载glibc源码包 (<a href=\"http://ftp.gnu.org/gnu/glibc/\" target=\"_blank\" rel=\"noopener\">http://ftp.gnu.org/gnu/glibc/</a>)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /usr/src/  </span><br><span class=\"line\">wget http:<span class=\"comment\">//mirror.bjtu.edu.cn/gnu/glibc/glibc-2.15.tar.gz  </span></span><br><span class=\"line\">wget http:<span class=\"comment\">//mirror.bjtu.edu.cn/gnu/glibc/glibc-ports-2.15.tar.gz　　　　　　#glibc插件</span></span><br></pre></td></tr></table></figure>\n<p>3.解压安装升级glibc</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxvf glibc-<span class=\"number\">2.15</span>.tar.gz  </span><br><span class=\"line\">tar zxvf glibc-ports-<span class=\"number\">2.15</span>.tar.gz  </span><br><span class=\"line\">mv glibc-ports-<span class=\"number\">2.15</span> glibc-<span class=\"number\">2.15</span>/ports  </span><br><span class=\"line\">mkdir build  </span><br><span class=\"line\">cd build  </span><br><span class=\"line\">../glibc-<span class=\"number\">2.15</span>/configure  --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin  </span><br><span class=\"line\">make -j4  </span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure>\n<p>4.验证(查看系统glibc支持的版本)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">strings /lib64/libc.so.6 |grep GLIBC</span><br></pre></td></tr></table></figure>\n<p>5.误删libc.so.6解决办法(命令行执行如下：)</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#LD_PRELOAD=/lib/libc-2.12.so ln -s /lib/libc-2.12.so lib/libc.so.6</span><br></pre></td></tr></table></figure>\n<p>升级完glibc之后，android 命令终于有反应了，继续执行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android list sdk -a</span><br></pre></td></tr></table></figure>\n<p>卡住了，想了想应该是被墙的原因，还好androd命令提供了代理参数：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">--proxy-host <span class=\"comment\">//设置代理host</span></span><br><span class=\"line\">--proxy-port <span class=\"comment\">//设置代理端口</span></span><br></pre></td></tr></table></figure>\n<p>网络找了找个国内的Android代理镜像服务器</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:<span class=\"comment\">//mirrors.neusoft.edu.cn 端口：80</span></span><br></pre></td></tr></table></figure>\n<p>接下来执行</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">android list sdk --proxy-host mirrors.neusoft.edu.cn --proxy-port <span class=\"number\">80</span> -s --all</span><br></pre></td></tr></table></figure>\n<p>成功了</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Packages available <span class=\"keyword\">for</span> installation or update: <span class=\"number\">184</span></span><br><span class=\"line\">   <span class=\"number\">1</span>- Android SDK Tools, revision <span class=\"number\">25.2</span>.5</span><br><span class=\"line\">   <span class=\"number\">2</span>- Android SDK Platform-tools, revision <span class=\"number\">26</span></span><br><span class=\"line\">   <span class=\"number\">3</span>- Android SDK Build-tools, revision <span class=\"number\">26</span></span><br><span class=\"line\">   <span class=\"number\">4</span>- Android SDK Build-tools, revision <span class=\"number\">25.0</span>.3</span><br><span class=\"line\">   <span class=\"number\">5</span>- Android SDK Build-tools, revision <span class=\"number\">25.0</span>.2</span><br><span class=\"line\">   <span class=\"number\">6</span>- Android SDK Build-tools, revision <span class=\"number\">25.0</span>.1</span><br><span class=\"line\">   <span class=\"number\">7</span>- Android SDK Build-tools, revision <span class=\"number\">25</span></span><br><span class=\"line\">   <span class=\"number\">8</span>- Android SDK Build-tools, revision <span class=\"number\">24.0</span>.3</span><br><span class=\"line\">   <span class=\"number\">9</span>- Android SDK Build-tools, revision <span class=\"number\">24.0</span>.2</span><br><span class=\"line\">  <span class=\"number\">10</span>- Android SDK Build-tools, revision <span class=\"number\">24.0</span>.1</span><br><span class=\"line\">  <span class=\"number\">11</span>- Android SDK Build-tools, revision <span class=\"number\">24</span></span><br></pre></td></tr></table></figure>\n<p>接下来执行下载sdk命令</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// --filter 3后面的数字3对面上面列表的项，这时表示下载 (3- Android SDK Build-tools, revision 26)</span></span><br><span class=\"line\">android update sdk --no-ui --filter <span class=\"number\">3</span> --proxy-host mirrors.neusoft.edu.cn --proxy-port <span class=\"number\">80</span> -s --all</span><br></pre></td></tr></table></figure>\n<p>安装的时候会提示是否接受<code>license</code></p>\n<p>类似</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Do you accept the license &apos;android-sdk-license-c81a61d9&apos; [y/n]:</span><br></pre></td></tr></table></figure>\n<p>输入<code>y</code>之后开始下载，等待安装成功，又可以愉快的玩耍了</p>"},{"title":"What's in iOS?","date":"2016-06-22T07:03:30.000Z","_content":"\n### What's is in iOS?\n\n![ios01](/img/swift/ios01.jpg)\n\n![ios02](/img/swift/ios02.jpg)\n\n![ios03](/img/swift/ios03.jpg)\n\n![ios04](/img/swift/ios04.jpg)\n\n### UIKIt\n\n#### bounds VS frame\n\n![ios05](/img/swift/ios05.jpg)\n\n> 在未设置bounds的情况下，bounds是相对于view自身坐标的，以view自身的左上角为原点(0,0)，如上图所示，不管怎么旋转view，bounds始终是一样的\n","source":"_posts/ios/ios-stanford.md","raw":"---\ntitle: What's in iOS?\ndate: 2016-06-22 15:03:30\ntags: [ios,stanford]\n---\n\n### What's is in iOS?\n\n![ios01](/img/swift/ios01.jpg)\n\n![ios02](/img/swift/ios02.jpg)\n\n![ios03](/img/swift/ios03.jpg)\n\n![ios04](/img/swift/ios04.jpg)\n\n### UIKIt\n\n#### bounds VS frame\n\n![ios05](/img/swift/ios05.jpg)\n\n> 在未设置bounds的情况下，bounds是相对于view自身坐标的，以view自身的左上角为原点(0,0)，如上图所示，不管怎么旋转view，bounds始终是一样的\n","slug":"ios/ios-stanford","published":1,"updated":"2018-01-31T09:35:37.817Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fc002wizcbk3wgtuel","content":"<h3 id=\"What’s-is-in-iOS\"><a href=\"#What’s-is-in-iOS\" class=\"headerlink\" title=\"What’s is in iOS?\"></a>What’s is in iOS?</h3><p><img src=\"/img/swift/ios01.jpg\" alt=\"ios01\"></p>\n<p><img src=\"/img/swift/ios02.jpg\" alt=\"ios02\"></p>\n<p><img src=\"/img/swift/ios03.jpg\" alt=\"ios03\"></p>\n<p><img src=\"/img/swift/ios04.jpg\" alt=\"ios04\"></p>\n<h3 id=\"UIKIt\"><a href=\"#UIKIt\" class=\"headerlink\" title=\"UIKIt\"></a>UIKIt</h3><h4 id=\"bounds-VS-frame\"><a href=\"#bounds-VS-frame\" class=\"headerlink\" title=\"bounds VS frame\"></a>bounds VS frame</h4><p><img src=\"/img/swift/ios05.jpg\" alt=\"ios05\"></p>\n<blockquote>\n<p>在未设置bounds的情况下，bounds是相对于view自身坐标的，以view自身的左上角为原点(0,0)，如上图所示，不管怎么旋转view，bounds始终是一样的</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"What’s-is-in-iOS\"><a href=\"#What’s-is-in-iOS\" class=\"headerlink\" title=\"What’s is in iOS?\"></a>What’s is in iOS?</h3><p><img src=\"/img/swift/ios01.jpg\" alt=\"ios01\"></p>\n<p><img src=\"/img/swift/ios02.jpg\" alt=\"ios02\"></p>\n<p><img src=\"/img/swift/ios03.jpg\" alt=\"ios03\"></p>\n<p><img src=\"/img/swift/ios04.jpg\" alt=\"ios04\"></p>\n<h3 id=\"UIKIt\"><a href=\"#UIKIt\" class=\"headerlink\" title=\"UIKIt\"></a>UIKIt</h3><h4 id=\"bounds-VS-frame\"><a href=\"#bounds-VS-frame\" class=\"headerlink\" title=\"bounds VS frame\"></a>bounds VS frame</h4><p><img src=\"/img/swift/ios05.jpg\" alt=\"ios05\"></p>\n<blockquote>\n<p>在未设置bounds的情况下，bounds是相对于view自身坐标的，以view自身的左上角为原点(0,0)，如上图所示，不管怎么旋转view，bounds始终是一样的</p>\n</blockquote>\n"},{"title":"Java 运行时注解(RetentionPolicy.RUNTIME)","date":"2018-04-13T08:07:34.000Z","_content":"\n### 前言\n\n对于运行时注解`RetentionPolicy.RUNTIME`，我们可以通过反射的方式来获取注解的相关信息。根据注解中的`Target`，我们可以从`Constructor`、`CLASS`、`Field`、`Method`获取注解对象，基本方法都差不多。\n\n| Target                  | 获取Annotation                | 描述                        |\n| ----------------------- | ----------------------------- | --------------------------- |\n| ElementType.TYPE        | `Class<?>`. getAnnotation()   | 通过Class对象获取注解       |\n| ElementType.CONSTRUCTOR | `Constructor`.getAnnotation() | 通过Constructor对象获取注解 |\n| ElementType.FIELD       | `Field`.getAnnotation()       | 通过Field对象获取注解       |\n| ElementType.METHOD      | `Method`.getAnnotation()      | 通过Method对象获取注解      |\n| ...                     | ...                           | ...                         |\n\n<!-- More -->\n\n一些常见的获取注解的方法\n\n```java\n/**\n * 获取指定类型的注解\n */\npublic <A extends Annotation> A getAnnotation(Class<A> annotationType);\n\n/**\n * 获取所有注解，如果有的话\n */\npublic Annotation[] getAnnotations();\n\n/**\n * 获取所有注解，忽略继承的注解\n */\npublic Annotation[] getDeclaredAnnotations();\n\n/**\n * 指定注解是否存在该元素上，如果有则返回true，否则false\n */\npublic boolean isAnnotationPresent(Class<? extends Annotation> annotationType);\n\n/**\n * 获取Method中参数的所有注解\n */\npublic Annotation[][] getParameterAnnotations();\n```\n\n### 定义运行时注解\n\n**自定义注解**\n\n```java\n// 适用于类、接口(包含注解类型)或enum\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface ClassAnnotation {\n\tString value();\n}\n\n// 适用于构造函数\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.CONSTRUCTOR)\npublic @interface ConstructorAnnotation {\n\tint id();\n\tString value();\n}\n\n// 适用于字段(包含enum实例)\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.FIELD)\npublic @interface FiledAnnotation {\n\tint[] value();\n}\n\n// 适用于方法\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.METHOD)\npublic @interface MethodAnnotation {\n\tString value();\n}\n```\n\n在注解中定义`成员(属性)`时它的类型必须是 8 种基本数据类型外加 类、接口、注解及它们的数组(下面例子中的`int id()`、`String value()`)。注解中`成员(属性)`可以有默认值，默认值需要用 `default` 关键值指定。\n\n```java\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.CONSTRUCTOR)\npublic @interface ConstructorAnnotation {\n\tint id() default 0;\n\tString value() default \"ConstructorAnnotation\";\n}\n```\n\n**如何使用**\n\n```java\n@ClassAnnotation(\"this is class annotation\")\npublic class TestAnnotation {\n\n\t@ConstructorAnnotation(id = 1, value = \"this is constructor annotation\")\n\tpublic TestAnnotation() {\n\t}\n\n\t@ConstructorAnnotation\n\tpublic TestAnnotation(int id, String msg) {\n\t}\n\n\t@FiledAnnotation({ 1, 2 })\n\tpublic int id = 1;\n\n\t@FiledAnnotation(3)\n\tpublic String field = \"field\";\n\n\t@MethodAnnotation(\"this is method annotation\")\n\tpublic String method() {\n\t\treturn \"method\";\n\t}\n}\n```\n\n注解赋值的方式是在注解的括号内以` value=”” `形式，多个属性之前用`,`隔开。如果希望使用注解的默认值，可以像以述例子中一样直接使用`@ConstructorAnnotation`或`@ConstructorAnnotation()`\n\n```java\n@ConstructorAnnotation\npublic TestAnnotation(int id, String msg) {\n}\n==>\n@ConstructorAnnotation()\npublic TestAnnotation(int id, String msg) {\n}\n```\n\n如果注解只包含一个成员，并且成员定义的名称为`value()`，则可以省略`value`关键字\n\n例如上面定义的`FiledAnnotation`和`MethodAnnotation`，都使用了`value()`名称\n\n```java\npublic @interface FiledAnnotation {\n\tint[] value();\n}\npublic @interface MethodAnnotation {\n\tString value();\n}\n```\n\n则可以省略`value`关键字，下面的调用方式是等同的\n\n```java\n// 对于字段\n@FiledAnnotation(value = { 1, 2 })\npublic int id = 1;\n==>\n@FiledAnnotation({ 1, 2 })\npublic int id = 1;\n\n// 对于方法\n@MethodAnnotation(value = \"this is method annotation\")\npublic String method() {\n    return \"method\";\n}\n==>\n@MethodAnnotation(\"this is method annotation\")\npublic String method() {\n    return \"method\";\n}\n```\n\n### 获取运行时注解信息\n\n因为我们定义的是`RetentionPolicy.RUNTIME`的注解，所以我们可以在运行时拿到注解的信息**(需要反射获取)**\n\n```java\n// 获取@ClassAnnotation的信息\npublic static void printClassAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Class注解:\");\n    ClassAnnotation classAnnotation = clazz\n        .getAnnotation(ClassAnnotation.class);\n    if (null != classAnnotation) {\n        sb.append(\"\\n\\t类名: \");\n        sb.append(Modifier.toString(clazz.getModifiers())).append(\" \")\n            .append(clazz.getSimpleName());\n        sb.append(\"\\n\\t注解值: \").append(classAnnotation.value());\n    }\n    System.out.println(sb.toString());\n}\n\n// 获取ConstructorAnnotation的信息\npublic static void printConstructorAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Constructor注解:\");\n    Constructor<?>[] constructors = clazz.getConstructors();\n    for (Constructor<?> constructor : constructors) {\n        ConstructorAnnotation constructorAnnotation = constructor\n            .getAnnotation(ConstructorAnnotation.class);\n        sb.append(\"\\n\\t构造函数名: \");\n        sb.append(Modifier.toString(constructor.getModifiers())).append(\" \")\n            .append(constructor.getClass().getSimpleName());\n\n        sb.append(\"\\n\\t构造函数参数: \");\n        Parameter[] parameters = constructor.getParameters();\n        for (Parameter parameter: parameters) {\n            sb.append(\"\\n\\t\\t\");\n            sb.append(parameter.getType().getSimpleName()).append(\" \")\n                .append(parameter.getName());\n        }\n\n        sb.append(\"\\n\\t注解值: \")\n            .append(\"\\n\\t\\tid: \" + constructorAnnotation.id())\n            .append(\"\\n\\t\\tvalue: \" + constructorAnnotation.value());\n        sb.append(\"\\n\\t---------------\");\n    }\n    System.out.println(sb.toString());\n}\n\n// 获取@FieldAnnotation的信息\npublic static void printFieldAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Filed注解:\");\n    Field[] fields = clazz.getFields();\n    for (Field field : fields) {\n        FiledAnnotation filedAnnotation = field\n            .getAnnotation(FiledAnnotation.class);\n        if (null != filedAnnotation) {\n            sb.append(\"\\n\\t字段名: \");\n            sb.append(Modifier.toString(field.getModifiers())).append(\" \")\n                .append(field.getType().getSimpleName()).append(\" \")\n                .append(field.getName());\n            sb.append(\"\\n\\t注解值: \").append(\n                Arrays.toString(filedAnnotation.value()));\n        }\n    }\n    System.out.println(sb.toString());\n}\n// 获取@MethodAnnotation的信息\npublic static void printMethodAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Method注解:\");\n    Method[] methods = clazz.getMethods();\n    for (Method method : methods) {\n        MethodAnnotation methodAnnotation = method\n            .getAnnotation(MethodAnnotation.class);\n        if (null != methodAnnotation) {\n            sb.append(\"\\n\\t方法名: \");\n            sb.append(Modifier.toString(method.getModifiers())).append(\" \")\n                .append(method.getReturnType().getSimpleName()).append(\" \")\n                .append(method.getName());\n            sb.append(\"\\n\\t注解值: \").append(methodAnnotation.value());\n        }\n    }\n    System.out.println(sb.toString());\n}\n```\n\n输出如下信息===>\n\n```java\nClass注解:\n\t类名: public TestAnnotation\n\t注解值: this is class annotation\nConstructor注解:\n\t构造函数名: public Constructor\n\t构造函数参数: \n\t注解值: \n\t\tid: 1\n\t\tvalue: this is constructor annotation\n\t---------------\n\t构造函数名: public Constructor\n\t构造函数参数: \n\t\tint arg0\n\t\tString arg1\n\t注解值: \n\t\tid: 0\n\t\tvalue: ConstructorAnnotation\n\t---------------\nFiled注解:\n\t字段名: public int id\n\t注解值: [1, 2]\n\t字段名: public String field\n\t注解值: [3]\nMethod注解:\n\t方法名: public String method\n\t注解值: this is method annotation\n```","source":"_posts/java/java-annotation-runtime.md","raw":"---\ntitle: Java 运行时注解(RetentionPolicy.RUNTIME)\ndate: 2018-04-13 16:07:34\ntags: [java, Annotation]\n---\n\n### 前言\n\n对于运行时注解`RetentionPolicy.RUNTIME`，我们可以通过反射的方式来获取注解的相关信息。根据注解中的`Target`，我们可以从`Constructor`、`CLASS`、`Field`、`Method`获取注解对象，基本方法都差不多。\n\n| Target                  | 获取Annotation                | 描述                        |\n| ----------------------- | ----------------------------- | --------------------------- |\n| ElementType.TYPE        | `Class<?>`. getAnnotation()   | 通过Class对象获取注解       |\n| ElementType.CONSTRUCTOR | `Constructor`.getAnnotation() | 通过Constructor对象获取注解 |\n| ElementType.FIELD       | `Field`.getAnnotation()       | 通过Field对象获取注解       |\n| ElementType.METHOD      | `Method`.getAnnotation()      | 通过Method对象获取注解      |\n| ...                     | ...                           | ...                         |\n\n<!-- More -->\n\n一些常见的获取注解的方法\n\n```java\n/**\n * 获取指定类型的注解\n */\npublic <A extends Annotation> A getAnnotation(Class<A> annotationType);\n\n/**\n * 获取所有注解，如果有的话\n */\npublic Annotation[] getAnnotations();\n\n/**\n * 获取所有注解，忽略继承的注解\n */\npublic Annotation[] getDeclaredAnnotations();\n\n/**\n * 指定注解是否存在该元素上，如果有则返回true，否则false\n */\npublic boolean isAnnotationPresent(Class<? extends Annotation> annotationType);\n\n/**\n * 获取Method中参数的所有注解\n */\npublic Annotation[][] getParameterAnnotations();\n```\n\n### 定义运行时注解\n\n**自定义注解**\n\n```java\n// 适用于类、接口(包含注解类型)或enum\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface ClassAnnotation {\n\tString value();\n}\n\n// 适用于构造函数\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.CONSTRUCTOR)\npublic @interface ConstructorAnnotation {\n\tint id();\n\tString value();\n}\n\n// 适用于字段(包含enum实例)\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.FIELD)\npublic @interface FiledAnnotation {\n\tint[] value();\n}\n\n// 适用于方法\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.METHOD)\npublic @interface MethodAnnotation {\n\tString value();\n}\n```\n\n在注解中定义`成员(属性)`时它的类型必须是 8 种基本数据类型外加 类、接口、注解及它们的数组(下面例子中的`int id()`、`String value()`)。注解中`成员(属性)`可以有默认值，默认值需要用 `default` 关键值指定。\n\n```java\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.CONSTRUCTOR)\npublic @interface ConstructorAnnotation {\n\tint id() default 0;\n\tString value() default \"ConstructorAnnotation\";\n}\n```\n\n**如何使用**\n\n```java\n@ClassAnnotation(\"this is class annotation\")\npublic class TestAnnotation {\n\n\t@ConstructorAnnotation(id = 1, value = \"this is constructor annotation\")\n\tpublic TestAnnotation() {\n\t}\n\n\t@ConstructorAnnotation\n\tpublic TestAnnotation(int id, String msg) {\n\t}\n\n\t@FiledAnnotation({ 1, 2 })\n\tpublic int id = 1;\n\n\t@FiledAnnotation(3)\n\tpublic String field = \"field\";\n\n\t@MethodAnnotation(\"this is method annotation\")\n\tpublic String method() {\n\t\treturn \"method\";\n\t}\n}\n```\n\n注解赋值的方式是在注解的括号内以` value=”” `形式，多个属性之前用`,`隔开。如果希望使用注解的默认值，可以像以述例子中一样直接使用`@ConstructorAnnotation`或`@ConstructorAnnotation()`\n\n```java\n@ConstructorAnnotation\npublic TestAnnotation(int id, String msg) {\n}\n==>\n@ConstructorAnnotation()\npublic TestAnnotation(int id, String msg) {\n}\n```\n\n如果注解只包含一个成员，并且成员定义的名称为`value()`，则可以省略`value`关键字\n\n例如上面定义的`FiledAnnotation`和`MethodAnnotation`，都使用了`value()`名称\n\n```java\npublic @interface FiledAnnotation {\n\tint[] value();\n}\npublic @interface MethodAnnotation {\n\tString value();\n}\n```\n\n则可以省略`value`关键字，下面的调用方式是等同的\n\n```java\n// 对于字段\n@FiledAnnotation(value = { 1, 2 })\npublic int id = 1;\n==>\n@FiledAnnotation({ 1, 2 })\npublic int id = 1;\n\n// 对于方法\n@MethodAnnotation(value = \"this is method annotation\")\npublic String method() {\n    return \"method\";\n}\n==>\n@MethodAnnotation(\"this is method annotation\")\npublic String method() {\n    return \"method\";\n}\n```\n\n### 获取运行时注解信息\n\n因为我们定义的是`RetentionPolicy.RUNTIME`的注解，所以我们可以在运行时拿到注解的信息**(需要反射获取)**\n\n```java\n// 获取@ClassAnnotation的信息\npublic static void printClassAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Class注解:\");\n    ClassAnnotation classAnnotation = clazz\n        .getAnnotation(ClassAnnotation.class);\n    if (null != classAnnotation) {\n        sb.append(\"\\n\\t类名: \");\n        sb.append(Modifier.toString(clazz.getModifiers())).append(\" \")\n            .append(clazz.getSimpleName());\n        sb.append(\"\\n\\t注解值: \").append(classAnnotation.value());\n    }\n    System.out.println(sb.toString());\n}\n\n// 获取ConstructorAnnotation的信息\npublic static void printConstructorAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Constructor注解:\");\n    Constructor<?>[] constructors = clazz.getConstructors();\n    for (Constructor<?> constructor : constructors) {\n        ConstructorAnnotation constructorAnnotation = constructor\n            .getAnnotation(ConstructorAnnotation.class);\n        sb.append(\"\\n\\t构造函数名: \");\n        sb.append(Modifier.toString(constructor.getModifiers())).append(\" \")\n            .append(constructor.getClass().getSimpleName());\n\n        sb.append(\"\\n\\t构造函数参数: \");\n        Parameter[] parameters = constructor.getParameters();\n        for (Parameter parameter: parameters) {\n            sb.append(\"\\n\\t\\t\");\n            sb.append(parameter.getType().getSimpleName()).append(\" \")\n                .append(parameter.getName());\n        }\n\n        sb.append(\"\\n\\t注解值: \")\n            .append(\"\\n\\t\\tid: \" + constructorAnnotation.id())\n            .append(\"\\n\\t\\tvalue: \" + constructorAnnotation.value());\n        sb.append(\"\\n\\t---------------\");\n    }\n    System.out.println(sb.toString());\n}\n\n// 获取@FieldAnnotation的信息\npublic static void printFieldAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Filed注解:\");\n    Field[] fields = clazz.getFields();\n    for (Field field : fields) {\n        FiledAnnotation filedAnnotation = field\n            .getAnnotation(FiledAnnotation.class);\n        if (null != filedAnnotation) {\n            sb.append(\"\\n\\t字段名: \");\n            sb.append(Modifier.toString(field.getModifiers())).append(\" \")\n                .append(field.getType().getSimpleName()).append(\" \")\n                .append(field.getName());\n            sb.append(\"\\n\\t注解值: \").append(\n                Arrays.toString(filedAnnotation.value()));\n        }\n    }\n    System.out.println(sb.toString());\n}\n// 获取@MethodAnnotation的信息\npublic static void printMethodAnnotation(Class<?> clazz) {\n    StringBuilder sb = new StringBuilder();\n    sb.append(\"Method注解:\");\n    Method[] methods = clazz.getMethods();\n    for (Method method : methods) {\n        MethodAnnotation methodAnnotation = method\n            .getAnnotation(MethodAnnotation.class);\n        if (null != methodAnnotation) {\n            sb.append(\"\\n\\t方法名: \");\n            sb.append(Modifier.toString(method.getModifiers())).append(\" \")\n                .append(method.getReturnType().getSimpleName()).append(\" \")\n                .append(method.getName());\n            sb.append(\"\\n\\t注解值: \").append(methodAnnotation.value());\n        }\n    }\n    System.out.println(sb.toString());\n}\n```\n\n输出如下信息===>\n\n```java\nClass注解:\n\t类名: public TestAnnotation\n\t注解值: this is class annotation\nConstructor注解:\n\t构造函数名: public Constructor\n\t构造函数参数: \n\t注解值: \n\t\tid: 1\n\t\tvalue: this is constructor annotation\n\t---------------\n\t构造函数名: public Constructor\n\t构造函数参数: \n\t\tint arg0\n\t\tString arg1\n\t注解值: \n\t\tid: 0\n\t\tvalue: ConstructorAnnotation\n\t---------------\nFiled注解:\n\t字段名: public int id\n\t注解值: [1, 2]\n\t字段名: public String field\n\t注解值: [3]\nMethod注解:\n\t方法名: public String method\n\t注解值: this is method annotation\n```","slug":"java/java-annotation-runtime","published":1,"updated":"2018-05-20T13:04:25.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fd002yizcbg20fims8","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>对于运行时注解<code>RetentionPolicy.RUNTIME</code>，我们可以通过反射的方式来获取注解的相关信息。根据注解中的<code>Target</code>，我们可以从<code>Constructor</code>、<code>CLASS</code>、<code>Field</code>、<code>Method</code>获取注解对象，基本方法都差不多。</p>\n<table>\n<thead>\n<tr>\n<th>Target</th>\n<th>获取Annotation</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ElementType.TYPE</td>\n<td><code>Class&lt;?&gt;</code>. getAnnotation()</td>\n<td>通过Class对象获取注解</td>\n</tr>\n<tr>\n<td>ElementType.CONSTRUCTOR</td>\n<td><code>Constructor</code>.getAnnotation()</td>\n<td>通过Constructor对象获取注解</td>\n</tr>\n<tr>\n<td>ElementType.FIELD</td>\n<td><code>Field</code>.getAnnotation()</td>\n<td>通过Field对象获取注解</td>\n</tr>\n<tr>\n<td>ElementType.METHOD</td>\n<td><code>Method</code>.getAnnotation()</td>\n<td>通过Method对象获取注解</td>\n</tr>\n<tr>\n<td>…</td>\n<td>…</td>\n<td>…</td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a>\n<p>一些常见的获取注解的方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取指定类型的注解</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> &lt;A extends Annotation&gt; <span class=\"function\">A <span class=\"title\">getAnnotation</span><span class=\"params\">(Class&lt;A&gt; annotationType)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取所有注解，如果有的话</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Annotation[] getAnnotations();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取所有注解，忽略继承的注解</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Annotation[] getDeclaredAnnotations();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 指定注解是否存在该元素上，如果有则返回true，否则false</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isAnnotationPresent</span><span class=\"params\">(Class&lt;? extends Annotation&gt; annotationType)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取Method中参数的所有注解</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Annotation[][] getParameterAnnotations();</span><br></pre></td></tr></table></figure>\n<h3 id=\"定义运行时注解\"><a href=\"#定义运行时注解\" class=\"headerlink\" title=\"定义运行时注解\"></a>定义运行时注解</h3><p><strong>自定义注解</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 适用于类、接口(包含注解类型)或enum</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ClassAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 适用于构造函数</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.CONSTRUCTOR)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ConstructorAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 适用于字段(包含enum实例)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.FIELD)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> FiledAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span>[] value();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 适用于方法</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.METHOD)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> MethodAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在注解中定义<code>成员(属性)</code>时它的类型必须是 8 种基本数据类型外加 类、接口、注解及它们的数组(下面例子中的<code>int id()</code>、<code>String value()</code>)。注解中<code>成员(属性)</code>可以有默认值，默认值需要用 <code>default</code> 关键值指定。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.CONSTRUCTOR)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ConstructorAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> 0</span>;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> \"ConstructorAnnotation\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>如何使用</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ClassAnnotation</span>(<span class=\"string\">\"this is class annotation\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestAnnotation</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@ConstructorAnnotation</span>(id = <span class=\"number\">1</span>, value = <span class=\"string\">\"this is constructor annotation\"</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@ConstructorAnnotation</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String msg)</span> </span>&#123;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@FiledAnnotation</span>(&#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@FiledAnnotation</span>(<span class=\"number\">3</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String field = <span class=\"string\">\"field\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@MethodAnnotation</span>(<span class=\"string\">\"this is method annotation\"</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">method</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"method\"</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注解赋值的方式是在注解的括号内以<code>value=””</code>形式，多个属性之前用<code>,</code>隔开。如果希望使用注解的默认值，可以像以述例子中一样直接使用<code>@ConstructorAnnotation</code>或<code>@ConstructorAnnotation()</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ConstructorAnnotation</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String msg)</span> </span>&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"meta\">@ConstructorAnnotation</span>()</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String msg)</span> </span>&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>如果注解只包含一个成员，并且成员定义的名称为<code>value()</code>，则可以省略<code>value</code>关键字</p>\n<p>例如上面定义的<code>FiledAnnotation</code>和<code>MethodAnnotation</code>，都使用了<code>value()</code>名称</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> FiledAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span>[] value();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> MethodAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>则可以省略<code>value</code>关键字，下面的调用方式是等同的</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 对于字段</span></span><br><span class=\"line\"><span class=\"meta\">@FiledAnnotation</span>(value = &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id = <span class=\"number\">1</span>;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"meta\">@FiledAnnotation</span>(&#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于方法</span></span><br><span class=\"line\"><span class=\"meta\">@MethodAnnotation</span>(value = <span class=\"string\">\"this is method annotation\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">method</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"method\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"meta\">@MethodAnnotation</span>(<span class=\"string\">\"this is method annotation\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">method</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"method\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取运行时注解信息\"><a href=\"#获取运行时注解信息\" class=\"headerlink\" title=\"获取运行时注解信息\"></a>获取运行时注解信息</h3><p>因为我们定义的是<code>RetentionPolicy.RUNTIME</code>的注解，所以我们可以在运行时拿到注解的信息<strong>(需要反射获取)</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取@ClassAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printClassAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Class注解:\"</span>);</span><br><span class=\"line\">    ClassAnnotation classAnnotation = clazz</span><br><span class=\"line\">        .getAnnotation(ClassAnnotation.class);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != classAnnotation) &#123;</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t类名: \"</span>);</span><br><span class=\"line\">        sb.append(Modifier.toString(clazz.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">            .append(clazz.getSimpleName());</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>).append(classAnnotation.value());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取ConstructorAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printConstructorAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Constructor注解:\"</span>);</span><br><span class=\"line\">    Constructor&lt;?&gt;[] constructors = clazz.getConstructors();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Constructor&lt;?&gt; constructor : constructors) &#123;</span><br><span class=\"line\">        ConstructorAnnotation constructorAnnotation = constructor</span><br><span class=\"line\">            .getAnnotation(ConstructorAnnotation.class);</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t构造函数名: \"</span>);</span><br><span class=\"line\">        sb.append(Modifier.toString(constructor.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">            .append(constructor.getClass().getSimpleName());</span><br><span class=\"line\"></span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t构造函数参数: \"</span>);</span><br><span class=\"line\">        Parameter[] parameters = constructor.getParameters();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Parameter parameter: parameters) &#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t\\t\"</span>);</span><br><span class=\"line\">            sb.append(parameter.getType().getSimpleName()).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(parameter.getName());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>)</span><br><span class=\"line\">            .append(<span class=\"string\">\"\\n\\t\\tid: \"</span> + constructorAnnotation.id())</span><br><span class=\"line\">            .append(<span class=\"string\">\"\\n\\t\\tvalue: \"</span> + constructorAnnotation.value());</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t---------------\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取@FieldAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printFieldAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Filed注解:\"</span>);</span><br><span class=\"line\">    Field[] fields = clazz.getFields();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">        FiledAnnotation filedAnnotation = field</span><br><span class=\"line\">            .getAnnotation(FiledAnnotation.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != filedAnnotation) &#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t字段名: \"</span>);</span><br><span class=\"line\">            sb.append(Modifier.toString(field.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(field.getType().getSimpleName()).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(field.getName());</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>).append(</span><br><span class=\"line\">                Arrays.toString(filedAnnotation.value()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 获取@MethodAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printMethodAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Method注解:\"</span>);</span><br><span class=\"line\">    Method[] methods = clazz.getMethods();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Method method : methods) &#123;</span><br><span class=\"line\">        MethodAnnotation methodAnnotation = method</span><br><span class=\"line\">            .getAnnotation(MethodAnnotation.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != methodAnnotation) &#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t方法名: \"</span>);</span><br><span class=\"line\">            sb.append(Modifier.toString(method.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(method.getReturnType().getSimpleName()).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(method.getName());</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>).append(methodAnnotation.value());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出如下信息===&gt;</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class注解:</span><br><span class=\"line\">\t类名: <span class=\"keyword\">public</span> TestAnnotation</span><br><span class=\"line\">\t注解值: <span class=\"keyword\">this</span> is <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">annotation</span></span></span><br><span class=\"line\">Constructor注解:</span><br><span class=\"line\">\t构造函数名: <span class=\"keyword\">public</span> Constructor</span><br><span class=\"line\">\t构造函数参数: </span><br><span class=\"line\">\t注解值: </span><br><span class=\"line\">\t\tid: <span class=\"number\">1</span></span><br><span class=\"line\">\t\tvalue: <span class=\"keyword\">this</span> is constructor annotation</span><br><span class=\"line\">\t---------------</span><br><span class=\"line\">\t构造函数名: <span class=\"keyword\">public</span> Constructor</span><br><span class=\"line\">\t构造函数参数: </span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> arg0</span><br><span class=\"line\">\t\tString arg1</span><br><span class=\"line\">\t注解值: </span><br><span class=\"line\">\t\tid: <span class=\"number\">0</span></span><br><span class=\"line\">\t\tvalue: ConstructorAnnotation</span><br><span class=\"line\">\t---------------</span><br><span class=\"line\">Filed注解:</span><br><span class=\"line\">\t字段名: <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id</span><br><span class=\"line\">\t注解值: [<span class=\"number\">1</span>, <span class=\"number\">2</span>]</span><br><span class=\"line\">\t字段名: <span class=\"keyword\">public</span> String field</span><br><span class=\"line\">\t注解值: [<span class=\"number\">3</span>]</span><br><span class=\"line\">Method注解:</span><br><span class=\"line\">\t方法名: <span class=\"keyword\">public</span> String method</span><br><span class=\"line\">\t注解值: <span class=\"keyword\">this</span> is method annotation</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>对于运行时注解<code>RetentionPolicy.RUNTIME</code>，我们可以通过反射的方式来获取注解的相关信息。根据注解中的<code>Target</code>，我们可以从<code>Constructor</code>、<code>CLASS</code>、<code>Field</code>、<code>Method</code>获取注解对象，基本方法都差不多。</p>\n<table>\n<thead>\n<tr>\n<th>Target</th>\n<th>获取Annotation</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ElementType.TYPE</td>\n<td><code>Class&lt;?&gt;</code>. getAnnotation()</td>\n<td>通过Class对象获取注解</td>\n</tr>\n<tr>\n<td>ElementType.CONSTRUCTOR</td>\n<td><code>Constructor</code>.getAnnotation()</td>\n<td>通过Constructor对象获取注解</td>\n</tr>\n<tr>\n<td>ElementType.FIELD</td>\n<td><code>Field</code>.getAnnotation()</td>\n<td>通过Field对象获取注解</td>\n</tr>\n<tr>\n<td>ElementType.METHOD</td>\n<td><code>Method</code>.getAnnotation()</td>\n<td>通过Method对象获取注解</td>\n</tr>\n<tr>\n<td>…</td>\n<td>…</td>\n<td>…</td>\n</tr>\n</tbody>\n</table>","more":"<p>一些常见的获取注解的方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取指定类型的注解</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> &lt;A extends Annotation&gt; <span class=\"function\">A <span class=\"title\">getAnnotation</span><span class=\"params\">(Class&lt;A&gt; annotationType)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取所有注解，如果有的话</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Annotation[] getAnnotations();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取所有注解，忽略继承的注解</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Annotation[] getDeclaredAnnotations();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 指定注解是否存在该元素上，如果有则返回true，否则false</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isAnnotationPresent</span><span class=\"params\">(Class&lt;? extends Annotation&gt; annotationType)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取Method中参数的所有注解</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Annotation[][] getParameterAnnotations();</span><br></pre></td></tr></table></figure>\n<h3 id=\"定义运行时注解\"><a href=\"#定义运行时注解\" class=\"headerlink\" title=\"定义运行时注解\"></a>定义运行时注解</h3><p><strong>自定义注解</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 适用于类、接口(包含注解类型)或enum</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ClassAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 适用于构造函数</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.CONSTRUCTOR)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ConstructorAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 适用于字段(包含enum实例)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.FIELD)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> FiledAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span>[] value();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 适用于方法</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.METHOD)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> MethodAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在注解中定义<code>成员(属性)</code>时它的类型必须是 8 种基本数据类型外加 类、接口、注解及它们的数组(下面例子中的<code>int id()</code>、<code>String value()</code>)。注解中<code>成员(属性)</code>可以有默认值，默认值需要用 <code>default</code> 关键值指定。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.CONSTRUCTOR)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> ConstructorAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">id</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> 0</span>;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> \"ConstructorAnnotation\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>如何使用</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ClassAnnotation</span>(<span class=\"string\">\"this is class annotation\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestAnnotation</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@ConstructorAnnotation</span>(id = <span class=\"number\">1</span>, value = <span class=\"string\">\"this is constructor annotation\"</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@ConstructorAnnotation</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String msg)</span> </span>&#123;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@FiledAnnotation</span>(&#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@FiledAnnotation</span>(<span class=\"number\">3</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String field = <span class=\"string\">\"field\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@MethodAnnotation</span>(<span class=\"string\">\"this is method annotation\"</span>)</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">method</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"method\"</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>注解赋值的方式是在注解的括号内以<code>value=””</code>形式，多个属性之前用<code>,</code>隔开。如果希望使用注解的默认值，可以像以述例子中一样直接使用<code>@ConstructorAnnotation</code>或<code>@ConstructorAnnotation()</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ConstructorAnnotation</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String msg)</span> </span>&#123;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"meta\">@ConstructorAnnotation</span>()</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">TestAnnotation</span><span class=\"params\">(<span class=\"keyword\">int</span> id, String msg)</span> </span>&#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>如果注解只包含一个成员，并且成员定义的名称为<code>value()</code>，则可以省略<code>value</code>关键字</p>\n<p>例如上面定义的<code>FiledAnnotation</code>和<code>MethodAnnotation</code>，都使用了<code>value()</code>名称</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> FiledAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span>[] value();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> MethodAnnotation &#123;</span><br><span class=\"line\">\t<span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>则可以省略<code>value</code>关键字，下面的调用方式是等同的</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 对于字段</span></span><br><span class=\"line\"><span class=\"meta\">@FiledAnnotation</span>(value = &#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id = <span class=\"number\">1</span>;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"meta\">@FiledAnnotation</span>(&#123; <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于方法</span></span><br><span class=\"line\"><span class=\"meta\">@MethodAnnotation</span>(value = <span class=\"string\">\"this is method annotation\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">method</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"method\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"meta\">@MethodAnnotation</span>(<span class=\"string\">\"this is method annotation\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">method</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">\"method\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取运行时注解信息\"><a href=\"#获取运行时注解信息\" class=\"headerlink\" title=\"获取运行时注解信息\"></a>获取运行时注解信息</h3><p>因为我们定义的是<code>RetentionPolicy.RUNTIME</code>的注解，所以我们可以在运行时拿到注解的信息<strong>(需要反射获取)</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取@ClassAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printClassAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Class注解:\"</span>);</span><br><span class=\"line\">    ClassAnnotation classAnnotation = clazz</span><br><span class=\"line\">        .getAnnotation(ClassAnnotation.class);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != classAnnotation) &#123;</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t类名: \"</span>);</span><br><span class=\"line\">        sb.append(Modifier.toString(clazz.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">            .append(clazz.getSimpleName());</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>).append(classAnnotation.value());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取ConstructorAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printConstructorAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Constructor注解:\"</span>);</span><br><span class=\"line\">    Constructor&lt;?&gt;[] constructors = clazz.getConstructors();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Constructor&lt;?&gt; constructor : constructors) &#123;</span><br><span class=\"line\">        ConstructorAnnotation constructorAnnotation = constructor</span><br><span class=\"line\">            .getAnnotation(ConstructorAnnotation.class);</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t构造函数名: \"</span>);</span><br><span class=\"line\">        sb.append(Modifier.toString(constructor.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">            .append(constructor.getClass().getSimpleName());</span><br><span class=\"line\"></span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t构造函数参数: \"</span>);</span><br><span class=\"line\">        Parameter[] parameters = constructor.getParameters();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Parameter parameter: parameters) &#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t\\t\"</span>);</span><br><span class=\"line\">            sb.append(parameter.getType().getSimpleName()).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(parameter.getName());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>)</span><br><span class=\"line\">            .append(<span class=\"string\">\"\\n\\t\\tid: \"</span> + constructorAnnotation.id())</span><br><span class=\"line\">            .append(<span class=\"string\">\"\\n\\t\\tvalue: \"</span> + constructorAnnotation.value());</span><br><span class=\"line\">        sb.append(<span class=\"string\">\"\\n\\t---------------\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取@FieldAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printFieldAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Filed注解:\"</span>);</span><br><span class=\"line\">    Field[] fields = clazz.getFields();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">        FiledAnnotation filedAnnotation = field</span><br><span class=\"line\">            .getAnnotation(FiledAnnotation.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != filedAnnotation) &#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t字段名: \"</span>);</span><br><span class=\"line\">            sb.append(Modifier.toString(field.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(field.getType().getSimpleName()).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(field.getName());</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>).append(</span><br><span class=\"line\">                Arrays.toString(filedAnnotation.value()));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 获取@MethodAnnotation的信息</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">printMethodAnnotation</span><span class=\"params\">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class=\"line\">    StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">    sb.append(<span class=\"string\">\"Method注解:\"</span>);</span><br><span class=\"line\">    Method[] methods = clazz.getMethods();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Method method : methods) &#123;</span><br><span class=\"line\">        MethodAnnotation methodAnnotation = method</span><br><span class=\"line\">            .getAnnotation(MethodAnnotation.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != methodAnnotation) &#123;</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t方法名: \"</span>);</span><br><span class=\"line\">            sb.append(Modifier.toString(method.getModifiers())).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(method.getReturnType().getSimpleName()).append(<span class=\"string\">\" \"</span>)</span><br><span class=\"line\">                .append(method.getName());</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"\\n\\t注解值: \"</span>).append(methodAnnotation.value());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println(sb.toString());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出如下信息===&gt;</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class注解:</span><br><span class=\"line\">\t类名: <span class=\"keyword\">public</span> TestAnnotation</span><br><span class=\"line\">\t注解值: <span class=\"keyword\">this</span> is <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">annotation</span></span></span><br><span class=\"line\">Constructor注解:</span><br><span class=\"line\">\t构造函数名: <span class=\"keyword\">public</span> Constructor</span><br><span class=\"line\">\t构造函数参数: </span><br><span class=\"line\">\t注解值: </span><br><span class=\"line\">\t\tid: <span class=\"number\">1</span></span><br><span class=\"line\">\t\tvalue: <span class=\"keyword\">this</span> is constructor annotation</span><br><span class=\"line\">\t---------------</span><br><span class=\"line\">\t构造函数名: <span class=\"keyword\">public</span> Constructor</span><br><span class=\"line\">\t构造函数参数: </span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> arg0</span><br><span class=\"line\">\t\tString arg1</span><br><span class=\"line\">\t注解值: </span><br><span class=\"line\">\t\tid: <span class=\"number\">0</span></span><br><span class=\"line\">\t\tvalue: ConstructorAnnotation</span><br><span class=\"line\">\t---------------</span><br><span class=\"line\">Filed注解:</span><br><span class=\"line\">\t字段名: <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> id</span><br><span class=\"line\">\t注解值: [<span class=\"number\">1</span>, <span class=\"number\">2</span>]</span><br><span class=\"line\">\t字段名: <span class=\"keyword\">public</span> String field</span><br><span class=\"line\">\t注解值: [<span class=\"number\">3</span>]</span><br><span class=\"line\">Method注解:</span><br><span class=\"line\">\t方法名: <span class=\"keyword\">public</span> String method</span><br><span class=\"line\">\t注解值: <span class=\"keyword\">this</span> is method annotation</span><br></pre></td></tr></table></figure>"},{"title":"Java 编译时注解(RetentionPolicy.CLASS)","date":"2018-04-13T08:07:56.000Z","_content":"\n","source":"_posts/java/java-annotation-class.md","raw":"---\ntitle: Java 编译时注解(RetentionPolicy.CLASS)\ndate: 2018-04-13 16:07:56\ntags: [java, Annotation]\n---\n\n","slug":"java/java-annotation-class","published":1,"updated":"2018-05-20T13:04:25.685Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fe0031izcbwjd3de3w","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"Java 注解处理器(Annotation Processor)","date":"2018-04-18T10:48:52.000Z","_content":"\n### 前言\n\n注解处理器(Annotation Processor)是`javac`的一个工具，主要用于在编译时处理`运行时注解RetentionPolicy.RUNTIME）`。我们可以自定义注解处理器，获取我们自定义的注解信息，通过注解信息生成`java`文件(如： [ButterKnife](https://github.com/JakeWharton/butterknife))或进行其它的一些操作\n\n### 自定义注解处理器\n\n自定义注解处理器需要继承于`AbstractProcessor`，一般我们会重写下面4个方法\n\n```java\npublic class MyProcessor extends AbstractProcessor {\n    @Override\n    public synchronized void init(ProcessingEnvironment processingEnvironment) { }\n   \n    @Override\n    public Set<String> getSupportedAnnotationTypes() {\n        Set<String> types = new LinkedHashSet<>();\n        return types\n    }\n    \n    @Override\n    public SourceVersion getSupportedSourceVersion() {\n        return SourceVersion.latestSupported();\n    }\n    \n    @Override\n    public boolean process(Set<? extends TypeElement> set, RoundEnvironment roundEnvironment) {\n        return true\n    }\n}\n```\n\n- init(ProcessingEnvironment env):  每一个注解处理器类都必须有一个空的构造函数。然而，这里有一个特殊的init()方法，它会被注解处理工具调用，并输入ProcessingEnviroment参数。ProcessingEnviroment提供很多有用的工具类Elements, Types和Filer。后面我们将看到详细的内容。\n- process(Set<? extends TypeElement> annotations, RoundEnvironment env) :  这相当于每个处理器的主函数main()。你在这里写你的扫描、评估和处理注解的代码，以及生成Java文件。输入参数RoundEnviroment，可以让你查询出包含特定注解的被注解元素。后面我们将看到详细的内容。\n- getSupportedAnnotationTypes():  这里你必须指定，这个注解处理器是注册给哪个注解的。注意，它的返回值是一个字符串的集合，包含本处理器想要处理的注解类型的合法全称。换句话说，你在这里定义你的注解处理器注册到哪些注解上。\n- getSupportedSourceVersion(): 用来指定你使用的Java版本。通常这里返回`SourceVersion.latestSupported()`。然而，如果你有足够的理由只支持Java 6的话，你也可以返回SourceVersion.RELEASE_6。我推荐你使用前者。\n\n在Java 7中，你也可以使用注解来代替getSupportedAnnotationTypes()和getSupportedSourceVersion()，像这样：\n\n```java\n@SupportedSourceVersion(SourceVersion.latestSupported())\n@SupportedAnnotationTypes({\n   // 合法注解全名的集合\n })\npublic class MyProcessor extends AbstractProcessor {\n\n    @Override\n    public synchronized void init(ProcessingEnvironment env){ }\n\n    @Override\n    public boolean process(Set<? extends TypeElement> annoations, RoundEnvironment env) {}\n}\n```\n\n因为兼容的原因，特别是针对Android平台，我建议使用重载`getSupportedAnnotationTypes()`和`getSupportedSourceVersion()`方法代替`@SupportedAnnotationTypes`和\n\n`@SuppozrtedSourceVersion`\n\n接下来的你必须知道的事情是，注解处理器是运行它自己的虚拟机JVM中。是的，你没有看错，**javac**启动一个完整Java虚拟机来运行注解处理器。这对你意味着什么？你可以使用任何你在其他java应用中使用的的东西。使用guava。如果你愿意，你可以使用依赖注入工具，例如dagger或者其他你想要的类库。但是不要忘记，即使是一个很小的处理，你也要像其他Java应用一样，注意算法效率，以及设计模式。\n\n**注册你的处理器**\n\n你可能会问，我怎样将处理器MyProcessor注册到javac中。你必须提供一个**.jar**文件。就像其他**.jar**文件一样，你打包你的注解处理器到此文件中。并且，在你的jar中，你需要打包一个特定的文件javax.annotation.processing.Processor到META-INF/services路径下。所以，你的.jar文件看起来就像下面这样：\n\n- MyProcessor.jar\n- -- com\n- -- -- example\n- -- -- -- MyProcessor.class\n- -- META-INF\n- -- -- services\n- -- -- -- javax.annotation.processing.Processor\n\n打包进MyProcessor.jar中的javax.annotation.processing.Processor的内容是，注解处理器的合法的全名列表，每一个元素换行分割：\n\n```java\ncom.example.MyProcessor  \ncom.foo.OtherProcessor  \nnet.blabla.SpecialProcessor  \n```\n\n把MyProcessor.jar放到你的builpath中，**javac**会自动检查和读取javax.annotation.processing.Processor中的内容，并且注册MyProcessor作为注解处理器。","source":"_posts/java/java-annotations-processor.md","raw":"---\ntitle: Java 注解处理器(Annotation Processor)\ndate: 2018-04-18 18:48:52\ntags: [java, Annotation]\n---\n\n### 前言\n\n注解处理器(Annotation Processor)是`javac`的一个工具，主要用于在编译时处理`运行时注解RetentionPolicy.RUNTIME）`。我们可以自定义注解处理器，获取我们自定义的注解信息，通过注解信息生成`java`文件(如： [ButterKnife](https://github.com/JakeWharton/butterknife))或进行其它的一些操作\n\n### 自定义注解处理器\n\n自定义注解处理器需要继承于`AbstractProcessor`，一般我们会重写下面4个方法\n\n```java\npublic class MyProcessor extends AbstractProcessor {\n    @Override\n    public synchronized void init(ProcessingEnvironment processingEnvironment) { }\n   \n    @Override\n    public Set<String> getSupportedAnnotationTypes() {\n        Set<String> types = new LinkedHashSet<>();\n        return types\n    }\n    \n    @Override\n    public SourceVersion getSupportedSourceVersion() {\n        return SourceVersion.latestSupported();\n    }\n    \n    @Override\n    public boolean process(Set<? extends TypeElement> set, RoundEnvironment roundEnvironment) {\n        return true\n    }\n}\n```\n\n- init(ProcessingEnvironment env):  每一个注解处理器类都必须有一个空的构造函数。然而，这里有一个特殊的init()方法，它会被注解处理工具调用，并输入ProcessingEnviroment参数。ProcessingEnviroment提供很多有用的工具类Elements, Types和Filer。后面我们将看到详细的内容。\n- process(Set<? extends TypeElement> annotations, RoundEnvironment env) :  这相当于每个处理器的主函数main()。你在这里写你的扫描、评估和处理注解的代码，以及生成Java文件。输入参数RoundEnviroment，可以让你查询出包含特定注解的被注解元素。后面我们将看到详细的内容。\n- getSupportedAnnotationTypes():  这里你必须指定，这个注解处理器是注册给哪个注解的。注意，它的返回值是一个字符串的集合，包含本处理器想要处理的注解类型的合法全称。换句话说，你在这里定义你的注解处理器注册到哪些注解上。\n- getSupportedSourceVersion(): 用来指定你使用的Java版本。通常这里返回`SourceVersion.latestSupported()`。然而，如果你有足够的理由只支持Java 6的话，你也可以返回SourceVersion.RELEASE_6。我推荐你使用前者。\n\n在Java 7中，你也可以使用注解来代替getSupportedAnnotationTypes()和getSupportedSourceVersion()，像这样：\n\n```java\n@SupportedSourceVersion(SourceVersion.latestSupported())\n@SupportedAnnotationTypes({\n   // 合法注解全名的集合\n })\npublic class MyProcessor extends AbstractProcessor {\n\n    @Override\n    public synchronized void init(ProcessingEnvironment env){ }\n\n    @Override\n    public boolean process(Set<? extends TypeElement> annoations, RoundEnvironment env) {}\n}\n```\n\n因为兼容的原因，特别是针对Android平台，我建议使用重载`getSupportedAnnotationTypes()`和`getSupportedSourceVersion()`方法代替`@SupportedAnnotationTypes`和\n\n`@SuppozrtedSourceVersion`\n\n接下来的你必须知道的事情是，注解处理器是运行它自己的虚拟机JVM中。是的，你没有看错，**javac**启动一个完整Java虚拟机来运行注解处理器。这对你意味着什么？你可以使用任何你在其他java应用中使用的的东西。使用guava。如果你愿意，你可以使用依赖注入工具，例如dagger或者其他你想要的类库。但是不要忘记，即使是一个很小的处理，你也要像其他Java应用一样，注意算法效率，以及设计模式。\n\n**注册你的处理器**\n\n你可能会问，我怎样将处理器MyProcessor注册到javac中。你必须提供一个**.jar**文件。就像其他**.jar**文件一样，你打包你的注解处理器到此文件中。并且，在你的jar中，你需要打包一个特定的文件javax.annotation.processing.Processor到META-INF/services路径下。所以，你的.jar文件看起来就像下面这样：\n\n- MyProcessor.jar\n- -- com\n- -- -- example\n- -- -- -- MyProcessor.class\n- -- META-INF\n- -- -- services\n- -- -- -- javax.annotation.processing.Processor\n\n打包进MyProcessor.jar中的javax.annotation.processing.Processor的内容是，注解处理器的合法的全名列表，每一个元素换行分割：\n\n```java\ncom.example.MyProcessor  \ncom.foo.OtherProcessor  \nnet.blabla.SpecialProcessor  \n```\n\n把MyProcessor.jar放到你的builpath中，**javac**会自动检查和读取javax.annotation.processing.Processor中的内容，并且注册MyProcessor作为注解处理器。","slug":"java/java-annotations-processor","published":1,"updated":"2018-05-20T13:04:25.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ff0033izcb0gekz7hd","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>注解处理器(Annotation Processor)是<code>javac</code>的一个工具，主要用于在编译时处理<code>运行时注解RetentionPolicy.RUNTIME）</code>。我们可以自定义注解处理器，获取我们自定义的注解信息，通过注解信息生成<code>java</code>文件(如： <a href=\"https://github.com/JakeWharton/butterknife\" target=\"_blank\" rel=\"noopener\">ButterKnife</a>)或进行其它的一些操作</p>\n<h3 id=\"自定义注解处理器\"><a href=\"#自定义注解处理器\" class=\"headerlink\" title=\"自定义注解处理器\"></a>自定义注解处理器</h3><p>自定义注解处理器需要继承于<code>AbstractProcessor</code>，一般我们会重写下面4个方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ProcessingEnvironment processingEnvironment)</span> </span>&#123; &#125;</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Set&lt;String&gt; <span class=\"title\">getSupportedAnnotationTypes</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Set&lt;String&gt; types = <span class=\"keyword\">new</span> LinkedHashSet&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> types</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> SourceVersion <span class=\"title\">getSupportedSourceVersion</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> SourceVersion.latestSupported();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">process</span><span class=\"params\">(Set&lt;? extends TypeElement&gt; set, RoundEnvironment roundEnvironment)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>init(ProcessingEnvironment env):  每一个注解处理器类都必须有一个空的构造函数。然而，这里有一个特殊的init()方法，它会被注解处理工具调用，并输入ProcessingEnviroment参数。ProcessingEnviroment提供很多有用的工具类Elements, Types和Filer。后面我们将看到详细的内容。</li>\n<li>process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment env) :  这相当于每个处理器的主函数main()。你在这里写你的扫描、评估和处理注解的代码，以及生成Java文件。输入参数RoundEnviroment，可以让你查询出包含特定注解的被注解元素。后面我们将看到详细的内容。</li>\n<li>getSupportedAnnotationTypes():  这里你必须指定，这个注解处理器是注册给哪个注解的。注意，它的返回值是一个字符串的集合，包含本处理器想要处理的注解类型的合法全称。换句话说，你在这里定义你的注解处理器注册到哪些注解上。</li>\n<li>getSupportedSourceVersion(): 用来指定你使用的Java版本。通常这里返回<code>SourceVersion.latestSupported()</code>。然而，如果你有足够的理由只支持Java 6的话，你也可以返回SourceVersion.RELEASE_6。我推荐你使用前者。</li>\n</ul>\n<p>在Java 7中，你也可以使用注解来代替getSupportedAnnotationTypes()和getSupportedSourceVersion()，像这样：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SupportedSourceVersion</span>(SourceVersion.latestSupported())</span><br><span class=\"line\"><span class=\"meta\">@SupportedAnnotationTypes</span>(&#123;</span><br><span class=\"line\">   <span class=\"comment\">// 合法注解全名的集合</span></span><br><span class=\"line\"> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ProcessingEnvironment env)</span></span>&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">process</span><span class=\"params\">(Set&lt;? extends TypeElement&gt; annoations, RoundEnvironment env)</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>因为兼容的原因，特别是针对Android平台，我建议使用重载<code>getSupportedAnnotationTypes()</code>和<code>getSupportedSourceVersion()</code>方法代替<code>@SupportedAnnotationTypes</code>和</p>\n<p><code>@SuppozrtedSourceVersion</code></p>\n<p>接下来的你必须知道的事情是，注解处理器是运行它自己的虚拟机JVM中。是的，你没有看错，<strong>javac</strong>启动一个完整Java虚拟机来运行注解处理器。这对你意味着什么？你可以使用任何你在其他java应用中使用的的东西。使用guava。如果你愿意，你可以使用依赖注入工具，例如dagger或者其他你想要的类库。但是不要忘记，即使是一个很小的处理，你也要像其他Java应用一样，注意算法效率，以及设计模式。</p>\n<p><strong>注册你的处理器</strong></p>\n<p>你可能会问，我怎样将处理器MyProcessor注册到javac中。你必须提供一个<strong>.jar</strong>文件。就像其他<strong>.jar</strong>文件一样，你打包你的注解处理器到此文件中。并且，在你的jar中，你需要打包一个特定的文件javax.annotation.processing.Processor到META-INF/services路径下。所以，你的.jar文件看起来就像下面这样：</p>\n<ul>\n<li>MyProcessor.jar</li>\n<li>– com</li>\n<li>– – example</li>\n<li>– – – MyProcessor.class</li>\n<li>– META-INF</li>\n<li>– – services</li>\n<li>– – – javax.annotation.processing.Processor</li>\n</ul>\n<p>打包进MyProcessor.jar中的javax.annotation.processing.Processor的内容是，注解处理器的合法的全名列表，每一个元素换行分割：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">com.example.MyProcessor  </span><br><span class=\"line\">com.foo.OtherProcessor  </span><br><span class=\"line\">net.blabla.SpecialProcessor</span><br></pre></td></tr></table></figure>\n<p>把MyProcessor.jar放到你的builpath中，<strong>javac</strong>会自动检查和读取javax.annotation.processing.Processor中的内容，并且注册MyProcessor作为注解处理器。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>注解处理器(Annotation Processor)是<code>javac</code>的一个工具，主要用于在编译时处理<code>运行时注解RetentionPolicy.RUNTIME）</code>。我们可以自定义注解处理器，获取我们自定义的注解信息，通过注解信息生成<code>java</code>文件(如： <a href=\"https://github.com/JakeWharton/butterknife\" target=\"_blank\" rel=\"noopener\">ButterKnife</a>)或进行其它的一些操作</p>\n<h3 id=\"自定义注解处理器\"><a href=\"#自定义注解处理器\" class=\"headerlink\" title=\"自定义注解处理器\"></a>自定义注解处理器</h3><p>自定义注解处理器需要继承于<code>AbstractProcessor</code>，一般我们会重写下面4个方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ProcessingEnvironment processingEnvironment)</span> </span>&#123; &#125;</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Set&lt;String&gt; <span class=\"title\">getSupportedAnnotationTypes</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Set&lt;String&gt; types = <span class=\"keyword\">new</span> LinkedHashSet&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> types</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> SourceVersion <span class=\"title\">getSupportedSourceVersion</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> SourceVersion.latestSupported();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">process</span><span class=\"params\">(Set&lt;? extends TypeElement&gt; set, RoundEnvironment roundEnvironment)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>init(ProcessingEnvironment env):  每一个注解处理器类都必须有一个空的构造函数。然而，这里有一个特殊的init()方法，它会被注解处理工具调用，并输入ProcessingEnviroment参数。ProcessingEnviroment提供很多有用的工具类Elements, Types和Filer。后面我们将看到详细的内容。</li>\n<li>process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment env) :  这相当于每个处理器的主函数main()。你在这里写你的扫描、评估和处理注解的代码，以及生成Java文件。输入参数RoundEnviroment，可以让你查询出包含特定注解的被注解元素。后面我们将看到详细的内容。</li>\n<li>getSupportedAnnotationTypes():  这里你必须指定，这个注解处理器是注册给哪个注解的。注意，它的返回值是一个字符串的集合，包含本处理器想要处理的注解类型的合法全称。换句话说，你在这里定义你的注解处理器注册到哪些注解上。</li>\n<li>getSupportedSourceVersion(): 用来指定你使用的Java版本。通常这里返回<code>SourceVersion.latestSupported()</code>。然而，如果你有足够的理由只支持Java 6的话，你也可以返回SourceVersion.RELEASE_6。我推荐你使用前者。</li>\n</ul>\n<p>在Java 7中，你也可以使用注解来代替getSupportedAnnotationTypes()和getSupportedSourceVersion()，像这样：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SupportedSourceVersion</span>(SourceVersion.latestSupported())</span><br><span class=\"line\"><span class=\"meta\">@SupportedAnnotationTypes</span>(&#123;</span><br><span class=\"line\">   <span class=\"comment\">// 合法注解全名的集合</span></span><br><span class=\"line\"> &#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyProcessor</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractProcessor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">(ProcessingEnvironment env)</span></span>&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">process</span><span class=\"params\">(Set&lt;? extends TypeElement&gt; annoations, RoundEnvironment env)</span> </span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>因为兼容的原因，特别是针对Android平台，我建议使用重载<code>getSupportedAnnotationTypes()</code>和<code>getSupportedSourceVersion()</code>方法代替<code>@SupportedAnnotationTypes</code>和</p>\n<p><code>@SuppozrtedSourceVersion</code></p>\n<p>接下来的你必须知道的事情是，注解处理器是运行它自己的虚拟机JVM中。是的，你没有看错，<strong>javac</strong>启动一个完整Java虚拟机来运行注解处理器。这对你意味着什么？你可以使用任何你在其他java应用中使用的的东西。使用guava。如果你愿意，你可以使用依赖注入工具，例如dagger或者其他你想要的类库。但是不要忘记，即使是一个很小的处理，你也要像其他Java应用一样，注意算法效率，以及设计模式。</p>\n<p><strong>注册你的处理器</strong></p>\n<p>你可能会问，我怎样将处理器MyProcessor注册到javac中。你必须提供一个<strong>.jar</strong>文件。就像其他<strong>.jar</strong>文件一样，你打包你的注解处理器到此文件中。并且，在你的jar中，你需要打包一个特定的文件javax.annotation.processing.Processor到META-INF/services路径下。所以，你的.jar文件看起来就像下面这样：</p>\n<ul>\n<li>MyProcessor.jar</li>\n<li>– com</li>\n<li>– – example</li>\n<li>– – – MyProcessor.class</li>\n<li>– META-INF</li>\n<li>– – services</li>\n<li>– – – javax.annotation.processing.Processor</li>\n</ul>\n<p>打包进MyProcessor.jar中的javax.annotation.processing.Processor的内容是，注解处理器的合法的全名列表，每一个元素换行分割：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">com.example.MyProcessor  </span><br><span class=\"line\">com.foo.OtherProcessor  </span><br><span class=\"line\">net.blabla.SpecialProcessor</span><br></pre></td></tr></table></figure>\n<p>把MyProcessor.jar放到你的builpath中，<strong>javac</strong>会自动检查和读取javax.annotation.processing.Processor中的内容，并且注册MyProcessor作为注解处理器。</p>\n"},{"title":"Java 源码注解(RetentionPolicy.SOURCE)","date":"2018-04-13T08:00:56.000Z","_content":"\n### 前言\n\n通过之前的文章[Java 注解介绍](/2018/04/12/java/java-annotations/)，我们了解到源码注解(`RetentionPolicy.SOURCE`)的生命周期只存在Java源文件这一阶段，是3种生命周期中最短的注解。当在Java源程序上加了一个注解，这个Java源程序要由javac去编译，javac把java源文件编译成.class文件，在编译成class时会把Java源程序上的源码注解给去掉。需要注意的是，在编译器处理期间源码注解还存在，即`注解处理器Processor` 也能处理源码注解，编译器处理完之后就没有该注解信息了。\n\n<!-- More -->\n\n### 定义源码注解\n\n在`Android`中，我们经常会用到下拉刷新的功能，通常会有四种状态\n\n- PULL_FROM_START：下拉刷新\n- PULL_FROM_END：上拉加载\n- BOTH：同时设置下拉刷新和上拉加载\n- DISABLED：禁用下拉刷新和上拉加载\n\n为了限制程序只能使用上面4种状态，我们一般会定义一个`Enum`枚举作为参数，这样就能限定参数的取值范围\n\n```java\npublic class PullToRefresh {\n\tprivate Mode mMode =  Mode.PULL_FROM_START;\n    \n\tpublic void setMode(Mode mode) {\n\t\tmMode = mode;\n\t}\n\n\tpublic Mode getMode() {\n\t\treturn mMode;\n\t}\n\n\tpublic void doSomething() {\n\t\tif (mMode == Mode.PULL_FROM_START) {\n\t\t} else if (mMode == Mode.PULL_FROM_END) {\n\t\t} else if (mMode == Mode.BOTH) {\n\t\t} else if (mMode == Mode.DISABLED) {\n\t\t}\n\t}\n    \n\tpublic enum Mode {\n\t\tPULL_FROM_START, PULL_FROM_END, BOTH, DISABLED\n\t}\n}\n\n// 通过以下的方式调用\nPullToRefresh pullToRefresh = new PullToRefresh();\npullToRefresh.setMode(Mode.BOTH);\n```\n\n根据google官网的描述，使用枚举会比常量占用更多的内存。这个时候我们就可以自己定义一个注解来处理上面的问题\n\n```java\npublic class PullToRefresh {\n\n\tpublic static final int PULL_FROM_START = 1;\n\tpublic static final int PULL_FROM_END = 2;\n\tpublic static final int BOTH = 3;\n\tpublic static final int DISABLED = 4;\n\n\tprivate static int sMode = PULL_FROM_START;\n\n\tpublic void setMode(@Mode int mode) {\n\t\tsMode = mode;\n\t}\n\n\tpublic int getMode() {\n\t\treturn sMode;\n\t}\n\n\tpublic void doSomething() {\n\t\tif (sMode == PULL_FROM_START) {\n\t\t} else if (sMode == PULL_FROM_END) {\n\t\t} else if (sMode == BOTH) {\n\t\t} else if (sMode == DISABLED) {\n\t\t}\n\t}\n\n\t@Retention(RetentionPolicy.SOURCE)\n\t@Target(ElementType.PARAMETER)\n\t@IntDef({PULL_FROM_START,PULL_FROM_END,BOTH,DISABLED})\n\tpublic @interface Mode {\n\t}\n}\n\n// 通过以下的方式调用\nPullToRefresh pullToRefresh = new PullToRefresh();\npullToRefresh.setMode(PullToRefresh.BOTH);\n```\n\n其中的`@IntDef`为`Android`提供的源码注解，用于表示取值范围，在`android.support.annotation`包下\n\n```java\n@Retention(RetentionPolicy.SOURCE)\n@Target({ElementType.ANNOTATION_TYPE})\npublic @interface IntDef {\n    /** Defines the allowed constants for this element */\n    long[] value() default {};\n\n    /** Defines whether the constants can be used as a flag, or just as an enum (the default) */\n    boolean flag() default false;\n}\n```\n\n类似的还有`@StringDef`\n\n```java\n@Retention(RetentionPolicy.SOURCE)\n@Target({ElementType.ANNOTATION_TYPE})\npublic @interface StringDef {\n    /** Defines the allowed constants for this element */\n    String[] value() default {};\n}\n```\n\n### 结束语\n\n总的来说，了解了源码注解，我们可以更规范的写代码，避免的很多问题的发生","source":"_posts/java/java-annotations-source.md","raw":"---\ntitle: Java 源码注解(RetentionPolicy.SOURCE)\ndate: 2018-04-13 16:00:56\ntags: [java, Annotation]\n---\n\n### 前言\n\n通过之前的文章[Java 注解介绍](/2018/04/12/java/java-annotations/)，我们了解到源码注解(`RetentionPolicy.SOURCE`)的生命周期只存在Java源文件这一阶段，是3种生命周期中最短的注解。当在Java源程序上加了一个注解，这个Java源程序要由javac去编译，javac把java源文件编译成.class文件，在编译成class时会把Java源程序上的源码注解给去掉。需要注意的是，在编译器处理期间源码注解还存在，即`注解处理器Processor` 也能处理源码注解，编译器处理完之后就没有该注解信息了。\n\n<!-- More -->\n\n### 定义源码注解\n\n在`Android`中，我们经常会用到下拉刷新的功能，通常会有四种状态\n\n- PULL_FROM_START：下拉刷新\n- PULL_FROM_END：上拉加载\n- BOTH：同时设置下拉刷新和上拉加载\n- DISABLED：禁用下拉刷新和上拉加载\n\n为了限制程序只能使用上面4种状态，我们一般会定义一个`Enum`枚举作为参数，这样就能限定参数的取值范围\n\n```java\npublic class PullToRefresh {\n\tprivate Mode mMode =  Mode.PULL_FROM_START;\n    \n\tpublic void setMode(Mode mode) {\n\t\tmMode = mode;\n\t}\n\n\tpublic Mode getMode() {\n\t\treturn mMode;\n\t}\n\n\tpublic void doSomething() {\n\t\tif (mMode == Mode.PULL_FROM_START) {\n\t\t} else if (mMode == Mode.PULL_FROM_END) {\n\t\t} else if (mMode == Mode.BOTH) {\n\t\t} else if (mMode == Mode.DISABLED) {\n\t\t}\n\t}\n    \n\tpublic enum Mode {\n\t\tPULL_FROM_START, PULL_FROM_END, BOTH, DISABLED\n\t}\n}\n\n// 通过以下的方式调用\nPullToRefresh pullToRefresh = new PullToRefresh();\npullToRefresh.setMode(Mode.BOTH);\n```\n\n根据google官网的描述，使用枚举会比常量占用更多的内存。这个时候我们就可以自己定义一个注解来处理上面的问题\n\n```java\npublic class PullToRefresh {\n\n\tpublic static final int PULL_FROM_START = 1;\n\tpublic static final int PULL_FROM_END = 2;\n\tpublic static final int BOTH = 3;\n\tpublic static final int DISABLED = 4;\n\n\tprivate static int sMode = PULL_FROM_START;\n\n\tpublic void setMode(@Mode int mode) {\n\t\tsMode = mode;\n\t}\n\n\tpublic int getMode() {\n\t\treturn sMode;\n\t}\n\n\tpublic void doSomething() {\n\t\tif (sMode == PULL_FROM_START) {\n\t\t} else if (sMode == PULL_FROM_END) {\n\t\t} else if (sMode == BOTH) {\n\t\t} else if (sMode == DISABLED) {\n\t\t}\n\t}\n\n\t@Retention(RetentionPolicy.SOURCE)\n\t@Target(ElementType.PARAMETER)\n\t@IntDef({PULL_FROM_START,PULL_FROM_END,BOTH,DISABLED})\n\tpublic @interface Mode {\n\t}\n}\n\n// 通过以下的方式调用\nPullToRefresh pullToRefresh = new PullToRefresh();\npullToRefresh.setMode(PullToRefresh.BOTH);\n```\n\n其中的`@IntDef`为`Android`提供的源码注解，用于表示取值范围，在`android.support.annotation`包下\n\n```java\n@Retention(RetentionPolicy.SOURCE)\n@Target({ElementType.ANNOTATION_TYPE})\npublic @interface IntDef {\n    /** Defines the allowed constants for this element */\n    long[] value() default {};\n\n    /** Defines whether the constants can be used as a flag, or just as an enum (the default) */\n    boolean flag() default false;\n}\n```\n\n类似的还有`@StringDef`\n\n```java\n@Retention(RetentionPolicy.SOURCE)\n@Target({ElementType.ANNOTATION_TYPE})\npublic @interface StringDef {\n    /** Defines the allowed constants for this element */\n    String[] value() default {};\n}\n```\n\n### 结束语\n\n总的来说，了解了源码注解，我们可以更规范的写代码，避免的很多问题的发生","slug":"java/java-annotations-source","published":1,"updated":"2018-05-20T13:04:25.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fh0036izcb4sp7yzz9","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>通过之前的文章<a href=\"/2018/04/12/java/java-annotations/\">Java 注解介绍</a>，我们了解到源码注解(<code>RetentionPolicy.SOURCE</code>)的生命周期只存在Java源文件这一阶段，是3种生命周期中最短的注解。当在Java源程序上加了一个注解，这个Java源程序要由javac去编译，javac把java源文件编译成.class文件，在编译成class时会把Java源程序上的源码注解给去掉。需要注意的是，在编译器处理期间源码注解还存在，即<code>注解处理器Processor</code> 也能处理源码注解，编译器处理完之后就没有该注解信息了。</p>\n<a id=\"more\"></a>\n<h3 id=\"定义源码注解\"><a href=\"#定义源码注解\" class=\"headerlink\" title=\"定义源码注解\"></a>定义源码注解</h3><p>在<code>Android</code>中，我们经常会用到下拉刷新的功能，通常会有四种状态</p>\n<ul>\n<li>PULL_FROM_START：下拉刷新</li>\n<li>PULL_FROM_END：上拉加载</li>\n<li>BOTH：同时设置下拉刷新和上拉加载</li>\n<li>DISABLED：禁用下拉刷新和上拉加载</li>\n</ul>\n<p>为了限制程序只能使用上面4种状态，我们一般会定义一个<code>Enum</code>枚举作为参数，这样就能限定参数的取值范围</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PullToRefresh</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Mode mMode =  Mode.PULL_FROM_START;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMode</span><span class=\"params\">(Mode mode)</span> </span>&#123;</span><br><span class=\"line\">\t\tmMode = mode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Mode <span class=\"title\">getMode</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> mMode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (mMode == Mode.PULL_FROM_START) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mMode == Mode.PULL_FROM_END) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mMode == Mode.BOTH) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mMode == Mode.DISABLED) &#123;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> Mode &#123;</span><br><span class=\"line\">\t\tPULL_FROM_START, PULL_FROM_END, BOTH, DISABLED</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过以下的方式调用</span></span><br><span class=\"line\">PullToRefresh pullToRefresh = <span class=\"keyword\">new</span> PullToRefresh();</span><br><span class=\"line\">pullToRefresh.setMode(Mode.BOTH);</span><br></pre></td></tr></table></figure>\n<p>根据google官网的描述，使用枚举会比常量占用更多的内存。这个时候我们就可以自己定义一个注解来处理上面的问题</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PullToRefresh</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> PULL_FROM_START = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> PULL_FROM_END = <span class=\"number\">2</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> BOTH = <span class=\"number\">3</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> DISABLED = <span class=\"number\">4</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> sMode = PULL_FROM_START;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMode</span><span class=\"params\">(@Mode <span class=\"keyword\">int</span> mode)</span> </span>&#123;</span><br><span class=\"line\">\t\tsMode = mode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getMode</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> sMode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (sMode == PULL_FROM_START) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sMode == PULL_FROM_END) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sMode == BOTH) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sMode == DISABLED) &#123;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\">\t<span class=\"meta\">@Target</span>(ElementType.PARAMETER)</span><br><span class=\"line\">\t<span class=\"meta\">@IntDef</span>(&#123;PULL_FROM_START,PULL_FROM_END,BOTH,DISABLED&#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Mode &#123;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过以下的方式调用</span></span><br><span class=\"line\">PullToRefresh pullToRefresh = <span class=\"keyword\">new</span> PullToRefresh();</span><br><span class=\"line\">pullToRefresh.setMode(PullToRefresh.BOTH);</span><br></pre></td></tr></table></figure>\n<p>其中的<code>@IntDef</code>为<code>Android</code>提供的源码注解，用于表示取值范围，在<code>android.support.annotation</code>包下</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.ANNOTATION_TYPE&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> IntDef &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** Defines the allowed constants for this element */</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span>[] value() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Defines whether the constants can be used as a flag, or just as an enum (the default) */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">flag</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"keyword\">false</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>类似的还有<code>@StringDef</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.ANNOTATION_TYPE&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> StringDef &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** Defines the allowed constants for this element */</span></span><br><span class=\"line\">    String[] value() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"结束语\"><a href=\"#结束语\" class=\"headerlink\" title=\"结束语\"></a>结束语</h3><p>总的来说，了解了源码注解，我们可以更规范的写代码，避免的很多问题的发生</p>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>通过之前的文章<a href=\"/2018/04/12/java/java-annotations/\">Java 注解介绍</a>，我们了解到源码注解(<code>RetentionPolicy.SOURCE</code>)的生命周期只存在Java源文件这一阶段，是3种生命周期中最短的注解。当在Java源程序上加了一个注解，这个Java源程序要由javac去编译，javac把java源文件编译成.class文件，在编译成class时会把Java源程序上的源码注解给去掉。需要注意的是，在编译器处理期间源码注解还存在，即<code>注解处理器Processor</code> 也能处理源码注解，编译器处理完之后就没有该注解信息了。</p>","more":"<h3 id=\"定义源码注解\"><a href=\"#定义源码注解\" class=\"headerlink\" title=\"定义源码注解\"></a>定义源码注解</h3><p>在<code>Android</code>中，我们经常会用到下拉刷新的功能，通常会有四种状态</p>\n<ul>\n<li>PULL_FROM_START：下拉刷新</li>\n<li>PULL_FROM_END：上拉加载</li>\n<li>BOTH：同时设置下拉刷新和上拉加载</li>\n<li>DISABLED：禁用下拉刷新和上拉加载</li>\n</ul>\n<p>为了限制程序只能使用上面4种状态，我们一般会定义一个<code>Enum</code>枚举作为参数，这样就能限定参数的取值范围</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PullToRefresh</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Mode mMode =  Mode.PULL_FROM_START;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMode</span><span class=\"params\">(Mode mode)</span> </span>&#123;</span><br><span class=\"line\">\t\tmMode = mode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> Mode <span class=\"title\">getMode</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> mMode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (mMode == Mode.PULL_FROM_START) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mMode == Mode.PULL_FROM_END) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mMode == Mode.BOTH) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mMode == Mode.DISABLED) &#123;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> Mode &#123;</span><br><span class=\"line\">\t\tPULL_FROM_START, PULL_FROM_END, BOTH, DISABLED</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过以下的方式调用</span></span><br><span class=\"line\">PullToRefresh pullToRefresh = <span class=\"keyword\">new</span> PullToRefresh();</span><br><span class=\"line\">pullToRefresh.setMode(Mode.BOTH);</span><br></pre></td></tr></table></figure>\n<p>根据google官网的描述，使用枚举会比常量占用更多的内存。这个时候我们就可以自己定义一个注解来处理上面的问题</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PullToRefresh</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> PULL_FROM_START = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> PULL_FROM_END = <span class=\"number\">2</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> BOTH = <span class=\"number\">3</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> DISABLED = <span class=\"number\">4</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> sMode = PULL_FROM_START;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMode</span><span class=\"params\">(@Mode <span class=\"keyword\">int</span> mode)</span> </span>&#123;</span><br><span class=\"line\">\t\tsMode = mode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getMode</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> sMode;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">doSomething</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (sMode == PULL_FROM_START) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sMode == PULL_FROM_END) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sMode == BOTH) &#123;</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (sMode == DISABLED) &#123;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\">\t<span class=\"meta\">@Target</span>(ElementType.PARAMETER)</span><br><span class=\"line\">\t<span class=\"meta\">@IntDef</span>(&#123;PULL_FROM_START,PULL_FROM_END,BOTH,DISABLED&#125;)</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Mode &#123;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过以下的方式调用</span></span><br><span class=\"line\">PullToRefresh pullToRefresh = <span class=\"keyword\">new</span> PullToRefresh();</span><br><span class=\"line\">pullToRefresh.setMode(PullToRefresh.BOTH);</span><br></pre></td></tr></table></figure>\n<p>其中的<code>@IntDef</code>为<code>Android</code>提供的源码注解，用于表示取值范围，在<code>android.support.annotation</code>包下</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.ANNOTATION_TYPE&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> IntDef &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** Defines the allowed constants for this element */</span></span><br><span class=\"line\">    <span class=\"keyword\">long</span>[] value() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Defines whether the constants can be used as a flag, or just as an enum (the default) */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">flag</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"keyword\">false</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>类似的还有<code>@StringDef</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.ANNOTATION_TYPE&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> StringDef &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** Defines the allowed constants for this element */</span></span><br><span class=\"line\">    String[] value() <span class=\"keyword\">default</span> &#123;&#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"结束语\"><a href=\"#结束语\" class=\"headerlink\" title=\"结束语\"></a>结束语</h3><p>总的来说，了解了源码注解，我们可以更规范的写代码，避免的很多问题的发生</p>"},{"title":"Java 注解介绍","date":"2018-04-12T10:09:35.000Z","_content":"\n[TOC]\n\n\n\n本文及相关注解文章部分摘自以下的博客，推荐大家阅读\n\n[ 秒懂，Java 注解 （Annotation）你可以这样学](http://blog.csdn.net/briblue/article/details/73824058)\n\n[Java注解基础概念总结](https://blog.csdn.net/github_35180164/article/details/52107204)\n\n### 定义\n\n注解(Annotaion)，也叫元数据。一种代码级别的说明。它是`JDK1.5`及以后版本引入的一特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明、注解。\n\n作用分类：\n\n- 编写文档：通过代码里标识的元数据生成文档【生成文档doc文档】。\n- 代码分析：通过代码里标识的元数据对代码进行分析【使用反射】。\n- 编译检查：通过代码里标识的元数据让编译器能实现基本的编译检查【Override】。\n\n<!-- More -->\n\n### 语法\n\n示例：\n\n```java\n// 定义一个注解\n@Retention(RetentionPolicy.CLASS)\n@Target(ElementType.TYPE)\npublic @interface AnnotationsTest { \n    String value ();\n}\n\n// 使用\n@AnnotationsTest(value = \"abc\")\nclass Foo {}\n```\n\n1. 以`@interface`关键字定义\n2. 注解包含成员，成员以无参数的方法的形式被声明。其方法名和返回值定义了该成员的名字和类型，例如上述例子中的`String value()`\n3. 成员赋值是通过@Annotation(name=value)的形式，例如上述例子中的`@Target(ElementType.TYPE)`\n4. 注解需要标明注解的生命周期，注解的修饰目标等信息，这些信息是通过元注解实现\n\n下面我们来分析一下`java.lang.annotation`中定义的`Target`注解：\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Target {\n    ElementType[] value();\n}\n```\n\n- 元注解@Retention，成员value的值为`RetentionPolicy.RUNTIME`\n- 元注解@Target，成员value是个数组，用{}形式赋值，值为`ElementType.ANNOTATION_TYPE`\n- 成员名称为value，类型为`ElementType[]`\n\n另外，需要注意一下，如果成员名称是value，在赋值过程中可以简写。如果成员类型为数组，但是只赋值一个元素，则也可以简写。如上面的简写形式为：\n\n```java\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\n```\n\n### 注解的类型\n\n注解分为两类，一类是元注解(meta-annotation)，另外一类是普通注解\n\n#### 元注解\n\n> 所谓元注解就是修饰注解的注解。\n> 拿到一个注解，如何知道它是否是元注解呢？需要看它的元注解（无论是元注解还是普通注解都是有元注解），如果看到这样的元注解：`@Target(ElementType.ANNOTATION_TYPE)`，那么此时这个注解一定是元注解。\n\n**@Retention**\n\n表示在什么级别保存该注解信息，可能的值在枚举类`ElementType`中\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Retention {\n    RetentionPolicy value();\n}\n\n// RetentionPolicy\npublic enum RetentionPolicy {\n    SOURCE, // 注解只保留在源文件，当Java文件编译成class文件的时候，注解被遗弃\n    CLASS, // 注解被保留到class文件，jvm加载class文件时候被遗弃。这是默认的生命周期\n    /*\n    * 注解不仅被保存到class文件中，jvm加载class文件之后，仍然存在，保存到class对象中，\n    * 可以通过反射来获取\n    */\n    RUNTIME \n}\n```\n\n这3个生命周期对应表如下\n\n| 名称                    | 生命周期              |\n| ----------------------- | --------------------- |\n| RetentionPolicy.SOURCE  | Java源文件(.java文件) |\n| RetentionPolicy.CLASS   | .class文件            |\n| RetentionPolicy.RUNTIME | 内存中的字节          |\n\n> 首先要明确生命周期长度 **SOURCE < CLASS < RUNTIME** ，所以前者能作用的地方后者一定也能作用。一般如果需要在运行时去动态获取注解信息，那只能用 `RUNTIME `注解；如果要在编译时进行一些预处理操作，比如生成一些辅助代码（如 [ButterKnife](https://github.com/JakeWharton/butterknife)），就用 `CLASS`注解；如果只是做一些检查性的操作，比如` @Override` 和 `@SuppressWarnings`，则可选用 `SOURCE` 注解。\n\n**@Target**\n\n表示该注解用于什么地方，可能的值在枚举类`ElementType`中\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Target {\n    ElementType[] value();\n}\n\npublic enum ElementType {\n    TYPE,  // 类、接口(包含注解类型)或enum声明\n    FIELD, // 字段声明(包含enum实例)\n    METHOD, // 方法声明\n    PARAMETER, // 参数声明\n    CONSTRUCTOR, // 构造器声明\n    LOCAL_VARIABLE, // 局部变量声明\n    ANNOTATION_TYPE, // 注解声明\n    PACKAGE, // 包声明\n    TYPE_PARAMETER, // 泛型参数声明 (自1.8提供)\n    TYPE_USE, // 泛型声明 (自1.8提供)\n}\n```\n\n**@Documented**\n\n将此注解包含在 javadoc 中 ，它代表着此注解会被javadoc工具提取成文档。在doc文档中的内容会因为此注解的信息内容不同而不同。相当与@see,@param 等。\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Documented {\n}\n```\n\n**@Inherited**\n\n允许子类继承父类中的注解\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Inherited {\n}\n```\n\n**@Repeatable**\n\n@Repeatable 是 Java 1.8 才加的，意为可重复，也就是注解的值可以同时取多个\n\n示例，一个人\n\n\n\n#### 普通注解\n\n##### 基本内置注解\n\n**@Override**\n\n该注解提示子类复写父类中的方法\n\n```java\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.SOURCE)\npublic @interface Override {\n}\n```\n\n**@Deprecated**\n\n这注解用来标记过时的元素。编译器在编译阶段遇到这个注解时会发出提醒警告，告诉开发者正在调用一个过时的元素（过时的方法、过时的类、过时的成员变量）\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(value={CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, PARAMETER, TYPE})\npublic @interface Deprecated {\n}\n```\n\n**@SuppressWarnings**\n\n阻止警告的意思。之前说过调用被 @Deprecated 注解的方法后，编译器会警告提醒，而有时候开发者会忽略这种警告，他们可以在调用的地方通过 @SuppressWarnings 达到目的。\n\n```java\n@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})\n@Retention(RetentionPolicy.SOURCE)\npublic @interface SuppressWarnings {\n    String[] value();\n}\n```\n\n##### 自定义注解\n\n关于自定义注解，请移步\n\n[java 自定义源码注解](/2018/01/25/study/study-bwh/)\n\n[java 自定义编译时注解](/2018/01/25/study/study-bwh/)\n\n[java 自定运行时注解](/2018/01/25/study/study-bwh/)","source":"_posts/java/java-annotations.md","raw":"---\ntitle: Java 注解介绍\ndate: 2018-04-12 18:09:35\ntags: [java, Annotation]\n---\n\n[TOC]\n\n\n\n本文及相关注解文章部分摘自以下的博客，推荐大家阅读\n\n[ 秒懂，Java 注解 （Annotation）你可以这样学](http://blog.csdn.net/briblue/article/details/73824058)\n\n[Java注解基础概念总结](https://blog.csdn.net/github_35180164/article/details/52107204)\n\n### 定义\n\n注解(Annotaion)，也叫元数据。一种代码级别的说明。它是`JDK1.5`及以后版本引入的一特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明、注解。\n\n作用分类：\n\n- 编写文档：通过代码里标识的元数据生成文档【生成文档doc文档】。\n- 代码分析：通过代码里标识的元数据对代码进行分析【使用反射】。\n- 编译检查：通过代码里标识的元数据让编译器能实现基本的编译检查【Override】。\n\n<!-- More -->\n\n### 语法\n\n示例：\n\n```java\n// 定义一个注解\n@Retention(RetentionPolicy.CLASS)\n@Target(ElementType.TYPE)\npublic @interface AnnotationsTest { \n    String value ();\n}\n\n// 使用\n@AnnotationsTest(value = \"abc\")\nclass Foo {}\n```\n\n1. 以`@interface`关键字定义\n2. 注解包含成员，成员以无参数的方法的形式被声明。其方法名和返回值定义了该成员的名字和类型，例如上述例子中的`String value()`\n3. 成员赋值是通过@Annotation(name=value)的形式，例如上述例子中的`@Target(ElementType.TYPE)`\n4. 注解需要标明注解的生命周期，注解的修饰目标等信息，这些信息是通过元注解实现\n\n下面我们来分析一下`java.lang.annotation`中定义的`Target`注解：\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Target {\n    ElementType[] value();\n}\n```\n\n- 元注解@Retention，成员value的值为`RetentionPolicy.RUNTIME`\n- 元注解@Target，成员value是个数组，用{}形式赋值，值为`ElementType.ANNOTATION_TYPE`\n- 成员名称为value，类型为`ElementType[]`\n\n另外，需要注意一下，如果成员名称是value，在赋值过程中可以简写。如果成员类型为数组，但是只赋值一个元素，则也可以简写。如上面的简写形式为：\n\n```java\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\n```\n\n### 注解的类型\n\n注解分为两类，一类是元注解(meta-annotation)，另外一类是普通注解\n\n#### 元注解\n\n> 所谓元注解就是修饰注解的注解。\n> 拿到一个注解，如何知道它是否是元注解呢？需要看它的元注解（无论是元注解还是普通注解都是有元注解），如果看到这样的元注解：`@Target(ElementType.ANNOTATION_TYPE)`，那么此时这个注解一定是元注解。\n\n**@Retention**\n\n表示在什么级别保存该注解信息，可能的值在枚举类`ElementType`中\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Retention {\n    RetentionPolicy value();\n}\n\n// RetentionPolicy\npublic enum RetentionPolicy {\n    SOURCE, // 注解只保留在源文件，当Java文件编译成class文件的时候，注解被遗弃\n    CLASS, // 注解被保留到class文件，jvm加载class文件时候被遗弃。这是默认的生命周期\n    /*\n    * 注解不仅被保存到class文件中，jvm加载class文件之后，仍然存在，保存到class对象中，\n    * 可以通过反射来获取\n    */\n    RUNTIME \n}\n```\n\n这3个生命周期对应表如下\n\n| 名称                    | 生命周期              |\n| ----------------------- | --------------------- |\n| RetentionPolicy.SOURCE  | Java源文件(.java文件) |\n| RetentionPolicy.CLASS   | .class文件            |\n| RetentionPolicy.RUNTIME | 内存中的字节          |\n\n> 首先要明确生命周期长度 **SOURCE < CLASS < RUNTIME** ，所以前者能作用的地方后者一定也能作用。一般如果需要在运行时去动态获取注解信息，那只能用 `RUNTIME `注解；如果要在编译时进行一些预处理操作，比如生成一些辅助代码（如 [ButterKnife](https://github.com/JakeWharton/butterknife)），就用 `CLASS`注解；如果只是做一些检查性的操作，比如` @Override` 和 `@SuppressWarnings`，则可选用 `SOURCE` 注解。\n\n**@Target**\n\n表示该注解用于什么地方，可能的值在枚举类`ElementType`中\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Target {\n    ElementType[] value();\n}\n\npublic enum ElementType {\n    TYPE,  // 类、接口(包含注解类型)或enum声明\n    FIELD, // 字段声明(包含enum实例)\n    METHOD, // 方法声明\n    PARAMETER, // 参数声明\n    CONSTRUCTOR, // 构造器声明\n    LOCAL_VARIABLE, // 局部变量声明\n    ANNOTATION_TYPE, // 注解声明\n    PACKAGE, // 包声明\n    TYPE_PARAMETER, // 泛型参数声明 (自1.8提供)\n    TYPE_USE, // 泛型声明 (自1.8提供)\n}\n```\n\n**@Documented**\n\n将此注解包含在 javadoc 中 ，它代表着此注解会被javadoc工具提取成文档。在doc文档中的内容会因为此注解的信息内容不同而不同。相当与@see,@param 等。\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Documented {\n}\n```\n\n**@Inherited**\n\n允许子类继承父类中的注解\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Inherited {\n}\n```\n\n**@Repeatable**\n\n@Repeatable 是 Java 1.8 才加的，意为可重复，也就是注解的值可以同时取多个\n\n示例，一个人\n\n\n\n#### 普通注解\n\n##### 基本内置注解\n\n**@Override**\n\n该注解提示子类复写父类中的方法\n\n```java\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.SOURCE)\npublic @interface Override {\n}\n```\n\n**@Deprecated**\n\n这注解用来标记过时的元素。编译器在编译阶段遇到这个注解时会发出提醒警告，告诉开发者正在调用一个过时的元素（过时的方法、过时的类、过时的成员变量）\n\n```java\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(value={CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, PARAMETER, TYPE})\npublic @interface Deprecated {\n}\n```\n\n**@SuppressWarnings**\n\n阻止警告的意思。之前说过调用被 @Deprecated 注解的方法后，编译器会警告提醒，而有时候开发者会忽略这种警告，他们可以在调用的地方通过 @SuppressWarnings 达到目的。\n\n```java\n@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})\n@Retention(RetentionPolicy.SOURCE)\npublic @interface SuppressWarnings {\n    String[] value();\n}\n```\n\n##### 自定义注解\n\n关于自定义注解，请移步\n\n[java 自定义源码注解](/2018/01/25/study/study-bwh/)\n\n[java 自定义编译时注解](/2018/01/25/study/study-bwh/)\n\n[java 自定运行时注解](/2018/01/25/study/study-bwh/)","slug":"java/java-annotations","published":1,"updated":"2018-05-20T13:04:25.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fi0038izcbgyefxi49","content":"<p>[TOC]</p>\n<p>本文及相关注解文章部分摘自以下的博客，推荐大家阅读</p>\n<p><a href=\"http://blog.csdn.net/briblue/article/details/73824058\" target=\"_blank\" rel=\"noopener\"> 秒懂，Java 注解 （Annotation）你可以这样学</a></p>\n<p><a href=\"https://blog.csdn.net/github_35180164/article/details/52107204\" target=\"_blank\" rel=\"noopener\">Java注解基础概念总结</a></p>\n<h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>注解(Annotaion)，也叫元数据。一种代码级别的说明。它是<code>JDK1.5</code>及以后版本引入的一特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明、注解。</p>\n<p>作用分类：</p>\n<ul>\n<li>编写文档：通过代码里标识的元数据生成文档【生成文档doc文档】。</li>\n<li>代码分析：通过代码里标识的元数据对代码进行分析【使用反射】。</li>\n<li>编译检查：通过代码里标识的元数据让编译器能实现基本的编译检查【Override】。</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"语法\"><a href=\"#语法\" class=\"headerlink\" title=\"语法\"></a>语法</h3><p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义一个注解</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.CLASS)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> AnnotationsTest &#123; </span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span> <span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 使用</span></span><br><span class=\"line\"><span class=\"meta\">@AnnotationsTest</span>(value = <span class=\"string\">\"abc\"</span>)</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<ol>\n<li>以<code>@interface</code>关键字定义</li>\n<li>注解包含成员，成员以无参数的方法的形式被声明。其方法名和返回值定义了该成员的名字和类型，例如上述例子中的<code>String value()</code></li>\n<li>成员赋值是通过@Annotation(name=value)的形式，例如上述例子中的<code>@Target(ElementType.TYPE)</code></li>\n<li>注解需要标明注解的生命周期，注解的修饰目标等信息，这些信息是通过元注解实现</li>\n</ol>\n<p>下面我们来分析一下<code>java.lang.annotation</code>中定义的<code>Target</code>注解：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Target &#123;</span><br><span class=\"line\">    ElementType[] value();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>元注解@Retention，成员value的值为<code>RetentionPolicy.RUNTIME</code></li>\n<li>元注解@Target，成员value是个数组，用{}形式赋值，值为<code>ElementType.ANNOTATION_TYPE</code></li>\n<li>成员名称为value，类型为<code>ElementType[]</code></li>\n</ul>\n<p>另外，需要注意一下，如果成员名称是value，在赋值过程中可以简写。如果成员类型为数组，但是只赋值一个元素，则也可以简写。如上面的简写形式为：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br></pre></td></tr></table></figure>\n<h3 id=\"注解的类型\"><a href=\"#注解的类型\" class=\"headerlink\" title=\"注解的类型\"></a>注解的类型</h3><p>注解分为两类，一类是元注解(meta-annotation)，另外一类是普通注解</p>\n<h4 id=\"元注解\"><a href=\"#元注解\" class=\"headerlink\" title=\"元注解\"></a>元注解</h4><blockquote>\n<p>所谓元注解就是修饰注解的注解。<br>拿到一个注解，如何知道它是否是元注解呢？需要看它的元注解（无论是元注解还是普通注解都是有元注解），如果看到这样的元注解：<code>@Target(ElementType.ANNOTATION_TYPE)</code>，那么此时这个注解一定是元注解。</p>\n</blockquote>\n<p><strong>@Retention</strong></p>\n<p>表示在什么级别保存该注解信息，可能的值在枚举类<code>ElementType</code>中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Retention &#123;</span><br><span class=\"line\">    <span class=\"function\">RetentionPolicy <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// RetentionPolicy</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> RetentionPolicy &#123;</span><br><span class=\"line\">    SOURCE, <span class=\"comment\">// 注解只保留在源文件，当Java文件编译成class文件的时候，注解被遗弃</span></span><br><span class=\"line\">    CLASS, <span class=\"comment\">// 注解被保留到class文件，jvm加载class文件时候被遗弃。这是默认的生命周期</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    * 注解不仅被保存到class文件中，jvm加载class文件之后，仍然存在，保存到class对象中，</span></span><br><span class=\"line\"><span class=\"comment\">    * 可以通过反射来获取</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    RUNTIME </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这3个生命周期对应表如下</p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>生命周期</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>RetentionPolicy.SOURCE</td>\n<td>Java源文件(.java文件)</td>\n</tr>\n<tr>\n<td>RetentionPolicy.CLASS</td>\n<td>.class文件</td>\n</tr>\n<tr>\n<td>RetentionPolicy.RUNTIME</td>\n<td>内存中的字节</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>首先要明确生命周期长度 <strong>SOURCE &lt; CLASS &lt; RUNTIME</strong> ，所以前者能作用的地方后者一定也能作用。一般如果需要在运行时去动态获取注解信息，那只能用 <code>RUNTIME</code>注解；如果要在编译时进行一些预处理操作，比如生成一些辅助代码（如 <a href=\"https://github.com/JakeWharton/butterknife\" target=\"_blank\" rel=\"noopener\">ButterKnife</a>），就用 <code>CLASS</code>注解；如果只是做一些检查性的操作，比如<code>@Override</code> 和 <code>@SuppressWarnings</code>，则可选用 <code>SOURCE</code> 注解。</p>\n</blockquote>\n<p><strong>@Target</strong></p>\n<p>表示该注解用于什么地方，可能的值在枚举类<code>ElementType</code>中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Target &#123;</span><br><span class=\"line\">    ElementType[] value();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> ElementType &#123;</span><br><span class=\"line\">    TYPE,  <span class=\"comment\">// 类、接口(包含注解类型)或enum声明</span></span><br><span class=\"line\">    FIELD, <span class=\"comment\">// 字段声明(包含enum实例)</span></span><br><span class=\"line\">    METHOD, <span class=\"comment\">// 方法声明</span></span><br><span class=\"line\">    PARAMETER, <span class=\"comment\">// 参数声明</span></span><br><span class=\"line\">    CONSTRUCTOR, <span class=\"comment\">// 构造器声明</span></span><br><span class=\"line\">    LOCAL_VARIABLE, <span class=\"comment\">// 局部变量声明</span></span><br><span class=\"line\">    ANNOTATION_TYPE, <span class=\"comment\">// 注解声明</span></span><br><span class=\"line\">    PACKAGE, <span class=\"comment\">// 包声明</span></span><br><span class=\"line\">    TYPE_PARAMETER, <span class=\"comment\">// 泛型参数声明 (自1.8提供)</span></span><br><span class=\"line\">    TYPE_USE, <span class=\"comment\">// 泛型声明 (自1.8提供)</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Documented</strong></p>\n<p>将此注解包含在 javadoc 中 ，它代表着此注解会被javadoc工具提取成文档。在doc文档中的内容会因为此注解的信息内容不同而不同。相当与@see,@param 等。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Documented &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Inherited</strong></p>\n<p>允许子类继承父类中的注解</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Inherited &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Repeatable</strong></p>\n<p>@Repeatable 是 Java 1.8 才加的，意为可重复，也就是注解的值可以同时取多个</p>\n<p>示例，一个人</p>\n<h4 id=\"普通注解\"><a href=\"#普通注解\" class=\"headerlink\" title=\"普通注解\"></a>普通注解</h4><h5 id=\"基本内置注解\"><a href=\"#基本内置注解\" class=\"headerlink\" title=\"基本内置注解\"></a>基本内置注解</h5><p><strong>@Override</strong></p>\n<p>该注解提示子类复写父类中的方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.METHOD)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Override &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Deprecated</strong></p>\n<p>这注解用来标记过时的元素。编译器在编译阶段遇到这个注解时会发出提醒警告，告诉开发者正在调用一个过时的元素（过时的方法、过时的类、过时的成员变量）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(value=&#123;CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, PARAMETER, TYPE&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Deprecated &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@SuppressWarnings</strong></p>\n<p>阻止警告的意思。之前说过调用被 @Deprecated 注解的方法后，编译器会警告提醒，而有时候开发者会忽略这种警告，他们可以在调用的地方通过 @SuppressWarnings 达到目的。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SuppressWarnings &#123;</span><br><span class=\"line\">    String[] value();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"自定义注解\"><a href=\"#自定义注解\" class=\"headerlink\" title=\"自定义注解\"></a>自定义注解</h5><p>关于自定义注解，请移步</p>\n<p><a href=\"/2018/01/25/study/study-bwh/\">java 自定义源码注解</a></p>\n<p><a href=\"/2018/01/25/study/study-bwh/\">java 自定义编译时注解</a></p>\n<p><a href=\"/2018/01/25/study/study-bwh/\">java 自定运行时注解</a></p>\n","site":{"data":{}},"excerpt":"<p>[TOC]</p>\n<p>本文及相关注解文章部分摘自以下的博客，推荐大家阅读</p>\n<p><a href=\"http://blog.csdn.net/briblue/article/details/73824058\" target=\"_blank\" rel=\"noopener\"> 秒懂，Java 注解 （Annotation）你可以这样学</a></p>\n<p><a href=\"https://blog.csdn.net/github_35180164/article/details/52107204\" target=\"_blank\" rel=\"noopener\">Java注解基础概念总结</a></p>\n<h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>注解(Annotaion)，也叫元数据。一种代码级别的说明。它是<code>JDK1.5</code>及以后版本引入的一特性，与类、接口、枚举是在同一个层次。它可以声明在包、类、字段、方法、局部变量、方法参数等的前面，用来对这些元素进行说明、注解。</p>\n<p>作用分类：</p>\n<ul>\n<li>编写文档：通过代码里标识的元数据生成文档【生成文档doc文档】。</li>\n<li>代码分析：通过代码里标识的元数据对代码进行分析【使用反射】。</li>\n<li>编译检查：通过代码里标识的元数据让编译器能实现基本的编译检查【Override】。</li>\n</ul>","more":"<h3 id=\"语法\"><a href=\"#语法\" class=\"headerlink\" title=\"语法\"></a>语法</h3><p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义一个注解</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.CLASS)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> AnnotationsTest &#123; </span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span> <span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 使用</span></span><br><span class=\"line\"><span class=\"meta\">@AnnotationsTest</span>(value = <span class=\"string\">\"abc\"</span>)</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Foo</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<ol>\n<li>以<code>@interface</code>关键字定义</li>\n<li>注解包含成员，成员以无参数的方法的形式被声明。其方法名和返回值定义了该成员的名字和类型，例如上述例子中的<code>String value()</code></li>\n<li>成员赋值是通过@Annotation(name=value)的形式，例如上述例子中的<code>@Target(ElementType.TYPE)</code></li>\n<li>注解需要标明注解的生命周期，注解的修饰目标等信息，这些信息是通过元注解实现</li>\n</ol>\n<p>下面我们来分析一下<code>java.lang.annotation</code>中定义的<code>Target</code>注解：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Target &#123;</span><br><span class=\"line\">    ElementType[] value();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>元注解@Retention，成员value的值为<code>RetentionPolicy.RUNTIME</code></li>\n<li>元注解@Target，成员value是个数组，用{}形式赋值，值为<code>ElementType.ANNOTATION_TYPE</code></li>\n<li>成员名称为value，类型为<code>ElementType[]</code></li>\n</ul>\n<p>另外，需要注意一下，如果成员名称是value，在赋值过程中可以简写。如果成员类型为数组，但是只赋值一个元素，则也可以简写。如上面的简写形式为：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br></pre></td></tr></table></figure>\n<h3 id=\"注解的类型\"><a href=\"#注解的类型\" class=\"headerlink\" title=\"注解的类型\"></a>注解的类型</h3><p>注解分为两类，一类是元注解(meta-annotation)，另外一类是普通注解</p>\n<h4 id=\"元注解\"><a href=\"#元注解\" class=\"headerlink\" title=\"元注解\"></a>元注解</h4><blockquote>\n<p>所谓元注解就是修饰注解的注解。<br>拿到一个注解，如何知道它是否是元注解呢？需要看它的元注解（无论是元注解还是普通注解都是有元注解），如果看到这样的元注解：<code>@Target(ElementType.ANNOTATION_TYPE)</code>，那么此时这个注解一定是元注解。</p>\n</blockquote>\n<p><strong>@Retention</strong></p>\n<p>表示在什么级别保存该注解信息，可能的值在枚举类<code>ElementType</code>中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Retention &#123;</span><br><span class=\"line\">    <span class=\"function\">RetentionPolicy <span class=\"title\">value</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// RetentionPolicy</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> RetentionPolicy &#123;</span><br><span class=\"line\">    SOURCE, <span class=\"comment\">// 注解只保留在源文件，当Java文件编译成class文件的时候，注解被遗弃</span></span><br><span class=\"line\">    CLASS, <span class=\"comment\">// 注解被保留到class文件，jvm加载class文件时候被遗弃。这是默认的生命周期</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    * 注解不仅被保存到class文件中，jvm加载class文件之后，仍然存在，保存到class对象中，</span></span><br><span class=\"line\"><span class=\"comment\">    * 可以通过反射来获取</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    RUNTIME </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这3个生命周期对应表如下</p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>生命周期</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>RetentionPolicy.SOURCE</td>\n<td>Java源文件(.java文件)</td>\n</tr>\n<tr>\n<td>RetentionPolicy.CLASS</td>\n<td>.class文件</td>\n</tr>\n<tr>\n<td>RetentionPolicy.RUNTIME</td>\n<td>内存中的字节</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>首先要明确生命周期长度 <strong>SOURCE &lt; CLASS &lt; RUNTIME</strong> ，所以前者能作用的地方后者一定也能作用。一般如果需要在运行时去动态获取注解信息，那只能用 <code>RUNTIME</code>注解；如果要在编译时进行一些预处理操作，比如生成一些辅助代码（如 <a href=\"https://github.com/JakeWharton/butterknife\" target=\"_blank\" rel=\"noopener\">ButterKnife</a>），就用 <code>CLASS</code>注解；如果只是做一些检查性的操作，比如<code>@Override</code> 和 <code>@SuppressWarnings</code>，则可选用 <code>SOURCE</code> 注解。</p>\n</blockquote>\n<p><strong>@Target</strong></p>\n<p>表示该注解用于什么地方，可能的值在枚举类<code>ElementType</code>中</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Target &#123;</span><br><span class=\"line\">    ElementType[] value();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> ElementType &#123;</span><br><span class=\"line\">    TYPE,  <span class=\"comment\">// 类、接口(包含注解类型)或enum声明</span></span><br><span class=\"line\">    FIELD, <span class=\"comment\">// 字段声明(包含enum实例)</span></span><br><span class=\"line\">    METHOD, <span class=\"comment\">// 方法声明</span></span><br><span class=\"line\">    PARAMETER, <span class=\"comment\">// 参数声明</span></span><br><span class=\"line\">    CONSTRUCTOR, <span class=\"comment\">// 构造器声明</span></span><br><span class=\"line\">    LOCAL_VARIABLE, <span class=\"comment\">// 局部变量声明</span></span><br><span class=\"line\">    ANNOTATION_TYPE, <span class=\"comment\">// 注解声明</span></span><br><span class=\"line\">    PACKAGE, <span class=\"comment\">// 包声明</span></span><br><span class=\"line\">    TYPE_PARAMETER, <span class=\"comment\">// 泛型参数声明 (自1.8提供)</span></span><br><span class=\"line\">    TYPE_USE, <span class=\"comment\">// 泛型声明 (自1.8提供)</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Documented</strong></p>\n<p>将此注解包含在 javadoc 中 ，它代表着此注解会被javadoc工具提取成文档。在doc文档中的内容会因为此注解的信息内容不同而不同。相当与@see,@param 等。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Documented &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Inherited</strong></p>\n<p>允许子类继承父类中的注解</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.ANNOTATION_TYPE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Inherited &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Repeatable</strong></p>\n<p>@Repeatable 是 Java 1.8 才加的，意为可重复，也就是注解的值可以同时取多个</p>\n<p>示例，一个人</p>\n<h4 id=\"普通注解\"><a href=\"#普通注解\" class=\"headerlink\" title=\"普通注解\"></a>普通注解</h4><h5 id=\"基本内置注解\"><a href=\"#基本内置注解\" class=\"headerlink\" title=\"基本内置注解\"></a>基本内置注解</h5><p><strong>@Override</strong></p>\n<p>该注解提示子类复写父类中的方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(ElementType.METHOD)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Override &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@Deprecated</strong></p>\n<p>这注解用来标记过时的元素。编译器在编译阶段遇到这个注解时会发出提醒警告，告诉开发者正在调用一个过时的元素（过时的方法、过时的类、过时的成员变量）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"meta\">@Target</span>(value=&#123;CONSTRUCTOR, FIELD, LOCAL_VARIABLE, METHOD, PACKAGE, PARAMETER, TYPE&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Deprecated &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>@SuppressWarnings</strong></p>\n<p>阻止警告的意思。之前说过调用被 @Deprecated 注解的方法后，编译器会警告提醒，而有时候开发者会忽略这种警告，他们可以在调用的地方通过 @SuppressWarnings 达到目的。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> SuppressWarnings &#123;</span><br><span class=\"line\">    String[] value();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"自定义注解\"><a href=\"#自定义注解\" class=\"headerlink\" title=\"自定义注解\"></a>自定义注解</h5><p>关于自定义注解，请移步</p>\n<p><a href=\"/2018/01/25/study/study-bwh/\">java 自定义源码注解</a></p>\n<p><a href=\"/2018/01/25/study/study-bwh/\">java 自定义编译时注解</a></p>\n<p><a href=\"/2018/01/25/study/study-bwh/\">java 自定运行时注解</a></p>"},{"title":"Java反射","date":"2018-04-27T08:35:46.000Z","_content":"\n### 前言\n\n在Java中，我们主要通过反射(Reflection)来在运行时来获取类或对象的相关信息\n\n- 获取对象所属的类\n- 构造类的对象\n- 获取类的构造函数对象\n- 获取类的成员变量，包括`private` 修饰的变量\n- 调用类的方法，包括`private`修饰的方法\n\n<!-- More -->\n\n### 基本运用\n\n在使用反射时，我们会先获取`Class对象`，再通过`Class对象`获取对象常用的操作类：`Constructor(构造函数)`、`Field(字段)`、`Method(方法)`\n\n#### Class类\n\n**`Class`代表类对象，可以通过以下几种方式获取**\n\n```java\n// 第一种\nClass<?> cls1 = MyClass.class;\n\n// 第二种\nMyClass myClass = new MyClass();\nClass<?> cls2 = myClass.getClass();\n\n// 第三种，forName方法的参数需要填完整的包名和类名\nClass<?> cls3 = null;\ntry {\n    cls3 = Class.forName(\"reflection.MyClass\");\n} catch (ClassNotFoundException e) {\n    e.printStackTrace();\n}\n```\n\n**获取类名称**\n\n```java\nClass<?> myClass = MyClass.class;\n// 返回类的名称(包含包名): reflection.MyClass\nmyClass.getName() \n// 返回类的名称(不包含包名): MyClass\nmyClass.getSimpleName()\n```\n\n**创建实例**\n\n```java\nClass<?> cls = MyClass.class;\n// 调用newInstance()方法获取实例对象时，类必需提供一个公有的无参数的构造函数\nMyClass myClass = cls.newInstance();\n```\n\n**Class类的一些常用方法**\n\n```java\n// 获取父类\npublic native Class<? super T> getSuperclass();\n// 获取实现的所有接口\npublic Class<?>[] getInterfaces();\n```\n\n\n\n#### Constructor类\n\n**`Constructor`表示类的构造器对象，可以通过以下方式获取。其中类似`getDeclaredConstructor`的方法返回不限修饰符的构造函数，`getConstructor`的方法表示只返回`public`修饰的构造函数**\n\n部分源码:\n\n```java\n// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数 \npublic Constructor<?>[] getConstructors();\n\n// 返回所有构造函数对象列表，不限修饰符(包含private等修饰的构造函数)\npublic Constructor<?>[] getDeclaredConstructors();\n\n// 根据给定的参数类型返回构造函数，如果获取的构造函数不是public修饰的，会报NoSuchMethodException\npublic Constructor<T> getConstructor(Class<?>... parameterTypes);\n    \n// 根据给定的参数类型返回不限修饰符的构造函数\npublic Constructor<T> getDeclaredConstructor(Class<?>... parameterTypes);\n```\n\n示例：\n\n```java\npublic class MyClass {\n\tpublic MyClass() {} // 第一个\n\tpublic MyClass(int arg) {} // 第二个\n\tprotected MyClass(String arg) {} // 第三个\n\tprivate MyClass(int arg1, String arg2) {} // 第四个\n}\nClass<?> myClass = MyClass.class;\n\n// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数(2个对象)\nConstructor[] constructors = myClass.getConstructors() \n    \n// 返回所有构造函数对象列表，包含private等修饰的构造函数(4个对象)\nConstructor[] declaredConstructors = myClass.getDeclaredConstructors() \n    \n// 报NoSuchMethodException，因为getConstructor只能获取public修饰的构造函数，这里的第四个构造是private修饰的\nConstructor<?> constructor = myClass.getConstructor(int.class, String.class);\n\n// 返回第四个构造函数\nConstructor<?> declaredConstructor = myClass.getDeclaredConstructor(int.class, String.class);\n```\n\n**创建实例**\n\n我们可以使用`newInstance`方法创建实例，这里有一点要注意的是：`newInstance`方法需要修饰符为`public`的构造函数来调用，否则会创建实例时会报错。看下面的例子\n\n```java\nClass<?> myClass = MyClass.class;\n\nConstructor<?> intConstructor = myClass.getConstructor(int.class);\n// 正常获取，因为参数为int的构造函数的访问级别是public的\nMyClass myClass1 = (MyClass) intConstructor.newInstance(1);\n\nConstructor<?> intAndStringConstructor = myClass.getDeclaredConstructor(int.class, String.class);\n// 报IllegalAccessException, 因为参数为int, String的构造函数的访问级别是private的\nMyClass myClass2 = (MyClass) intAndStringConstructor.newInstance(1, \"hello\");\n```\n\n**Constructor对象的一些常用方法**\n\n```java\nConstructor<?> constructor = myClass.getDeclaredConstructor(int.class, String.class);\n\n// 获取构造函数的访问级别(public,private等),可以调用Modifier类的一些方法(isPublic/isPrivate)来判断访问级别\nint modifiers = constructor.getModifiers();\n\n// 获取构造函数的参数数量\nint count = constructor.getParameterCount();\n\n// 获取构造函数的参数列表\nParameter[] Parameteres = constructor.getParameters();\n```\n\n### Field类\n\n**`Field`表示类的字段对象，可以通过以下方式获取。其中类似`getDeclaredField`的方法返回不限修饰符的字段，`getField`的方法表示只返回`public`修饰的字段。`getField`会从当前类开始，一直找到最顶级的父类(Object)为止**\n\n部分源码：\n\n```java\n// 只返回public修饰的字段, 包括父类的字段\npublic Field[] getFields();\n\n// 返回本类的所有字段(不包括父类)，不限修饰符\npublic Field[] getDeclaredFields();\n\n// 通过给定的字段名称(包括父类)，获取Field对象，如果字段名称不存在或Field对象不是public修饰的，会报NoSuchFieldException\npublic Field getField(String name);\n\n// 通过给定的字段名称(不包括父类)，获取不限修饰符的字段\npublic Field getDeclaredField(String name)\n```\n\n示例：\n\n```java\npublic class FatherClass {\n\tpublic String fatherName = \"fatherName\";\n}\npublic class MyClass extends FatherClass {\n\tpublic static String TAG = \"tag\";\n\tpublic int age;\n\tprotected String name;\n\tprivate String address;\n}\n\nClass<?> myClass = MyClass.class;\n\n// 只返回public修饰的字段(TAG, age, fatherName), 包括父类的public字段。FatherClass继承至Object，但Object没有字段，所以只会返回MyClass和FatherClass的所有public字段\nField[] fields = myClass.getFields();\n\n// 返回本类的所有字段(不包括父类)，不限修饰符(TAG, age, name ,address)\nField[] declaredFields = myClass.getDeclaredFields();\n\n// 报NoSuchFieldException，因为address字段是private修饰的\nField addressField = myClass.getField(\"address\");\n\n// 通过给定的字段名称，获取Field对象，返回address字段对象\nField addressDeclaredField = myClass.getDeclaredField(\"address\");\n```\n\n**`Field`一些常用的方法**\n\n`Field`提供了`get`/`set`方法用于获取、设置字段的值。同时提供了基本数据类型的`get`/`set`方法，用于简化操作。下面是截取的`Field`类的部分代码\n\n`Get`/`Set`方法\n\n```java\n// get方法\npublic native Object get(Object obj) \n// 基本数据类的get方法\npublic native boolean getBoolean(Object obj)\npublic native byte getByte(Object obj)\npublic native char getChar(Object obj)\npublic native int getInt(Object obj)\npublic native double getDouble(Object obj)\n...\n    \n// set方法\npublic native void set(Object obj, Object value)\n// 基本数据类的set方法\npublic native void setBoolean(Object obj, boolean z)\npublic native void setInt(Object obj, int i)\npublic native void setDouble(Object obj, double d)\n...\n```\n\n需要注意的是\n\n1.对于非静态字段来说，调用`get/set`方法，`Object`参数需要传实例对象。对于静态字段来说，可以传实例对象，也可以传null，因为实例对象对静态字段来说，没有意义。\n\n2.对于非公有字段(private/protected)等，在进行访问的时候需要先调用`Field`类的`setAccessible(true)`\n\n示例\n\n```java\nClass<?> myClass = MyClass.class;\nMyClass cls = (MyClass) myClass.newInstance();\n\n// 对于静态字段\nField tagFiled = myClass.getDeclaredField(\"TAG\");\n// 下面的代码是等价的\nString tag1 = (String) tagFiled.get(null);\nString tag2 = (String) tagFiled.get(cls);\n\n// 对于public修改的字段\nField ageFiled = myClass.getDeclaredField(\"age\");\n// 对于get, 下面的代码是等价的\nint age1 = (int) ageFiled.get(cls);\nint age2 = ageFiled.getInt(cls); \n// 对于set, 下面的代码是等价的\nageFiled.setInt(cls, 3);\nageFiled.set(cls, 5);\n\n// 对于private修饰的字段\nField addressFiled = myClass.getDeclaredField(\"address\");\n// 需要先调用addressFiled.setAccessible(true)，否则会报IllegalAccessException，因为address字段是private修饰的\naddressFiled.setAccessible(true);\nString address = (String) addressFiled.get(cls);\n```\n\n其它方法\n\n```java\n// 返回字段的访问级别(public/private等)，可以通过Modifier类来进行一些操作\npublic int getModifiers()\n// 返回字段的名称\npublic String getName()\n// 返回字段的类型(int, String, double等)\npublic Class<?> getType()\n// 返回字段所在的类\npublic Class<?> getDeclaringClass()\n```\n\n### Method类\n\n**`Method`表示类的方法对象，可以通过以下方式获取。和`Constructor`/`Field`相似，提供`getDeclaredMethod`的方法返回不限修饰符的方法，`getMethod`的方法表示只返回`public`修饰的方法。`getMethod`会从当前类开始，一直找到最顶级的父类(Object)为止**\n\n部分源码：\n\n```java\n// 只返回public修饰的方法, 包括父类的方法\npublic Method[] getMethods();\n\n// 返回本类的所有方法(不包括父类)，不限修饰符\npublic Method[] getDeclaredMethods();\n\n// 通过给定的方法名称和参数类型(包括父类)，获取Method对象，如果找不到方法或Method对象不是public修饰的，会报NoSuchMethodException\npublic Method getMethod(String name, Class<?>... parameterTypes)\n    \n// 通过给定的方法名称(不包括父类)，获取不限修饰符的Method对象\npublic Method getDeclaredMethod(String name, Class<?>... parameterTypes)\n```\n\n示例：\n\n```java\npublic class MyClass {\n\tpublic int getAge() {\n\t\treturn 1;\n\t}\n\n\tprivate String getName() {\n\t\treturn \"张三\";\n\t}\n\n    public String getSomething(String something) {\n\t\treturn something;\n\t}\n    \n\tpublic static String getAddress() {\n\t\treturn \"北京\";\n\t}\n    \n    private void excuteCommand(String command) {\n\t\tif (command.equals(\"1\")) {\n\t\t\tSystem.out.println(\"执行命令1\");\n\t\t} else if (command.equals(\"2\")) {\n\t\t\tSystem.out.println(\"执行命令2\");\n\t\t} else {\n\t\t\tSystem.out.println(\"找不到命令\");\n\t\t}\n\t}\n}\nClass<?> myClass = MyClass.class;\n\n// 不仅会返回本类的public方法，还会返回Object类的public方法，因为MyClass是继承Object类的\nMethod[] methods = myClass.getMethods();\n\n// 返回本类的所有方法(getAge, getName, getAddress)，不限修饰符\nMethod[] declaredMethods = myClass.getDeclaredMethods();\n\n// 通过给定的方法名称和参数类型，获取Method对象\nMethod ageMethod = myClass.getMethod(\"getAge\", null);\nMethod notifyMethod = myClass.getMethod(\"notify\", null);\nMethod somethingMethod = myClass.getMethod(\"getSomething\", String.class);\n\n// 报NoSuchMethodException，因为getName方法是private修饰的\nMethod nameMethod = myClass.getMethod(\"getName\", null);\n```\n\n**Method类的一些常用方法**\n\n`Method`类提供`invoike`方法，来执行方法\n\n源码：\n\n```java\npublic Object invoke(Object obj, Object... args)\n```\n\n和`Field`类似，对于非`public`修饰的方法，需要先调用`setAccessible(true)`\n\n示例：\n\n```java\nClass<?> myClass = MyClass.class;\nMyClass cls = (MyClass) myClass.newInstance();\n\nMethod commandMethod = myClass.getDeclaredMethod(\"excuteCommand\", String.class);\n// 需要先调用commandMethod.setAccessible(true)，否则会报IllegalAccessException，因为excuteCommand方法是private修饰的\ncommandMethod.setAccessible(true);\ncommandMethod.invoke(cls, \"1\"); // 执行命令1\ncommandMethod.invoke(cls, \"3\"); // 找不到命令\n```\n\n其它常用方法\n\n```java\n// 返回方法的访问级别(public/private等)，可以通过Modifier类来进行一些操作\npublic int getModifiers()\n// 返回方法的名称\npublic String getName()\n// 返回方法的返回类型(void, int, String, double等)\npublic Class<?> getReturnType()\n// 返回方法所在的类\npublic Class<?> getDeclaringClass()\n// 返回参数列表的类型数组\npublic Class<?>[] getParameterTypes()\n// 返回参数列表数量\npublic int getParameterCount()\n```\n\n","source":"_posts/java/java-reflection.md","raw":"---\ntitle: Java反射\ndate: 2018-04-27 16:35:46\ntags: java\n---\n\n### 前言\n\n在Java中，我们主要通过反射(Reflection)来在运行时来获取类或对象的相关信息\n\n- 获取对象所属的类\n- 构造类的对象\n- 获取类的构造函数对象\n- 获取类的成员变量，包括`private` 修饰的变量\n- 调用类的方法，包括`private`修饰的方法\n\n<!-- More -->\n\n### 基本运用\n\n在使用反射时，我们会先获取`Class对象`，再通过`Class对象`获取对象常用的操作类：`Constructor(构造函数)`、`Field(字段)`、`Method(方法)`\n\n#### Class类\n\n**`Class`代表类对象，可以通过以下几种方式获取**\n\n```java\n// 第一种\nClass<?> cls1 = MyClass.class;\n\n// 第二种\nMyClass myClass = new MyClass();\nClass<?> cls2 = myClass.getClass();\n\n// 第三种，forName方法的参数需要填完整的包名和类名\nClass<?> cls3 = null;\ntry {\n    cls3 = Class.forName(\"reflection.MyClass\");\n} catch (ClassNotFoundException e) {\n    e.printStackTrace();\n}\n```\n\n**获取类名称**\n\n```java\nClass<?> myClass = MyClass.class;\n// 返回类的名称(包含包名): reflection.MyClass\nmyClass.getName() \n// 返回类的名称(不包含包名): MyClass\nmyClass.getSimpleName()\n```\n\n**创建实例**\n\n```java\nClass<?> cls = MyClass.class;\n// 调用newInstance()方法获取实例对象时，类必需提供一个公有的无参数的构造函数\nMyClass myClass = cls.newInstance();\n```\n\n**Class类的一些常用方法**\n\n```java\n// 获取父类\npublic native Class<? super T> getSuperclass();\n// 获取实现的所有接口\npublic Class<?>[] getInterfaces();\n```\n\n\n\n#### Constructor类\n\n**`Constructor`表示类的构造器对象，可以通过以下方式获取。其中类似`getDeclaredConstructor`的方法返回不限修饰符的构造函数，`getConstructor`的方法表示只返回`public`修饰的构造函数**\n\n部分源码:\n\n```java\n// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数 \npublic Constructor<?>[] getConstructors();\n\n// 返回所有构造函数对象列表，不限修饰符(包含private等修饰的构造函数)\npublic Constructor<?>[] getDeclaredConstructors();\n\n// 根据给定的参数类型返回构造函数，如果获取的构造函数不是public修饰的，会报NoSuchMethodException\npublic Constructor<T> getConstructor(Class<?>... parameterTypes);\n    \n// 根据给定的参数类型返回不限修饰符的构造函数\npublic Constructor<T> getDeclaredConstructor(Class<?>... parameterTypes);\n```\n\n示例：\n\n```java\npublic class MyClass {\n\tpublic MyClass() {} // 第一个\n\tpublic MyClass(int arg) {} // 第二个\n\tprotected MyClass(String arg) {} // 第三个\n\tprivate MyClass(int arg1, String arg2) {} // 第四个\n}\nClass<?> myClass = MyClass.class;\n\n// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数(2个对象)\nConstructor[] constructors = myClass.getConstructors() \n    \n// 返回所有构造函数对象列表，包含private等修饰的构造函数(4个对象)\nConstructor[] declaredConstructors = myClass.getDeclaredConstructors() \n    \n// 报NoSuchMethodException，因为getConstructor只能获取public修饰的构造函数，这里的第四个构造是private修饰的\nConstructor<?> constructor = myClass.getConstructor(int.class, String.class);\n\n// 返回第四个构造函数\nConstructor<?> declaredConstructor = myClass.getDeclaredConstructor(int.class, String.class);\n```\n\n**创建实例**\n\n我们可以使用`newInstance`方法创建实例，这里有一点要注意的是：`newInstance`方法需要修饰符为`public`的构造函数来调用，否则会创建实例时会报错。看下面的例子\n\n```java\nClass<?> myClass = MyClass.class;\n\nConstructor<?> intConstructor = myClass.getConstructor(int.class);\n// 正常获取，因为参数为int的构造函数的访问级别是public的\nMyClass myClass1 = (MyClass) intConstructor.newInstance(1);\n\nConstructor<?> intAndStringConstructor = myClass.getDeclaredConstructor(int.class, String.class);\n// 报IllegalAccessException, 因为参数为int, String的构造函数的访问级别是private的\nMyClass myClass2 = (MyClass) intAndStringConstructor.newInstance(1, \"hello\");\n```\n\n**Constructor对象的一些常用方法**\n\n```java\nConstructor<?> constructor = myClass.getDeclaredConstructor(int.class, String.class);\n\n// 获取构造函数的访问级别(public,private等),可以调用Modifier类的一些方法(isPublic/isPrivate)来判断访问级别\nint modifiers = constructor.getModifiers();\n\n// 获取构造函数的参数数量\nint count = constructor.getParameterCount();\n\n// 获取构造函数的参数列表\nParameter[] Parameteres = constructor.getParameters();\n```\n\n### Field类\n\n**`Field`表示类的字段对象，可以通过以下方式获取。其中类似`getDeclaredField`的方法返回不限修饰符的字段，`getField`的方法表示只返回`public`修饰的字段。`getField`会从当前类开始，一直找到最顶级的父类(Object)为止**\n\n部分源码：\n\n```java\n// 只返回public修饰的字段, 包括父类的字段\npublic Field[] getFields();\n\n// 返回本类的所有字段(不包括父类)，不限修饰符\npublic Field[] getDeclaredFields();\n\n// 通过给定的字段名称(包括父类)，获取Field对象，如果字段名称不存在或Field对象不是public修饰的，会报NoSuchFieldException\npublic Field getField(String name);\n\n// 通过给定的字段名称(不包括父类)，获取不限修饰符的字段\npublic Field getDeclaredField(String name)\n```\n\n示例：\n\n```java\npublic class FatherClass {\n\tpublic String fatherName = \"fatherName\";\n}\npublic class MyClass extends FatherClass {\n\tpublic static String TAG = \"tag\";\n\tpublic int age;\n\tprotected String name;\n\tprivate String address;\n}\n\nClass<?> myClass = MyClass.class;\n\n// 只返回public修饰的字段(TAG, age, fatherName), 包括父类的public字段。FatherClass继承至Object，但Object没有字段，所以只会返回MyClass和FatherClass的所有public字段\nField[] fields = myClass.getFields();\n\n// 返回本类的所有字段(不包括父类)，不限修饰符(TAG, age, name ,address)\nField[] declaredFields = myClass.getDeclaredFields();\n\n// 报NoSuchFieldException，因为address字段是private修饰的\nField addressField = myClass.getField(\"address\");\n\n// 通过给定的字段名称，获取Field对象，返回address字段对象\nField addressDeclaredField = myClass.getDeclaredField(\"address\");\n```\n\n**`Field`一些常用的方法**\n\n`Field`提供了`get`/`set`方法用于获取、设置字段的值。同时提供了基本数据类型的`get`/`set`方法，用于简化操作。下面是截取的`Field`类的部分代码\n\n`Get`/`Set`方法\n\n```java\n// get方法\npublic native Object get(Object obj) \n// 基本数据类的get方法\npublic native boolean getBoolean(Object obj)\npublic native byte getByte(Object obj)\npublic native char getChar(Object obj)\npublic native int getInt(Object obj)\npublic native double getDouble(Object obj)\n...\n    \n// set方法\npublic native void set(Object obj, Object value)\n// 基本数据类的set方法\npublic native void setBoolean(Object obj, boolean z)\npublic native void setInt(Object obj, int i)\npublic native void setDouble(Object obj, double d)\n...\n```\n\n需要注意的是\n\n1.对于非静态字段来说，调用`get/set`方法，`Object`参数需要传实例对象。对于静态字段来说，可以传实例对象，也可以传null，因为实例对象对静态字段来说，没有意义。\n\n2.对于非公有字段(private/protected)等，在进行访问的时候需要先调用`Field`类的`setAccessible(true)`\n\n示例\n\n```java\nClass<?> myClass = MyClass.class;\nMyClass cls = (MyClass) myClass.newInstance();\n\n// 对于静态字段\nField tagFiled = myClass.getDeclaredField(\"TAG\");\n// 下面的代码是等价的\nString tag1 = (String) tagFiled.get(null);\nString tag2 = (String) tagFiled.get(cls);\n\n// 对于public修改的字段\nField ageFiled = myClass.getDeclaredField(\"age\");\n// 对于get, 下面的代码是等价的\nint age1 = (int) ageFiled.get(cls);\nint age2 = ageFiled.getInt(cls); \n// 对于set, 下面的代码是等价的\nageFiled.setInt(cls, 3);\nageFiled.set(cls, 5);\n\n// 对于private修饰的字段\nField addressFiled = myClass.getDeclaredField(\"address\");\n// 需要先调用addressFiled.setAccessible(true)，否则会报IllegalAccessException，因为address字段是private修饰的\naddressFiled.setAccessible(true);\nString address = (String) addressFiled.get(cls);\n```\n\n其它方法\n\n```java\n// 返回字段的访问级别(public/private等)，可以通过Modifier类来进行一些操作\npublic int getModifiers()\n// 返回字段的名称\npublic String getName()\n// 返回字段的类型(int, String, double等)\npublic Class<?> getType()\n// 返回字段所在的类\npublic Class<?> getDeclaringClass()\n```\n\n### Method类\n\n**`Method`表示类的方法对象，可以通过以下方式获取。和`Constructor`/`Field`相似，提供`getDeclaredMethod`的方法返回不限修饰符的方法，`getMethod`的方法表示只返回`public`修饰的方法。`getMethod`会从当前类开始，一直找到最顶级的父类(Object)为止**\n\n部分源码：\n\n```java\n// 只返回public修饰的方法, 包括父类的方法\npublic Method[] getMethods();\n\n// 返回本类的所有方法(不包括父类)，不限修饰符\npublic Method[] getDeclaredMethods();\n\n// 通过给定的方法名称和参数类型(包括父类)，获取Method对象，如果找不到方法或Method对象不是public修饰的，会报NoSuchMethodException\npublic Method getMethod(String name, Class<?>... parameterTypes)\n    \n// 通过给定的方法名称(不包括父类)，获取不限修饰符的Method对象\npublic Method getDeclaredMethod(String name, Class<?>... parameterTypes)\n```\n\n示例：\n\n```java\npublic class MyClass {\n\tpublic int getAge() {\n\t\treturn 1;\n\t}\n\n\tprivate String getName() {\n\t\treturn \"张三\";\n\t}\n\n    public String getSomething(String something) {\n\t\treturn something;\n\t}\n    \n\tpublic static String getAddress() {\n\t\treturn \"北京\";\n\t}\n    \n    private void excuteCommand(String command) {\n\t\tif (command.equals(\"1\")) {\n\t\t\tSystem.out.println(\"执行命令1\");\n\t\t} else if (command.equals(\"2\")) {\n\t\t\tSystem.out.println(\"执行命令2\");\n\t\t} else {\n\t\t\tSystem.out.println(\"找不到命令\");\n\t\t}\n\t}\n}\nClass<?> myClass = MyClass.class;\n\n// 不仅会返回本类的public方法，还会返回Object类的public方法，因为MyClass是继承Object类的\nMethod[] methods = myClass.getMethods();\n\n// 返回本类的所有方法(getAge, getName, getAddress)，不限修饰符\nMethod[] declaredMethods = myClass.getDeclaredMethods();\n\n// 通过给定的方法名称和参数类型，获取Method对象\nMethod ageMethod = myClass.getMethod(\"getAge\", null);\nMethod notifyMethod = myClass.getMethod(\"notify\", null);\nMethod somethingMethod = myClass.getMethod(\"getSomething\", String.class);\n\n// 报NoSuchMethodException，因为getName方法是private修饰的\nMethod nameMethod = myClass.getMethod(\"getName\", null);\n```\n\n**Method类的一些常用方法**\n\n`Method`类提供`invoike`方法，来执行方法\n\n源码：\n\n```java\npublic Object invoke(Object obj, Object... args)\n```\n\n和`Field`类似，对于非`public`修饰的方法，需要先调用`setAccessible(true)`\n\n示例：\n\n```java\nClass<?> myClass = MyClass.class;\nMyClass cls = (MyClass) myClass.newInstance();\n\nMethod commandMethod = myClass.getDeclaredMethod(\"excuteCommand\", String.class);\n// 需要先调用commandMethod.setAccessible(true)，否则会报IllegalAccessException，因为excuteCommand方法是private修饰的\ncommandMethod.setAccessible(true);\ncommandMethod.invoke(cls, \"1\"); // 执行命令1\ncommandMethod.invoke(cls, \"3\"); // 找不到命令\n```\n\n其它常用方法\n\n```java\n// 返回方法的访问级别(public/private等)，可以通过Modifier类来进行一些操作\npublic int getModifiers()\n// 返回方法的名称\npublic String getName()\n// 返回方法的返回类型(void, int, String, double等)\npublic Class<?> getReturnType()\n// 返回方法所在的类\npublic Class<?> getDeclaringClass()\n// 返回参数列表的类型数组\npublic Class<?>[] getParameterTypes()\n// 返回参数列表数量\npublic int getParameterCount()\n```\n\n","slug":"java/java-reflection","published":1,"updated":"2018-05-20T13:04:25.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fk003aizcbofyk0sl4","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>在Java中，我们主要通过反射(Reflection)来在运行时来获取类或对象的相关信息</p>\n<ul>\n<li>获取对象所属的类</li>\n<li>构造类的对象</li>\n<li>获取类的构造函数对象</li>\n<li>获取类的成员变量，包括<code>private</code> 修饰的变量</li>\n<li>调用类的方法，包括<code>private</code>修饰的方法</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"基本运用\"><a href=\"#基本运用\" class=\"headerlink\" title=\"基本运用\"></a>基本运用</h3><p>在使用反射时，我们会先获取<code>Class对象</code>，再通过<code>Class对象</code>获取对象常用的操作类：<code>Constructor(构造函数)</code>、<code>Field(字段)</code>、<code>Method(方法)</code></p>\n<h4 id=\"Class类\"><a href=\"#Class类\" class=\"headerlink\" title=\"Class类\"></a>Class类</h4><p><strong><code>Class</code>代表类对象，可以通过以下几种方式获取</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 第一种</span></span><br><span class=\"line\">Class&lt;?&gt; cls1 = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第二种</span></span><br><span class=\"line\">MyClass myClass = <span class=\"keyword\">new</span> MyClass();</span><br><span class=\"line\">Class&lt;?&gt; cls2 = myClass.getClass();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第三种，forName方法的参数需要填完整的包名和类名</span></span><br><span class=\"line\">Class&lt;?&gt; cls3 = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    cls3 = Class.forName(<span class=\"string\">\"reflection.MyClass\"</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>获取类名称</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"><span class=\"comment\">// 返回类的名称(包含包名): reflection.MyClass</span></span><br><span class=\"line\">myClass.getName() </span><br><span class=\"line\"><span class=\"comment\">// 返回类的名称(不包含包名): MyClass</span></span><br><span class=\"line\">myClass.getSimpleName()</span><br></pre></td></tr></table></figure>\n<p><strong>创建实例</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; cls = MyClass.class;</span><br><span class=\"line\"><span class=\"comment\">// 调用newInstance()方法获取实例对象时，类必需提供一个公有的无参数的构造函数</span></span><br><span class=\"line\">MyClass myClass = cls.newInstance();</span><br></pre></td></tr></table></figure>\n<p><strong>Class类的一些常用方法</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取父类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> Class&lt;? <span class=\"keyword\">super</span> T&gt; getSuperclass();</span><br><span class=\"line\"><span class=\"comment\">// 获取实现的所有接口</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Class&lt;?&gt;[] getInterfaces();</span><br></pre></td></tr></table></figure>\n<h4 id=\"Constructor类\"><a href=\"#Constructor类\" class=\"headerlink\" title=\"Constructor类\"></a>Constructor类</h4><p><strong><code>Constructor</code>表示类的构造器对象，可以通过以下方式获取。其中类似<code>getDeclaredConstructor</code>的方法返回不限修饰符的构造函数，<code>getConstructor</code>的方法表示只返回<code>public</code>修饰的构造函数</strong></p>\n<p>部分源码:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数 </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Constructor&lt;?&gt;[] getConstructors();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回所有构造函数对象列表，不限修饰符(包含private等修饰的构造函数)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Constructor&lt;?&gt;[] getDeclaredConstructors();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 根据给定的参数类型返回构造函数，如果获取的构造函数不是public修饰的，会报NoSuchMethodException</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Constructor&lt;T&gt; <span class=\"title\">getConstructor</span><span class=\"params\">(Class&lt;?&gt;... parameterTypes)</span></span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 根据给定的参数类型返回不限修饰符的构造函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Constructor&lt;T&gt; <span class=\"title\">getDeclaredConstructor</span><span class=\"params\">(Class&lt;?&gt;... parameterTypes)</span></span>;</span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyClass</span><span class=\"params\">()</span> </span>&#123;&#125; <span class=\"comment\">// 第一个</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyClass</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;&#125; <span class=\"comment\">// 第二个</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"title\">MyClass</span><span class=\"params\">(String arg)</span> </span>&#123;&#125; <span class=\"comment\">// 第三个</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">MyClass</span><span class=\"params\">(<span class=\"keyword\">int</span> arg1, String arg2)</span> </span>&#123;&#125; <span class=\"comment\">// 第四个</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数(2个对象)</span></span><br><span class=\"line\">Constructor[] constructors = myClass.getConstructors() </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 返回所有构造函数对象列表，包含private等修饰的构造函数(4个对象)</span></span><br><span class=\"line\">Constructor[] declaredConstructors = myClass.getDeclaredConstructors() </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 报NoSuchMethodException，因为getConstructor只能获取public修饰的构造函数，这里的第四个构造是private修饰的</span></span><br><span class=\"line\">Constructor&lt;?&gt; constructor = myClass.getConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回第四个构造函数</span></span><br><span class=\"line\">Constructor&lt;?&gt; declaredConstructor = myClass.getDeclaredConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br></pre></td></tr></table></figure>\n<p><strong>创建实例</strong></p>\n<p>我们可以使用<code>newInstance</code>方法创建实例，这里有一点要注意的是：<code>newInstance</code>方法需要修饰符为<code>public</code>的构造函数来调用，否则会创建实例时会报错。看下面的例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\">Constructor&lt;?&gt; intConstructor = myClass.getConstructor(<span class=\"keyword\">int</span>.class);</span><br><span class=\"line\"><span class=\"comment\">// 正常获取，因为参数为int的构造函数的访问级别是public的</span></span><br><span class=\"line\">MyClass myClass1 = (MyClass) intConstructor.newInstance(<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Constructor&lt;?&gt; intAndStringConstructor = myClass.getDeclaredConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br><span class=\"line\"><span class=\"comment\">// 报IllegalAccessException, 因为参数为int, String的构造函数的访问级别是private的</span></span><br><span class=\"line\">MyClass myClass2 = (MyClass) intAndStringConstructor.newInstance(<span class=\"number\">1</span>, <span class=\"string\">\"hello\"</span>);</span><br></pre></td></tr></table></figure>\n<p><strong>Constructor对象的一些常用方法</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Constructor&lt;?&gt; constructor = myClass.getDeclaredConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取构造函数的访问级别(public,private等),可以调用Modifier类的一些方法(isPublic/isPrivate)来判断访问级别</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> modifiers = constructor.getModifiers();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取构造函数的参数数量</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> count = constructor.getParameterCount();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取构造函数的参数列表</span></span><br><span class=\"line\">Parameter[] Parameteres = constructor.getParameters();</span><br></pre></td></tr></table></figure>\n<h3 id=\"Field类\"><a href=\"#Field类\" class=\"headerlink\" title=\"Field类\"></a>Field类</h3><p><strong><code>Field</code>表示类的字段对象，可以通过以下方式获取。其中类似<code>getDeclaredField</code>的方法返回不限修饰符的字段，<code>getField</code>的方法表示只返回<code>public</code>修饰的字段。<code>getField</code>会从当前类开始，一直找到最顶级的父类(Object)为止</strong></p>\n<p>部分源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 只返回public修饰的字段, 包括父类的字段</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Field[] getFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有字段(不包括父类)，不限修饰符</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Field[] getDeclaredFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的字段名称(包括父类)，获取Field对象，如果字段名称不存在或Field对象不是public修饰的，会报NoSuchFieldException</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Field <span class=\"title\">getField</span><span class=\"params\">(String name)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的字段名称(不包括父类)，获取不限修饰符的字段</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Field <span class=\"title\">getDeclaredField</span><span class=\"params\">(String name)</span></span></span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FatherClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String fatherName = <span class=\"string\">\"fatherName\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> <span class=\"keyword\">extends</span> <span class=\"title\">FatherClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String TAG = <span class=\"string\">\"tag\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> String name;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String address;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 只返回public修饰的字段(TAG, age, fatherName), 包括父类的public字段。FatherClass继承至Object，但Object没有字段，所以只会返回MyClass和FatherClass的所有public字段</span></span><br><span class=\"line\">Field[] fields = myClass.getFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有字段(不包括父类)，不限修饰符(TAG, age, name ,address)</span></span><br><span class=\"line\">Field[] declaredFields = myClass.getDeclaredFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 报NoSuchFieldException，因为address字段是private修饰的</span></span><br><span class=\"line\">Field addressField = myClass.getField(<span class=\"string\">\"address\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的字段名称，获取Field对象，返回address字段对象</span></span><br><span class=\"line\">Field addressDeclaredField = myClass.getDeclaredField(<span class=\"string\">\"address\"</span>);</span><br></pre></td></tr></table></figure>\n<p><strong><code>Field</code>一些常用的方法</strong></p>\n<p><code>Field</code>提供了<code>get</code>/<code>set</code>方法用于获取、设置字段的值。同时提供了基本数据类型的<code>get</code>/<code>set</code>方法，用于简化操作。下面是截取的<code>Field</code>类的部分代码</p>\n<p><code>Get</code>/<code>Set</code>方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// get方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> Object <span class=\"title\">get</span><span class=\"params\">(Object obj)</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 基本数据类的get方法</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">getBoolean</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">byte</span> <span class=\"title\">getByte</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">char</span> <span class=\"title\">getChar</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">int</span> <span class=\"title\">getInt</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">double</span> <span class=\"title\">getDouble</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\">...</span></span><br><span class=\"line\"><span class=\"function\">    </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// set方法</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(Object obj, Object value)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 基本数据类的set方法</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">setBoolean</span><span class=\"params\">(Object obj, <span class=\"keyword\">boolean</span> z)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">setInt</span><span class=\"params\">(Object obj, <span class=\"keyword\">int</span> i)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">setDouble</span><span class=\"params\">(Object obj, <span class=\"keyword\">double</span> d)</span></span></span><br><span class=\"line\"><span class=\"function\">...</span></span><br></pre></td></tr></table></figure>\n<p>需要注意的是</p>\n<p>1.对于非静态字段来说，调用<code>get/set</code>方法，<code>Object</code>参数需要传实例对象。对于静态字段来说，可以传实例对象，也可以传null，因为实例对象对静态字段来说，没有意义。</p>\n<p>2.对于非公有字段(private/protected)等，在进行访问的时候需要先调用<code>Field</code>类的<code>setAccessible(true)</code></p>\n<p>示例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\">MyClass cls = (MyClass) myClass.newInstance();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于静态字段</span></span><br><span class=\"line\">Field tagFiled = myClass.getDeclaredField(<span class=\"string\">\"TAG\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 下面的代码是等价的</span></span><br><span class=\"line\">String tag1 = (String) tagFiled.get(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">String tag2 = (String) tagFiled.get(cls);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于public修改的字段</span></span><br><span class=\"line\">Field ageFiled = myClass.getDeclaredField(<span class=\"string\">\"age\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 对于get, 下面的代码是等价的</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> age1 = (<span class=\"keyword\">int</span>) ageFiled.get(cls);</span><br><span class=\"line\"><span class=\"keyword\">int</span> age2 = ageFiled.getInt(cls); </span><br><span class=\"line\"><span class=\"comment\">// 对于set, 下面的代码是等价的</span></span><br><span class=\"line\">ageFiled.setInt(cls, <span class=\"number\">3</span>);</span><br><span class=\"line\">ageFiled.set(cls, <span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于private修饰的字段</span></span><br><span class=\"line\">Field addressFiled = myClass.getDeclaredField(<span class=\"string\">\"address\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 需要先调用addressFiled.setAccessible(true)，否则会报IllegalAccessException，因为address字段是private修饰的</span></span><br><span class=\"line\">addressFiled.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">String address = (String) addressFiled.get(cls);</span><br></pre></td></tr></table></figure>\n<p>其它方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回字段的访问级别(public/private等)，可以通过Modifier类来进行一些操作</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getModifiers</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回字段的名称</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回字段的类型(int, String, double等)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getType</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回字段所在的类</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getDeclaringClass</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Method类\"><a href=\"#Method类\" class=\"headerlink\" title=\"Method类\"></a>Method类</h3><p><strong><code>Method</code>表示类的方法对象，可以通过以下方式获取。和<code>Constructor</code>/<code>Field</code>相似，提供<code>getDeclaredMethod</code>的方法返回不限修饰符的方法，<code>getMethod</code>的方法表示只返回<code>public</code>修饰的方法。<code>getMethod</code>会从当前类开始，一直找到最顶级的父类(Object)为止</strong></p>\n<p>部分源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 只返回public修饰的方法, 包括父类的方法</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Method[] getMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有方法(不包括父类)，不限修饰符</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Method[] getDeclaredMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的方法名称和参数类型(包括父类)，获取Method对象，如果找不到方法或Method对象不是public修饰的，会报NoSuchMethodException</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Method <span class=\"title\">getMethod</span><span class=\"params\">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 通过给定的方法名称(不包括父类)，获取不限修饰符的Method对象</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Method <span class=\"title\">getDeclaredMethod</span><span class=\"params\">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getAge</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"张三\"</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getSomething</span><span class=\"params\">(String something)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> something;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getAddress</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"北京\"</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">excuteCommand</span><span class=\"params\">(String command)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (command.equals(<span class=\"string\">\"1\"</span>)) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"执行命令1\"</span>);</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (command.equals(<span class=\"string\">\"2\"</span>)) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"执行命令2\"</span>);</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"找不到命令\"</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 不仅会返回本类的public方法，还会返回Object类的public方法，因为MyClass是继承Object类的</span></span><br><span class=\"line\">Method[] methods = myClass.getMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有方法(getAge, getName, getAddress)，不限修饰符</span></span><br><span class=\"line\">Method[] declaredMethods = myClass.getDeclaredMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的方法名称和参数类型，获取Method对象</span></span><br><span class=\"line\">Method ageMethod = myClass.getMethod(<span class=\"string\">\"getAge\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">Method notifyMethod = myClass.getMethod(<span class=\"string\">\"notify\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">Method somethingMethod = myClass.getMethod(<span class=\"string\">\"getSomething\"</span>, String.class);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 报NoSuchMethodException，因为getName方法是private修饰的</span></span><br><span class=\"line\">Method nameMethod = myClass.getMethod(<span class=\"string\">\"getName\"</span>, <span class=\"keyword\">null</span>);</span><br></pre></td></tr></table></figure>\n<p><strong>Method类的一些常用方法</strong></p>\n<p><code>Method</code>类提供<code>invoike</code>方法，来执行方法</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object obj, Object... args)</span></span></span><br></pre></td></tr></table></figure>\n<p>和<code>Field</code>类似，对于非<code>public</code>修饰的方法，需要先调用<code>setAccessible(true)</code></p>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\">MyClass cls = (MyClass) myClass.newInstance();</span><br><span class=\"line\"></span><br><span class=\"line\">Method commandMethod = myClass.getDeclaredMethod(<span class=\"string\">\"excuteCommand\"</span>, String.class);</span><br><span class=\"line\"><span class=\"comment\">// 需要先调用commandMethod.setAccessible(true)，否则会报IllegalAccessException，因为excuteCommand方法是private修饰的</span></span><br><span class=\"line\">commandMethod.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">commandMethod.invoke(cls, <span class=\"string\">\"1\"</span>); <span class=\"comment\">// 执行命令1</span></span><br><span class=\"line\">commandMethod.invoke(cls, <span class=\"string\">\"3\"</span>); <span class=\"comment\">// 找不到命令</span></span><br></pre></td></tr></table></figure>\n<p>其它常用方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回方法的访问级别(public/private等)，可以通过Modifier类来进行一些操作</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getModifiers</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回方法的名称</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回方法的返回类型(void, int, String, double等)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getReturnType</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回方法所在的类</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getDeclaringClass</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回参数列表的类型数组</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt;[] <span class=\"title\">getParameterTypes</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回参数列表数量</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getParameterCount</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>在Java中，我们主要通过反射(Reflection)来在运行时来获取类或对象的相关信息</p>\n<ul>\n<li>获取对象所属的类</li>\n<li>构造类的对象</li>\n<li>获取类的构造函数对象</li>\n<li>获取类的成员变量，包括<code>private</code> 修饰的变量</li>\n<li>调用类的方法，包括<code>private</code>修饰的方法</li>\n</ul>","more":"<h3 id=\"基本运用\"><a href=\"#基本运用\" class=\"headerlink\" title=\"基本运用\"></a>基本运用</h3><p>在使用反射时，我们会先获取<code>Class对象</code>，再通过<code>Class对象</code>获取对象常用的操作类：<code>Constructor(构造函数)</code>、<code>Field(字段)</code>、<code>Method(方法)</code></p>\n<h4 id=\"Class类\"><a href=\"#Class类\" class=\"headerlink\" title=\"Class类\"></a>Class类</h4><p><strong><code>Class</code>代表类对象，可以通过以下几种方式获取</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 第一种</span></span><br><span class=\"line\">Class&lt;?&gt; cls1 = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第二种</span></span><br><span class=\"line\">MyClass myClass = <span class=\"keyword\">new</span> MyClass();</span><br><span class=\"line\">Class&lt;?&gt; cls2 = myClass.getClass();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第三种，forName方法的参数需要填完整的包名和类名</span></span><br><span class=\"line\">Class&lt;?&gt; cls3 = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    cls3 = Class.forName(<span class=\"string\">\"reflection.MyClass\"</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>获取类名称</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"><span class=\"comment\">// 返回类的名称(包含包名): reflection.MyClass</span></span><br><span class=\"line\">myClass.getName() </span><br><span class=\"line\"><span class=\"comment\">// 返回类的名称(不包含包名): MyClass</span></span><br><span class=\"line\">myClass.getSimpleName()</span><br></pre></td></tr></table></figure>\n<p><strong>创建实例</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; cls = MyClass.class;</span><br><span class=\"line\"><span class=\"comment\">// 调用newInstance()方法获取实例对象时，类必需提供一个公有的无参数的构造函数</span></span><br><span class=\"line\">MyClass myClass = cls.newInstance();</span><br></pre></td></tr></table></figure>\n<p><strong>Class类的一些常用方法</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取父类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> Class&lt;? <span class=\"keyword\">super</span> T&gt; getSuperclass();</span><br><span class=\"line\"><span class=\"comment\">// 获取实现的所有接口</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Class&lt;?&gt;[] getInterfaces();</span><br></pre></td></tr></table></figure>\n<h4 id=\"Constructor类\"><a href=\"#Constructor类\" class=\"headerlink\" title=\"Constructor类\"></a>Constructor类</h4><p><strong><code>Constructor</code>表示类的构造器对象，可以通过以下方式获取。其中类似<code>getDeclaredConstructor</code>的方法返回不限修饰符的构造函数，<code>getConstructor</code>的方法表示只返回<code>public</code>修饰的构造函数</strong></p>\n<p>部分源码:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数 </span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Constructor&lt;?&gt;[] getConstructors();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回所有构造函数对象列表，不限修饰符(包含private等修饰的构造函数)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Constructor&lt;?&gt;[] getDeclaredConstructors();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 根据给定的参数类型返回构造函数，如果获取的构造函数不是public修饰的，会报NoSuchMethodException</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Constructor&lt;T&gt; <span class=\"title\">getConstructor</span><span class=\"params\">(Class&lt;?&gt;... parameterTypes)</span></span>;</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 根据给定的参数类型返回不限修饰符的构造函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Constructor&lt;T&gt; <span class=\"title\">getDeclaredConstructor</span><span class=\"params\">(Class&lt;?&gt;... parameterTypes)</span></span>;</span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyClass</span><span class=\"params\">()</span> </span>&#123;&#125; <span class=\"comment\">// 第一个</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">MyClass</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;&#125; <span class=\"comment\">// 第二个</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"title\">MyClass</span><span class=\"params\">(String arg)</span> </span>&#123;&#125; <span class=\"comment\">// 第三个</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">MyClass</span><span class=\"params\">(<span class=\"keyword\">int</span> arg1, String arg2)</span> </span>&#123;&#125; <span class=\"comment\">// 第四个</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回公有(public修饰)构造函数对象列表，不包含除public修饰的构造函数(2个对象)</span></span><br><span class=\"line\">Constructor[] constructors = myClass.getConstructors() </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 返回所有构造函数对象列表，包含private等修饰的构造函数(4个对象)</span></span><br><span class=\"line\">Constructor[] declaredConstructors = myClass.getDeclaredConstructors() </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 报NoSuchMethodException，因为getConstructor只能获取public修饰的构造函数，这里的第四个构造是private修饰的</span></span><br><span class=\"line\">Constructor&lt;?&gt; constructor = myClass.getConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回第四个构造函数</span></span><br><span class=\"line\">Constructor&lt;?&gt; declaredConstructor = myClass.getDeclaredConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br></pre></td></tr></table></figure>\n<p><strong>创建实例</strong></p>\n<p>我们可以使用<code>newInstance</code>方法创建实例，这里有一点要注意的是：<code>newInstance</code>方法需要修饰符为<code>public</code>的构造函数来调用，否则会创建实例时会报错。看下面的例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\">Constructor&lt;?&gt; intConstructor = myClass.getConstructor(<span class=\"keyword\">int</span>.class);</span><br><span class=\"line\"><span class=\"comment\">// 正常获取，因为参数为int的构造函数的访问级别是public的</span></span><br><span class=\"line\">MyClass myClass1 = (MyClass) intConstructor.newInstance(<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Constructor&lt;?&gt; intAndStringConstructor = myClass.getDeclaredConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br><span class=\"line\"><span class=\"comment\">// 报IllegalAccessException, 因为参数为int, String的构造函数的访问级别是private的</span></span><br><span class=\"line\">MyClass myClass2 = (MyClass) intAndStringConstructor.newInstance(<span class=\"number\">1</span>, <span class=\"string\">\"hello\"</span>);</span><br></pre></td></tr></table></figure>\n<p><strong>Constructor对象的一些常用方法</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Constructor&lt;?&gt; constructor = myClass.getDeclaredConstructor(<span class=\"keyword\">int</span>.class, String.class);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取构造函数的访问级别(public,private等),可以调用Modifier类的一些方法(isPublic/isPrivate)来判断访问级别</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> modifiers = constructor.getModifiers();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取构造函数的参数数量</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> count = constructor.getParameterCount();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取构造函数的参数列表</span></span><br><span class=\"line\">Parameter[] Parameteres = constructor.getParameters();</span><br></pre></td></tr></table></figure>\n<h3 id=\"Field类\"><a href=\"#Field类\" class=\"headerlink\" title=\"Field类\"></a>Field类</h3><p><strong><code>Field</code>表示类的字段对象，可以通过以下方式获取。其中类似<code>getDeclaredField</code>的方法返回不限修饰符的字段，<code>getField</code>的方法表示只返回<code>public</code>修饰的字段。<code>getField</code>会从当前类开始，一直找到最顶级的父类(Object)为止</strong></p>\n<p>部分源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 只返回public修饰的字段, 包括父类的字段</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Field[] getFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有字段(不包括父类)，不限修饰符</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Field[] getDeclaredFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的字段名称(包括父类)，获取Field对象，如果字段名称不存在或Field对象不是public修饰的，会报NoSuchFieldException</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Field <span class=\"title\">getField</span><span class=\"params\">(String name)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的字段名称(不包括父类)，获取不限修饰符的字段</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Field <span class=\"title\">getDeclaredField</span><span class=\"params\">(String name)</span></span></span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FatherClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String fatherName = <span class=\"string\">\"fatherName\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> <span class=\"keyword\">extends</span> <span class=\"title\">FatherClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String TAG = <span class=\"string\">\"tag\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> String name;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String address;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 只返回public修饰的字段(TAG, age, fatherName), 包括父类的public字段。FatherClass继承至Object，但Object没有字段，所以只会返回MyClass和FatherClass的所有public字段</span></span><br><span class=\"line\">Field[] fields = myClass.getFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有字段(不包括父类)，不限修饰符(TAG, age, name ,address)</span></span><br><span class=\"line\">Field[] declaredFields = myClass.getDeclaredFields();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 报NoSuchFieldException，因为address字段是private修饰的</span></span><br><span class=\"line\">Field addressField = myClass.getField(<span class=\"string\">\"address\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的字段名称，获取Field对象，返回address字段对象</span></span><br><span class=\"line\">Field addressDeclaredField = myClass.getDeclaredField(<span class=\"string\">\"address\"</span>);</span><br></pre></td></tr></table></figure>\n<p><strong><code>Field</code>一些常用的方法</strong></p>\n<p><code>Field</code>提供了<code>get</code>/<code>set</code>方法用于获取、设置字段的值。同时提供了基本数据类型的<code>get</code>/<code>set</code>方法，用于简化操作。下面是截取的<code>Field</code>类的部分代码</p>\n<p><code>Get</code>/<code>Set</code>方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// get方法</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> Object <span class=\"title\">get</span><span class=\"params\">(Object obj)</span> </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 基本数据类的get方法</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">getBoolean</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">byte</span> <span class=\"title\">getByte</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">char</span> <span class=\"title\">getChar</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">int</span> <span class=\"title\">getInt</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">double</span> <span class=\"title\">getDouble</span><span class=\"params\">(Object obj)</span></span></span><br><span class=\"line\"><span class=\"function\">...</span></span><br><span class=\"line\"><span class=\"function\">    </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// set方法</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(Object obj, Object value)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 基本数据类的set方法</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">setBoolean</span><span class=\"params\">(Object obj, <span class=\"keyword\">boolean</span> z)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">setInt</span><span class=\"params\">(Object obj, <span class=\"keyword\">int</span> i)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">setDouble</span><span class=\"params\">(Object obj, <span class=\"keyword\">double</span> d)</span></span></span><br><span class=\"line\"><span class=\"function\">...</span></span><br></pre></td></tr></table></figure>\n<p>需要注意的是</p>\n<p>1.对于非静态字段来说，调用<code>get/set</code>方法，<code>Object</code>参数需要传实例对象。对于静态字段来说，可以传实例对象，也可以传null，因为实例对象对静态字段来说，没有意义。</p>\n<p>2.对于非公有字段(private/protected)等，在进行访问的时候需要先调用<code>Field</code>类的<code>setAccessible(true)</code></p>\n<p>示例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\">MyClass cls = (MyClass) myClass.newInstance();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于静态字段</span></span><br><span class=\"line\">Field tagFiled = myClass.getDeclaredField(<span class=\"string\">\"TAG\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 下面的代码是等价的</span></span><br><span class=\"line\">String tag1 = (String) tagFiled.get(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">String tag2 = (String) tagFiled.get(cls);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于public修改的字段</span></span><br><span class=\"line\">Field ageFiled = myClass.getDeclaredField(<span class=\"string\">\"age\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 对于get, 下面的代码是等价的</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> age1 = (<span class=\"keyword\">int</span>) ageFiled.get(cls);</span><br><span class=\"line\"><span class=\"keyword\">int</span> age2 = ageFiled.getInt(cls); </span><br><span class=\"line\"><span class=\"comment\">// 对于set, 下面的代码是等价的</span></span><br><span class=\"line\">ageFiled.setInt(cls, <span class=\"number\">3</span>);</span><br><span class=\"line\">ageFiled.set(cls, <span class=\"number\">5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 对于private修饰的字段</span></span><br><span class=\"line\">Field addressFiled = myClass.getDeclaredField(<span class=\"string\">\"address\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// 需要先调用addressFiled.setAccessible(true)，否则会报IllegalAccessException，因为address字段是private修饰的</span></span><br><span class=\"line\">addressFiled.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">String address = (String) addressFiled.get(cls);</span><br></pre></td></tr></table></figure>\n<p>其它方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回字段的访问级别(public/private等)，可以通过Modifier类来进行一些操作</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getModifiers</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回字段的名称</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回字段的类型(int, String, double等)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getType</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回字段所在的类</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getDeclaringClass</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Method类\"><a href=\"#Method类\" class=\"headerlink\" title=\"Method类\"></a>Method类</h3><p><strong><code>Method</code>表示类的方法对象，可以通过以下方式获取。和<code>Constructor</code>/<code>Field</code>相似，提供<code>getDeclaredMethod</code>的方法返回不限修饰符的方法，<code>getMethod</code>的方法表示只返回<code>public</code>修饰的方法。<code>getMethod</code>会从当前类开始，一直找到最顶级的父类(Object)为止</strong></p>\n<p>部分源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 只返回public修饰的方法, 包括父类的方法</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Method[] getMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有方法(不包括父类)，不限修饰符</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Method[] getDeclaredMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的方法名称和参数类型(包括父类)，获取Method对象，如果找不到方法或Method对象不是public修饰的，会报NoSuchMethodException</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Method <span class=\"title\">getMethod</span><span class=\"params\">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 通过给定的方法名称(不包括父类)，获取不限修饰符的Method对象</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Method <span class=\"title\">getDeclaredMethod</span><span class=\"params\">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br></pre></td></tr></table></figure>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyClass</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getAge</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"张三\"</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getSomething</span><span class=\"params\">(String something)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> something;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">getAddress</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"北京\"</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">excuteCommand</span><span class=\"params\">(String command)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (command.equals(<span class=\"string\">\"1\"</span>)) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"执行命令1\"</span>);</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (command.equals(<span class=\"string\">\"2\"</span>)) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"执行命令2\"</span>);</span><br><span class=\"line\">\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">\"找不到命令\"</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 不仅会返回本类的public方法，还会返回Object类的public方法，因为MyClass是继承Object类的</span></span><br><span class=\"line\">Method[] methods = myClass.getMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回本类的所有方法(getAge, getName, getAddress)，不限修饰符</span></span><br><span class=\"line\">Method[] declaredMethods = myClass.getDeclaredMethods();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过给定的方法名称和参数类型，获取Method对象</span></span><br><span class=\"line\">Method ageMethod = myClass.getMethod(<span class=\"string\">\"getAge\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">Method notifyMethod = myClass.getMethod(<span class=\"string\">\"notify\"</span>, <span class=\"keyword\">null</span>);</span><br><span class=\"line\">Method somethingMethod = myClass.getMethod(<span class=\"string\">\"getSomething\"</span>, String.class);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 报NoSuchMethodException，因为getName方法是private修饰的</span></span><br><span class=\"line\">Method nameMethod = myClass.getMethod(<span class=\"string\">\"getName\"</span>, <span class=\"keyword\">null</span>);</span><br></pre></td></tr></table></figure>\n<p><strong>Method类的一些常用方法</strong></p>\n<p><code>Method</code>类提供<code>invoike</code>方法，来执行方法</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object obj, Object... args)</span></span></span><br></pre></td></tr></table></figure>\n<p>和<code>Field</code>类似，对于非<code>public</code>修饰的方法，需要先调用<code>setAccessible(true)</code></p>\n<p>示例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Class&lt;?&gt; myClass = MyClass.class;</span><br><span class=\"line\">MyClass cls = (MyClass) myClass.newInstance();</span><br><span class=\"line\"></span><br><span class=\"line\">Method commandMethod = myClass.getDeclaredMethod(<span class=\"string\">\"excuteCommand\"</span>, String.class);</span><br><span class=\"line\"><span class=\"comment\">// 需要先调用commandMethod.setAccessible(true)，否则会报IllegalAccessException，因为excuteCommand方法是private修饰的</span></span><br><span class=\"line\">commandMethod.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">commandMethod.invoke(cls, <span class=\"string\">\"1\"</span>); <span class=\"comment\">// 执行命令1</span></span><br><span class=\"line\">commandMethod.invoke(cls, <span class=\"string\">\"3\"</span>); <span class=\"comment\">// 找不到命令</span></span><br></pre></td></tr></table></figure>\n<p>其它常用方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 返回方法的访问级别(public/private等)，可以通过Modifier类来进行一些操作</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getModifiers</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回方法的名称</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回方法的返回类型(void, int, String, double等)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getReturnType</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回方法所在的类</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt; <span class=\"title\">getDeclaringClass</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回参数列表的类型数组</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Class&lt;?&gt;[] <span class=\"title\">getParameterTypes</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"comment\">// 返回参数列表数量</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getParameterCount</span><span class=\"params\">()</span></span></span><br></pre></td></tr></table></figure>"},{"title":"Lambda 表达式","date":"2016-05-19T06:18:52.000Z","_content":"\n# 概述\n\nJava 8 的最大变化是引入了Lambda表达式 —— 一种紧凑的、传递行为的方式，接下来就了解一下什么是Lambda表达式。\n\n> 为什么要叫这个名字呢？这多年前，在计算机出现之前，有位名叫`Alonzo Church`的逻辑学家，他想要证明什么样的数学函数是可以有效计算的(奇怪的是，当时已经存在了许多已知的函数，但是没有人知道怎么去计算它们的值)。他使用希腊字母的`lambda(𝛌)`来标记参数 。为什么使用`𝛌`?难道Church没有其它拉丁字母可用了吗？事实上经典的《数学原理》中使用\"^\"符号表示自由变量，这启发Church使用大写的`lambda \"Λ\"`来表示参数。但是最终，他选择换回到小写版本。于是从那时起，还有参数变量的表达式都被称为lambda表达式。\n\n<!-- More -->\n\n### 第一个Lambda表达式\n\n> Lambda表达式适用于只包含一个方法的接口的情况，表如：Runnable接口，只包含一个run方法。\n\n正常情况:\n\n```java\nnew Thread(new Runnable() {\n    @Override\n    public void run() {\n      System.out.println(\"Hello\");\n    }\n}).start();\n```\n\n使用Lambda:\n\n```java\nnew Thread(() -> System.out.println(\"Hello\")).start();\nnew Thread(() -> {System.out.println(\"Hello\");}).start();\n```\n\n> 你已经见到了 **Java** 中的  **lambda** 表达式的格式：参数、箭头 ->，以及一个表达式\n\n### Lambda表达式的不同形式\n\n```java\n1.Runnable noArguments = () -> System.out.println(\"Hello World\");\n2.ActionListener oneArguments = event -> System.out.println(\"Button Clicked\");\n3.Runnable multiStatement = () -> {\n  \t  System.out.println(\"Hello\");\n  \t  System.out.println(\"World\");\n  };\n4.BinaryOperator<Long> add = (x, y) -> x + y;\n5.BinaryOperator<Long> addExplicit = (Long x, Long y) -> x + y;\n6.变种 System.out::println\n```\n\n1. Lambda表达式不包含参数，使用空括号表示没有参数\n\n2. Lambda表达式包含且只包含一个参数，可省略参数的括号，如上面示例中的第2种情况\n\n3. Lambda表达式不仅可以是一个表达式，而且也可以是一段代码块，使用大括号({})将代码块括起来，如上面示例中的第3种情况。\n\n   注：只有一行代码的Lambda表达式也可使用大括号，但需要在表达式后面加上一个分号。\n\n4. Lambda表达式也可以包含多个参数的方法，如示例中的第4种情况。这时就有必要思考怎么样去阅读该Lambda表达式。这行代码并不是将两个数字相加，而是创建一个函数 ，用来计算两个数字相加的结果。变量add的类型是BinaryOperator<Long>，它不是两个数字的和，而是将两个数字相加的那行代码。\n\n5. 所有Lambda表达式的参数类型都是由编译器推断得出的。但有时也可以显示声明参数类型，此时就需要使用小括号将参数括起来，多个参数也是如此。如上面示例中的第5种情况\n\n6. 详情请阅读下面的 **方法引用** 章节\n\n\n> 你可以像对待方法参数一样向lambda表达式的参数添加注解或者final修饰符，如下：\n>\n> ```java\n> (final String name) -> ...\n> (@NonNull String name) -> ...\n> ```\n>\n> 注意：在lambda表达式中，只在某些分支中返回值(其它分支没有返回值)是不合法的。例如:\n>\n> ```java\n> (int x) -> { if (x > 0) return 1; }\n> ```\n\n### 引用值，而不是变量\n\n> Lambda表示式中引用的局部变量，必须是final或既成事实上的final变量\n\n什么是既成事实上的final变量呢？看看下面这种情况：\n\n```java\nString test = \"hello\";\nnew Thread(() -> System.out.println(test)).start();\n```\n\n对于变量test，虽然可以不用final修饰(编译不会报错)，但是只要你对test再赋值其它值，就会编译报错，这种情况就是既成事实的final变量\n\n### 函数接口\n\n> 函数接口是只有一个抽象方法的接口，用作lambda表达式的类型\n>\n> 你可能奇怪为什么函数接口必须只有一个抽象方法。难道接口中的方法不都是抽象的吗？事实上，接口经常会重新声明Object类中的方法，例如`toString`或者`clone`，而这些方法声明并不是抽象的。\n\n使用Java编程，总会遇到很多函数接口，但 Java 开发工具包（JDK）提供的一组核心函数接口会频繁出现。如下：\n\n| 接口                | 参数     | 返回类型    | 示例            |\n| ----------------- | ------ | ------- | ------------- |\n| Predicata<T>      | T      | boolean | 这张唱片已经发行了吗    |\n| Consumer<T>       | T      | void    | 输出一个值         |\n| Function<T>       | T      | R       | 获取Artist对象的名字 |\n| Supplier<T>       | None   | T       | 工厂方法          |\n| UnaryOperator<T>  | T      | T       | 逻辑非(!)        |\n| BinaryOperator<T> | (T, T) | T       | 求两个数的乘积(*)    |\n\n> 你可以在任意函数式接口上标注`@FunctionalInterface`注解，这样做有两个好处。首先，编译器会检查标注该注解的实体，检查它是否是只包含一个抽象方法的接口。别外，在 javadoc 页面也会包含一条声明，说明这个接口是一个函数式接口。\n>\n> 该注解并不要求强制使用。从概念上来讲，所有只包含一个抽象方法的接口都是函数式接口，但是使用`@FuncationalInterface`注解会让你的代码看上去更清楚。\n\n最后，当一个 **lambda** 表达式被转换为一个函数接口的实例时，请注意处理检查期异常。如果  **lambda** 表达式中可能会抛出一个检查期异常，那么该异常需要在目标接口的抽象方法中进行声明。例如，以下表达式会产生一个错误：\n\n```java\nRunnable sleeper = () -> { System.out.println(\"Zzz\"); Thread.sleep(1000); };\n// 错误：Thread.sleep可以抛出一个检查期的 InterruptedException.\n```\n\n由于 **Runnable.run** 不能抛出任何异常，所有这个赋值不是合法的，有两种方法可以修正该问题。一种是在 **lambda** 表达式中捕获异常，别一种是将  **lambda** 表达式赋给一个其抽象方法可以抛出异常的接口。例如，Callable 接口的 **call** 方法可以抛出任何异常，因此，你可以将该 **lambda** 表达式赋给 Callable<Void> (如果你添加一条 \"return null\" 语句)。\n\n### 方法引用 \n\n 一共有四种类型的方法引用\n\n| 类型        | 示例                                |\n| --------- | --------------------------------- |\n| 类静态方法引用   | ContainingClass::staticMethodName |\n| 某个对象的方法引用 |                                   |\n|           |                                   |\n\n\n\n> 参考文献：《Java8函数式编程》","source":"_posts/java/java8-lambda.md","raw":"---\ntitle: Lambda 表达式\ndate: 2016-05-19 14:18:52\ntags: [java,lambda]\n---\n\n# 概述\n\nJava 8 的最大变化是引入了Lambda表达式 —— 一种紧凑的、传递行为的方式，接下来就了解一下什么是Lambda表达式。\n\n> 为什么要叫这个名字呢？这多年前，在计算机出现之前，有位名叫`Alonzo Church`的逻辑学家，他想要证明什么样的数学函数是可以有效计算的(奇怪的是，当时已经存在了许多已知的函数，但是没有人知道怎么去计算它们的值)。他使用希腊字母的`lambda(𝛌)`来标记参数 。为什么使用`𝛌`?难道Church没有其它拉丁字母可用了吗？事实上经典的《数学原理》中使用\"^\"符号表示自由变量，这启发Church使用大写的`lambda \"Λ\"`来表示参数。但是最终，他选择换回到小写版本。于是从那时起，还有参数变量的表达式都被称为lambda表达式。\n\n<!-- More -->\n\n### 第一个Lambda表达式\n\n> Lambda表达式适用于只包含一个方法的接口的情况，表如：Runnable接口，只包含一个run方法。\n\n正常情况:\n\n```java\nnew Thread(new Runnable() {\n    @Override\n    public void run() {\n      System.out.println(\"Hello\");\n    }\n}).start();\n```\n\n使用Lambda:\n\n```java\nnew Thread(() -> System.out.println(\"Hello\")).start();\nnew Thread(() -> {System.out.println(\"Hello\");}).start();\n```\n\n> 你已经见到了 **Java** 中的  **lambda** 表达式的格式：参数、箭头 ->，以及一个表达式\n\n### Lambda表达式的不同形式\n\n```java\n1.Runnable noArguments = () -> System.out.println(\"Hello World\");\n2.ActionListener oneArguments = event -> System.out.println(\"Button Clicked\");\n3.Runnable multiStatement = () -> {\n  \t  System.out.println(\"Hello\");\n  \t  System.out.println(\"World\");\n  };\n4.BinaryOperator<Long> add = (x, y) -> x + y;\n5.BinaryOperator<Long> addExplicit = (Long x, Long y) -> x + y;\n6.变种 System.out::println\n```\n\n1. Lambda表达式不包含参数，使用空括号表示没有参数\n\n2. Lambda表达式包含且只包含一个参数，可省略参数的括号，如上面示例中的第2种情况\n\n3. Lambda表达式不仅可以是一个表达式，而且也可以是一段代码块，使用大括号({})将代码块括起来，如上面示例中的第3种情况。\n\n   注：只有一行代码的Lambda表达式也可使用大括号，但需要在表达式后面加上一个分号。\n\n4. Lambda表达式也可以包含多个参数的方法，如示例中的第4种情况。这时就有必要思考怎么样去阅读该Lambda表达式。这行代码并不是将两个数字相加，而是创建一个函数 ，用来计算两个数字相加的结果。变量add的类型是BinaryOperator<Long>，它不是两个数字的和，而是将两个数字相加的那行代码。\n\n5. 所有Lambda表达式的参数类型都是由编译器推断得出的。但有时也可以显示声明参数类型，此时就需要使用小括号将参数括起来，多个参数也是如此。如上面示例中的第5种情况\n\n6. 详情请阅读下面的 **方法引用** 章节\n\n\n> 你可以像对待方法参数一样向lambda表达式的参数添加注解或者final修饰符，如下：\n>\n> ```java\n> (final String name) -> ...\n> (@NonNull String name) -> ...\n> ```\n>\n> 注意：在lambda表达式中，只在某些分支中返回值(其它分支没有返回值)是不合法的。例如:\n>\n> ```java\n> (int x) -> { if (x > 0) return 1; }\n> ```\n\n### 引用值，而不是变量\n\n> Lambda表示式中引用的局部变量，必须是final或既成事实上的final变量\n\n什么是既成事实上的final变量呢？看看下面这种情况：\n\n```java\nString test = \"hello\";\nnew Thread(() -> System.out.println(test)).start();\n```\n\n对于变量test，虽然可以不用final修饰(编译不会报错)，但是只要你对test再赋值其它值，就会编译报错，这种情况就是既成事实的final变量\n\n### 函数接口\n\n> 函数接口是只有一个抽象方法的接口，用作lambda表达式的类型\n>\n> 你可能奇怪为什么函数接口必须只有一个抽象方法。难道接口中的方法不都是抽象的吗？事实上，接口经常会重新声明Object类中的方法，例如`toString`或者`clone`，而这些方法声明并不是抽象的。\n\n使用Java编程，总会遇到很多函数接口，但 Java 开发工具包（JDK）提供的一组核心函数接口会频繁出现。如下：\n\n| 接口                | 参数     | 返回类型    | 示例            |\n| ----------------- | ------ | ------- | ------------- |\n| Predicata<T>      | T      | boolean | 这张唱片已经发行了吗    |\n| Consumer<T>       | T      | void    | 输出一个值         |\n| Function<T>       | T      | R       | 获取Artist对象的名字 |\n| Supplier<T>       | None   | T       | 工厂方法          |\n| UnaryOperator<T>  | T      | T       | 逻辑非(!)        |\n| BinaryOperator<T> | (T, T) | T       | 求两个数的乘积(*)    |\n\n> 你可以在任意函数式接口上标注`@FunctionalInterface`注解，这样做有两个好处。首先，编译器会检查标注该注解的实体，检查它是否是只包含一个抽象方法的接口。别外，在 javadoc 页面也会包含一条声明，说明这个接口是一个函数式接口。\n>\n> 该注解并不要求强制使用。从概念上来讲，所有只包含一个抽象方法的接口都是函数式接口，但是使用`@FuncationalInterface`注解会让你的代码看上去更清楚。\n\n最后，当一个 **lambda** 表达式被转换为一个函数接口的实例时，请注意处理检查期异常。如果  **lambda** 表达式中可能会抛出一个检查期异常，那么该异常需要在目标接口的抽象方法中进行声明。例如，以下表达式会产生一个错误：\n\n```java\nRunnable sleeper = () -> { System.out.println(\"Zzz\"); Thread.sleep(1000); };\n// 错误：Thread.sleep可以抛出一个检查期的 InterruptedException.\n```\n\n由于 **Runnable.run** 不能抛出任何异常，所有这个赋值不是合法的，有两种方法可以修正该问题。一种是在 **lambda** 表达式中捕获异常，别一种是将  **lambda** 表达式赋给一个其抽象方法可以抛出异常的接口。例如，Callable 接口的 **call** 方法可以抛出任何异常，因此，你可以将该 **lambda** 表达式赋给 Callable<Void> (如果你添加一条 \"return null\" 语句)。\n\n### 方法引用 \n\n 一共有四种类型的方法引用\n\n| 类型        | 示例                                |\n| --------- | --------------------------------- |\n| 类静态方法引用   | ContainingClass::staticMethodName |\n| 某个对象的方法引用 |                                   |\n|           |                                   |\n\n\n\n> 参考文献：《Java8函数式编程》","slug":"java/java8-lambda","published":1,"updated":"2018-01-31T09:35:37.818Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fk003cizcbpol2meqc","content":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><p>Java 8 的最大变化是引入了Lambda表达式 —— 一种紧凑的、传递行为的方式，接下来就了解一下什么是Lambda表达式。</p>\n<blockquote>\n<p>为什么要叫这个名字呢？这多年前，在计算机出现之前，有位名叫<code>Alonzo Church</code>的逻辑学家，他想要证明什么样的数学函数是可以有效计算的(奇怪的是，当时已经存在了许多已知的函数，但是没有人知道怎么去计算它们的值)。他使用希腊字母的<code>lambda(𝛌)</code>来标记参数 。为什么使用<code>𝛌</code>?难道Church没有其它拉丁字母可用了吗？事实上经典的《数学原理》中使用”^”符号表示自由变量，这启发Church使用大写的<code>lambda &quot;Λ&quot;</code>来表示参数。但是最终，他选择换回到小写版本。于是从那时起，还有参数变量的表达式都被称为lambda表达式。</p>\n</blockquote>\n<a id=\"more\"></a>\n<h3 id=\"第一个Lambda表达式\"><a href=\"#第一个Lambda表达式\" class=\"headerlink\" title=\"第一个Lambda表达式\"></a>第一个Lambda表达式</h3><blockquote>\n<p>Lambda表达式适用于只包含一个方法的接口的情况，表如：Runnable接口，只包含一个run方法。</p>\n</blockquote>\n<p>正常情况:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"Hello\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;).start();</span><br></pre></td></tr></table></figure>\n<p>使用Lambda:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> Thread(() -&gt; System.out.println(<span class=\"string\">\"Hello\"</span>)).start();</span><br><span class=\"line\"><span class=\"keyword\">new</span> Thread(() -&gt; &#123;System.out.println(<span class=\"string\">\"Hello\"</span>);&#125;).start();</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>你已经见到了 <strong>Java</strong> 中的  <strong>lambda</strong> 表达式的格式：参数、箭头 -&gt;，以及一个表达式</p>\n</blockquote>\n<h3 id=\"Lambda表达式的不同形式\"><a href=\"#Lambda表达式的不同形式\" class=\"headerlink\" title=\"Lambda表达式的不同形式\"></a>Lambda表达式的不同形式</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span>.Runnable noArguments = () -&gt; System.out.println(<span class=\"string\">\"Hello World\"</span>);</span><br><span class=\"line\"><span class=\"number\">2</span>.ActionListener oneArguments = event -&gt; System.out.println(<span class=\"string\">\"Button Clicked\"</span>);</span><br><span class=\"line\"><span class=\"number\">3</span>.Runnable multiStatement = () -&gt; &#123;</span><br><span class=\"line\">  \t  System.out.println(<span class=\"string\">\"Hello\"</span>);</span><br><span class=\"line\">  \t  System.out.println(<span class=\"string\">\"World\"</span>);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"number\">4</span>.BinaryOperator&lt;Long&gt; add = (x, y) -&gt; x + y;</span><br><span class=\"line\"><span class=\"number\">5</span>.BinaryOperator&lt;Long&gt; addExplicit = (Long x, Long y) -&gt; x + y;</span><br><span class=\"line\"><span class=\"number\">6</span>.变种 System.out::println</span><br></pre></td></tr></table></figure>\n<ol>\n<li><p>Lambda表达式不包含参数，使用空括号表示没有参数</p>\n</li>\n<li><p>Lambda表达式包含且只包含一个参数，可省略参数的括号，如上面示例中的第2种情况</p>\n</li>\n<li><p>Lambda表达式不仅可以是一个表达式，而且也可以是一段代码块，使用大括号({})将代码块括起来，如上面示例中的第3种情况。</p>\n<p>注：只有一行代码的Lambda表达式也可使用大括号，但需要在表达式后面加上一个分号。</p>\n</li>\n<li><p>Lambda表达式也可以包含多个参数的方法，如示例中的第4种情况。这时就有必要思考怎么样去阅读该Lambda表达式。这行代码并不是将两个数字相加，而是创建一个函数 ，用来计算两个数字相加的结果。变量add的类型是BinaryOperator<long>，它不是两个数字的和，而是将两个数字相加的那行代码。</long></p>\n</li>\n<li><p>所有Lambda表达式的参数类型都是由编译器推断得出的。但有时也可以显示声明参数类型，此时就需要使用小括号将参数括起来，多个参数也是如此。如上面示例中的第5种情况</p>\n</li>\n<li><p>详情请阅读下面的 <strong>方法引用</strong> 章节</p>\n</li>\n</ol>\n<blockquote>\n<p>你可以像对待方法参数一样向lambda表达式的参数添加注解或者final修饰符，如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; (<span class=\"keyword\">final</span> String name) -&gt; ...</span><br><span class=\"line\">&gt; (<span class=\"meta\">@NonNull</span> String name) -&gt; ...</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>&gt;</p>\n<blockquote>\n<p>注意：在lambda表达式中，只在某些分支中返回值(其它分支没有返回值)是不合法的。例如:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; (<span class=\"keyword\">int</span> x) -&gt; &#123; <span class=\"keyword\">if</span> (x &gt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>; &#125;</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<h3 id=\"引用值，而不是变量\"><a href=\"#引用值，而不是变量\" class=\"headerlink\" title=\"引用值，而不是变量\"></a>引用值，而不是变量</h3><blockquote>\n<p>Lambda表示式中引用的局部变量，必须是final或既成事实上的final变量</p>\n</blockquote>\n<p>什么是既成事实上的final变量呢？看看下面这种情况：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String test = <span class=\"string\">\"hello\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">new</span> Thread(() -&gt; System.out.println(test)).start();</span><br></pre></td></tr></table></figure>\n<p>对于变量test，虽然可以不用final修饰(编译不会报错)，但是只要你对test再赋值其它值，就会编译报错，这种情况就是既成事实的final变量</p>\n<h3 id=\"函数接口\"><a href=\"#函数接口\" class=\"headerlink\" title=\"函数接口\"></a>函数接口</h3><blockquote>\n<p>函数接口是只有一个抽象方法的接口，用作lambda表达式的类型</p>\n<p>你可能奇怪为什么函数接口必须只有一个抽象方法。难道接口中的方法不都是抽象的吗？事实上，接口经常会重新声明Object类中的方法，例如<code>toString</code>或者<code>clone</code>，而这些方法声明并不是抽象的。</p>\n</blockquote>\n<p>使用Java编程，总会遇到很多函数接口，但 Java 开发工具包（JDK）提供的一组核心函数接口会频繁出现。如下：</p>\n<table>\n<thead>\n<tr>\n<th>接口</th>\n<th>参数</th>\n<th>返回类型</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Predicata<t></t></td>\n<td>T</td>\n<td>boolean</td>\n<td>这张唱片已经发行了吗</td>\n</tr>\n<tr>\n<td>Consumer<t></t></td>\n<td>T</td>\n<td>void</td>\n<td>输出一个值</td>\n</tr>\n<tr>\n<td>Function<t></t></td>\n<td>T</td>\n<td>R</td>\n<td>获取Artist对象的名字</td>\n</tr>\n<tr>\n<td>Supplier<t></t></td>\n<td>None</td>\n<td>T</td>\n<td>工厂方法</td>\n</tr>\n<tr>\n<td>UnaryOperator<t></t></td>\n<td>T</td>\n<td>T</td>\n<td>逻辑非(!)</td>\n</tr>\n<tr>\n<td>BinaryOperator<t></t></td>\n<td>(T, T)</td>\n<td>T</td>\n<td>求两个数的乘积(*)</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>你可以在任意函数式接口上标注<code>@FunctionalInterface</code>注解，这样做有两个好处。首先，编译器会检查标注该注解的实体，检查它是否是只包含一个抽象方法的接口。别外，在 javadoc 页面也会包含一条声明，说明这个接口是一个函数式接口。</p>\n<p>该注解并不要求强制使用。从概念上来讲，所有只包含一个抽象方法的接口都是函数式接口，但是使用<code>@FuncationalInterface</code>注解会让你的代码看上去更清楚。</p>\n</blockquote>\n<p>最后，当一个 <strong>lambda</strong> 表达式被转换为一个函数接口的实例时，请注意处理检查期异常。如果  <strong>lambda</strong> 表达式中可能会抛出一个检查期异常，那么该异常需要在目标接口的抽象方法中进行声明。例如，以下表达式会产生一个错误：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Runnable sleeper = () -&gt; &#123; System.out.println(<span class=\"string\">\"Zzz\"</span>); Thread.sleep(<span class=\"number\">1000</span>); &#125;;</span><br><span class=\"line\"><span class=\"comment\">// 错误：Thread.sleep可以抛出一个检查期的 InterruptedException.</span></span><br></pre></td></tr></table></figure>\n<p>由于 <strong>Runnable.run</strong> 不能抛出任何异常，所有这个赋值不是合法的，有两种方法可以修正该问题。一种是在 <strong>lambda</strong> 表达式中捕获异常，别一种是将  <strong>lambda</strong> 表达式赋给一个其抽象方法可以抛出异常的接口。例如，Callable 接口的 <strong>call</strong> 方法可以抛出任何异常，因此，你可以将该 <strong>lambda</strong> 表达式赋给 Callable<void> (如果你添加一条 “return null” 语句)。</void></p>\n<h3 id=\"方法引用\"><a href=\"#方法引用\" class=\"headerlink\" title=\"方法引用\"></a>方法引用</h3><p> 一共有四种类型的方法引用</p>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>类静态方法引用</td>\n<td>ContainingClass::staticMethodName</td>\n</tr>\n<tr>\n<td>某个对象的方法引用</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>参考文献：《Java8函数式编程》</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><p>Java 8 的最大变化是引入了Lambda表达式 —— 一种紧凑的、传递行为的方式，接下来就了解一下什么是Lambda表达式。</p>\n<blockquote>\n<p>为什么要叫这个名字呢？这多年前，在计算机出现之前，有位名叫<code>Alonzo Church</code>的逻辑学家，他想要证明什么样的数学函数是可以有效计算的(奇怪的是，当时已经存在了许多已知的函数，但是没有人知道怎么去计算它们的值)。他使用希腊字母的<code>lambda(𝛌)</code>来标记参数 。为什么使用<code>𝛌</code>?难道Church没有其它拉丁字母可用了吗？事实上经典的《数学原理》中使用”^”符号表示自由变量，这启发Church使用大写的<code>lambda &quot;Λ&quot;</code>来表示参数。但是最终，他选择换回到小写版本。于是从那时起，还有参数变量的表达式都被称为lambda表达式。</p>\n</blockquote>","more":"<h3 id=\"第一个Lambda表达式\"><a href=\"#第一个Lambda表达式\" class=\"headerlink\" title=\"第一个Lambda表达式\"></a>第一个Lambda表达式</h3><blockquote>\n<p>Lambda表达式适用于只包含一个方法的接口的情况，表如：Runnable接口，只包含一个run方法。</p>\n</blockquote>\n<p>正常情况:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">      System.out.println(<span class=\"string\">\"Hello\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;).start();</span><br></pre></td></tr></table></figure>\n<p>使用Lambda:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> Thread(() -&gt; System.out.println(<span class=\"string\">\"Hello\"</span>)).start();</span><br><span class=\"line\"><span class=\"keyword\">new</span> Thread(() -&gt; &#123;System.out.println(<span class=\"string\">\"Hello\"</span>);&#125;).start();</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>你已经见到了 <strong>Java</strong> 中的  <strong>lambda</strong> 表达式的格式：参数、箭头 -&gt;，以及一个表达式</p>\n</blockquote>\n<h3 id=\"Lambda表达式的不同形式\"><a href=\"#Lambda表达式的不同形式\" class=\"headerlink\" title=\"Lambda表达式的不同形式\"></a>Lambda表达式的不同形式</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span>.Runnable noArguments = () -&gt; System.out.println(<span class=\"string\">\"Hello World\"</span>);</span><br><span class=\"line\"><span class=\"number\">2</span>.ActionListener oneArguments = event -&gt; System.out.println(<span class=\"string\">\"Button Clicked\"</span>);</span><br><span class=\"line\"><span class=\"number\">3</span>.Runnable multiStatement = () -&gt; &#123;</span><br><span class=\"line\">  \t  System.out.println(<span class=\"string\">\"Hello\"</span>);</span><br><span class=\"line\">  \t  System.out.println(<span class=\"string\">\"World\"</span>);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"><span class=\"number\">4</span>.BinaryOperator&lt;Long&gt; add = (x, y) -&gt; x + y;</span><br><span class=\"line\"><span class=\"number\">5</span>.BinaryOperator&lt;Long&gt; addExplicit = (Long x, Long y) -&gt; x + y;</span><br><span class=\"line\"><span class=\"number\">6</span>.变种 System.out::println</span><br></pre></td></tr></table></figure>\n<ol>\n<li><p>Lambda表达式不包含参数，使用空括号表示没有参数</p>\n</li>\n<li><p>Lambda表达式包含且只包含一个参数，可省略参数的括号，如上面示例中的第2种情况</p>\n</li>\n<li><p>Lambda表达式不仅可以是一个表达式，而且也可以是一段代码块，使用大括号({})将代码块括起来，如上面示例中的第3种情况。</p>\n<p>注：只有一行代码的Lambda表达式也可使用大括号，但需要在表达式后面加上一个分号。</p>\n</li>\n<li><p>Lambda表达式也可以包含多个参数的方法，如示例中的第4种情况。这时就有必要思考怎么样去阅读该Lambda表达式。这行代码并不是将两个数字相加，而是创建一个函数 ，用来计算两个数字相加的结果。变量add的类型是BinaryOperator<long>，它不是两个数字的和，而是将两个数字相加的那行代码。</long></p>\n</li>\n<li><p>所有Lambda表达式的参数类型都是由编译器推断得出的。但有时也可以显示声明参数类型，此时就需要使用小括号将参数括起来，多个参数也是如此。如上面示例中的第5种情况</p>\n</li>\n<li><p>详情请阅读下面的 <strong>方法引用</strong> 章节</p>\n</li>\n</ol>\n<blockquote>\n<p>你可以像对待方法参数一样向lambda表达式的参数添加注解或者final修饰符，如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; (<span class=\"keyword\">final</span> String name) -&gt; ...</span><br><span class=\"line\">&gt; (<span class=\"meta\">@NonNull</span> String name) -&gt; ...</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>&gt;</p>\n<blockquote>\n<p>注意：在lambda表达式中，只在某些分支中返回值(其它分支没有返回值)是不合法的。例如:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; (<span class=\"keyword\">int</span> x) -&gt; &#123; <span class=\"keyword\">if</span> (x &gt; <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>; &#125;</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<h3 id=\"引用值，而不是变量\"><a href=\"#引用值，而不是变量\" class=\"headerlink\" title=\"引用值，而不是变量\"></a>引用值，而不是变量</h3><blockquote>\n<p>Lambda表示式中引用的局部变量，必须是final或既成事实上的final变量</p>\n</blockquote>\n<p>什么是既成事实上的final变量呢？看看下面这种情况：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String test = <span class=\"string\">\"hello\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">new</span> Thread(() -&gt; System.out.println(test)).start();</span><br></pre></td></tr></table></figure>\n<p>对于变量test，虽然可以不用final修饰(编译不会报错)，但是只要你对test再赋值其它值，就会编译报错，这种情况就是既成事实的final变量</p>\n<h3 id=\"函数接口\"><a href=\"#函数接口\" class=\"headerlink\" title=\"函数接口\"></a>函数接口</h3><blockquote>\n<p>函数接口是只有一个抽象方法的接口，用作lambda表达式的类型</p>\n<p>你可能奇怪为什么函数接口必须只有一个抽象方法。难道接口中的方法不都是抽象的吗？事实上，接口经常会重新声明Object类中的方法，例如<code>toString</code>或者<code>clone</code>，而这些方法声明并不是抽象的。</p>\n</blockquote>\n<p>使用Java编程，总会遇到很多函数接口，但 Java 开发工具包（JDK）提供的一组核心函数接口会频繁出现。如下：</p>\n<table>\n<thead>\n<tr>\n<th>接口</th>\n<th>参数</th>\n<th>返回类型</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Predicata<t></t></td>\n<td>T</td>\n<td>boolean</td>\n<td>这张唱片已经发行了吗</td>\n</tr>\n<tr>\n<td>Consumer<t></t></td>\n<td>T</td>\n<td>void</td>\n<td>输出一个值</td>\n</tr>\n<tr>\n<td>Function<t></t></td>\n<td>T</td>\n<td>R</td>\n<td>获取Artist对象的名字</td>\n</tr>\n<tr>\n<td>Supplier<t></t></td>\n<td>None</td>\n<td>T</td>\n<td>工厂方法</td>\n</tr>\n<tr>\n<td>UnaryOperator<t></t></td>\n<td>T</td>\n<td>T</td>\n<td>逻辑非(!)</td>\n</tr>\n<tr>\n<td>BinaryOperator<t></t></td>\n<td>(T, T)</td>\n<td>T</td>\n<td>求两个数的乘积(*)</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>你可以在任意函数式接口上标注<code>@FunctionalInterface</code>注解，这样做有两个好处。首先，编译器会检查标注该注解的实体，检查它是否是只包含一个抽象方法的接口。别外，在 javadoc 页面也会包含一条声明，说明这个接口是一个函数式接口。</p>\n<p>该注解并不要求强制使用。从概念上来讲，所有只包含一个抽象方法的接口都是函数式接口，但是使用<code>@FuncationalInterface</code>注解会让你的代码看上去更清楚。</p>\n</blockquote>\n<p>最后，当一个 <strong>lambda</strong> 表达式被转换为一个函数接口的实例时，请注意处理检查期异常。如果  <strong>lambda</strong> 表达式中可能会抛出一个检查期异常，那么该异常需要在目标接口的抽象方法中进行声明。例如，以下表达式会产生一个错误：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Runnable sleeper = () -&gt; &#123; System.out.println(<span class=\"string\">\"Zzz\"</span>); Thread.sleep(<span class=\"number\">1000</span>); &#125;;</span><br><span class=\"line\"><span class=\"comment\">// 错误：Thread.sleep可以抛出一个检查期的 InterruptedException.</span></span><br></pre></td></tr></table></figure>\n<p>由于 <strong>Runnable.run</strong> 不能抛出任何异常，所有这个赋值不是合法的，有两种方法可以修正该问题。一种是在 <strong>lambda</strong> 表达式中捕获异常，别一种是将  <strong>lambda</strong> 表达式赋给一个其抽象方法可以抛出异常的接口。例如，Callable 接口的 <strong>call</strong> 方法可以抛出任何异常，因此，你可以将该 <strong>lambda</strong> 表达式赋给 Callable<void> (如果你添加一条 “return null” 语句)。</void></p>\n<h3 id=\"方法引用\"><a href=\"#方法引用\" class=\"headerlink\" title=\"方法引用\"></a>方法引用</h3><p> 一共有四种类型的方法引用</p>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>类静态方法引用</td>\n<td>ContainingClass::staticMethodName</td>\n</tr>\n<tr>\n<td>某个对象的方法引用</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>参考文献：《Java8函数式编程》</p>\n</blockquote>"},{"title":"Stream","date":"2016-05-19T06:52:26.000Z","_content":"\n# 概述\n\n本篇会介绍Steam类中的一组方法，每个方法都对应集合上的一种操作\n\n## 迭代\n\n定义一个集合\n\n```\nList<String> numbers = Arrays.asList(\"1\", \"2\", \"3\");\n```\n\n外部迭代\n\n```java\n// 使用for循环\nfor (String number : numbers) {\n    System.out.println(number);\n}\n// 迭代器\nIterator<String> iterator = numbers.iterator();\nwhile (iterator.hasNext()){\n    String number = iterator.next();\n    System.out.println(number);\n}\n```\n\n内部迭代（Stream）\n\n```java\nnumbers.stream().forEach(action -> System.out.println(action));\n```\n\n<!-- More -->\n\n## 实现机制\n\n> Stream操作分为==惰性求值方法==和==及早求值方法==\n\n看下面一个例子\n\n```java\nnumbers.stream().filter(predicate -> predicate.equals(\"2\")); //返回值Stream<String>\nnumbers.stream().filter(predicate -> predicate.equals(\"2\")).count(); //返回值int\n```\n\n对于第1种，这行代码并未做什么实际性的工作，filter只刻画出了Stream，但没有产生新的集合。像filter这样只描述Stream，最终不产生新集合的方法叫作==惰性求值方法==；对于第2种的count这样最终会从Stream产生值的方法叫作==及早求值方法==\n\n```java\n// 由于使用了惰性求值，没有输出数字\nStream<String> stream = numbers.stream().filter(predicate -> {\n    System.out.println(predicate);\n    return predicate.equals(\"2\");\n});\n// 调用Count，输出了数字\nstream.count(); // 输出了1、2、3\n```\n\n> 判断一个操作是惰性求值还是及早求值很简单：只需看它的返回值。如果返回值是Stream，那么是惰性求值；如果返回值是另一个值或为空，那么就是及早求值。整个过程和==建造者模式==有共通之处。建造者模式使用一系列操作设置属性和配置，最后调用一个==build==方法，这时，对象才被真正的创建。\n\n## 常用的流操作\n\n### collect(toList())\n\n```java\nList<String> collected = Stream.of(\"1\", \"2\", \"3\").collect(Collectors.toList());\n```\n\n### map\n\nmap操作符用于将一个流中的值转换成一个新的流\n\n```java\n// 先调用Stream的of方法生成一个Stream流，再调用map方法把Stream流中的(a,b,c)转成大写\nList<String> collected = Stream.of(\"a\", \"b\", \"c\")\n  .map(string -> string.toUpperCase()).collect(Collectors.toList());\n\n// 等价于\nList<String> collected = new ArrayList<String>();\nfor (String string : Arrays.asList(\"a\", \"b\", \"c\")) {\n    collected.add(string.toUpperCase());\n}\n```\n\n### filter\n\n遍历数据并检查其中的元素时，可尝试使用Stream中的filter操作符\n\n```java\n// 下面代码的意思是从Stream流中取大于3的元素\nList<Integer> collected = Stream.of(1, 2, 3, 4, 5, 6)\n  .filter(predicate -> (predicate > 3)).collect(Collectors.toList());\n```\n\n### flatmap\n\nflatmap方法可用Stream替换值，然后将多个Stream连接成一个Stream\n\n```java\n// 把2个list合并成一个\nList<Integer> together = Stream.of(Arrays.asList(1, 2), Arrays.asList(3, 4))\n  .flatMap(mapper -> mapper.stream()).collect(Collectors.toList());\nSystem.out.println(together); // 输出[1,2,3,4]\n\n// 先计算2个list的个数，再把2个list的个数合并成一个list\nList<Integer> together = Stream.of(Arrays.asList(1, 2), Arrays.asList(3, 4, 5))\n  .flatMap(mapper -> Stream.of(mapper.size())).collect(Collectors.toList());\nSystem.out.println(together); // 输出[2,3]\n```\n\n### max和min\n\nStream上常用的操作之一是求最大值和最小值。Stream API中的max和min操作足以解决这一问题。\n\n定义一个Track类和集合：\n\n```java\npublic class Track {\n  \n\tpublic String name;\n\tpublic int count;\n\n\tpublic Track(String name, int count) {\n\t\tthis.name = name;\n\t\tthis.count = count;\n\t}\n\n\tpublic int getLength() {\n\t\treturn name.length();\n\t}\n}\n```\n\n```java\nList<Track> tracks = Arrays.asList(\n\t\t\t\tnew Track(\"Bakai\", 524), \n\t\t\t\tnew Track(\"Violets for Your Furs\", 378),\n\t\t\t\tnew Track(\"Time\",451));\n```\n\n求Track\n\n```java\n// 求name最小的Track\nTrack shortestTrack = tracks.stream()\n.min(Comparator.comparing(track -> track.getLength())).get();\n// 求name最大的Track\nTrack shortestTrack = tracks.stream()\n  .max(Comparator.comparing(track -> track.getLength())).get();\n```\n\n> 调用max和min，会返回一个Optional对象。Optional它代表一个可能存在也可能不存在的值。如果Stream为空，那么该值不存在，如果不为空，则该值存在。调用get方法可以取出Optional对象中的值\n\n### reduce\n\nreduce操作可以实现从一组值中生成一个值\n\n```java\n// 使用reduce求和\nint count = Stream.of(1, 2, 3, 4, 5).reduce(0, (acc, element) -> acc + element);\nSystem.out.println(count); // 返回15 1+2+3+4+5\n```\n\n> Lambda表达式的返回值是最新的acc，是上一轮acc的值和当前元素相加的结果。reduce的类型是之前Lambda文章介绍过的BinaryOperator。[点此查看Lambda](http://yzbzz.github.io/2016/05/19/java8-lambda/)\n\n### 整合操作\n\n下面的例子演示了找出一年级的所有同学\n\n```java\npublic class Classes {\n\n\tpublic String name;\n\tpublic List<Student> students = new ArrayList<Classes.Student>();\n\n\tpublic static class Student {\n\t\tpublic String name;\n\n\t\tpublic Student(String name) {\n\t\t\tthis.name = name;\n\t\t}\n\t\t\n\t\t@Override\n\t\tpublic String toString() {\n\t\t\treturn \"name: \" + name;\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\n\t\tClasses classesOne = new Classes();\n\t\tclassesOne.name = \"一年级\";\n\t\tclassesOne.students.addAll(\n\t\t\t\tArrays.asList(new Student(\"张三\"), new Student(\"李四\")));\n\n\t\tClasses classesTwo = new Classes();\n\t\tclassesTwo.name = \"二年级\";\n\t\tclassesTwo.students.addAll(\n\t\t\t\tArrays.asList(new Student(\"王五\"), new Student(\"赵六\")));\n\n\t\tList<Classes> classes = new ArrayList<Classes>();\n\t\tclasses.add(classesOne);\n\t\tclasses.add(classesTwo);\n\t\t\n\t\tList<Student> students = classes.stream().\n\t\t\t\tfilter(predicate -> predicate.name.equalsIgnoreCase(\"一年级\")).\n\t\t\t\tflatMap(mapper -> mapper.students.stream()).\n\t\t\t\tcollect(Collectors.toList());\n\t\tfor (Student student : students) {\n\t\t\tSystem.out.println(student.toString());\n\t\t}\n\t}\n}\n```\n\n计算学生名字长度\n\n```java\nIntSummaryStatistics intSummaryStatistics =classesTwo.students.stream()\n\t\t\t\t.mapToInt(mapper -> mapper.name.length())\n\t\t\t\t.summaryStatistics();\nSystem.out.println(intSummaryStatistics.getAverage()); // 2.0\nSystem.out.println(intSummaryStatistics.getCount()); // 2\nSystem.out.println(intSummaryStatistics.getMax()); // 2\nSystem.out.println(intSummaryStatistics.getMin()); // 2\nSystem.out.println(intSummaryStatistics.getSum()); // 4\n```\n\n","source":"_posts/java/java8-stream.md","raw":"---\ntitle: Stream\ndate: 2016-05-19 14:52:26\ntags: [java,stream]\n---\n\n# 概述\n\n本篇会介绍Steam类中的一组方法，每个方法都对应集合上的一种操作\n\n## 迭代\n\n定义一个集合\n\n```\nList<String> numbers = Arrays.asList(\"1\", \"2\", \"3\");\n```\n\n外部迭代\n\n```java\n// 使用for循环\nfor (String number : numbers) {\n    System.out.println(number);\n}\n// 迭代器\nIterator<String> iterator = numbers.iterator();\nwhile (iterator.hasNext()){\n    String number = iterator.next();\n    System.out.println(number);\n}\n```\n\n内部迭代（Stream）\n\n```java\nnumbers.stream().forEach(action -> System.out.println(action));\n```\n\n<!-- More -->\n\n## 实现机制\n\n> Stream操作分为==惰性求值方法==和==及早求值方法==\n\n看下面一个例子\n\n```java\nnumbers.stream().filter(predicate -> predicate.equals(\"2\")); //返回值Stream<String>\nnumbers.stream().filter(predicate -> predicate.equals(\"2\")).count(); //返回值int\n```\n\n对于第1种，这行代码并未做什么实际性的工作，filter只刻画出了Stream，但没有产生新的集合。像filter这样只描述Stream，最终不产生新集合的方法叫作==惰性求值方法==；对于第2种的count这样最终会从Stream产生值的方法叫作==及早求值方法==\n\n```java\n// 由于使用了惰性求值，没有输出数字\nStream<String> stream = numbers.stream().filter(predicate -> {\n    System.out.println(predicate);\n    return predicate.equals(\"2\");\n});\n// 调用Count，输出了数字\nstream.count(); // 输出了1、2、3\n```\n\n> 判断一个操作是惰性求值还是及早求值很简单：只需看它的返回值。如果返回值是Stream，那么是惰性求值；如果返回值是另一个值或为空，那么就是及早求值。整个过程和==建造者模式==有共通之处。建造者模式使用一系列操作设置属性和配置，最后调用一个==build==方法，这时，对象才被真正的创建。\n\n## 常用的流操作\n\n### collect(toList())\n\n```java\nList<String> collected = Stream.of(\"1\", \"2\", \"3\").collect(Collectors.toList());\n```\n\n### map\n\nmap操作符用于将一个流中的值转换成一个新的流\n\n```java\n// 先调用Stream的of方法生成一个Stream流，再调用map方法把Stream流中的(a,b,c)转成大写\nList<String> collected = Stream.of(\"a\", \"b\", \"c\")\n  .map(string -> string.toUpperCase()).collect(Collectors.toList());\n\n// 等价于\nList<String> collected = new ArrayList<String>();\nfor (String string : Arrays.asList(\"a\", \"b\", \"c\")) {\n    collected.add(string.toUpperCase());\n}\n```\n\n### filter\n\n遍历数据并检查其中的元素时，可尝试使用Stream中的filter操作符\n\n```java\n// 下面代码的意思是从Stream流中取大于3的元素\nList<Integer> collected = Stream.of(1, 2, 3, 4, 5, 6)\n  .filter(predicate -> (predicate > 3)).collect(Collectors.toList());\n```\n\n### flatmap\n\nflatmap方法可用Stream替换值，然后将多个Stream连接成一个Stream\n\n```java\n// 把2个list合并成一个\nList<Integer> together = Stream.of(Arrays.asList(1, 2), Arrays.asList(3, 4))\n  .flatMap(mapper -> mapper.stream()).collect(Collectors.toList());\nSystem.out.println(together); // 输出[1,2,3,4]\n\n// 先计算2个list的个数，再把2个list的个数合并成一个list\nList<Integer> together = Stream.of(Arrays.asList(1, 2), Arrays.asList(3, 4, 5))\n  .flatMap(mapper -> Stream.of(mapper.size())).collect(Collectors.toList());\nSystem.out.println(together); // 输出[2,3]\n```\n\n### max和min\n\nStream上常用的操作之一是求最大值和最小值。Stream API中的max和min操作足以解决这一问题。\n\n定义一个Track类和集合：\n\n```java\npublic class Track {\n  \n\tpublic String name;\n\tpublic int count;\n\n\tpublic Track(String name, int count) {\n\t\tthis.name = name;\n\t\tthis.count = count;\n\t}\n\n\tpublic int getLength() {\n\t\treturn name.length();\n\t}\n}\n```\n\n```java\nList<Track> tracks = Arrays.asList(\n\t\t\t\tnew Track(\"Bakai\", 524), \n\t\t\t\tnew Track(\"Violets for Your Furs\", 378),\n\t\t\t\tnew Track(\"Time\",451));\n```\n\n求Track\n\n```java\n// 求name最小的Track\nTrack shortestTrack = tracks.stream()\n.min(Comparator.comparing(track -> track.getLength())).get();\n// 求name最大的Track\nTrack shortestTrack = tracks.stream()\n  .max(Comparator.comparing(track -> track.getLength())).get();\n```\n\n> 调用max和min，会返回一个Optional对象。Optional它代表一个可能存在也可能不存在的值。如果Stream为空，那么该值不存在，如果不为空，则该值存在。调用get方法可以取出Optional对象中的值\n\n### reduce\n\nreduce操作可以实现从一组值中生成一个值\n\n```java\n// 使用reduce求和\nint count = Stream.of(1, 2, 3, 4, 5).reduce(0, (acc, element) -> acc + element);\nSystem.out.println(count); // 返回15 1+2+3+4+5\n```\n\n> Lambda表达式的返回值是最新的acc，是上一轮acc的值和当前元素相加的结果。reduce的类型是之前Lambda文章介绍过的BinaryOperator。[点此查看Lambda](http://yzbzz.github.io/2016/05/19/java8-lambda/)\n\n### 整合操作\n\n下面的例子演示了找出一年级的所有同学\n\n```java\npublic class Classes {\n\n\tpublic String name;\n\tpublic List<Student> students = new ArrayList<Classes.Student>();\n\n\tpublic static class Student {\n\t\tpublic String name;\n\n\t\tpublic Student(String name) {\n\t\t\tthis.name = name;\n\t\t}\n\t\t\n\t\t@Override\n\t\tpublic String toString() {\n\t\t\treturn \"name: \" + name;\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\n\t\tClasses classesOne = new Classes();\n\t\tclassesOne.name = \"一年级\";\n\t\tclassesOne.students.addAll(\n\t\t\t\tArrays.asList(new Student(\"张三\"), new Student(\"李四\")));\n\n\t\tClasses classesTwo = new Classes();\n\t\tclassesTwo.name = \"二年级\";\n\t\tclassesTwo.students.addAll(\n\t\t\t\tArrays.asList(new Student(\"王五\"), new Student(\"赵六\")));\n\n\t\tList<Classes> classes = new ArrayList<Classes>();\n\t\tclasses.add(classesOne);\n\t\tclasses.add(classesTwo);\n\t\t\n\t\tList<Student> students = classes.stream().\n\t\t\t\tfilter(predicate -> predicate.name.equalsIgnoreCase(\"一年级\")).\n\t\t\t\tflatMap(mapper -> mapper.students.stream()).\n\t\t\t\tcollect(Collectors.toList());\n\t\tfor (Student student : students) {\n\t\t\tSystem.out.println(student.toString());\n\t\t}\n\t}\n}\n```\n\n计算学生名字长度\n\n```java\nIntSummaryStatistics intSummaryStatistics =classesTwo.students.stream()\n\t\t\t\t.mapToInt(mapper -> mapper.name.length())\n\t\t\t\t.summaryStatistics();\nSystem.out.println(intSummaryStatistics.getAverage()); // 2.0\nSystem.out.println(intSummaryStatistics.getCount()); // 2\nSystem.out.println(intSummaryStatistics.getMax()); // 2\nSystem.out.println(intSummaryStatistics.getMin()); // 2\nSystem.out.println(intSummaryStatistics.getSum()); // 4\n```\n\n","slug":"java/java8-stream","published":1,"updated":"2018-01-31T09:35:37.818Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fl003eizcbl37f47mq","content":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><p>本篇会介绍Steam类中的一组方法，每个方法都对应集合上的一种操作</p>\n<h2 id=\"迭代\"><a href=\"#迭代\" class=\"headerlink\" title=\"迭代\"></a>迭代</h2><p>定义一个集合</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; numbers = Arrays.asList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;);</span><br></pre></td></tr></table></figure>\n<p>外部迭代</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 使用for循环</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (String number : numbers) &#123;</span><br><span class=\"line\">    System.out.println(number);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 迭代器</span></span><br><span class=\"line\">Iterator&lt;String&gt; iterator = numbers.iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span> (iterator.hasNext())&#123;</span><br><span class=\"line\">    String number = iterator.next();</span><br><span class=\"line\">    System.out.println(number);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>内部迭代（Stream）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numbers.stream().forEach(action -&gt; System.out.println(action));</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"实现机制\"><a href=\"#实现机制\" class=\"headerlink\" title=\"实现机制\"></a>实现机制</h2><blockquote>\n<p>Stream操作分为==惰性求值方法==和==及早求值方法==</p>\n</blockquote>\n<p>看下面一个例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numbers.stream().filter(predicate -&gt; predicate.equals(<span class=\"string\">\"2\"</span>)); <span class=\"comment\">//返回值Stream&lt;String&gt;</span></span><br><span class=\"line\">numbers.stream().filter(predicate -&gt; predicate.equals(<span class=\"string\">\"2\"</span>)).count(); <span class=\"comment\">//返回值int</span></span><br></pre></td></tr></table></figure>\n<p>对于第1种，这行代码并未做什么实际性的工作，filter只刻画出了Stream，但没有产生新的集合。像filter这样只描述Stream，最终不产生新集合的方法叫作==惰性求值方法==；对于第2种的count这样最终会从Stream产生值的方法叫作==及早求值方法==</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 由于使用了惰性求值，没有输出数字</span></span><br><span class=\"line\">Stream&lt;String&gt; stream = numbers.stream().filter(predicate -&gt; &#123;</span><br><span class=\"line\">    System.out.println(predicate);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> predicate.equals(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// 调用Count，输出了数字</span></span><br><span class=\"line\">stream.count(); <span class=\"comment\">// 输出了1、2、3</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>判断一个操作是惰性求值还是及早求值很简单：只需看它的返回值。如果返回值是Stream，那么是惰性求值；如果返回值是另一个值或为空，那么就是及早求值。整个过程和==建造者模式==有共通之处。建造者模式使用一系列操作设置属性和配置，最后调用一个==build==方法，这时，对象才被真正的创建。</p>\n</blockquote>\n<h2 id=\"常用的流操作\"><a href=\"#常用的流操作\" class=\"headerlink\" title=\"常用的流操作\"></a>常用的流操作</h2><h3 id=\"collect-toList\"><a href=\"#collect-toList\" class=\"headerlink\" title=\"collect(toList())\"></a>collect(toList())</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; collected = Stream.of(<span class=\"string\">\"1\"</span>, <span class=\"string\">\"2\"</span>, <span class=\"string\">\"3\"</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>\n<h3 id=\"map\"><a href=\"#map\" class=\"headerlink\" title=\"map\"></a>map</h3><p>map操作符用于将一个流中的值转换成一个新的流</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 先调用Stream的of方法生成一个Stream流，再调用map方法把Stream流中的(a,b,c)转成大写</span></span><br><span class=\"line\">List&lt;String&gt; collected = Stream.of(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>)</span><br><span class=\"line\">  .map(string -&gt; string.toUpperCase()).collect(Collectors.toList());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 等价于</span></span><br><span class=\"line\">List&lt;String&gt; collected = <span class=\"keyword\">new</span> ArrayList&lt;String&gt;();</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String string : Arrays.asList(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>)) &#123;</span><br><span class=\"line\">    collected.add(string.toUpperCase());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"filter\"><a href=\"#filter\" class=\"headerlink\" title=\"filter\"></a>filter</h3><p>遍历数据并检查其中的元素时，可尝试使用Stream中的filter操作符</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 下面代码的意思是从Stream流中取大于3的元素</span></span><br><span class=\"line\">List&lt;Integer&gt; collected = Stream.of(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">  .filter(predicate -&gt; (predicate &gt; <span class=\"number\">3</span>)).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>\n<h3 id=\"flatmap\"><a href=\"#flatmap\" class=\"headerlink\" title=\"flatmap\"></a>flatmap</h3><p>flatmap方法可用Stream替换值，然后将多个Stream连接成一个Stream</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 把2个list合并成一个</span></span><br><span class=\"line\">List&lt;Integer&gt; together = Stream.of(Arrays.asList(<span class=\"number\">1</span>, <span class=\"number\">2</span>), Arrays.asList(<span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\">  .flatMap(mapper -&gt; mapper.stream()).collect(Collectors.toList());</span><br><span class=\"line\">System.out.println(together); <span class=\"comment\">// 输出[1,2,3,4]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 先计算2个list的个数，再把2个list的个数合并成一个list</span></span><br><span class=\"line\">List&lt;Integer&gt; together = Stream.of(Arrays.asList(<span class=\"number\">1</span>, <span class=\"number\">2</span>), Arrays.asList(<span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>))</span><br><span class=\"line\">  .flatMap(mapper -&gt; Stream.of(mapper.size())).collect(Collectors.toList());</span><br><span class=\"line\">System.out.println(together); <span class=\"comment\">// 输出[2,3]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"max和min\"><a href=\"#max和min\" class=\"headerlink\" title=\"max和min\"></a>max和min</h3><p>Stream上常用的操作之一是求最大值和最小值。Stream API中的max和min操作足以解决这一问题。</p>\n<p>定义一个Track类和集合：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Track</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String name;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span> count;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Track</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> count)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.count = count;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getLength</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> name.length();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;Track&gt; tracks = Arrays.asList(</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">new</span> Track(<span class=\"string\">\"Bakai\"</span>, <span class=\"number\">524</span>), </span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">new</span> Track(<span class=\"string\">\"Violets for Your Furs\"</span>, <span class=\"number\">378</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">new</span> Track(<span class=\"string\">\"Time\"</span>,<span class=\"number\">451</span>));</span><br></pre></td></tr></table></figure>\n<p>求Track</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 求name最小的Track</span></span><br><span class=\"line\">Track shortestTrack = tracks.stream()</span><br><span class=\"line\">.min(Comparator.comparing(track -&gt; track.getLength())).get();</span><br><span class=\"line\"><span class=\"comment\">// 求name最大的Track</span></span><br><span class=\"line\">Track shortestTrack = tracks.stream()</span><br><span class=\"line\">  .max(Comparator.comparing(track -&gt; track.getLength())).get();</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>调用max和min，会返回一个Optional对象。Optional它代表一个可能存在也可能不存在的值。如果Stream为空，那么该值不存在，如果不为空，则该值存在。调用get方法可以取出Optional对象中的值</p>\n</blockquote>\n<h3 id=\"reduce\"><a href=\"#reduce\" class=\"headerlink\" title=\"reduce\"></a>reduce</h3><p>reduce操作可以实现从一组值中生成一个值</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 使用reduce求和</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> count = Stream.of(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>).reduce(<span class=\"number\">0</span>, (acc, element) -&gt; acc + element);</span><br><span class=\"line\">System.out.println(count); <span class=\"comment\">// 返回15 1+2+3+4+5</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Lambda表达式的返回值是最新的acc，是上一轮acc的值和当前元素相加的结果。reduce的类型是之前Lambda文章介绍过的BinaryOperator。<a href=\"http://yzbzz.github.io/2016/05/19/java8-lambda/\">点此查看Lambda</a></p>\n</blockquote>\n<h3 id=\"整合操作\"><a href=\"#整合操作\" class=\"headerlink\" title=\"整合操作\"></a>整合操作</h3><p>下面的例子演示了找出一年级的所有同学</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Classes</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String name;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> List&lt;Student&gt; students = <span class=\"keyword\">new</span> ArrayList&lt;Classes.Student&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">public</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Student</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"name: \"</span> + name;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tClasses classesOne = <span class=\"keyword\">new</span> Classes();</span><br><span class=\"line\">\t\tclassesOne.name = <span class=\"string\">\"一年级\"</span>;</span><br><span class=\"line\">\t\tclassesOne.students.addAll(</span><br><span class=\"line\">\t\t\t\tArrays.asList(<span class=\"keyword\">new</span> Student(<span class=\"string\">\"张三\"</span>), <span class=\"keyword\">new</span> Student(<span class=\"string\">\"李四\"</span>)));</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tClasses classesTwo = <span class=\"keyword\">new</span> Classes();</span><br><span class=\"line\">\t\tclassesTwo.name = <span class=\"string\">\"二年级\"</span>;</span><br><span class=\"line\">\t\tclassesTwo.students.addAll(</span><br><span class=\"line\">\t\t\t\tArrays.asList(<span class=\"keyword\">new</span> Student(<span class=\"string\">\"王五\"</span>), <span class=\"keyword\">new</span> Student(<span class=\"string\">\"赵六\"</span>)));</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tList&lt;Classes&gt; classes = <span class=\"keyword\">new</span> ArrayList&lt;Classes&gt;();</span><br><span class=\"line\">\t\tclasses.add(classesOne);</span><br><span class=\"line\">\t\tclasses.add(classesTwo);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tList&lt;Student&gt; students = classes.stream().</span><br><span class=\"line\">\t\t\t\tfilter(predicate -&gt; predicate.name.equalsIgnoreCase(<span class=\"string\">\"一年级\"</span>)).</span><br><span class=\"line\">\t\t\t\tflatMap(mapper -&gt; mapper.students.stream()).</span><br><span class=\"line\">\t\t\t\tcollect(Collectors.toList());</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (Student student : students) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(student.toString());</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>计算学生名字长度</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IntSummaryStatistics intSummaryStatistics =classesTwo.students.stream()</span><br><span class=\"line\">\t\t\t\t.mapToInt(mapper -&gt; mapper.name.length())</span><br><span class=\"line\">\t\t\t\t.summaryStatistics();</span><br><span class=\"line\">System.out.println(intSummaryStatistics.getAverage()); <span class=\"comment\">// 2.0</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getCount()); <span class=\"comment\">// 2</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getMax()); <span class=\"comment\">// 2</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getMin()); <span class=\"comment\">// 2</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getSum()); <span class=\"comment\">// 4</span></span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h1 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h1><p>本篇会介绍Steam类中的一组方法，每个方法都对应集合上的一种操作</p>\n<h2 id=\"迭代\"><a href=\"#迭代\" class=\"headerlink\" title=\"迭代\"></a>迭代</h2><p>定义一个集合</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; numbers = Arrays.asList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;);</span><br></pre></td></tr></table></figure>\n<p>外部迭代</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 使用for循环</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (String number : numbers) &#123;</span><br><span class=\"line\">    System.out.println(number);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 迭代器</span></span><br><span class=\"line\">Iterator&lt;String&gt; iterator = numbers.iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span> (iterator.hasNext())&#123;</span><br><span class=\"line\">    String number = iterator.next();</span><br><span class=\"line\">    System.out.println(number);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>内部迭代（Stream）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numbers.stream().forEach(action -&gt; System.out.println(action));</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"实现机制\"><a href=\"#实现机制\" class=\"headerlink\" title=\"实现机制\"></a>实现机制</h2><blockquote>\n<p>Stream操作分为==惰性求值方法==和==及早求值方法==</p>\n</blockquote>\n<p>看下面一个例子</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">numbers.stream().filter(predicate -&gt; predicate.equals(<span class=\"string\">\"2\"</span>)); <span class=\"comment\">//返回值Stream&lt;String&gt;</span></span><br><span class=\"line\">numbers.stream().filter(predicate -&gt; predicate.equals(<span class=\"string\">\"2\"</span>)).count(); <span class=\"comment\">//返回值int</span></span><br></pre></td></tr></table></figure>\n<p>对于第1种，这行代码并未做什么实际性的工作，filter只刻画出了Stream，但没有产生新的集合。像filter这样只描述Stream，最终不产生新集合的方法叫作==惰性求值方法==；对于第2种的count这样最终会从Stream产生值的方法叫作==及早求值方法==</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 由于使用了惰性求值，没有输出数字</span></span><br><span class=\"line\">Stream&lt;String&gt; stream = numbers.stream().filter(predicate -&gt; &#123;</span><br><span class=\"line\">    System.out.println(predicate);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> predicate.equals(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// 调用Count，输出了数字</span></span><br><span class=\"line\">stream.count(); <span class=\"comment\">// 输出了1、2、3</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>判断一个操作是惰性求值还是及早求值很简单：只需看它的返回值。如果返回值是Stream，那么是惰性求值；如果返回值是另一个值或为空，那么就是及早求值。整个过程和==建造者模式==有共通之处。建造者模式使用一系列操作设置属性和配置，最后调用一个==build==方法，这时，对象才被真正的创建。</p>\n</blockquote>\n<h2 id=\"常用的流操作\"><a href=\"#常用的流操作\" class=\"headerlink\" title=\"常用的流操作\"></a>常用的流操作</h2><h3 id=\"collect-toList\"><a href=\"#collect-toList\" class=\"headerlink\" title=\"collect(toList())\"></a>collect(toList())</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; collected = Stream.of(<span class=\"string\">\"1\"</span>, <span class=\"string\">\"2\"</span>, <span class=\"string\">\"3\"</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>\n<h3 id=\"map\"><a href=\"#map\" class=\"headerlink\" title=\"map\"></a>map</h3><p>map操作符用于将一个流中的值转换成一个新的流</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 先调用Stream的of方法生成一个Stream流，再调用map方法把Stream流中的(a,b,c)转成大写</span></span><br><span class=\"line\">List&lt;String&gt; collected = Stream.of(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>)</span><br><span class=\"line\">  .map(string -&gt; string.toUpperCase()).collect(Collectors.toList());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 等价于</span></span><br><span class=\"line\">List&lt;String&gt; collected = <span class=\"keyword\">new</span> ArrayList&lt;String&gt;();</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String string : Arrays.asList(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b\"</span>, <span class=\"string\">\"c\"</span>)) &#123;</span><br><span class=\"line\">    collected.add(string.toUpperCase());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"filter\"><a href=\"#filter\" class=\"headerlink\" title=\"filter\"></a>filter</h3><p>遍历数据并检查其中的元素时，可尝试使用Stream中的filter操作符</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 下面代码的意思是从Stream流中取大于3的元素</span></span><br><span class=\"line\">List&lt;Integer&gt; collected = Stream.of(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\">  .filter(predicate -&gt; (predicate &gt; <span class=\"number\">3</span>)).collect(Collectors.toList());</span><br></pre></td></tr></table></figure>\n<h3 id=\"flatmap\"><a href=\"#flatmap\" class=\"headerlink\" title=\"flatmap\"></a>flatmap</h3><p>flatmap方法可用Stream替换值，然后将多个Stream连接成一个Stream</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 把2个list合并成一个</span></span><br><span class=\"line\">List&lt;Integer&gt; together = Stream.of(Arrays.asList(<span class=\"number\">1</span>, <span class=\"number\">2</span>), Arrays.asList(<span class=\"number\">3</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\">  .flatMap(mapper -&gt; mapper.stream()).collect(Collectors.toList());</span><br><span class=\"line\">System.out.println(together); <span class=\"comment\">// 输出[1,2,3,4]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 先计算2个list的个数，再把2个list的个数合并成一个list</span></span><br><span class=\"line\">List&lt;Integer&gt; together = Stream.of(Arrays.asList(<span class=\"number\">1</span>, <span class=\"number\">2</span>), Arrays.asList(<span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>))</span><br><span class=\"line\">  .flatMap(mapper -&gt; Stream.of(mapper.size())).collect(Collectors.toList());</span><br><span class=\"line\">System.out.println(together); <span class=\"comment\">// 输出[2,3]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"max和min\"><a href=\"#max和min\" class=\"headerlink\" title=\"max和min\"></a>max和min</h3><p>Stream上常用的操作之一是求最大值和最小值。Stream API中的max和min操作足以解决这一问题。</p>\n<p>定义一个Track类和集合：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Track</span> </span>&#123;</span><br><span class=\"line\">  </span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String name;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span> count;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Track</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> count)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">\t\t<span class=\"keyword\">this</span>.count = count;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getLength</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> name.length();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">List&lt;Track&gt; tracks = Arrays.asList(</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">new</span> Track(<span class=\"string\">\"Bakai\"</span>, <span class=\"number\">524</span>), </span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">new</span> Track(<span class=\"string\">\"Violets for Your Furs\"</span>, <span class=\"number\">378</span>),</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">new</span> Track(<span class=\"string\">\"Time\"</span>,<span class=\"number\">451</span>));</span><br></pre></td></tr></table></figure>\n<p>求Track</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 求name最小的Track</span></span><br><span class=\"line\">Track shortestTrack = tracks.stream()</span><br><span class=\"line\">.min(Comparator.comparing(track -&gt; track.getLength())).get();</span><br><span class=\"line\"><span class=\"comment\">// 求name最大的Track</span></span><br><span class=\"line\">Track shortestTrack = tracks.stream()</span><br><span class=\"line\">  .max(Comparator.comparing(track -&gt; track.getLength())).get();</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>调用max和min，会返回一个Optional对象。Optional它代表一个可能存在也可能不存在的值。如果Stream为空，那么该值不存在，如果不为空，则该值存在。调用get方法可以取出Optional对象中的值</p>\n</blockquote>\n<h3 id=\"reduce\"><a href=\"#reduce\" class=\"headerlink\" title=\"reduce\"></a>reduce</h3><p>reduce操作可以实现从一组值中生成一个值</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 使用reduce求和</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> count = Stream.of(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>).reduce(<span class=\"number\">0</span>, (acc, element) -&gt; acc + element);</span><br><span class=\"line\">System.out.println(count); <span class=\"comment\">// 返回15 1+2+3+4+5</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Lambda表达式的返回值是最新的acc，是上一轮acc的值和当前元素相加的结果。reduce的类型是之前Lambda文章介绍过的BinaryOperator。<a href=\"http://yzbzz.github.io/2016/05/19/java8-lambda/\">点此查看Lambda</a></p>\n</blockquote>\n<h3 id=\"整合操作\"><a href=\"#整合操作\" class=\"headerlink\" title=\"整合操作\"></a>整合操作</h3><p>下面的例子演示了找出一年级的所有同学</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Classes</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String name;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> List&lt;Student&gt; students = <span class=\"keyword\">new</span> ArrayList&lt;Classes.Student&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">public</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Student</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"name: \"</span> + name;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tClasses classesOne = <span class=\"keyword\">new</span> Classes();</span><br><span class=\"line\">\t\tclassesOne.name = <span class=\"string\">\"一年级\"</span>;</span><br><span class=\"line\">\t\tclassesOne.students.addAll(</span><br><span class=\"line\">\t\t\t\tArrays.asList(<span class=\"keyword\">new</span> Student(<span class=\"string\">\"张三\"</span>), <span class=\"keyword\">new</span> Student(<span class=\"string\">\"李四\"</span>)));</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tClasses classesTwo = <span class=\"keyword\">new</span> Classes();</span><br><span class=\"line\">\t\tclassesTwo.name = <span class=\"string\">\"二年级\"</span>;</span><br><span class=\"line\">\t\tclassesTwo.students.addAll(</span><br><span class=\"line\">\t\t\t\tArrays.asList(<span class=\"keyword\">new</span> Student(<span class=\"string\">\"王五\"</span>), <span class=\"keyword\">new</span> Student(<span class=\"string\">\"赵六\"</span>)));</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tList&lt;Classes&gt; classes = <span class=\"keyword\">new</span> ArrayList&lt;Classes&gt;();</span><br><span class=\"line\">\t\tclasses.add(classesOne);</span><br><span class=\"line\">\t\tclasses.add(classesTwo);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tList&lt;Student&gt; students = classes.stream().</span><br><span class=\"line\">\t\t\t\tfilter(predicate -&gt; predicate.name.equalsIgnoreCase(<span class=\"string\">\"一年级\"</span>)).</span><br><span class=\"line\">\t\t\t\tflatMap(mapper -&gt; mapper.students.stream()).</span><br><span class=\"line\">\t\t\t\tcollect(Collectors.toList());</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (Student student : students) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(student.toString());</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>计算学生名字长度</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IntSummaryStatistics intSummaryStatistics =classesTwo.students.stream()</span><br><span class=\"line\">\t\t\t\t.mapToInt(mapper -&gt; mapper.name.length())</span><br><span class=\"line\">\t\t\t\t.summaryStatistics();</span><br><span class=\"line\">System.out.println(intSummaryStatistics.getAverage()); <span class=\"comment\">// 2.0</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getCount()); <span class=\"comment\">// 2</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getMax()); <span class=\"comment\">// 2</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getMin()); <span class=\"comment\">// 2</span></span><br><span class=\"line\">System.out.println(intSummaryStatistics.getSum()); <span class=\"comment\">// 4</span></span><br></pre></td></tr></table></figure>"},{"title":"多图详解咖啡种类","date":"2018-04-10T10:28:26.000Z","_content":"\n原文:[秒懂咖啡！一张图看懂拿铁、卡布奇诺、玛奇朵、摩卡的区别！](https://www.jianshu.com/p/5458fda01e6b?utm_campaign=maleskine&utm_content=note&utm_medium=pc_all_hots&utm_source=recommendation)\n\n<!--more-->\n\n![coffee_espresso](/img/life/coffee_espresso.jpg)\n\n![coffee_americano](/img/life/coffee_americano.jpg)\n\n![coffee_latte](/img/life/coffee_latte.jpg)\n\n![coffee_macchiato](/img/life/coffee_macchiato.jpg)\n\n![coffee_cappuccino](/img/life/coffee_cappuccino.jpg)\n\n![coffee_espresso_con_panna](/img/life/coffee_espresso_con_panna.jpg)\n\n![coffee_macha](/img/life/coffee_macha.jpg)\n\n![coffee_all](/img/life/coffee_all.jpg)\n\n虽然咖啡的种类很多，但无非就是浓缩咖啡与牛奶、糖、奶泡和奶油之间的排列组合，而在保证基本组合的情况下，\n\n加入不同的配料，又成了更加细分的咖啡。比如抹茶拿铁，就是在拿铁的基础上加入了抹茶粉。本文所有的咖啡种类，\n\n均已最初的意式咖啡为主，在实际制作中，不同咖啡店可能会有自己的改良。","source":"_posts/life/life-coffee.md","raw":"---\ntitle: 多图详解咖啡种类\ndate: 2018-04-10 18:28:26\ntags: life\n---\n\n原文:[秒懂咖啡！一张图看懂拿铁、卡布奇诺、玛奇朵、摩卡的区别！](https://www.jianshu.com/p/5458fda01e6b?utm_campaign=maleskine&utm_content=note&utm_medium=pc_all_hots&utm_source=recommendation)\n\n<!--more-->\n\n![coffee_espresso](/img/life/coffee_espresso.jpg)\n\n![coffee_americano](/img/life/coffee_americano.jpg)\n\n![coffee_latte](/img/life/coffee_latte.jpg)\n\n![coffee_macchiato](/img/life/coffee_macchiato.jpg)\n\n![coffee_cappuccino](/img/life/coffee_cappuccino.jpg)\n\n![coffee_espresso_con_panna](/img/life/coffee_espresso_con_panna.jpg)\n\n![coffee_macha](/img/life/coffee_macha.jpg)\n\n![coffee_all](/img/life/coffee_all.jpg)\n\n虽然咖啡的种类很多，但无非就是浓缩咖啡与牛奶、糖、奶泡和奶油之间的排列组合，而在保证基本组合的情况下，\n\n加入不同的配料，又成了更加细分的咖啡。比如抹茶拿铁，就是在拿铁的基础上加入了抹茶粉。本文所有的咖啡种类，\n\n均已最初的意式咖啡为主，在实际制作中，不同咖啡店可能会有自己的改良。","slug":"life/life-coffee","published":1,"updated":"2018-05-20T13:04:25.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fm003gizcbl7l6vx42","content":"<p>原文:<a href=\"https://www.jianshu.com/p/5458fda01e6b?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_all_hots&amp;utm_source=recommendation\" target=\"_blank\" rel=\"noopener\">秒懂咖啡！一张图看懂拿铁、卡布奇诺、玛奇朵、摩卡的区别！</a></p>\n<a id=\"more\"></a>\n<p><img src=\"/img/life/coffee_espresso.jpg\" alt=\"coffee_espresso\"></p>\n<p><img src=\"/img/life/coffee_americano.jpg\" alt=\"coffee_americano\"></p>\n<p><img src=\"/img/life/coffee_latte.jpg\" alt=\"coffee_latte\"></p>\n<p><img src=\"/img/life/coffee_macchiato.jpg\" alt=\"coffee_macchiato\"></p>\n<p><img src=\"/img/life/coffee_cappuccino.jpg\" alt=\"coffee_cappuccino\"></p>\n<p><img src=\"/img/life/coffee_espresso_con_panna.jpg\" alt=\"coffee_espresso_con_panna\"></p>\n<p><img src=\"/img/life/coffee_macha.jpg\" alt=\"coffee_macha\"></p>\n<p><img src=\"/img/life/coffee_all.jpg\" alt=\"coffee_all\"></p>\n<p>虽然咖啡的种类很多，但无非就是浓缩咖啡与牛奶、糖、奶泡和奶油之间的排列组合，而在保证基本组合的情况下，</p>\n<p>加入不同的配料，又成了更加细分的咖啡。比如抹茶拿铁，就是在拿铁的基础上加入了抹茶粉。本文所有的咖啡种类，</p>\n<p>均已最初的意式咖啡为主，在实际制作中，不同咖啡店可能会有自己的改良。</p>\n","site":{"data":{}},"excerpt":"<p>原文:<a href=\"https://www.jianshu.com/p/5458fda01e6b?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_all_hots&amp;utm_source=recommendation\" target=\"_blank\" rel=\"noopener\">秒懂咖啡！一张图看懂拿铁、卡布奇诺、玛奇朵、摩卡的区别！</a></p>","more":"<p><img src=\"/img/life/coffee_espresso.jpg\" alt=\"coffee_espresso\"></p>\n<p><img src=\"/img/life/coffee_americano.jpg\" alt=\"coffee_americano\"></p>\n<p><img src=\"/img/life/coffee_latte.jpg\" alt=\"coffee_latte\"></p>\n<p><img src=\"/img/life/coffee_macchiato.jpg\" alt=\"coffee_macchiato\"></p>\n<p><img src=\"/img/life/coffee_cappuccino.jpg\" alt=\"coffee_cappuccino\"></p>\n<p><img src=\"/img/life/coffee_espresso_con_panna.jpg\" alt=\"coffee_espresso_con_panna\"></p>\n<p><img src=\"/img/life/coffee_macha.jpg\" alt=\"coffee_macha\"></p>\n<p><img src=\"/img/life/coffee_all.jpg\" alt=\"coffee_all\"></p>\n<p>虽然咖啡的种类很多，但无非就是浓缩咖啡与牛奶、糖、奶泡和奶油之间的排列组合，而在保证基本组合的情况下，</p>\n<p>加入不同的配料，又成了更加细分的咖啡。比如抹茶拿铁，就是在拿铁的基础上加入了抹茶粉。本文所有的咖啡种类，</p>\n<p>均已最初的意式咖啡为主，在实际制作中，不同咖啡店可能会有自己的改良。</p>"},{"title":"2018，遇见更好的自己","date":"2018-02-26T06:50:56.000Z","_content":"\n### 前言\n\n时间过的好快，转眼就到了而立之年。去年一年太颓废了，今年一定要重拾心情，做更好的自己。\n先定个小目标^^\n\n### 2018愿望清单\n\n1、精读5本编程书籍，编写20篇技术文章\n\n​\t已读书本：《kotlin in action》《kotlin-for-android-developers》\n\n​\t已完成12篇技术文章\n\n2、练字，练完2本楷书字帖，2本行楷字帖\n\n3、读完`English in Use`初级、中级、高级\n\n4、每周花费2小时学习音乐，钢琴达到4级水平\n\n5、每周花费2小时学习PS/AI/AE\n\n6、学习IOS，能独立开发小APP\n\n7、跑步100天\n\n​\t已跑15天\n\n8、吃草1个月\n\n​\t已吃45天\n\n9、200天左右，每天锻炼30分钟\n\n10、去电影院看2场电影\n\n11、存款10W+\n\n12、学会Flutter","source":"_posts/life/life-flag-2018.md","raw":"---\ntitle: 2018，遇见更好的自己\ndate: 2018-02-26 14:50:56\ntags: life\n---\n\n### 前言\n\n时间过的好快，转眼就到了而立之年。去年一年太颓废了，今年一定要重拾心情，做更好的自己。\n先定个小目标^^\n\n### 2018愿望清单\n\n1、精读5本编程书籍，编写20篇技术文章\n\n​\t已读书本：《kotlin in action》《kotlin-for-android-developers》\n\n​\t已完成12篇技术文章\n\n2、练字，练完2本楷书字帖，2本行楷字帖\n\n3、读完`English in Use`初级、中级、高级\n\n4、每周花费2小时学习音乐，钢琴达到4级水平\n\n5、每周花费2小时学习PS/AI/AE\n\n6、学习IOS，能独立开发小APP\n\n7、跑步100天\n\n​\t已跑15天\n\n8、吃草1个月\n\n​\t已吃45天\n\n9、200天左右，每天锻炼30分钟\n\n10、去电影院看2场电影\n\n11、存款10W+\n\n12、学会Flutter","slug":"life/life-flag-2018","published":1,"updated":"2018-06-21T14:28:07.231Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fo003iizcb55rgctwh","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>时间过的好快，转眼就到了而立之年。去年一年太颓废了，今年一定要重拾心情，做更好的自己。<br>先定个小目标^^</p>\n<h3 id=\"2018愿望清单\"><a href=\"#2018愿望清单\" class=\"headerlink\" title=\"2018愿望清单\"></a>2018愿望清单</h3><p>1、精读5本编程书籍，编写20篇技术文章</p>\n<p>​    已读书本：《kotlin in action》《kotlin-for-android-developers》</p>\n<p>​    已完成12篇技术文章</p>\n<p>2、练字，练完2本楷书字帖，2本行楷字帖</p>\n<p>3、读完<code>English in Use</code>初级、中级、高级</p>\n<p>4、每周花费2小时学习音乐，钢琴达到4级水平</p>\n<p>5、每周花费2小时学习PS/AI/AE</p>\n<p>6、学习IOS，能独立开发小APP</p>\n<p>7、跑步100天</p>\n<p>​    已跑15天</p>\n<p>8、吃草1个月</p>\n<p>​    已吃45天</p>\n<p>9、200天左右，每天锻炼30分钟</p>\n<p>10、去电影院看2场电影</p>\n<p>11、存款10W+</p>\n<p>12、学会Flutter</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>时间过的好快，转眼就到了而立之年。去年一年太颓废了，今年一定要重拾心情，做更好的自己。<br>先定个小目标^^</p>\n<h3 id=\"2018愿望清单\"><a href=\"#2018愿望清单\" class=\"headerlink\" title=\"2018愿望清单\"></a>2018愿望清单</h3><p>1、精读5本编程书籍，编写20篇技术文章</p>\n<p>​    已读书本：《kotlin in action》《kotlin-for-android-developers》</p>\n<p>​    已完成12篇技术文章</p>\n<p>2、练字，练完2本楷书字帖，2本行楷字帖</p>\n<p>3、读完<code>English in Use</code>初级、中级、高级</p>\n<p>4、每周花费2小时学习音乐，钢琴达到4级水平</p>\n<p>5、每周花费2小时学习PS/AI/AE</p>\n<p>6、学习IOS，能独立开发小APP</p>\n<p>7、跑步100天</p>\n<p>​    已跑15天</p>\n<p>8、吃草1个月</p>\n<p>​    已吃45天</p>\n<p>9、200天左右，每天锻炼30分钟</p>\n<p>10、去电影院看2场电影</p>\n<p>11、存款10W+</p>\n<p>12、学会Flutter</p>\n"},{"title":"life","date":"2017-05-03T09:23:57.000Z","_content":"\nblog\n\n[叠衣](http://www.jianshu.com/p/95853fa8943b)\n\n\n\nArc’teryx 始祖鸟(也有写作Arcteryx或鸟家) 作为来自加拿大的顶级户外装备，Arc’teryx 始祖鸟的背包，软壳，硬壳，冲锋衣裤不断的出现在各种媒体中（像近期的电影《谍影重重》）Arc’teryx 始祖鸟对户外运动全能极致的设计理念深受驴友们的认可，Arc’teryx 始祖鸟迷都知道Arc’teryx在 款式命名上，会将其等级和用途的缩写加在款式型号上作为区分，以便选购时能能过型号分辨其功能或定位上的差异，一般常见有AR、SV、LT、SL、MX、SK、RT、M、LS、SS等型号.\n\nARCTERYX(始祖鸟)服装大体来说等级和用途与价格有很大的关系，但作为ARCTERYX(始祖鸟)户外玩家真正的关心的还在于使用环境上。让淘淘带大家看看Arc’teryx 始祖鸟官方是怎么定位和区别服装等级与用途.\n\nSV – Severe Use 向导级别: 针对最恶劣的极限环境所设计，采用了最耐用的材质，为了应付恶劣的天气都会加上风帽设计给予最完整的保护。适合三极探险（南北极和最高峰），可长时间的为使用者提供了最全天候的保护,但是所带来的是重量增加，因此除非你要去那些地方真的够冷，够险，够偏。否则一般探险使用大可不用买到此等级,当然有钱烧装备除外。\n\nAR – All-Round Use 多功能级别：强调了一系列功能,使用中等厚度材质，能应付未来大多数环境的使用，以最完全的包覆剪裁设计。使用耐用的材质，虽然稍重了一些，但所带来的性价比是很高的，非常耐用能百分百应付国内所有的地形与气候，例如：Beta AR Jacket 与 Gamma AR Jacket。此型号若出现在底层排汗衣或中层保暖衣，则是(相对地)定位较适合秋冬使用，例如：Rho AR Zip Top 与 Delta AR Zip Top 系列。 \n\nMX – Mixed Use混合天气用途级别：针对不断变化的天气条件和多样的活动与多变地形环境使用，会尽可能地使用耐磨、透气、排汗、高活动性的布料。此定位的设计常只出现在 Soft Shell 类的衣物，如果活动区域的四季分明与海拔变化度大，通常很适合这类的衣物。\n\nLT – Light 轻量化级别：使用轻量化材质，设计上追求简单，减少不必要的部份。以风雨衣来说大部分是降低材料的耐磨性来达到轻量；以保暖衣或排汗衣来说会使用较薄的布料，来达到适合三季的使用。\n\nSL – Super Light 超轻量化级别：使用最轻量的布料，同时耐用性能有所降低。在风雨衣上很明显最具优势就属于 Gore-tex 的 Paclite 了，其他款式也会使用最轻量化的材质。超轻量化设计来说，目前来说风雨衣一定使用 Paclite了，底层衣会以利用布料的四向弹性来降低太多的剪裁，例如：Rho SL Crew。另外会降低一些细节上的设计，或用不同的思惟来设计，就像 Alpha SL Pullover 是一个明显的例子。\n\nSK – Ski Specialized 滑雪专用：结合滑雪与雪地攀登的冬季设计。大方的衔接，额外的空间层次感，再加上较大的裤腿开放，以适应在雪上运动.\n\nLS（Long Sleeve）是长袖，SS（Short Sleeve）是短袖，RT (Rolltop) 卷口防水,M(Mountain )登山用途.\n\n\n\n按照始祖鸟的官方分法，产品线是traverse（徒步）、endorphin（越野跑）、whiteline（滑雪）、essential（基础）、ascent（攀登）、24（城市休闲）、veilance（商务休闲）。\n\n\n\nhttps://post.smzdm.com/p/595891/\n\n","source":"_posts/life/life.md","raw":"---\ntitle: life\ndate: 2017-05-03 17:23:57\ntags: life\n---\n\nblog\n\n[叠衣](http://www.jianshu.com/p/95853fa8943b)\n\n\n\nArc’teryx 始祖鸟(也有写作Arcteryx或鸟家) 作为来自加拿大的顶级户外装备，Arc’teryx 始祖鸟的背包，软壳，硬壳，冲锋衣裤不断的出现在各种媒体中（像近期的电影《谍影重重》）Arc’teryx 始祖鸟对户外运动全能极致的设计理念深受驴友们的认可，Arc’teryx 始祖鸟迷都知道Arc’teryx在 款式命名上，会将其等级和用途的缩写加在款式型号上作为区分，以便选购时能能过型号分辨其功能或定位上的差异，一般常见有AR、SV、LT、SL、MX、SK、RT、M、LS、SS等型号.\n\nARCTERYX(始祖鸟)服装大体来说等级和用途与价格有很大的关系，但作为ARCTERYX(始祖鸟)户外玩家真正的关心的还在于使用环境上。让淘淘带大家看看Arc’teryx 始祖鸟官方是怎么定位和区别服装等级与用途.\n\nSV – Severe Use 向导级别: 针对最恶劣的极限环境所设计，采用了最耐用的材质，为了应付恶劣的天气都会加上风帽设计给予最完整的保护。适合三极探险（南北极和最高峰），可长时间的为使用者提供了最全天候的保护,但是所带来的是重量增加，因此除非你要去那些地方真的够冷，够险，够偏。否则一般探险使用大可不用买到此等级,当然有钱烧装备除外。\n\nAR – All-Round Use 多功能级别：强调了一系列功能,使用中等厚度材质，能应付未来大多数环境的使用，以最完全的包覆剪裁设计。使用耐用的材质，虽然稍重了一些，但所带来的性价比是很高的，非常耐用能百分百应付国内所有的地形与气候，例如：Beta AR Jacket 与 Gamma AR Jacket。此型号若出现在底层排汗衣或中层保暖衣，则是(相对地)定位较适合秋冬使用，例如：Rho AR Zip Top 与 Delta AR Zip Top 系列。 \n\nMX – Mixed Use混合天气用途级别：针对不断变化的天气条件和多样的活动与多变地形环境使用，会尽可能地使用耐磨、透气、排汗、高活动性的布料。此定位的设计常只出现在 Soft Shell 类的衣物，如果活动区域的四季分明与海拔变化度大，通常很适合这类的衣物。\n\nLT – Light 轻量化级别：使用轻量化材质，设计上追求简单，减少不必要的部份。以风雨衣来说大部分是降低材料的耐磨性来达到轻量；以保暖衣或排汗衣来说会使用较薄的布料，来达到适合三季的使用。\n\nSL – Super Light 超轻量化级别：使用最轻量的布料，同时耐用性能有所降低。在风雨衣上很明显最具优势就属于 Gore-tex 的 Paclite 了，其他款式也会使用最轻量化的材质。超轻量化设计来说，目前来说风雨衣一定使用 Paclite了，底层衣会以利用布料的四向弹性来降低太多的剪裁，例如：Rho SL Crew。另外会降低一些细节上的设计，或用不同的思惟来设计，就像 Alpha SL Pullover 是一个明显的例子。\n\nSK – Ski Specialized 滑雪专用：结合滑雪与雪地攀登的冬季设计。大方的衔接，额外的空间层次感，再加上较大的裤腿开放，以适应在雪上运动.\n\nLS（Long Sleeve）是长袖，SS（Short Sleeve）是短袖，RT (Rolltop) 卷口防水,M(Mountain )登山用途.\n\n\n\n按照始祖鸟的官方分法，产品线是traverse（徒步）、endorphin（越野跑）、whiteline（滑雪）、essential（基础）、ascent（攀登）、24（城市休闲）、veilance（商务休闲）。\n\n\n\nhttps://post.smzdm.com/p/595891/\n\n","slug":"life/life","published":1,"updated":"2018-05-20T13:04:25.687Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fp003kizcb0od876m1","content":"<p>blog</p>\n<p><a href=\"http://www.jianshu.com/p/95853fa8943b\" target=\"_blank\" rel=\"noopener\">叠衣</a></p>\n<p>Arc’teryx 始祖鸟(也有写作Arcteryx或鸟家) 作为来自加拿大的顶级户外装备，Arc’teryx 始祖鸟的背包，软壳，硬壳，冲锋衣裤不断的出现在各种媒体中（像近期的电影《谍影重重》）Arc’teryx 始祖鸟对户外运动全能极致的设计理念深受驴友们的认可，Arc’teryx 始祖鸟迷都知道Arc’teryx在 款式命名上，会将其等级和用途的缩写加在款式型号上作为区分，以便选购时能能过型号分辨其功能或定位上的差异，一般常见有AR、SV、LT、SL、MX、SK、RT、M、LS、SS等型号.</p>\n<p>ARCTERYX(始祖鸟)服装大体来说等级和用途与价格有很大的关系，但作为ARCTERYX(始祖鸟)户外玩家真正的关心的还在于使用环境上。让淘淘带大家看看Arc’teryx 始祖鸟官方是怎么定位和区别服装等级与用途.</p>\n<p>SV – Severe Use 向导级别: 针对最恶劣的极限环境所设计，采用了最耐用的材质，为了应付恶劣的天气都会加上风帽设计给予最完整的保护。适合三极探险（南北极和最高峰），可长时间的为使用者提供了最全天候的保护,但是所带来的是重量增加，因此除非你要去那些地方真的够冷，够险，够偏。否则一般探险使用大可不用买到此等级,当然有钱烧装备除外。</p>\n<p>AR – All-Round Use 多功能级别：强调了一系列功能,使用中等厚度材质，能应付未来大多数环境的使用，以最完全的包覆剪裁设计。使用耐用的材质，虽然稍重了一些，但所带来的性价比是很高的，非常耐用能百分百应付国内所有的地形与气候，例如：Beta AR Jacket 与 Gamma AR Jacket。此型号若出现在底层排汗衣或中层保暖衣，则是(相对地)定位较适合秋冬使用，例如：Rho AR Zip Top 与 Delta AR Zip Top 系列。 </p>\n<p>MX – Mixed Use混合天气用途级别：针对不断变化的天气条件和多样的活动与多变地形环境使用，会尽可能地使用耐磨、透气、排汗、高活动性的布料。此定位的设计常只出现在 Soft Shell 类的衣物，如果活动区域的四季分明与海拔变化度大，通常很适合这类的衣物。</p>\n<p>LT – Light 轻量化级别：使用轻量化材质，设计上追求简单，减少不必要的部份。以风雨衣来说大部分是降低材料的耐磨性来达到轻量；以保暖衣或排汗衣来说会使用较薄的布料，来达到适合三季的使用。</p>\n<p>SL – Super Light 超轻量化级别：使用最轻量的布料，同时耐用性能有所降低。在风雨衣上很明显最具优势就属于 Gore-tex 的 Paclite 了，其他款式也会使用最轻量化的材质。超轻量化设计来说，目前来说风雨衣一定使用 Paclite了，底层衣会以利用布料的四向弹性来降低太多的剪裁，例如：Rho SL Crew。另外会降低一些细节上的设计，或用不同的思惟来设计，就像 Alpha SL Pullover 是一个明显的例子。</p>\n<p>SK – Ski Specialized 滑雪专用：结合滑雪与雪地攀登的冬季设计。大方的衔接，额外的空间层次感，再加上较大的裤腿开放，以适应在雪上运动.</p>\n<p>LS（Long Sleeve）是长袖，SS（Short Sleeve）是短袖，RT (Rolltop) 卷口防水,M(Mountain )登山用途.</p>\n<p>按照始祖鸟的官方分法，产品线是traverse（徒步）、endorphin（越野跑）、whiteline（滑雪）、essential（基础）、ascent（攀登）、24（城市休闲）、veilance（商务休闲）。</p>\n<p><a href=\"https://post.smzdm.com/p/595891/\" target=\"_blank\" rel=\"noopener\">https://post.smzdm.com/p/595891/</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>blog</p>\n<p><a href=\"http://www.jianshu.com/p/95853fa8943b\" target=\"_blank\" rel=\"noopener\">叠衣</a></p>\n<p>Arc’teryx 始祖鸟(也有写作Arcteryx或鸟家) 作为来自加拿大的顶级户外装备，Arc’teryx 始祖鸟的背包，软壳，硬壳，冲锋衣裤不断的出现在各种媒体中（像近期的电影《谍影重重》）Arc’teryx 始祖鸟对户外运动全能极致的设计理念深受驴友们的认可，Arc’teryx 始祖鸟迷都知道Arc’teryx在 款式命名上，会将其等级和用途的缩写加在款式型号上作为区分，以便选购时能能过型号分辨其功能或定位上的差异，一般常见有AR、SV、LT、SL、MX、SK、RT、M、LS、SS等型号.</p>\n<p>ARCTERYX(始祖鸟)服装大体来说等级和用途与价格有很大的关系，但作为ARCTERYX(始祖鸟)户外玩家真正的关心的还在于使用环境上。让淘淘带大家看看Arc’teryx 始祖鸟官方是怎么定位和区别服装等级与用途.</p>\n<p>SV – Severe Use 向导级别: 针对最恶劣的极限环境所设计，采用了最耐用的材质，为了应付恶劣的天气都会加上风帽设计给予最完整的保护。适合三极探险（南北极和最高峰），可长时间的为使用者提供了最全天候的保护,但是所带来的是重量增加，因此除非你要去那些地方真的够冷，够险，够偏。否则一般探险使用大可不用买到此等级,当然有钱烧装备除外。</p>\n<p>AR – All-Round Use 多功能级别：强调了一系列功能,使用中等厚度材质，能应付未来大多数环境的使用，以最完全的包覆剪裁设计。使用耐用的材质，虽然稍重了一些，但所带来的性价比是很高的，非常耐用能百分百应付国内所有的地形与气候，例如：Beta AR Jacket 与 Gamma AR Jacket。此型号若出现在底层排汗衣或中层保暖衣，则是(相对地)定位较适合秋冬使用，例如：Rho AR Zip Top 与 Delta AR Zip Top 系列。 </p>\n<p>MX – Mixed Use混合天气用途级别：针对不断变化的天气条件和多样的活动与多变地形环境使用，会尽可能地使用耐磨、透气、排汗、高活动性的布料。此定位的设计常只出现在 Soft Shell 类的衣物，如果活动区域的四季分明与海拔变化度大，通常很适合这类的衣物。</p>\n<p>LT – Light 轻量化级别：使用轻量化材质，设计上追求简单，减少不必要的部份。以风雨衣来说大部分是降低材料的耐磨性来达到轻量；以保暖衣或排汗衣来说会使用较薄的布料，来达到适合三季的使用。</p>\n<p>SL – Super Light 超轻量化级别：使用最轻量的布料，同时耐用性能有所降低。在风雨衣上很明显最具优势就属于 Gore-tex 的 Paclite 了，其他款式也会使用最轻量化的材质。超轻量化设计来说，目前来说风雨衣一定使用 Paclite了，底层衣会以利用布料的四向弹性来降低太多的剪裁，例如：Rho SL Crew。另外会降低一些细节上的设计，或用不同的思惟来设计，就像 Alpha SL Pullover 是一个明显的例子。</p>\n<p>SK – Ski Specialized 滑雪专用：结合滑雪与雪地攀登的冬季设计。大方的衔接，额外的空间层次感，再加上较大的裤腿开放，以适应在雪上运动.</p>\n<p>LS（Long Sleeve）是长袖，SS（Short Sleeve）是短袖，RT (Rolltop) 卷口防水,M(Mountain )登山用途.</p>\n<p>按照始祖鸟的官方分法，产品线是traverse（徒步）、endorphin（越野跑）、whiteline（滑雪）、essential（基础）、ascent（攀登）、24（城市休闲）、veilance（商务休闲）。</p>\n<p><a href=\"https://post.smzdm.com/p/595891/\" target=\"_blank\" rel=\"noopener\">https://post.smzdm.com/p/595891/</a></p>\n"},{"title":"优美的英文诗句","date":"2018-05-11T02:59:14.000Z","_content":"\n- **I love three things in the world, the sun, the moon and you. The sun for day, the moon for the night, and you forever**\n\n  浮世三千，吾爱有三。日，月与卿。日为朝，月为暮，卿为朝朝暮暮。\n\n- **Some of us get dipped in flat, some in satin, some in gloss. But every once in a while you find someone who's iridescent, and when you do, nothing will ever compare.(怦然心动)**\n\n  有人住高楼,有人在深沟,有人光万丈,有人一身锈,世人万千种,浮云莫去求,斯人若彩虹,遇上方知有\n\n- ","source":"_posts/poetry/poetry-english.md","raw":"---\ntitle: 优美的英文诗句\ndate: 2018-05-11 10:59:14\ntags: poetry\n---\n\n- **I love three things in the world, the sun, the moon and you. The sun for day, the moon for the night, and you forever**\n\n  浮世三千，吾爱有三。日，月与卿。日为朝，月为暮，卿为朝朝暮暮。\n\n- **Some of us get dipped in flat, some in satin, some in gloss. But every once in a while you find someone who's iridescent, and when you do, nothing will ever compare.(怦然心动)**\n\n  有人住高楼,有人在深沟,有人光万丈,有人一身锈,世人万千种,浮云莫去求,斯人若彩虹,遇上方知有\n\n- ","slug":"poetry/poetry-english","published":1,"updated":"2018-05-20T13:04:25.687Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fq003mizcbszm7qqa5","content":"<ul>\n<li><p><strong>I love three things in the world, the sun, the moon and you. The sun for day, the moon for the night, and you forever</strong></p>\n<p>浮世三千，吾爱有三。日，月与卿。日为朝，月为暮，卿为朝朝暮暮。</p>\n</li>\n<li><p><strong>Some of us get dipped in flat, some in satin, some in gloss. But every once in a while you find someone who’s iridescent, and when you do, nothing will ever compare.(怦然心动)</strong></p>\n<p>有人住高楼,有人在深沟,有人光万丈,有人一身锈,世人万千种,浮云莫去求,斯人若彩虹,遇上方知有</p>\n</li>\n<li></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><p><strong>I love three things in the world, the sun, the moon and you. The sun for day, the moon for the night, and you forever</strong></p>\n<p>浮世三千，吾爱有三。日，月与卿。日为朝，月为暮，卿为朝朝暮暮。</p>\n</li>\n<li><p><strong>Some of us get dipped in flat, some in satin, some in gloss. But every once in a while you find someone who’s iridescent, and when you do, nothing will ever compare.(怦然心动)</strong></p>\n<p>有人住高楼,有人在深沟,有人光万丈,有人一身锈,世人万千种,浮云莫去求,斯人若彩虹,遇上方知有</p>\n</li>\n<li></li>\n</ul>\n"},{"title":"心灵鸡汤","date":"2018-05-11T03:17:01.000Z","_content":"\n- 不在乎有的，不惦记没的，不害怕失去的，不追求强扭的。对得到适可而止，对失去心无畏惧 \n\n- 喷泉之所以漂亮是因为她有了压力；瀑布之所以壮观是因为她没有了退路；水之所以能穿石是因为永远在坚持 \n\n- 只要你真正努力过，再惨也不过是大器晚成\n\n- 人最怕一生碌碌无为，还说平凡难能可贵\n\n- 因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上 \n\n- 有钱虽不意味着你想干什么就能干什么，但可以让你不想做什么就不做什么 \n\n- 不管我们活成了什么样子，优秀也好，平庸也罢，高贵也好，卑贱也罢，富裕也好，贫穷也罢，总会有人喜欢你，也总会有人不喜欢你。\n\n- 没有钱，你拿什么维持你的亲情，稳固你的爱情，联络你的友情，靠嘴说吗，别闹了，大家都挺忙的！\n\n- 宁愿浪费3分钟或2个小时换来一句“不过如此”，也别让快进和剧透造成一点“早知当初”。\n\n- 因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上\n\n- 你安逸到无法改变，成为所谓“佛系青年”\n\n- 比你好看的人还比你优秀，比你优秀的人还比你努力，努力用几个月的时间做足了你一年都做不了的准备\n\n- 在没有人看到的地方去努力，坚持早起、坚持学习、坚持运动，不断学习新技能，努力遇见更好的自己。\n\n- 世界有2件事最难：一是把自己的知识装进别人的脑袋；二是把别人的钱装进自己的口袋 \n\n- 你之所以即使疲劳了，也不肯睡觉，是因为你没有勇气结束这一天，也没有勇气迎接新的一天\n\n- 在为浪费时间而后悔和自责时，你依然在浪费时间。\n\n- 哪有什么岁月静好，只是有人为你默默承受 \n\n- 当你开始变优秀的时候，连世界都会忍不住想要跟你做朋友。那些曾经想也不敢想的资源会尽数朝你倾过来，那些做梦也想不到的际遇会如雨后春笋般出现在你身旁。\n\n- 上帝给你的所有东西都是明码标价的，现在你浪费青春换来的片刻安逸，未来要用半辈子的辛苦劳作去偿还。 \n\n- 正如我常说的，人生是一个积分，你的选择影响的绝不仅仅是你自己，还有你的孩子。今天安逸的选择或许让你的人生某个阶段更加舒适，但是往往也意味着你给孩子设置了一个本可以没有的屏障 \n\n- 我怕自己成功的速度赶不上父母老去的速度，或者父母已经老了而我还没有成功\n\n- 不是急于求成，也不是踟蹰不前，只是朝着一个方向，慢慢地往前走着。世上没有白走的路，每走一步都算数。\n\n- 目标设到月球，即使失败，也能落到众星之间。\n\n   \n\n","source":"_posts/poetry/poetry-heart.md","raw":"---\ntitle: 心灵鸡汤\ndate: 2018-05-11 11:17:01\ntags: poetry\n---\n\n- 不在乎有的，不惦记没的，不害怕失去的，不追求强扭的。对得到适可而止，对失去心无畏惧 \n\n- 喷泉之所以漂亮是因为她有了压力；瀑布之所以壮观是因为她没有了退路；水之所以能穿石是因为永远在坚持 \n\n- 只要你真正努力过，再惨也不过是大器晚成\n\n- 人最怕一生碌碌无为，还说平凡难能可贵\n\n- 因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上 \n\n- 有钱虽不意味着你想干什么就能干什么，但可以让你不想做什么就不做什么 \n\n- 不管我们活成了什么样子，优秀也好，平庸也罢，高贵也好，卑贱也罢，富裕也好，贫穷也罢，总会有人喜欢你，也总会有人不喜欢你。\n\n- 没有钱，你拿什么维持你的亲情，稳固你的爱情，联络你的友情，靠嘴说吗，别闹了，大家都挺忙的！\n\n- 宁愿浪费3分钟或2个小时换来一句“不过如此”，也别让快进和剧透造成一点“早知当初”。\n\n- 因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上\n\n- 你安逸到无法改变，成为所谓“佛系青年”\n\n- 比你好看的人还比你优秀，比你优秀的人还比你努力，努力用几个月的时间做足了你一年都做不了的准备\n\n- 在没有人看到的地方去努力，坚持早起、坚持学习、坚持运动，不断学习新技能，努力遇见更好的自己。\n\n- 世界有2件事最难：一是把自己的知识装进别人的脑袋；二是把别人的钱装进自己的口袋 \n\n- 你之所以即使疲劳了，也不肯睡觉，是因为你没有勇气结束这一天，也没有勇气迎接新的一天\n\n- 在为浪费时间而后悔和自责时，你依然在浪费时间。\n\n- 哪有什么岁月静好，只是有人为你默默承受 \n\n- 当你开始变优秀的时候，连世界都会忍不住想要跟你做朋友。那些曾经想也不敢想的资源会尽数朝你倾过来，那些做梦也想不到的际遇会如雨后春笋般出现在你身旁。\n\n- 上帝给你的所有东西都是明码标价的，现在你浪费青春换来的片刻安逸，未来要用半辈子的辛苦劳作去偿还。 \n\n- 正如我常说的，人生是一个积分，你的选择影响的绝不仅仅是你自己，还有你的孩子。今天安逸的选择或许让你的人生某个阶段更加舒适，但是往往也意味着你给孩子设置了一个本可以没有的屏障 \n\n- 我怕自己成功的速度赶不上父母老去的速度，或者父母已经老了而我还没有成功\n\n- 不是急于求成，也不是踟蹰不前，只是朝着一个方向，慢慢地往前走着。世上没有白走的路，每走一步都算数。\n\n- 目标设到月球，即使失败，也能落到众星之间。\n\n   \n\n","slug":"poetry/poetry-heart","published":1,"updated":"2018-05-20T13:04:25.687Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fr003oizcbcyxf64wq","content":"<ul>\n<li><p>不在乎有的，不惦记没的，不害怕失去的，不追求强扭的。对得到适可而止，对失去心无畏惧 </p>\n</li>\n<li><p>喷泉之所以漂亮是因为她有了压力；瀑布之所以壮观是因为她没有了退路；水之所以能穿石是因为永远在坚持 </p>\n</li>\n<li><p>只要你真正努力过，再惨也不过是大器晚成</p>\n</li>\n<li><p>人最怕一生碌碌无为，还说平凡难能可贵</p>\n</li>\n<li><p>因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上 </p>\n</li>\n<li><p>有钱虽不意味着你想干什么就能干什么，但可以让你不想做什么就不做什么 </p>\n</li>\n<li><p>不管我们活成了什么样子，优秀也好，平庸也罢，高贵也好，卑贱也罢，富裕也好，贫穷也罢，总会有人喜欢你，也总会有人不喜欢你。</p>\n</li>\n<li><p>没有钱，你拿什么维持你的亲情，稳固你的爱情，联络你的友情，靠嘴说吗，别闹了，大家都挺忙的！</p>\n</li>\n<li><p>宁愿浪费3分钟或2个小时换来一句“不过如此”，也别让快进和剧透造成一点“早知当初”。</p>\n</li>\n<li><p>因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上</p>\n</li>\n<li><p>你安逸到无法改变，成为所谓“佛系青年”</p>\n</li>\n<li><p>比你好看的人还比你优秀，比你优秀的人还比你努力，努力用几个月的时间做足了你一年都做不了的准备</p>\n</li>\n<li><p>在没有人看到的地方去努力，坚持早起、坚持学习、坚持运动，不断学习新技能，努力遇见更好的自己。</p>\n</li>\n<li><p>世界有2件事最难：一是把自己的知识装进别人的脑袋；二是把别人的钱装进自己的口袋 </p>\n</li>\n<li><p>你之所以即使疲劳了，也不肯睡觉，是因为你没有勇气结束这一天，也没有勇气迎接新的一天</p>\n</li>\n<li><p>在为浪费时间而后悔和自责时，你依然在浪费时间。</p>\n</li>\n<li><p>哪有什么岁月静好，只是有人为你默默承受 </p>\n</li>\n<li><p>当你开始变优秀的时候，连世界都会忍不住想要跟你做朋友。那些曾经想也不敢想的资源会尽数朝你倾过来，那些做梦也想不到的际遇会如雨后春笋般出现在你身旁。</p>\n</li>\n<li><p>上帝给你的所有东西都是明码标价的，现在你浪费青春换来的片刻安逸，未来要用半辈子的辛苦劳作去偿还。 </p>\n</li>\n<li><p>正如我常说的，人生是一个积分，你的选择影响的绝不仅仅是你自己，还有你的孩子。今天安逸的选择或许让你的人生某个阶段更加舒适，但是往往也意味着你给孩子设置了一个本可以没有的屏障 </p>\n</li>\n<li><p>我怕自己成功的速度赶不上父母老去的速度，或者父母已经老了而我还没有成功</p>\n</li>\n<li><p>不是急于求成，也不是踟蹰不前，只是朝着一个方向，慢慢地往前走着。世上没有白走的路，每走一步都算数。</p>\n</li>\n<li><p>目标设到月球，即使失败，也能落到众星之间。</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><p>不在乎有的，不惦记没的，不害怕失去的，不追求强扭的。对得到适可而止，对失去心无畏惧 </p>\n</li>\n<li><p>喷泉之所以漂亮是因为她有了压力；瀑布之所以壮观是因为她没有了退路；水之所以能穿石是因为永远在坚持 </p>\n</li>\n<li><p>只要你真正努力过，再惨也不过是大器晚成</p>\n</li>\n<li><p>人最怕一生碌碌无为，还说平凡难能可贵</p>\n</li>\n<li><p>因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上 </p>\n</li>\n<li><p>有钱虽不意味着你想干什么就能干什么，但可以让你不想做什么就不做什么 </p>\n</li>\n<li><p>不管我们活成了什么样子，优秀也好，平庸也罢，高贵也好，卑贱也罢，富裕也好，贫穷也罢，总会有人喜欢你，也总会有人不喜欢你。</p>\n</li>\n<li><p>没有钱，你拿什么维持你的亲情，稳固你的爱情，联络你的友情，靠嘴说吗，别闹了，大家都挺忙的！</p>\n</li>\n<li><p>宁愿浪费3分钟或2个小时换来一句“不过如此”，也别让快进和剧透造成一点“早知当初”。</p>\n</li>\n<li><p>因果不虚，你昨天偷过的懒，总有一天会变成一记重重的耳光，打在你的脸上</p>\n</li>\n<li><p>你安逸到无法改变，成为所谓“佛系青年”</p>\n</li>\n<li><p>比你好看的人还比你优秀，比你优秀的人还比你努力，努力用几个月的时间做足了你一年都做不了的准备</p>\n</li>\n<li><p>在没有人看到的地方去努力，坚持早起、坚持学习、坚持运动，不断学习新技能，努力遇见更好的自己。</p>\n</li>\n<li><p>世界有2件事最难：一是把自己的知识装进别人的脑袋；二是把别人的钱装进自己的口袋 </p>\n</li>\n<li><p>你之所以即使疲劳了，也不肯睡觉，是因为你没有勇气结束这一天，也没有勇气迎接新的一天</p>\n</li>\n<li><p>在为浪费时间而后悔和自责时，你依然在浪费时间。</p>\n</li>\n<li><p>哪有什么岁月静好，只是有人为你默默承受 </p>\n</li>\n<li><p>当你开始变优秀的时候，连世界都会忍不住想要跟你做朋友。那些曾经想也不敢想的资源会尽数朝你倾过来，那些做梦也想不到的际遇会如雨后春笋般出现在你身旁。</p>\n</li>\n<li><p>上帝给你的所有东西都是明码标价的，现在你浪费青春换来的片刻安逸，未来要用半辈子的辛苦劳作去偿还。 </p>\n</li>\n<li><p>正如我常说的，人生是一个积分，你的选择影响的绝不仅仅是你自己，还有你的孩子。今天安逸的选择或许让你的人生某个阶段更加舒适，但是往往也意味着你给孩子设置了一个本可以没有的屏障 </p>\n</li>\n<li><p>我怕自己成功的速度赶不上父母老去的速度，或者父母已经老了而我还没有成功</p>\n</li>\n<li><p>不是急于求成，也不是踟蹰不前，只是朝着一个方向，慢慢地往前走着。世上没有白走的路，每走一步都算数。</p>\n</li>\n<li><p>目标设到月球，即使失败，也能落到众星之间。</p>\n</li>\n</ul>\n"},{"title":"poetry-love","date":"2018-05-11T03:13:48.000Z","_content":"\n- 如果今生我们注定擦肩而过，我能做的，惟有深深地祝福你，愿你永远快乐！然后收我所有的点点情意，期待下世再与你相逢...\n\n- 就是这样一个普通女孩，一见不过尔尔，再见方觉有些可爱，最终经历千山万水走到她身边，才惊呼她魅力非凡\n\n- 夜阑卧听风吹雨，铁马是你，冰河也是你  \n\n- 月落乌啼霜满天，江枫似卿，渔火亦似卿。 \n\n- 年年白发催人老，夜夜是你，青山也是你 \n\n- 晓看天色暮看云，行也思君，坐也思君 \n\n- 二斤黄酒加十年相思，才说出喜欢二字 \n\n- 我从未拥有过你一秒钟，心里却失去过你千万次 \n\n- 总有一天 你会遇见一个好姑娘 她不要你有房子 不要你有车子 不要你有钻石 更不要你的钱 也不要你。 \n\n- 遇见你\n\n  我变得很低很低\n\n  一直低到尘埃里去\n\n  但我的心是欢喜的\n\n  并且在那里开出一朵花来\n\n- 一生会遇见两个人，一个惊艳了时光，一个温柔了岁月\n\n- 一生待一人，一世一双人\n\n- 怎么用一句话，写出一个悲情的有诗感的爱情故事？\n\n  系统提示：你们有67个共同朋友，是否添加她为好友？","source":"_posts/poetry/poetry-love.md","raw":"---\ntitle: poetry-love\ndate: 2018-05-11 11:13:48\ntags:\n---\n\n- 如果今生我们注定擦肩而过，我能做的，惟有深深地祝福你，愿你永远快乐！然后收我所有的点点情意，期待下世再与你相逢...\n\n- 就是这样一个普通女孩，一见不过尔尔，再见方觉有些可爱，最终经历千山万水走到她身边，才惊呼她魅力非凡\n\n- 夜阑卧听风吹雨，铁马是你，冰河也是你  \n\n- 月落乌啼霜满天，江枫似卿，渔火亦似卿。 \n\n- 年年白发催人老，夜夜是你，青山也是你 \n\n- 晓看天色暮看云，行也思君，坐也思君 \n\n- 二斤黄酒加十年相思，才说出喜欢二字 \n\n- 我从未拥有过你一秒钟，心里却失去过你千万次 \n\n- 总有一天 你会遇见一个好姑娘 她不要你有房子 不要你有车子 不要你有钻石 更不要你的钱 也不要你。 \n\n- 遇见你\n\n  我变得很低很低\n\n  一直低到尘埃里去\n\n  但我的心是欢喜的\n\n  并且在那里开出一朵花来\n\n- 一生会遇见两个人，一个惊艳了时光，一个温柔了岁月\n\n- 一生待一人，一世一双人\n\n- 怎么用一句话，写出一个悲情的有诗感的爱情故事？\n\n  系统提示：你们有67个共同朋友，是否添加她为好友？","slug":"poetry/poetry-love","published":1,"updated":"2018-05-20T13:04:25.687Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fs003qizcb4ns3mjvh","content":"<ul>\n<li><p>如果今生我们注定擦肩而过，我能做的，惟有深深地祝福你，愿你永远快乐！然后收我所有的点点情意，期待下世再与你相逢…</p>\n</li>\n<li><p>就是这样一个普通女孩，一见不过尔尔，再见方觉有些可爱，最终经历千山万水走到她身边，才惊呼她魅力非凡</p>\n</li>\n<li><p>夜阑卧听风吹雨，铁马是你，冰河也是你  </p>\n</li>\n<li><p>月落乌啼霜满天，江枫似卿，渔火亦似卿。 </p>\n</li>\n<li><p>年年白发催人老，夜夜是你，青山也是你 </p>\n</li>\n<li><p>晓看天色暮看云，行也思君，坐也思君 </p>\n</li>\n<li><p>二斤黄酒加十年相思，才说出喜欢二字 </p>\n</li>\n<li><p>我从未拥有过你一秒钟，心里却失去过你千万次 </p>\n</li>\n<li><p>总有一天 你会遇见一个好姑娘 她不要你有房子 不要你有车子 不要你有钻石 更不要你的钱 也不要你。 </p>\n</li>\n<li><p>遇见你</p>\n<p>我变得很低很低</p>\n<p>一直低到尘埃里去</p>\n<p>但我的心是欢喜的</p>\n<p>并且在那里开出一朵花来</p>\n</li>\n<li><p>一生会遇见两个人，一个惊艳了时光，一个温柔了岁月</p>\n</li>\n<li><p>一生待一人，一世一双人</p>\n</li>\n<li><p>怎么用一句话，写出一个悲情的有诗感的爱情故事？</p>\n<p>系统提示：你们有67个共同朋友，是否添加她为好友？</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li><p>如果今生我们注定擦肩而过，我能做的，惟有深深地祝福你，愿你永远快乐！然后收我所有的点点情意，期待下世再与你相逢…</p>\n</li>\n<li><p>就是这样一个普通女孩，一见不过尔尔，再见方觉有些可爱，最终经历千山万水走到她身边，才惊呼她魅力非凡</p>\n</li>\n<li><p>夜阑卧听风吹雨，铁马是你，冰河也是你  </p>\n</li>\n<li><p>月落乌啼霜满天，江枫似卿，渔火亦似卿。 </p>\n</li>\n<li><p>年年白发催人老，夜夜是你，青山也是你 </p>\n</li>\n<li><p>晓看天色暮看云，行也思君，坐也思君 </p>\n</li>\n<li><p>二斤黄酒加十年相思，才说出喜欢二字 </p>\n</li>\n<li><p>我从未拥有过你一秒钟，心里却失去过你千万次 </p>\n</li>\n<li><p>总有一天 你会遇见一个好姑娘 她不要你有房子 不要你有车子 不要你有钻石 更不要你的钱 也不要你。 </p>\n</li>\n<li><p>遇见你</p>\n<p>我变得很低很低</p>\n<p>一直低到尘埃里去</p>\n<p>但我的心是欢喜的</p>\n<p>并且在那里开出一朵花来</p>\n</li>\n<li><p>一生会遇见两个人，一个惊艳了时光，一个温柔了岁月</p>\n</li>\n<li><p>一生待一人，一世一双人</p>\n</li>\n<li><p>怎么用一句话，写出一个悲情的有诗感的爱情故事？</p>\n<p>系统提示：你们有67个共同朋友，是否添加她为好友？</p>\n</li>\n</ul>\n"},{"title":"poetry-zen","date":"2018-05-11T03:32:27.000Z","_content":"\n八苦：生、老、病、死、怨憎会、爱别离、求不得、五阴盛 \n\n无论我走到哪里，那都是我该去的地方，经历一些我该经历的事，遇见我该遇见的人 \n\n> 1.人笨就要多花时间学习，努力提高绩点，别听别人瞎BB。　　\n>\n> 2.人弱就要多花时间锻炼，努力提升体质，别跟别人瞎胡闹。\n>\n> 　　3.人丑就要多花时间读书，努力提高内涵，别和别人瞎攀比。\n>\n> 　　4.人蠢就要多花时间观察，努力修炼为人，别和别人瞎搅合。\n>\n> 　　5.人傻就要多花时间请教，努力开阔眼界，别和别人瞎虚混。\n\n\n\n弟子问老师：“您能谈谈人类的奇怪之处吗？”老师答道：“他们急于成长，然后又哀叹失去的童年；他们以健康换取金钱，不久后又想用金钱恢复健康。他们对未来焦虑不已，却又无视现在的幸福。因此，他们既不活在当下，也不活在未来.他们活着仿佛从来不会死亡。临死前，又仿佛从未活过。” \n\n\n\n卦不可算尽，畏天道无常 \n\n情不敢至深，恐大梦一场 \n\n人生如茶，第一道苦如生命，第二道香如爱情，第三道淡如清风 \n\n听过很多道理，依然过不好这一生\n\n我们看不惯那么多人和事，却也没比别人好到哪去","source":"_posts/poetry/poetry-zen.md","raw":"---\ntitle: poetry-zen\ndate: 2018-05-11 11:32:27\ntags: poetry\n---\n\n八苦：生、老、病、死、怨憎会、爱别离、求不得、五阴盛 \n\n无论我走到哪里，那都是我该去的地方，经历一些我该经历的事，遇见我该遇见的人 \n\n> 1.人笨就要多花时间学习，努力提高绩点，别听别人瞎BB。　　\n>\n> 2.人弱就要多花时间锻炼，努力提升体质，别跟别人瞎胡闹。\n>\n> 　　3.人丑就要多花时间读书，努力提高内涵，别和别人瞎攀比。\n>\n> 　　4.人蠢就要多花时间观察，努力修炼为人，别和别人瞎搅合。\n>\n> 　　5.人傻就要多花时间请教，努力开阔眼界，别和别人瞎虚混。\n\n\n\n弟子问老师：“您能谈谈人类的奇怪之处吗？”老师答道：“他们急于成长，然后又哀叹失去的童年；他们以健康换取金钱，不久后又想用金钱恢复健康。他们对未来焦虑不已，却又无视现在的幸福。因此，他们既不活在当下，也不活在未来.他们活着仿佛从来不会死亡。临死前，又仿佛从未活过。” \n\n\n\n卦不可算尽，畏天道无常 \n\n情不敢至深，恐大梦一场 \n\n人生如茶，第一道苦如生命，第二道香如爱情，第三道淡如清风 \n\n听过很多道理，依然过不好这一生\n\n我们看不惯那么多人和事，却也没比别人好到哪去","slug":"poetry/poetry-zen","published":1,"updated":"2018-05-20T13:04:25.688Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ft003sizcbbdiv4ky0","content":"<p>八苦：生、老、病、死、怨憎会、爱别离、求不得、五阴盛 </p>\n<p>无论我走到哪里，那都是我该去的地方，经历一些我该经历的事，遇见我该遇见的人 </p>\n<blockquote>\n<p>1.人笨就要多花时间学习，努力提高绩点，别听别人瞎BB。　　</p>\n<p>2.人弱就要多花时间锻炼，努力提升体质，别跟别人瞎胡闹。</p>\n<p>　　3.人丑就要多花时间读书，努力提高内涵，别和别人瞎攀比。</p>\n<p>　　4.人蠢就要多花时间观察，努力修炼为人，别和别人瞎搅合。</p>\n<p>　　5.人傻就要多花时间请教，努力开阔眼界，别和别人瞎虚混。</p>\n</blockquote>\n<p>弟子问老师：“您能谈谈人类的奇怪之处吗？”老师答道：“他们急于成长，然后又哀叹失去的童年；他们以健康换取金钱，不久后又想用金钱恢复健康。他们对未来焦虑不已，却又无视现在的幸福。因此，他们既不活在当下，也不活在未来.他们活着仿佛从来不会死亡。临死前，又仿佛从未活过。” </p>\n<p>卦不可算尽，畏天道无常 </p>\n<p>情不敢至深，恐大梦一场 </p>\n<p>人生如茶，第一道苦如生命，第二道香如爱情，第三道淡如清风 </p>\n<p>听过很多道理，依然过不好这一生</p>\n<p>我们看不惯那么多人和事，却也没比别人好到哪去</p>\n","site":{"data":{}},"excerpt":"","more":"<p>八苦：生、老、病、死、怨憎会、爱别离、求不得、五阴盛 </p>\n<p>无论我走到哪里，那都是我该去的地方，经历一些我该经历的事，遇见我该遇见的人 </p>\n<blockquote>\n<p>1.人笨就要多花时间学习，努力提高绩点，别听别人瞎BB。　　</p>\n<p>2.人弱就要多花时间锻炼，努力提升体质，别跟别人瞎胡闹。</p>\n<p>　　3.人丑就要多花时间读书，努力提高内涵，别和别人瞎攀比。</p>\n<p>　　4.人蠢就要多花时间观察，努力修炼为人，别和别人瞎搅合。</p>\n<p>　　5.人傻就要多花时间请教，努力开阔眼界，别和别人瞎虚混。</p>\n</blockquote>\n<p>弟子问老师：“您能谈谈人类的奇怪之处吗？”老师答道：“他们急于成长，然后又哀叹失去的童年；他们以健康换取金钱，不久后又想用金钱恢复健康。他们对未来焦虑不已，却又无视现在的幸福。因此，他们既不活在当下，也不活在未来.他们活着仿佛从来不会死亡。临死前，又仿佛从未活过。” </p>\n<p>卦不可算尽，畏天道无常 </p>\n<p>情不敢至深，恐大梦一场 </p>\n<p>人生如茶，第一道苦如生命，第二道香如爱情，第三道淡如清风 </p>\n<p>听过很多道理，依然过不好这一生</p>\n<p>我们看不惯那么多人和事，却也没比别人好到哪去</p>\n"},{"title":"refactor-demo","date":"2017-03-21T03:56:09.000Z","_content":"\n### 重新组织函数\n\n##### Extract Method (提炼函数)\n(将这段代码放进一个独立函数中，并让函数名称解释该函数的用途)\n```java\nvoid printOwing(double amount) {\n  printBanner();\n  \n  // print details\n  System.out.println(\"name: \" + _name);\n  System.out.println(\"amout: \" + amount);\n}\n==>\nvoid printOwing(double amount) {\n  printBanner();\n  printDetails(amount);\n}\n\nvoid  printDetails(double amount) {\n  System.out.println(\"name: \" + _name);\n  System.out.println(\"amout: \" + amount);\n}\n\n\n```\n\n<!--more-->\n\n##### Inline Method (内联函数)\n\n（在函数调用点插入函数体，然后移除该函数）\n\n```java\nint getRating() {\n  return (moreThanFiveLateDeliveries()) ? 2 : 1;\n}\nboolean moreThanFiveLateDeliveries() {\n  return _numberOfLateDeliveries > 5;\n}\n==>\nint getRating() {\n  return (_numberOfLateDeliveries > 5) ? 2 : 1;\n} \n  \n```\n\n##### Inline Temp (内联临时变量)\n\n（将所有对该变量的引用动作，替换为对它赋值的那个表达式自身。）\n\n```java\ndouble basePrice = anOrder.basePrice();\nreturn (basePrice > 1000);\n==>\nreturn (anOrder.basePrice() > 1000);\n```\n\n##### Replace Temp with Query（以查询取代临时变量）\n\n(将这个表达式提炼到一个独立函数中，将这个临时变量的所有引用点替换为对新函数的调用。此后，新函数就可被其他函数使用。)\n\n```java\ndouble basePrice = _quantity * _itemPrice;\nif (basePrice > 1000) {\n  return basePrice * 0.95;\n} else {\n  return basePrice * 0.98;\n}\n==>\nif (basePrice() > 1000) {\n  return basePrice() * 0.95;\n} else {\n  return basePrice * 0.98;\n}\ndouble basePrice() {\n  return _quantity * _itemPrice;\n}\n```\n\n##### Introduce Explaining Variable（引用解释性变量）\n\n(将该复杂表达或其中一部分的结果放进一个临时变量，以此变量名称来解释表达式的用途。)\n\n```java\nif ((platform.toUpperCase().indexOf(\"MAC\") > -1) &&\n    (browser.toUpperCase().indexOf(\"IE\") > -1) &&\n    wasInitialized() && resize > 0 {\n      \n   // do something\n}\n==>\nfinal boolean isMacOs = platform.toUpperCase().indexOf(\"MAC\") > -1;\nfinal boolean isIEBrowser = browser.toUpperCase().indexOf(\"IE\") > -1;\nfinal boolean wasResized = resize > 0;\n\nif (isMacOs && isIEBrowser && wasInitialized() && wasResized) {\n  // do something\n}\n```\n\n##### Split Temporary Variable（分解临时变量）\n\n（针对每次赋值，创造一个独立、对应的临时变量）\n\n```java\ndouble temp = 2 * (_height + _width);\nSystem.out.println(temp);\ntemp = _height * _width;\nSystem.out.println(temp);\n==>\nfinal double perimeter = 2 * (_height + _width);\nSystem.out.println(perimeter);\nfinal double area = _height * _width;\nSystem.out.println(area);\n```\n\n##### Remove Assignments to Parameters\n\n(以一个临时变量取代该参数的位置)\n\n```java\nint discount(int inputVal, int quantity, int yearToDate) {\n  if (inputVal > 50) {\n    inputVal -= 2;\n  }\n}\n==>\nint discount(int inputVal, int quantity, int yearToDate) {\n  int result = inputVal;\n  if (inputVal > 50) {\n    result -= 2;\n  }\n} \n```\n\n##### Replace Method with Method Object(以函数对象取代函数)\n\n(将这个函数放进一个单独对象中，如此一来局部变量就成了对象内的字段。然后你可以在同一个对象中将这个大型函数分解为多个小型函数)\n\n```java\nclass Order {\n  double price() {\n    double primaryBasePrice\n    double secondaryBasePrice\n    ....\n    return primaryBasePrice + secondaryBasePrice + ...\n  }\n}\n==>\nclass Order {\n  double price() {\n    return new PriceCalculator(this).compute();\n  }\n}\nclass PriceCalculator {\n  double primaryBasePrice\n  double secondaryBasePrice\n  ...\n  double compute() {\n    return primaryBasePrice + secondaryBasePrice + ...\n  }\n}\n```\n\n##### Substitute Algorithm（替换算法）\n\n（将函数本体替换为另一个算法）\n\n```java\nString foundPerson(String[] people) {\n  for (int i = 0; i < people.length;i++) {\n    if (people[i].equals(\"Don\")) {\n      return \"Don\";\n    }\n    ...\n  }\n  return \"\";\n}\n==>\nString foundPerson(String[] people) {\n  List candidates = Arrays.asList(new String[] {\"Don\",\"John\",\"Kent\"});\n  for (int i = 0; i < people.length;i++) {\n    if (candidates.contains(people[i])) {\n      return people[i];\n    }\n  }\n  return \"\";\n}  \n```\n\n\n\n### 在对象之间搬移特性\n\n##### Move Method （搬移函数）\n\n\"搬移函数\"是重构理论的支柱。如是一个类有太多行为，或如果一个类与另一个类有太多合作而形成高度耦合，我就会搬移函数。通过这种手段，可以使系统中的类更简单，这些类最终也将更干净利落地实现系统交付的任务。\n\n##### Move File (搬移字段)\n\n在类之间移动状态和行为，是重构过程中必不可少的措施。随着系统的发展，你会发现自己需要新的类，并需要将现有的工作责任拖到新的类中。在这个星期看似合理而正确的设计决策，到了下个星期可能不再正确。这没问题。如果你从来没遇到这种情况，那才有问题。\n\n##### Extract Class（提炼类）\n\n（建立一个新类，将相关的字段和函数从旧类搬移到新类）\n\n```java\nclass Person {\n  String name, officeAreaCode, officeNumber;\n  void getTelephoneNumber(){}\n}\n==>\nclass Person {\n  String name;\n  void getTelephoneNumber(){}\n}\nclass TelephoneNumber {\n  String areaCode, number;\n  void getTelephoneNumber(){}\n}\n```\n\n##### Inline Class（将类内联化）\n\n将这个类的所有特性搬移到别一个类中，然后移除原类。\n\n##### Hide Delegate（隐藏\"委托关系\"）\n\n在服务类上建立客户所需的所有函数，用以隐藏委托关系。\n\n##### Remove Middle Man（移除中间人）\n\n让客户直接调用受托类\n\n##### Introduce Foreign Method（引入外加函数）\n\n（在客户类中建立一个函数，并以第一参数形式传入一个服务类实例）\n\n```java\nDate newStart = new Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate() + 1);\n==>\nDate newStart = nextDay(previousEnd);\nprivate static Date nextDay(Date arg) {\n  return new Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate());\n}\n\n```\n\n##### Introduce Local Extension（引入本地扩展）\n\n建立一个新类，使它包含这些额外函数。让这个扩展品成为源类的子类或包装类。\n\n\n\n### 重新组织数据\n\n##### Self Encapsulate Field（自封装字段）\n\n（为这个字段建立取值/设值函数，并且只以这些函数来访问字段）\n\n```java\nprivate int _low, _hight;\nboolean includes (int arg) {\n  return arg >= _low && arg <= _high;\n}\n==>\nprivate int _low, _hight;\nboolean includes (int arg) {\n  return arg >= getLow() && arg <= getHigh();\n}\nint getLow() {return _low;}\nint getHight() {return _hight;}\n```\n\n##### Replace Data Value with Object（以对象取代数据值）\n\n你有一个数据，需要与其他数据和行为一起使用才有意义。\n\n##### Change Value to Reference（将值对象改为引用对象）\n\n你从一个类衍生出许多彼此相等的实例，希望将它们替换为同一个对象。**将这个值对象变世引用对象**\n\n##### Change Reference to Value （将引用对象改为值对象）\n\n你有一个引用对象，很小且不可变，而且不易管理。**将它变成一个值对象**。\n\n##### Replace Array with Object（以对象取代数组）\n\n你有一个数组，其中的元素各自代表不同的东西。\n\n(以对象替换数组，对于数组中的每个元素，以一个字段来表示)\n\n```java\nString[] row = new String[3];\nrow[0] = \"Liverpool\";\nrow[1] = \"15\";\n==>\nPerformance row = new Performance();\nrow.setName(\"Liverpool\");\nrow.setWins(\"15\");\n```\n\n##### Duplicate Observed Data（复制\"被监视数据\"）\n\n你有一些领域数据置身于GUI控件中，而领域函数需要访问这些数据。（将该数据复制到一个领域对象中。建立一个Observer模式，用以同步领域对象和GUI对象内的重复数据）\n\n##### Change Unidirectional Association to Bidirectional（将单向关联改为双向关联）\n\n两个类都需要使用对方特性，但其间只有一条单向连接。（添加一个返回指针，并使修改函数能够同时更新两条连接）\n\n**Change Bidirectional Association to Unidirectional （将双向关联改为单向关联）**\n\n两个类之间有双向关联，但其中一个类如今不再需要另一个类的特性。（去除不必要的关联）\n\n**Replace Magic Number with Symbolic Constant（以字面常量取代魔法数）**\n\n（创建一个常量，根据其意义为它命名，并将上述的字面数值替换为这个常量。）\n\n```java\ndouble potentialEnergy(double mass, double height) {\n  return mass * 9.81 * height;\n}\n==>\ndouble potentialEnergy(double mass, double height) {\n  return mass * GRAVITATIONAL_CONSTANT * height;\n}\nstatic final double GRAVITATIONAL_CONSTANT = 9.81;\n```\n\n**Encapsulate Field（封装字段 ）**\n\n你的类中存在一个public字段。将它声明为private，并提供相应的访问函数。\n\n```java\npublic String _name;\n==>\nprivate String _name;\npublic String getName() {return _name;}\npublic void setName(String arg) {_name = arg;}\n```\n\n##### Encapsulate Collection（封装集合）\n\n有个函数返回一个集合。（让这个函数返回该集合的一个只读副本，并在这个类中提供添加、移除集合元素的函数。）\n\n##### Replace Recore with Data Class（以数据类取代记录）\n\n你需要面对传统编程环境中的记录结构。为该记录创建一个\"哑\"数据对象。\n\n##### Replace Type Code with Class（以类取代类型码）\n\n类之中有一个数值类型码，但它并不影响类的行为。（以一个新的类替换该数值类型码。）\n\n```java\nclass Person {\n  int O, A, B, AB;\n  int bloodGroup;\n}\n==>\nclass Person {}\nclass BloodGroup {\n  BloodGroup O, A, B, AB\n}\n```\n\n##### Replace Type Code with Subclasses（以子类取代类型码）\n\n你有一个不可变的类型码，它会影响类的行为：\n\n```java\nclass Employee {\n  int ENGINEER;\n  int SALESMAN;\n}\n==>\nclass Employee {}\nclass Engineer {}\nclass Salesman {}\n```\n\n##### Replace Type Code with State/Strategy（以State/Strategy取代类型码）\n\n你有一个类型码，它会影响类的行为，但你无法通过继承手法消除它。（以状态对象取代类型码）\n\n##### Replace Subclass with Fields（以字段取代子类）\n\n你的各个子类的唯一差别只在\"返回常量数据\"的函数身上。修改这些函数，使它们返回超类中的某个（新增）字段，然后销毁子类\n\n\n\n### 简化条件表达式\n\n##### Decompose Conditional（分解条件表达式）\n\n（从if、then、else三个段落中分别提炼出独立函数）\n\n```java\nif (date.before (SUMMER_START) || date.after(SUMMER_END)) {\n  charge = quantity * _winterRate + _winterServiceCharge;\n} else {\n  charge = quantity * _summberRate;\n}\n==>\nif (notSummer(date)) {\n  charge = winterCharge(quantity);\n} else {\n  charge = summerCharge(quantity);\n}\n```\n\n##### Consolidate Conditional Expression（合并条件表达式）\n\n你有一系列条件测试，都得到相同结果。（将这些测试合并为一个条件表达式，并将这个条件表达式提炼成为一个独立函数）\n\n```java\ndouble disabilityAmount () {\n  if (_seniority < 2) { return 0;}\n  if (_monthsDisabled > 12) { return 0;}\n  if (_isPartTime) { return 0;}\n}\n==>\ndouble disabilityAmount() {\n  if (isNotEligibleForDisability()) {return 0;}\n}\n```\n\n##### Consolidate Duplicate Conditional Fragments（合并重复的条件片段）\n\n将下面这段重复代码搬移到条件表达式之外。\n\n```java\nif (isSpecialDeal()) {\n  total = price * 0.95;\n  send();\n} else {\n  total = price * 0.98;\n  send();\n}\n==>\nif (isSpecialDeal()) {\n  total = price * 0.95;\n} else {\n  total = price * 0.98;\n}\nsend();\n```\n##### Remove Control Flag（移除控制标记）\n\n以break语句或return语句取代控制标记\n\n##### Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件表达式）\n\n函数中的条件逻辑使人难以看清正常的执行路径。（使用卫语句表现所有特殊情况）\n\n```java\ndouble getPayAmount() {\n  double result;\n  if (_isDead) {\n    result = deadAmount();\n  } else {\n    if (_isSeparated) {\n      result = separatedAmount();\n    } else {\n      if (_isRetired) {\n        result = retiredAmount();\n      } else {\n        result = normalPayAmount();\n      } \n    }\n  }\n}\n==>\ndouble getPayAmount() {\n  if (_isDead) {\n    return deadAmount();\n  }\n  if (_isSeparated) {\n    return separatedAmount();\n  }\n  if (_isRetired) {\n    return retiredAmount();\n  } \n  return normalPayAmount();\n}\n```\n\n##### Replace Conditional with Polymorphism（以多态取代条件表达式）\n\n你手上有个条件表达式，它根据对象类型的不同而选择不同的行为。（将这个条件表达式的每个分支放进一个子类内的覆写函数中，然后将原始函数声明为抽象函数。）\n\n```java\ndouble getSpeed() {\n  switch(_type) {\n    case EUROPEAN:\n      return getBaseSpeed;\n    case AFRICAN:\n      return getBaseSpeed() - getLoadFactor() * _numberOfCoconuts;\n    case NORWEGINA_BLUE:\n      return (_isNailed) ? 0 : getBaseSpeed(_voltage);\n  }\n  throw new RuntimeException(\"Should be unreachable\");\n}\n==>\nabstract class Bird { abstract getSpeed()}\nclass European extends Bird { getSpeed()}\nclass African extends Bird { getSpeed()}\nclass NorwegianBlue extends Bird { getSpeed()}\n```\n\n##### Introduce Null Object（引用Null对象）\n\n你需要再三检查某个对象是否为null。（将null值替换为null对象）\n\n```java\nif (customer == null) {\n  plan = BillingPlan.basic();\n} else {\n  plan = customer.getPlan();\n}\n==>\nclass Customer { getPlan()}\nclass NullCustomer extends Customer {getPlan()}\n```\n\n##### Introduce Assertion（引入断言）\n\n某一段代码需要对程序状态做出某种假设。以断言明确表现这种假设。\n\n```java\ndouble getExpenseLimit() {\n  return (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();\n}\n==>\ndouble getExpenseLimit() {\n  Assert.isTrue (_expenseLimit != NULL_EXPENSE || _primaryProject != null);\n  return (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();\n}\n```\n\n\n\n### 简化函数调用\n\n##### Rename Method（函数改名）\n\n函数的名称未能指示函数的用途。修改函数名称。\n\n```java\nclass Customer {getinvcdtlmt()}\n==>\nclass Customer {getInvoiceableCreditLimit()}\n```\n\n##### Add Parameter（添加函数）\n\n某个函数需要从调用端得到更多信息。（为些函数添加一个对象参数，让该对象带进函数所需的信息）\n\n##### Remove Parameter（移除参数）\n\n函数本体不再需要某个参数。将该参数去除。\n\n##### Separate Query from Modifier（将查询函数和修改函数分离）\n\n某个函数既返回对象状态值，又修改对象状态。（建立两个不同的函数，其中一个负责查询，别一个负责修改。）\n\n```java\nclass Customer {getTotalOutstandingAndSetReadyForSummaries()}\n==>\nclass Customer {\n  getTotalOutstanding()\n  setReadyForSummaries()\n}\n```\n\n##### Parameterize Method（令函数携带参数）\n\n若干函数做了类似的工作，但在函数本体中却包含了不同的值。（建立单一函数，以参数表达那些不同的值。）\n\n```java\nclass Employee { \n  fivePercentRaise();\n  tenPercentRaise();\n}\n==>\nclass Employee {\n  raise(percentage);\n}\n```\n\n##### Replace Parameter with Explicit Methods（以明确函数取代参数）\n\n你有一个函数，其中完全取决于参数值而采取不同行为。（针对该参数的每一个可能值，建立一个独立函数。）\n\n```java\nvoid setValue(String name, int value) {\n  if (name.equals(\"height\")) {\n    _height = value;\n    return;\n  }\n  if (name.equals(\"width\")) {\n    _width = value;\n    return;\n  }\n  Assert.shouldNeverReachHere();\n}\n==>\nvoid setHeight(int arg) {\n  _height = arg;\n}\nvoid setWidth(int arg) {\n  _width = arg;\n}\n```\n\n##### Preserve Whole Object（保持对象完整）\n\n你从某个对象中取出若干值，将它们作为某一次函数调用的参数。改为传递整个对象。\n\n```java\nint low = daysTempRange().getLow();\nint hight = daysTempRange().getHeight;\nwithinPlan = plan.withinRange(low, hight);\n==>\nwithinPlan = plan.withinRange(daysTempRange());\n```\n\n##### Replace Parameter with Methods（以函数取代参数）\n\n对象调用某个函数，并将所得结果作为参数，传递给另一个函数。而接受该参数的函数本身也能够调用前一个函数。（让参数接受者去除该项参数，并直接调用前一个函数）\n\n```java\nint basePrice = _quantity * _itemPrice;\ndiscountLevel = getDiscountLevel();\ndouble finalPrice = discountedPrice(basePrice, discountLevel);\n==>\nint basePrice = _quantity * _itemPrice;\ndouble finalPrice = discountedPrice(basePrice);\n```\n\n##### Introduce Parameter Object（引入参数对象）\n\n某些参数总是很自然地同时出现。以一个对象取代这些参数。\n\n```java\nclass Customer {\n  amountInvoicedIn(start:Date, end: Date);\n  amountReceived(start:Date, end: Date);\n  amountOverdueln(start:Date, end: Date);\n}\n==>\nclass Customer {\n  amountInvoicedIn(DateRange);\n  amountReceived(DateRange);\n  amountOverdueln(DateRange);\n}\n```\n\n##### Remove Setting Method（移除设值函数）\n\n类中的某个字段应该在对象创建时候被设值，然后就不再改变。（去掉该字段的所有设值函数）\n\n```java\nclass Employee {\n  Immutable;\n  setImmutableValue()}\n==>\nclass Employee {}\n```\n\n##### Hide Method（隐藏函数）\n\n有一个函数，从来没有被其他任何类用到。（将这个函数修改为private）\n\n##### Replace Constructor with Factory Method（以工厂函数取代构造函数）\n\n你希望在创建对象时不仅仅是做简单的构建动作。（将构造函数替换为工厂函数。）\n\n```java\nEmployee(int type) {\n  _type = type\n}\n==>\nstatic Employee create(int type) {\n  return new Employee(type);\n}\n```\n\n##### Encapsulate Downcast（封装向下转型）\n\n某个函数返回的对象，需要由函数调用者执行向下转型(downcast)。（将向下转型动作移到函数中）\n\n```java\nObject lastReading() {\n  return readings.lastElement();\n}\n==>\nReading lastReading() {\n  return (Reading) readings.lastElement();\n}\n```\n\n##### Replace Error Code with Exception（以异常取代错误码）\n\n某个函数返回一个特定的代码，用以表示某种错误情况。（改用异常）\n\n```java\nint withdraw(int amount) {\n  if (amount > _balance) {\n    return -1;\n  } else {\n    _balance -= amount;\n    return 0;\n  }\n}\n==>\nvoid withdraw(int amount) throws BalanceException {\n  if (amount > _balance) {\n    throw new BalanceException();\n  }\n  _balance -= amount;\n}\n```\n\n##### Replace Exception with Test（以测试取代异常）\n\n面对一个调用者可以预先检查的条件，你抛出了一个异常。(修改调用者，使它在调用函数之前先做检查)\n\n```java\ndouble getValueForPeriod(int periodNumber) {\n  try {\n    return _values[periodNumber];\n  } catch(ArrayIndexOutOfBoundsException e) {\n    return 0;\n  }\n}\n==>\ndouble getValueForPeriod(int periodNumber) {\n  if (periodNumber >= _values.length) {\n    return 0;\n  }\n  return _values[periodNumber];\n}\n```\n\n\n\n### 处理概括关系\n\n##### Pull Up Field（字段上移）\n\n两个子类拥有相同的字段。（将该字段移至超类）\n\n##### Pull Up Method（函数上移）\n\n有些函数，在各个子类中产生完全相同的结果。（将该函数移至超类）\n\n##### Pull Up Constructor Body（构造函数本体上移）\n\n你在各个子类中拥有一些构造函数，它们的本体几乎完全一致。（在超类中新建一个构造函数，并在子类的构造函数中调用它）\n\n```java\nclass Manager extends Employee {\n  public Manager(String name,String id,int grade) {\n    _name = name;\n    _id = id;\n    _grade = grade;\n  }\n}\n==>\npublic Manager(String name, String id, int grade) {\n  super(name, id);\n  _grade = grade;\n}\n```\n\n##### Push Down Method（函数下移）\n\n超类中的某个函数只与部分（而非全部）子类有关。（将这个函数移到相关子类去）\n\n##### Push Down Field（字段下移）\n\n超类中的某个字段只被部分（而非全部）子类用到。（将这个字段移到需要它的那些子类去）\n\n##### Extract Subclass（提炼子类）\n\n类中的某些特性只被某些（而非全部）实例用到。（新建一个子类，将上面所说的那一部分特性移到子类中）\n\n##### Extract SuperClass（提炼超类）\n\n两个类有相似特性。（为这两个类建立一个超类，将相同特性移至超类）\n\n##### Extract Interface（提炼接口）\n\n若干客户使用类接口中的同一子集，或者两个类的接口有部分相同。（将相同的子集提炼到一个独立接口中）\n\n##### Collapse Hierarchy（折叠继承体系）\n\n超类和子类之间无太大区别。（将它们合为一体）\n\n##### Form Template Method（塑造模板函数）\n\n你有一些子类，其中相应的某些函数以相同顺序执行类似的操作，但各个操作的细节上有所不同。（将这些操作分别放进独立函数中，并保持它们都有相同的签名，于是原函数也就变得相同了。然后将原函数上移至超类）\n\n##### Replace Inheritance with Delegation（以委托取代继承）\n\n某个子类只使用超类接口中的一部分，或是根本不需要继承而来的数据。（在子类中新建一个字段用以保存超类；调整子类函数，令它改而委托超类；然后去掉两者之间的继承关系）\n\n##### Replace Delegation with Inheritance（以继承取代委托）\n\n你在两个类之间使用委托关系，并经常为整个接口编写许多极简单的委托函数。（让委托类继承受托类）\n\n\n\n### 大型重构\n\n##### Tease Apart Inheritance（梳理并分解继承体系）\n\n某个继承体系同时承担两项责任。（建立两个继承体系，并通过委托关系让其中一个可以调用另一个）\n\n##### Convert Procedural Design to Objects（将过程化设计转化为对象设计）\n\n你手上有一些传统过程化风格的代码。（将数据记录变成对象，将大块的行为分成小块，并将行为移入相关对象之中。）\n\n##### Separate Domain from Presentation（将领域和表述、显示分离）\n\n某些GUI类之中包含了领域逻辑。（将领域逻辑分离出来，为它们建立独立的领域类）\n\n```java\nclass OrderWindow {}\n==>\nclass OrderWindow{}\nclass Order{}\n```\n\n##### Extract Hierarchy（提炼继承体系）\n\n你有某个类做了太多工作，其中一部分工作是以大量条件表达式完成的。（建立继承体系，以一个子类表示一特殊情况）\n\n","source":"_posts/refactor/refactor-demo.md","raw":"---\ntitle: refactor-demo\ndate: 2017-03-21 11:56:09\ntags: read\n---\n\n### 重新组织函数\n\n##### Extract Method (提炼函数)\n(将这段代码放进一个独立函数中，并让函数名称解释该函数的用途)\n```java\nvoid printOwing(double amount) {\n  printBanner();\n  \n  // print details\n  System.out.println(\"name: \" + _name);\n  System.out.println(\"amout: \" + amount);\n}\n==>\nvoid printOwing(double amount) {\n  printBanner();\n  printDetails(amount);\n}\n\nvoid  printDetails(double amount) {\n  System.out.println(\"name: \" + _name);\n  System.out.println(\"amout: \" + amount);\n}\n\n\n```\n\n<!--more-->\n\n##### Inline Method (内联函数)\n\n（在函数调用点插入函数体，然后移除该函数）\n\n```java\nint getRating() {\n  return (moreThanFiveLateDeliveries()) ? 2 : 1;\n}\nboolean moreThanFiveLateDeliveries() {\n  return _numberOfLateDeliveries > 5;\n}\n==>\nint getRating() {\n  return (_numberOfLateDeliveries > 5) ? 2 : 1;\n} \n  \n```\n\n##### Inline Temp (内联临时变量)\n\n（将所有对该变量的引用动作，替换为对它赋值的那个表达式自身。）\n\n```java\ndouble basePrice = anOrder.basePrice();\nreturn (basePrice > 1000);\n==>\nreturn (anOrder.basePrice() > 1000);\n```\n\n##### Replace Temp with Query（以查询取代临时变量）\n\n(将这个表达式提炼到一个独立函数中，将这个临时变量的所有引用点替换为对新函数的调用。此后，新函数就可被其他函数使用。)\n\n```java\ndouble basePrice = _quantity * _itemPrice;\nif (basePrice > 1000) {\n  return basePrice * 0.95;\n} else {\n  return basePrice * 0.98;\n}\n==>\nif (basePrice() > 1000) {\n  return basePrice() * 0.95;\n} else {\n  return basePrice * 0.98;\n}\ndouble basePrice() {\n  return _quantity * _itemPrice;\n}\n```\n\n##### Introduce Explaining Variable（引用解释性变量）\n\n(将该复杂表达或其中一部分的结果放进一个临时变量，以此变量名称来解释表达式的用途。)\n\n```java\nif ((platform.toUpperCase().indexOf(\"MAC\") > -1) &&\n    (browser.toUpperCase().indexOf(\"IE\") > -1) &&\n    wasInitialized() && resize > 0 {\n      \n   // do something\n}\n==>\nfinal boolean isMacOs = platform.toUpperCase().indexOf(\"MAC\") > -1;\nfinal boolean isIEBrowser = browser.toUpperCase().indexOf(\"IE\") > -1;\nfinal boolean wasResized = resize > 0;\n\nif (isMacOs && isIEBrowser && wasInitialized() && wasResized) {\n  // do something\n}\n```\n\n##### Split Temporary Variable（分解临时变量）\n\n（针对每次赋值，创造一个独立、对应的临时变量）\n\n```java\ndouble temp = 2 * (_height + _width);\nSystem.out.println(temp);\ntemp = _height * _width;\nSystem.out.println(temp);\n==>\nfinal double perimeter = 2 * (_height + _width);\nSystem.out.println(perimeter);\nfinal double area = _height * _width;\nSystem.out.println(area);\n```\n\n##### Remove Assignments to Parameters\n\n(以一个临时变量取代该参数的位置)\n\n```java\nint discount(int inputVal, int quantity, int yearToDate) {\n  if (inputVal > 50) {\n    inputVal -= 2;\n  }\n}\n==>\nint discount(int inputVal, int quantity, int yearToDate) {\n  int result = inputVal;\n  if (inputVal > 50) {\n    result -= 2;\n  }\n} \n```\n\n##### Replace Method with Method Object(以函数对象取代函数)\n\n(将这个函数放进一个单独对象中，如此一来局部变量就成了对象内的字段。然后你可以在同一个对象中将这个大型函数分解为多个小型函数)\n\n```java\nclass Order {\n  double price() {\n    double primaryBasePrice\n    double secondaryBasePrice\n    ....\n    return primaryBasePrice + secondaryBasePrice + ...\n  }\n}\n==>\nclass Order {\n  double price() {\n    return new PriceCalculator(this).compute();\n  }\n}\nclass PriceCalculator {\n  double primaryBasePrice\n  double secondaryBasePrice\n  ...\n  double compute() {\n    return primaryBasePrice + secondaryBasePrice + ...\n  }\n}\n```\n\n##### Substitute Algorithm（替换算法）\n\n（将函数本体替换为另一个算法）\n\n```java\nString foundPerson(String[] people) {\n  for (int i = 0; i < people.length;i++) {\n    if (people[i].equals(\"Don\")) {\n      return \"Don\";\n    }\n    ...\n  }\n  return \"\";\n}\n==>\nString foundPerson(String[] people) {\n  List candidates = Arrays.asList(new String[] {\"Don\",\"John\",\"Kent\"});\n  for (int i = 0; i < people.length;i++) {\n    if (candidates.contains(people[i])) {\n      return people[i];\n    }\n  }\n  return \"\";\n}  \n```\n\n\n\n### 在对象之间搬移特性\n\n##### Move Method （搬移函数）\n\n\"搬移函数\"是重构理论的支柱。如是一个类有太多行为，或如果一个类与另一个类有太多合作而形成高度耦合，我就会搬移函数。通过这种手段，可以使系统中的类更简单，这些类最终也将更干净利落地实现系统交付的任务。\n\n##### Move File (搬移字段)\n\n在类之间移动状态和行为，是重构过程中必不可少的措施。随着系统的发展，你会发现自己需要新的类，并需要将现有的工作责任拖到新的类中。在这个星期看似合理而正确的设计决策，到了下个星期可能不再正确。这没问题。如果你从来没遇到这种情况，那才有问题。\n\n##### Extract Class（提炼类）\n\n（建立一个新类，将相关的字段和函数从旧类搬移到新类）\n\n```java\nclass Person {\n  String name, officeAreaCode, officeNumber;\n  void getTelephoneNumber(){}\n}\n==>\nclass Person {\n  String name;\n  void getTelephoneNumber(){}\n}\nclass TelephoneNumber {\n  String areaCode, number;\n  void getTelephoneNumber(){}\n}\n```\n\n##### Inline Class（将类内联化）\n\n将这个类的所有特性搬移到别一个类中，然后移除原类。\n\n##### Hide Delegate（隐藏\"委托关系\"）\n\n在服务类上建立客户所需的所有函数，用以隐藏委托关系。\n\n##### Remove Middle Man（移除中间人）\n\n让客户直接调用受托类\n\n##### Introduce Foreign Method（引入外加函数）\n\n（在客户类中建立一个函数，并以第一参数形式传入一个服务类实例）\n\n```java\nDate newStart = new Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate() + 1);\n==>\nDate newStart = nextDay(previousEnd);\nprivate static Date nextDay(Date arg) {\n  return new Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate());\n}\n\n```\n\n##### Introduce Local Extension（引入本地扩展）\n\n建立一个新类，使它包含这些额外函数。让这个扩展品成为源类的子类或包装类。\n\n\n\n### 重新组织数据\n\n##### Self Encapsulate Field（自封装字段）\n\n（为这个字段建立取值/设值函数，并且只以这些函数来访问字段）\n\n```java\nprivate int _low, _hight;\nboolean includes (int arg) {\n  return arg >= _low && arg <= _high;\n}\n==>\nprivate int _low, _hight;\nboolean includes (int arg) {\n  return arg >= getLow() && arg <= getHigh();\n}\nint getLow() {return _low;}\nint getHight() {return _hight;}\n```\n\n##### Replace Data Value with Object（以对象取代数据值）\n\n你有一个数据，需要与其他数据和行为一起使用才有意义。\n\n##### Change Value to Reference（将值对象改为引用对象）\n\n你从一个类衍生出许多彼此相等的实例，希望将它们替换为同一个对象。**将这个值对象变世引用对象**\n\n##### Change Reference to Value （将引用对象改为值对象）\n\n你有一个引用对象，很小且不可变，而且不易管理。**将它变成一个值对象**。\n\n##### Replace Array with Object（以对象取代数组）\n\n你有一个数组，其中的元素各自代表不同的东西。\n\n(以对象替换数组，对于数组中的每个元素，以一个字段来表示)\n\n```java\nString[] row = new String[3];\nrow[0] = \"Liverpool\";\nrow[1] = \"15\";\n==>\nPerformance row = new Performance();\nrow.setName(\"Liverpool\");\nrow.setWins(\"15\");\n```\n\n##### Duplicate Observed Data（复制\"被监视数据\"）\n\n你有一些领域数据置身于GUI控件中，而领域函数需要访问这些数据。（将该数据复制到一个领域对象中。建立一个Observer模式，用以同步领域对象和GUI对象内的重复数据）\n\n##### Change Unidirectional Association to Bidirectional（将单向关联改为双向关联）\n\n两个类都需要使用对方特性，但其间只有一条单向连接。（添加一个返回指针，并使修改函数能够同时更新两条连接）\n\n**Change Bidirectional Association to Unidirectional （将双向关联改为单向关联）**\n\n两个类之间有双向关联，但其中一个类如今不再需要另一个类的特性。（去除不必要的关联）\n\n**Replace Magic Number with Symbolic Constant（以字面常量取代魔法数）**\n\n（创建一个常量，根据其意义为它命名，并将上述的字面数值替换为这个常量。）\n\n```java\ndouble potentialEnergy(double mass, double height) {\n  return mass * 9.81 * height;\n}\n==>\ndouble potentialEnergy(double mass, double height) {\n  return mass * GRAVITATIONAL_CONSTANT * height;\n}\nstatic final double GRAVITATIONAL_CONSTANT = 9.81;\n```\n\n**Encapsulate Field（封装字段 ）**\n\n你的类中存在一个public字段。将它声明为private，并提供相应的访问函数。\n\n```java\npublic String _name;\n==>\nprivate String _name;\npublic String getName() {return _name;}\npublic void setName(String arg) {_name = arg;}\n```\n\n##### Encapsulate Collection（封装集合）\n\n有个函数返回一个集合。（让这个函数返回该集合的一个只读副本，并在这个类中提供添加、移除集合元素的函数。）\n\n##### Replace Recore with Data Class（以数据类取代记录）\n\n你需要面对传统编程环境中的记录结构。为该记录创建一个\"哑\"数据对象。\n\n##### Replace Type Code with Class（以类取代类型码）\n\n类之中有一个数值类型码，但它并不影响类的行为。（以一个新的类替换该数值类型码。）\n\n```java\nclass Person {\n  int O, A, B, AB;\n  int bloodGroup;\n}\n==>\nclass Person {}\nclass BloodGroup {\n  BloodGroup O, A, B, AB\n}\n```\n\n##### Replace Type Code with Subclasses（以子类取代类型码）\n\n你有一个不可变的类型码，它会影响类的行为：\n\n```java\nclass Employee {\n  int ENGINEER;\n  int SALESMAN;\n}\n==>\nclass Employee {}\nclass Engineer {}\nclass Salesman {}\n```\n\n##### Replace Type Code with State/Strategy（以State/Strategy取代类型码）\n\n你有一个类型码，它会影响类的行为，但你无法通过继承手法消除它。（以状态对象取代类型码）\n\n##### Replace Subclass with Fields（以字段取代子类）\n\n你的各个子类的唯一差别只在\"返回常量数据\"的函数身上。修改这些函数，使它们返回超类中的某个（新增）字段，然后销毁子类\n\n\n\n### 简化条件表达式\n\n##### Decompose Conditional（分解条件表达式）\n\n（从if、then、else三个段落中分别提炼出独立函数）\n\n```java\nif (date.before (SUMMER_START) || date.after(SUMMER_END)) {\n  charge = quantity * _winterRate + _winterServiceCharge;\n} else {\n  charge = quantity * _summberRate;\n}\n==>\nif (notSummer(date)) {\n  charge = winterCharge(quantity);\n} else {\n  charge = summerCharge(quantity);\n}\n```\n\n##### Consolidate Conditional Expression（合并条件表达式）\n\n你有一系列条件测试，都得到相同结果。（将这些测试合并为一个条件表达式，并将这个条件表达式提炼成为一个独立函数）\n\n```java\ndouble disabilityAmount () {\n  if (_seniority < 2) { return 0;}\n  if (_monthsDisabled > 12) { return 0;}\n  if (_isPartTime) { return 0;}\n}\n==>\ndouble disabilityAmount() {\n  if (isNotEligibleForDisability()) {return 0;}\n}\n```\n\n##### Consolidate Duplicate Conditional Fragments（合并重复的条件片段）\n\n将下面这段重复代码搬移到条件表达式之外。\n\n```java\nif (isSpecialDeal()) {\n  total = price * 0.95;\n  send();\n} else {\n  total = price * 0.98;\n  send();\n}\n==>\nif (isSpecialDeal()) {\n  total = price * 0.95;\n} else {\n  total = price * 0.98;\n}\nsend();\n```\n##### Remove Control Flag（移除控制标记）\n\n以break语句或return语句取代控制标记\n\n##### Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件表达式）\n\n函数中的条件逻辑使人难以看清正常的执行路径。（使用卫语句表现所有特殊情况）\n\n```java\ndouble getPayAmount() {\n  double result;\n  if (_isDead) {\n    result = deadAmount();\n  } else {\n    if (_isSeparated) {\n      result = separatedAmount();\n    } else {\n      if (_isRetired) {\n        result = retiredAmount();\n      } else {\n        result = normalPayAmount();\n      } \n    }\n  }\n}\n==>\ndouble getPayAmount() {\n  if (_isDead) {\n    return deadAmount();\n  }\n  if (_isSeparated) {\n    return separatedAmount();\n  }\n  if (_isRetired) {\n    return retiredAmount();\n  } \n  return normalPayAmount();\n}\n```\n\n##### Replace Conditional with Polymorphism（以多态取代条件表达式）\n\n你手上有个条件表达式，它根据对象类型的不同而选择不同的行为。（将这个条件表达式的每个分支放进一个子类内的覆写函数中，然后将原始函数声明为抽象函数。）\n\n```java\ndouble getSpeed() {\n  switch(_type) {\n    case EUROPEAN:\n      return getBaseSpeed;\n    case AFRICAN:\n      return getBaseSpeed() - getLoadFactor() * _numberOfCoconuts;\n    case NORWEGINA_BLUE:\n      return (_isNailed) ? 0 : getBaseSpeed(_voltage);\n  }\n  throw new RuntimeException(\"Should be unreachable\");\n}\n==>\nabstract class Bird { abstract getSpeed()}\nclass European extends Bird { getSpeed()}\nclass African extends Bird { getSpeed()}\nclass NorwegianBlue extends Bird { getSpeed()}\n```\n\n##### Introduce Null Object（引用Null对象）\n\n你需要再三检查某个对象是否为null。（将null值替换为null对象）\n\n```java\nif (customer == null) {\n  plan = BillingPlan.basic();\n} else {\n  plan = customer.getPlan();\n}\n==>\nclass Customer { getPlan()}\nclass NullCustomer extends Customer {getPlan()}\n```\n\n##### Introduce Assertion（引入断言）\n\n某一段代码需要对程序状态做出某种假设。以断言明确表现这种假设。\n\n```java\ndouble getExpenseLimit() {\n  return (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();\n}\n==>\ndouble getExpenseLimit() {\n  Assert.isTrue (_expenseLimit != NULL_EXPENSE || _primaryProject != null);\n  return (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();\n}\n```\n\n\n\n### 简化函数调用\n\n##### Rename Method（函数改名）\n\n函数的名称未能指示函数的用途。修改函数名称。\n\n```java\nclass Customer {getinvcdtlmt()}\n==>\nclass Customer {getInvoiceableCreditLimit()}\n```\n\n##### Add Parameter（添加函数）\n\n某个函数需要从调用端得到更多信息。（为些函数添加一个对象参数，让该对象带进函数所需的信息）\n\n##### Remove Parameter（移除参数）\n\n函数本体不再需要某个参数。将该参数去除。\n\n##### Separate Query from Modifier（将查询函数和修改函数分离）\n\n某个函数既返回对象状态值，又修改对象状态。（建立两个不同的函数，其中一个负责查询，别一个负责修改。）\n\n```java\nclass Customer {getTotalOutstandingAndSetReadyForSummaries()}\n==>\nclass Customer {\n  getTotalOutstanding()\n  setReadyForSummaries()\n}\n```\n\n##### Parameterize Method（令函数携带参数）\n\n若干函数做了类似的工作，但在函数本体中却包含了不同的值。（建立单一函数，以参数表达那些不同的值。）\n\n```java\nclass Employee { \n  fivePercentRaise();\n  tenPercentRaise();\n}\n==>\nclass Employee {\n  raise(percentage);\n}\n```\n\n##### Replace Parameter with Explicit Methods（以明确函数取代参数）\n\n你有一个函数，其中完全取决于参数值而采取不同行为。（针对该参数的每一个可能值，建立一个独立函数。）\n\n```java\nvoid setValue(String name, int value) {\n  if (name.equals(\"height\")) {\n    _height = value;\n    return;\n  }\n  if (name.equals(\"width\")) {\n    _width = value;\n    return;\n  }\n  Assert.shouldNeverReachHere();\n}\n==>\nvoid setHeight(int arg) {\n  _height = arg;\n}\nvoid setWidth(int arg) {\n  _width = arg;\n}\n```\n\n##### Preserve Whole Object（保持对象完整）\n\n你从某个对象中取出若干值，将它们作为某一次函数调用的参数。改为传递整个对象。\n\n```java\nint low = daysTempRange().getLow();\nint hight = daysTempRange().getHeight;\nwithinPlan = plan.withinRange(low, hight);\n==>\nwithinPlan = plan.withinRange(daysTempRange());\n```\n\n##### Replace Parameter with Methods（以函数取代参数）\n\n对象调用某个函数，并将所得结果作为参数，传递给另一个函数。而接受该参数的函数本身也能够调用前一个函数。（让参数接受者去除该项参数，并直接调用前一个函数）\n\n```java\nint basePrice = _quantity * _itemPrice;\ndiscountLevel = getDiscountLevel();\ndouble finalPrice = discountedPrice(basePrice, discountLevel);\n==>\nint basePrice = _quantity * _itemPrice;\ndouble finalPrice = discountedPrice(basePrice);\n```\n\n##### Introduce Parameter Object（引入参数对象）\n\n某些参数总是很自然地同时出现。以一个对象取代这些参数。\n\n```java\nclass Customer {\n  amountInvoicedIn(start:Date, end: Date);\n  amountReceived(start:Date, end: Date);\n  amountOverdueln(start:Date, end: Date);\n}\n==>\nclass Customer {\n  amountInvoicedIn(DateRange);\n  amountReceived(DateRange);\n  amountOverdueln(DateRange);\n}\n```\n\n##### Remove Setting Method（移除设值函数）\n\n类中的某个字段应该在对象创建时候被设值，然后就不再改变。（去掉该字段的所有设值函数）\n\n```java\nclass Employee {\n  Immutable;\n  setImmutableValue()}\n==>\nclass Employee {}\n```\n\n##### Hide Method（隐藏函数）\n\n有一个函数，从来没有被其他任何类用到。（将这个函数修改为private）\n\n##### Replace Constructor with Factory Method（以工厂函数取代构造函数）\n\n你希望在创建对象时不仅仅是做简单的构建动作。（将构造函数替换为工厂函数。）\n\n```java\nEmployee(int type) {\n  _type = type\n}\n==>\nstatic Employee create(int type) {\n  return new Employee(type);\n}\n```\n\n##### Encapsulate Downcast（封装向下转型）\n\n某个函数返回的对象，需要由函数调用者执行向下转型(downcast)。（将向下转型动作移到函数中）\n\n```java\nObject lastReading() {\n  return readings.lastElement();\n}\n==>\nReading lastReading() {\n  return (Reading) readings.lastElement();\n}\n```\n\n##### Replace Error Code with Exception（以异常取代错误码）\n\n某个函数返回一个特定的代码，用以表示某种错误情况。（改用异常）\n\n```java\nint withdraw(int amount) {\n  if (amount > _balance) {\n    return -1;\n  } else {\n    _balance -= amount;\n    return 0;\n  }\n}\n==>\nvoid withdraw(int amount) throws BalanceException {\n  if (amount > _balance) {\n    throw new BalanceException();\n  }\n  _balance -= amount;\n}\n```\n\n##### Replace Exception with Test（以测试取代异常）\n\n面对一个调用者可以预先检查的条件，你抛出了一个异常。(修改调用者，使它在调用函数之前先做检查)\n\n```java\ndouble getValueForPeriod(int periodNumber) {\n  try {\n    return _values[periodNumber];\n  } catch(ArrayIndexOutOfBoundsException e) {\n    return 0;\n  }\n}\n==>\ndouble getValueForPeriod(int periodNumber) {\n  if (periodNumber >= _values.length) {\n    return 0;\n  }\n  return _values[periodNumber];\n}\n```\n\n\n\n### 处理概括关系\n\n##### Pull Up Field（字段上移）\n\n两个子类拥有相同的字段。（将该字段移至超类）\n\n##### Pull Up Method（函数上移）\n\n有些函数，在各个子类中产生完全相同的结果。（将该函数移至超类）\n\n##### Pull Up Constructor Body（构造函数本体上移）\n\n你在各个子类中拥有一些构造函数，它们的本体几乎完全一致。（在超类中新建一个构造函数，并在子类的构造函数中调用它）\n\n```java\nclass Manager extends Employee {\n  public Manager(String name,String id,int grade) {\n    _name = name;\n    _id = id;\n    _grade = grade;\n  }\n}\n==>\npublic Manager(String name, String id, int grade) {\n  super(name, id);\n  _grade = grade;\n}\n```\n\n##### Push Down Method（函数下移）\n\n超类中的某个函数只与部分（而非全部）子类有关。（将这个函数移到相关子类去）\n\n##### Push Down Field（字段下移）\n\n超类中的某个字段只被部分（而非全部）子类用到。（将这个字段移到需要它的那些子类去）\n\n##### Extract Subclass（提炼子类）\n\n类中的某些特性只被某些（而非全部）实例用到。（新建一个子类，将上面所说的那一部分特性移到子类中）\n\n##### Extract SuperClass（提炼超类）\n\n两个类有相似特性。（为这两个类建立一个超类，将相同特性移至超类）\n\n##### Extract Interface（提炼接口）\n\n若干客户使用类接口中的同一子集，或者两个类的接口有部分相同。（将相同的子集提炼到一个独立接口中）\n\n##### Collapse Hierarchy（折叠继承体系）\n\n超类和子类之间无太大区别。（将它们合为一体）\n\n##### Form Template Method（塑造模板函数）\n\n你有一些子类，其中相应的某些函数以相同顺序执行类似的操作，但各个操作的细节上有所不同。（将这些操作分别放进独立函数中，并保持它们都有相同的签名，于是原函数也就变得相同了。然后将原函数上移至超类）\n\n##### Replace Inheritance with Delegation（以委托取代继承）\n\n某个子类只使用超类接口中的一部分，或是根本不需要继承而来的数据。（在子类中新建一个字段用以保存超类；调整子类函数，令它改而委托超类；然后去掉两者之间的继承关系）\n\n##### Replace Delegation with Inheritance（以继承取代委托）\n\n你在两个类之间使用委托关系，并经常为整个接口编写许多极简单的委托函数。（让委托类继承受托类）\n\n\n\n### 大型重构\n\n##### Tease Apart Inheritance（梳理并分解继承体系）\n\n某个继承体系同时承担两项责任。（建立两个继承体系，并通过委托关系让其中一个可以调用另一个）\n\n##### Convert Procedural Design to Objects（将过程化设计转化为对象设计）\n\n你手上有一些传统过程化风格的代码。（将数据记录变成对象，将大块的行为分成小块，并将行为移入相关对象之中。）\n\n##### Separate Domain from Presentation（将领域和表述、显示分离）\n\n某些GUI类之中包含了领域逻辑。（将领域逻辑分离出来，为它们建立独立的领域类）\n\n```java\nclass OrderWindow {}\n==>\nclass OrderWindow{}\nclass Order{}\n```\n\n##### Extract Hierarchy（提炼继承体系）\n\n你有某个类做了太多工作，其中一部分工作是以大量条件表达式完成的。（建立继承体系，以一个子类表示一特殊情况）\n\n","slug":"refactor/refactor-demo","published":1,"updated":"2018-01-31T09:35:37.819Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ft003uizcbi00glxe9","content":"<h3 id=\"重新组织函数\"><a href=\"#重新组织函数\" class=\"headerlink\" title=\"重新组织函数\"></a>重新组织函数</h3><h5 id=\"Extract-Method-提炼函数\"><a href=\"#Extract-Method-提炼函数\" class=\"headerlink\" title=\"Extract Method (提炼函数)\"></a>Extract Method (提炼函数)</h5><p>(将这段代码放进一个独立函数中，并让函数名称解释该函数的用途)<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">printOwing</span><span class=\"params\">(<span class=\"keyword\">double</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  printBanner();</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// print details</span></span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"name: \"</span> + _name);</span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"amout: \"</span> + amount);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">printOwing</span><span class=\"params\">(<span class=\"keyword\">double</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  printBanner();</span><br><span class=\"line\">  printDetails(amount);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span>  <span class=\"title\">printDetails</span><span class=\"params\">(<span class=\"keyword\">double</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"name: \"</span> + _name);</span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"amout: \"</span> + amount);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h5 id=\"Inline-Method-内联函数\"><a href=\"#Inline-Method-内联函数\" class=\"headerlink\" title=\"Inline Method (内联函数)\"></a>Inline Method (内联函数)</h5><p>（在函数调用点插入函数体，然后移除该函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getRating</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (moreThanFiveLateDeliveries()) ? <span class=\"number\">2</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">moreThanFiveLateDeliveries</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> _numberOfLateDeliveries &gt; <span class=\"number\">5</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getRating</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (_numberOfLateDeliveries &gt; <span class=\"number\">5</span>) ? <span class=\"number\">2</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Inline-Temp-内联临时变量\"><a href=\"#Inline-Temp-内联临时变量\" class=\"headerlink\" title=\"Inline Temp (内联临时变量)\"></a>Inline Temp (内联临时变量)</h5><p>（将所有对该变量的引用动作，替换为对它赋值的那个表达式自身。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">double</span> basePrice = anOrder.basePrice();</span><br><span class=\"line\"><span class=\"keyword\">return</span> (basePrice &gt; <span class=\"number\">1000</span>);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">return</span> (anOrder.basePrice() &gt; <span class=\"number\">1000</span>);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Temp-with-Query（以查询取代临时变量）\"><a href=\"#Replace-Temp-with-Query（以查询取代临时变量）\" class=\"headerlink\" title=\"Replace Temp with Query（以查询取代临时变量）\"></a>Replace Temp with Query（以查询取代临时变量）</h5><p>(将这个表达式提炼到一个独立函数中，将这个临时变量的所有引用点替换为对新函数的调用。此后，新函数就可被其他函数使用。)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">double</span> basePrice = _quantity * _itemPrice;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (basePrice &gt; <span class=\"number\">1000</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (basePrice() &gt; <span class=\"number\">1000</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice() * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">basePrice</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> _quantity * _itemPrice;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Explaining-Variable（引用解释性变量）\"><a href=\"#Introduce-Explaining-Variable（引用解释性变量）\" class=\"headerlink\" title=\"Introduce Explaining Variable（引用解释性变量）\"></a>Introduce Explaining Variable（引用解释性变量）</h5><p>(将该复杂表达或其中一部分的结果放进一个临时变量，以此变量名称来解释表达式的用途。)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ((platform.toUpperCase().indexOf(<span class=\"string\">\"MAC\"</span>) &gt; -<span class=\"number\">1</span>) &amp;&amp;</span><br><span class=\"line\">    (browser.toUpperCase().indexOf(<span class=\"string\">\"IE\"</span>) &gt; -<span class=\"number\">1</span>) &amp;&amp;</span><br><span class=\"line\">    wasInitialized() &amp;&amp; resize &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">      </span><br><span class=\"line\">   <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> isMacOs = platform.toUpperCase().indexOf(<span class=\"string\">\"MAC\"</span>) &gt; -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> isIEBrowser = browser.toUpperCase().indexOf(<span class=\"string\">\"IE\"</span>) &gt; -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> wasResized = resize &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (isMacOs &amp;&amp; isIEBrowser &amp;&amp; wasInitialized() &amp;&amp; wasResized) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Split-Temporary-Variable（分解临时变量）\"><a href=\"#Split-Temporary-Variable（分解临时变量）\" class=\"headerlink\" title=\"Split Temporary Variable（分解临时变量）\"></a>Split Temporary Variable（分解临时变量）</h5><p>（针对每次赋值，创造一个独立、对应的临时变量）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">double</span> temp = <span class=\"number\">2</span> * (_height + _width);</span><br><span class=\"line\">System.out.println(temp);</span><br><span class=\"line\">temp = _height * _width;</span><br><span class=\"line\">System.out.println(temp);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">double</span> perimeter = <span class=\"number\">2</span> * (_height + _width);</span><br><span class=\"line\">System.out.println(perimeter);</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">double</span> area = _height * _width;</span><br><span class=\"line\">System.out.println(area);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Remove-Assignments-to-Parameters\"><a href=\"#Remove-Assignments-to-Parameters\" class=\"headerlink\" title=\"Remove Assignments to Parameters\"></a>Remove Assignments to Parameters</h5><p>(以一个临时变量取代该参数的位置)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">discount</span><span class=\"params\">(<span class=\"keyword\">int</span> inputVal, <span class=\"keyword\">int</span> quantity, <span class=\"keyword\">int</span> yearToDate)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (inputVal &gt; <span class=\"number\">50</span>) &#123;</span><br><span class=\"line\">    inputVal -= <span class=\"number\">2</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">discount</span><span class=\"params\">(<span class=\"keyword\">int</span> inputVal, <span class=\"keyword\">int</span> quantity, <span class=\"keyword\">int</span> yearToDate)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> result = inputVal;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (inputVal &gt; <span class=\"number\">50</span>) &#123;</span><br><span class=\"line\">    result -= <span class=\"number\">2</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Method-with-Method-Object-以函数对象取代函数\"><a href=\"#Replace-Method-with-Method-Object-以函数对象取代函数\" class=\"headerlink\" title=\"Replace Method with Method Object(以函数对象取代函数)\"></a>Replace Method with Method Object(以函数对象取代函数)</h5><p>(将这个函数放进一个单独对象中，如此一来局部变量就成了对象内的字段。然后你可以在同一个对象中将这个大型函数分解为多个小型函数)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">price</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">double</span> primaryBasePrice</span><br><span class=\"line\">    <span class=\"keyword\">double</span> secondaryBasePrice</span><br><span class=\"line\">    ....</span><br><span class=\"line\">    <span class=\"keyword\">return</span> primaryBasePrice + secondaryBasePrice + ...</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">price</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> PriceCalculator(<span class=\"keyword\">this</span>).compute();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PriceCalculator</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">double</span> primaryBasePrice</span><br><span class=\"line\">  <span class=\"keyword\">double</span> secondaryBasePrice</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">compute</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> primaryBasePrice + secondaryBasePrice + ...</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Substitute-Algorithm（替换算法）\"><a href=\"#Substitute-Algorithm（替换算法）\" class=\"headerlink\" title=\"Substitute Algorithm（替换算法）\"></a>Substitute Algorithm（替换算法）</h5><p>（将函数本体替换为另一个算法）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">String <span class=\"title\">foundPerson</span><span class=\"params\">(String[] people)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; people.length;i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (people[i].equals(<span class=\"string\">\"Don\"</span>)) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">\"Don\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\">String <span class=\"title\">foundPerson</span><span class=\"params\">(String[] people)</span> </span>&#123;</span><br><span class=\"line\">  List candidates = Arrays.asList(<span class=\"keyword\">new</span> String[] &#123;<span class=\"string\">\"Don\"</span>,<span class=\"string\">\"John\"</span>,<span class=\"string\">\"Kent\"</span>&#125;);</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; people.length;i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (candidates.contains(people[i])) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> people[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"在对象之间搬移特性\"><a href=\"#在对象之间搬移特性\" class=\"headerlink\" title=\"在对象之间搬移特性\"></a>在对象之间搬移特性</h3><h5 id=\"Move-Method-（搬移函数）\"><a href=\"#Move-Method-（搬移函数）\" class=\"headerlink\" title=\"Move Method （搬移函数）\"></a>Move Method （搬移函数）</h5><p>“搬移函数”是重构理论的支柱。如是一个类有太多行为，或如果一个类与另一个类有太多合作而形成高度耦合，我就会搬移函数。通过这种手段，可以使系统中的类更简单，这些类最终也将更干净利落地实现系统交付的任务。</p>\n<h5 id=\"Move-File-搬移字段\"><a href=\"#Move-File-搬移字段\" class=\"headerlink\" title=\"Move File (搬移字段)\"></a>Move File (搬移字段)</h5><p>在类之间移动状态和行为，是重构过程中必不可少的措施。随着系统的发展，你会发现自己需要新的类，并需要将现有的工作责任拖到新的类中。在这个星期看似合理而正确的设计决策，到了下个星期可能不再正确。这没问题。如果你从来没遇到这种情况，那才有问题。</p>\n<h5 id=\"Extract-Class（提炼类）\"><a href=\"#Extract-Class（提炼类）\" class=\"headerlink\" title=\"Extract Class（提炼类）\"></a>Extract Class（提炼类）</h5><p>（建立一个新类，将相关的字段和函数从旧类搬移到新类）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">  String name, officeAreaCode, officeNumber;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">getTelephoneNumber</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">  String name;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">getTelephoneNumber</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TelephoneNumber</span> </span>&#123;</span><br><span class=\"line\">  String areaCode, number;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">getTelephoneNumber</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Inline-Class（将类内联化）\"><a href=\"#Inline-Class（将类内联化）\" class=\"headerlink\" title=\"Inline Class（将类内联化）\"></a>Inline Class（将类内联化）</h5><p>将这个类的所有特性搬移到别一个类中，然后移除原类。</p>\n<h5 id=\"Hide-Delegate（隐藏”委托关系”）\"><a href=\"#Hide-Delegate（隐藏”委托关系”）\" class=\"headerlink\" title=\"Hide Delegate（隐藏”委托关系”）\"></a>Hide Delegate（隐藏”委托关系”）</h5><p>在服务类上建立客户所需的所有函数，用以隐藏委托关系。</p>\n<h5 id=\"Remove-Middle-Man（移除中间人）\"><a href=\"#Remove-Middle-Man（移除中间人）\" class=\"headerlink\" title=\"Remove Middle Man（移除中间人）\"></a>Remove Middle Man（移除中间人）</h5><p>让客户直接调用受托类</p>\n<h5 id=\"Introduce-Foreign-Method（引入外加函数）\"><a href=\"#Introduce-Foreign-Method（引入外加函数）\" class=\"headerlink\" title=\"Introduce Foreign Method（引入外加函数）\"></a>Introduce Foreign Method（引入外加函数）</h5><p>（在客户类中建立一个函数，并以第一参数形式传入一个服务类实例）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Date newStart = <span class=\"keyword\">new</span> Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate() + <span class=\"number\">1</span>);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">Date newStart = nextDay(previousEnd);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Date <span class=\"title\">nextDay</span><span class=\"params\">(Date arg)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Local-Extension（引入本地扩展）\"><a href=\"#Introduce-Local-Extension（引入本地扩展）\" class=\"headerlink\" title=\"Introduce Local Extension（引入本地扩展）\"></a>Introduce Local Extension（引入本地扩展）</h5><p>建立一个新类，使它包含这些额外函数。让这个扩展品成为源类的子类或包装类。</p>\n<h3 id=\"重新组织数据\"><a href=\"#重新组织数据\" class=\"headerlink\" title=\"重新组织数据\"></a>重新组织数据</h3><h5 id=\"Self-Encapsulate-Field（自封装字段）\"><a href=\"#Self-Encapsulate-Field（自封装字段）\" class=\"headerlink\" title=\"Self Encapsulate Field（自封装字段）\"></a>Self Encapsulate Field（自封装字段）</h5><p>（为这个字段建立取值/设值函数，并且只以这些函数来访问字段）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _low, _hight;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">includes</span> <span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> arg &gt;= _low &amp;&amp; arg &lt;= _high;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _low, _hight;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">includes</span> <span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> arg &gt;= getLow() &amp;&amp; arg &lt;= getHigh();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getLow</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> _low;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getHight</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> _hight;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Data-Value-with-Object（以对象取代数据值）\"><a href=\"#Replace-Data-Value-with-Object（以对象取代数据值）\" class=\"headerlink\" title=\"Replace Data Value with Object（以对象取代数据值）\"></a>Replace Data Value with Object（以对象取代数据值）</h5><p>你有一个数据，需要与其他数据和行为一起使用才有意义。</p>\n<h5 id=\"Change-Value-to-Reference（将值对象改为引用对象）\"><a href=\"#Change-Value-to-Reference（将值对象改为引用对象）\" class=\"headerlink\" title=\"Change Value to Reference（将值对象改为引用对象）\"></a>Change Value to Reference（将值对象改为引用对象）</h5><p>你从一个类衍生出许多彼此相等的实例，希望将它们替换为同一个对象。<strong>将这个值对象变世引用对象</strong></p>\n<h5 id=\"Change-Reference-to-Value-（将引用对象改为值对象）\"><a href=\"#Change-Reference-to-Value-（将引用对象改为值对象）\" class=\"headerlink\" title=\"Change Reference to Value （将引用对象改为值对象）\"></a>Change Reference to Value （将引用对象改为值对象）</h5><p>你有一个引用对象，很小且不可变，而且不易管理。<strong>将它变成一个值对象</strong>。</p>\n<h5 id=\"Replace-Array-with-Object（以对象取代数组）\"><a href=\"#Replace-Array-with-Object（以对象取代数组）\" class=\"headerlink\" title=\"Replace Array with Object（以对象取代数组）\"></a>Replace Array with Object（以对象取代数组）</h5><p>你有一个数组，其中的元素各自代表不同的东西。</p>\n<p>(以对象替换数组，对于数组中的每个元素，以一个字段来表示)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String[] row = <span class=\"keyword\">new</span> String[<span class=\"number\">3</span>];</span><br><span class=\"line\">row[<span class=\"number\">0</span>] = <span class=\"string\">\"Liverpool\"</span>;</span><br><span class=\"line\">row[<span class=\"number\">1</span>] = <span class=\"string\">\"15\"</span>;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">Performance row = <span class=\"keyword\">new</span> Performance();</span><br><span class=\"line\">row.setName(<span class=\"string\">\"Liverpool\"</span>);</span><br><span class=\"line\">row.setWins(<span class=\"string\">\"15\"</span>);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Duplicate-Observed-Data（复制”被监视数据”）\"><a href=\"#Duplicate-Observed-Data（复制”被监视数据”）\" class=\"headerlink\" title=\"Duplicate Observed Data（复制”被监视数据”）\"></a>Duplicate Observed Data（复制”被监视数据”）</h5><p>你有一些领域数据置身于GUI控件中，而领域函数需要访问这些数据。（将该数据复制到一个领域对象中。建立一个Observer模式，用以同步领域对象和GUI对象内的重复数据）</p>\n<h5 id=\"Change-Unidirectional-Association-to-Bidirectional（将单向关联改为双向关联）\"><a href=\"#Change-Unidirectional-Association-to-Bidirectional（将单向关联改为双向关联）\" class=\"headerlink\" title=\"Change Unidirectional Association to Bidirectional（将单向关联改为双向关联）\"></a>Change Unidirectional Association to Bidirectional（将单向关联改为双向关联）</h5><p>两个类都需要使用对方特性，但其间只有一条单向连接。（添加一个返回指针，并使修改函数能够同时更新两条连接）</p>\n<p><strong>Change Bidirectional Association to Unidirectional （将双向关联改为单向关联）</strong></p>\n<p>两个类之间有双向关联，但其中一个类如今不再需要另一个类的特性。（去除不必要的关联）</p>\n<p><strong>Replace Magic Number with Symbolic Constant（以字面常量取代魔法数）</strong></p>\n<p>（创建一个常量，根据其意义为它命名，并将上述的字面数值替换为这个常量。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">potentialEnergy</span><span class=\"params\">(<span class=\"keyword\">double</span> mass, <span class=\"keyword\">double</span> height)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> mass * <span class=\"number\">9.81</span> * height;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">potentialEnergy</span><span class=\"params\">(<span class=\"keyword\">double</span> mass, <span class=\"keyword\">double</span> height)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> mass * GRAVITATIONAL_CONSTANT * height;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">double</span> GRAVITATIONAL_CONSTANT = <span class=\"number\">9.81</span>;</span><br></pre></td></tr></table></figure>\n<p><strong>Encapsulate Field（封装字段 ）</strong></p>\n<p>你的类中存在一个public字段。将它声明为private，并提供相应的访问函数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> String _name;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">private</span> String _name;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> _name;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String arg)</span> </span>&#123;_name = arg;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Encapsulate-Collection（封装集合）\"><a href=\"#Encapsulate-Collection（封装集合）\" class=\"headerlink\" title=\"Encapsulate Collection（封装集合）\"></a>Encapsulate Collection（封装集合）</h5><p>有个函数返回一个集合。（让这个函数返回该集合的一个只读副本，并在这个类中提供添加、移除集合元素的函数。）</p>\n<h5 id=\"Replace-Recore-with-Data-Class（以数据类取代记录）\"><a href=\"#Replace-Recore-with-Data-Class（以数据类取代记录）\" class=\"headerlink\" title=\"Replace Recore with Data Class（以数据类取代记录）\"></a>Replace Recore with Data Class（以数据类取代记录）</h5><p>你需要面对传统编程环境中的记录结构。为该记录创建一个”哑”数据对象。</p>\n<h5 id=\"Replace-Type-Code-with-Class（以类取代类型码）\"><a href=\"#Replace-Type-Code-with-Class（以类取代类型码）\" class=\"headerlink\" title=\"Replace Type Code with Class（以类取代类型码）\"></a>Replace Type Code with Class（以类取代类型码）</h5><p>类之中有一个数值类型码，但它并不影响类的行为。（以一个新的类替换该数值类型码。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> O, A, B, AB;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> bloodGroup;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BloodGroup</span> </span>&#123;</span><br><span class=\"line\">  BloodGroup O, A, B, AB</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Type-Code-with-Subclasses（以子类取代类型码）\"><a href=\"#Replace-Type-Code-with-Subclasses（以子类取代类型码）\" class=\"headerlink\" title=\"Replace Type Code with Subclasses（以子类取代类型码）\"></a>Replace Type Code with Subclasses（以子类取代类型码）</h5><p>你有一个不可变的类型码，它会影响类的行为：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> ENGINEER;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> SALESMAN;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Engineer</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Salesman</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Type-Code-with-State-Strategy（以State-Strategy取代类型码）\"><a href=\"#Replace-Type-Code-with-State-Strategy（以State-Strategy取代类型码）\" class=\"headerlink\" title=\"Replace Type Code with State/Strategy（以State/Strategy取代类型码）\"></a>Replace Type Code with State/Strategy（以State/Strategy取代类型码）</h5><p>你有一个类型码，它会影响类的行为，但你无法通过继承手法消除它。（以状态对象取代类型码）</p>\n<h5 id=\"Replace-Subclass-with-Fields（以字段取代子类）\"><a href=\"#Replace-Subclass-with-Fields（以字段取代子类）\" class=\"headerlink\" title=\"Replace Subclass with Fields（以字段取代子类）\"></a>Replace Subclass with Fields（以字段取代子类）</h5><p>你的各个子类的唯一差别只在”返回常量数据”的函数身上。修改这些函数，使它们返回超类中的某个（新增）字段，然后销毁子类</p>\n<h3 id=\"简化条件表达式\"><a href=\"#简化条件表达式\" class=\"headerlink\" title=\"简化条件表达式\"></a>简化条件表达式</h3><h5 id=\"Decompose-Conditional（分解条件表达式）\"><a href=\"#Decompose-Conditional（分解条件表达式）\" class=\"headerlink\" title=\"Decompose Conditional（分解条件表达式）\"></a>Decompose Conditional（分解条件表达式）</h5><p>（从if、then、else三个段落中分别提炼出独立函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (date.before (SUMMER_START) || date.after(SUMMER_END)) &#123;</span><br><span class=\"line\">  charge = quantity * _winterRate + _winterServiceCharge;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  charge = quantity * _summberRate;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (notSummer(date)) &#123;</span><br><span class=\"line\">  charge = winterCharge(quantity);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  charge = summerCharge(quantity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Consolidate-Conditional-Expression（合并条件表达式）\"><a href=\"#Consolidate-Conditional-Expression（合并条件表达式）\" class=\"headerlink\" title=\"Consolidate Conditional Expression（合并条件表达式）\"></a>Consolidate Conditional Expression（合并条件表达式）</h5><p>你有一系列条件测试，都得到相同结果。（将这些测试合并为一个条件表达式，并将这个条件表达式提炼成为一个独立函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">disabilityAmount</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_seniority &lt; <span class=\"number\">2</span>) &#123; <span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_monthsDisabled &gt; <span class=\"number\">12</span>) &#123; <span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isPartTime) &#123; <span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">disabilityAmount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (isNotEligibleForDisability()) &#123;<span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Consolidate-Duplicate-Conditional-Fragments（合并重复的条件片段）\"><a href=\"#Consolidate-Duplicate-Conditional-Fragments（合并重复的条件片段）\" class=\"headerlink\" title=\"Consolidate Duplicate Conditional Fragments（合并重复的条件片段）\"></a>Consolidate Duplicate Conditional Fragments（合并重复的条件片段）</h5><p>将下面这段重复代码搬移到条件表达式之外。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (isSpecialDeal()) &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">  send();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">  send();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (isSpecialDeal()) &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">send();</span><br></pre></td></tr></table></figure>\n<h5 id=\"Remove-Control-Flag（移除控制标记）\"><a href=\"#Remove-Control-Flag（移除控制标记）\" class=\"headerlink\" title=\"Remove Control Flag（移除控制标记）\"></a>Remove Control Flag（移除控制标记）</h5><p>以break语句或return语句取代控制标记</p>\n<h5 id=\"Replace-Nested-Conditional-with-Guard-Clauses（以卫语句取代嵌套条件表达式）\"><a href=\"#Replace-Nested-Conditional-with-Guard-Clauses（以卫语句取代嵌套条件表达式）\" class=\"headerlink\" title=\"Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件表达式）\"></a>Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件表达式）</h5><p>函数中的条件逻辑使人难以看清正常的执行路径。（使用卫语句表现所有特殊情况）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getPayAmount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">double</span> result;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isDead) &#123;</span><br><span class=\"line\">    result = deadAmount();</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (_isSeparated) &#123;</span><br><span class=\"line\">      result = separatedAmount();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (_isRetired) &#123;</span><br><span class=\"line\">        result = retiredAmount();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        result = normalPayAmount();</span><br><span class=\"line\">      &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getPayAmount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isDead) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> deadAmount();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isSeparated) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> separatedAmount();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isRetired) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> retiredAmount();</span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">  <span class=\"keyword\">return</span> normalPayAmount();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Conditional-with-Polymorphism（以多态取代条件表达式）\"><a href=\"#Replace-Conditional-with-Polymorphism（以多态取代条件表达式）\" class=\"headerlink\" title=\"Replace Conditional with Polymorphism（以多态取代条件表达式）\"></a>Replace Conditional with Polymorphism（以多态取代条件表达式）</h5><p>你手上有个条件表达式，它根据对象类型的不同而选择不同的行为。（将这个条件表达式的每个分支放进一个子类内的覆写函数中，然后将原始函数声明为抽象函数。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getSpeed</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">switch</span>(_type) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> EUROPEAN:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> getBaseSpeed;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> AFRICAN:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> getBaseSpeed() - getLoadFactor() * _numberOfCoconuts;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> NORWEGINA_BLUE:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (_isNailed) ? <span class=\"number\">0</span> : getBaseSpeed(_voltage);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"Should be unreachable\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Bird</span> </span>&#123; <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"title\">getSpeed</span><span class=\"params\">()</span>&#125;</span></span><br><span class=\"line\"><span class=\"function\">class European extends Bird </span>&#123; getSpeed()&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">African</span> <span class=\"keyword\">extends</span> <span class=\"title\">Bird</span> </span>&#123; getSpeed()&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NorwegianBlue</span> <span class=\"keyword\">extends</span> <span class=\"title\">Bird</span> </span>&#123; getSpeed()&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Null-Object（引用Null对象）\"><a href=\"#Introduce-Null-Object（引用Null对象）\" class=\"headerlink\" title=\"Introduce Null Object（引用Null对象）\"></a>Introduce Null Object（引用Null对象）</h5><p>你需要再三检查某个对象是否为null。（将null值替换为null对象）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (customer == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">  plan = BillingPlan.basic();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  plan = customer.getPlan();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123; getPlan()&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NullCustomer</span> <span class=\"keyword\">extends</span> <span class=\"title\">Customer</span> </span>&#123;getPlan()&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Assertion（引入断言）\"><a href=\"#Introduce-Assertion（引入断言）\" class=\"headerlink\" title=\"Introduce Assertion（引入断言）\"></a>Introduce Assertion（引入断言）</h5><p>某一段代码需要对程序状态做出某种假设。以断言明确表现这种假设。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getExpenseLimit</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getExpenseLimit</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  Assert.isTrue (_expenseLimit != NULL_EXPENSE || _primaryProject != <span class=\"keyword\">null</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"简化函数调用\"><a href=\"#简化函数调用\" class=\"headerlink\" title=\"简化函数调用\"></a>简化函数调用</h3><h5 id=\"Rename-Method（函数改名）\"><a href=\"#Rename-Method（函数改名）\" class=\"headerlink\" title=\"Rename Method（函数改名）\"></a>Rename Method（函数改名）</h5><p>函数的名称未能指示函数的用途。修改函数名称。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;getinvcdtlmt()&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;getInvoiceableCreditLimit()&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Add-Parameter（添加函数）\"><a href=\"#Add-Parameter（添加函数）\" class=\"headerlink\" title=\"Add Parameter（添加函数）\"></a>Add Parameter（添加函数）</h5><p>某个函数需要从调用端得到更多信息。（为些函数添加一个对象参数，让该对象带进函数所需的信息）</p>\n<h5 id=\"Remove-Parameter（移除参数）\"><a href=\"#Remove-Parameter（移除参数）\" class=\"headerlink\" title=\"Remove Parameter（移除参数）\"></a>Remove Parameter（移除参数）</h5><p>函数本体不再需要某个参数。将该参数去除。</p>\n<h5 id=\"Separate-Query-from-Modifier（将查询函数和修改函数分离）\"><a href=\"#Separate-Query-from-Modifier（将查询函数和修改函数分离）\" class=\"headerlink\" title=\"Separate Query from Modifier（将查询函数和修改函数分离）\"></a>Separate Query from Modifier（将查询函数和修改函数分离）</h5><p>某个函数既返回对象状态值，又修改对象状态。（建立两个不同的函数，其中一个负责查询，别一个负责修改。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;getTotalOutstandingAndSetReadyForSummaries()&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;</span><br><span class=\"line\">  getTotalOutstanding()</span><br><span class=\"line\">  setReadyForSummaries()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Parameterize-Method（令函数携带参数）\"><a href=\"#Parameterize-Method（令函数携带参数）\" class=\"headerlink\" title=\"Parameterize Method（令函数携带参数）\"></a>Parameterize Method（令函数携带参数）</h5><p>若干函数做了类似的工作，但在函数本体中却包含了不同的值。（建立单一函数，以参数表达那些不同的值。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123; </span><br><span class=\"line\">  fivePercentRaise();</span><br><span class=\"line\">  tenPercentRaise();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  raise(percentage);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）\"><a href=\"#Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）\" class=\"headerlink\" title=\"Replace Parameter with Explicit Methods（以明确函数取代参数）\"></a>Replace Parameter with Explicit Methods（以明确函数取代参数）</h5><p>你有一个函数，其中完全取决于参数值而采取不同行为。（针对该参数的每一个可能值，建立一个独立函数。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setValue</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> value)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (name.equals(<span class=\"string\">\"height\"</span>)) &#123;</span><br><span class=\"line\">    _height = value;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (name.equals(<span class=\"string\">\"width\"</span>)) &#123;</span><br><span class=\"line\">    _width = value;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  Assert.shouldNeverReachHere();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setHeight</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  _height = arg;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setWidth</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  _width = arg;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Preserve-Whole-Object（保持对象完整）\"><a href=\"#Preserve-Whole-Object（保持对象完整）\" class=\"headerlink\" title=\"Preserve Whole Object（保持对象完整）\"></a>Preserve Whole Object（保持对象完整）</h5><p>你从某个对象中取出若干值，将它们作为某一次函数调用的参数。改为传递整个对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> low = daysTempRange().getLow();</span><br><span class=\"line\"><span class=\"keyword\">int</span> hight = daysTempRange().getHeight;</span><br><span class=\"line\">withinPlan = plan.withinRange(low, hight);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">withinPlan = plan.withinRange(daysTempRange());</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Parameter-with-Methods（以函数取代参数）\"><a href=\"#Replace-Parameter-with-Methods（以函数取代参数）\" class=\"headerlink\" title=\"Replace Parameter with Methods（以函数取代参数）\"></a>Replace Parameter with Methods（以函数取代参数）</h5><p>对象调用某个函数，并将所得结果作为参数，传递给另一个函数。而接受该参数的函数本身也能够调用前一个函数。（让参数接受者去除该项参数，并直接调用前一个函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> basePrice = _quantity * _itemPrice;</span><br><span class=\"line\">discountLevel = getDiscountLevel();</span><br><span class=\"line\"><span class=\"keyword\">double</span> finalPrice = discountedPrice(basePrice, discountLevel);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">int</span> basePrice = _quantity * _itemPrice;</span><br><span class=\"line\"><span class=\"keyword\">double</span> finalPrice = discountedPrice(basePrice);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Parameter-Object（引入参数对象）\"><a href=\"#Introduce-Parameter-Object（引入参数对象）\" class=\"headerlink\" title=\"Introduce Parameter Object（引入参数对象）\"></a>Introduce Parameter Object（引入参数对象）</h5><p>某些参数总是很自然地同时出现。以一个对象取代这些参数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;</span><br><span class=\"line\">  amountInvoicedIn(start:Date, end: Date);</span><br><span class=\"line\">  amountReceived(start:Date, end: Date);</span><br><span class=\"line\">  amountOverdueln(start:Date, end: Date);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;</span><br><span class=\"line\">  amountInvoicedIn(DateRange);</span><br><span class=\"line\">  amountReceived(DateRange);</span><br><span class=\"line\">  amountOverdueln(DateRange);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Remove-Setting-Method（移除设值函数）\"><a href=\"#Remove-Setting-Method（移除设值函数）\" class=\"headerlink\" title=\"Remove Setting Method（移除设值函数）\"></a>Remove Setting Method（移除设值函数）</h5><p>类中的某个字段应该在对象创建时候被设值，然后就不再改变。（去掉该字段的所有设值函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  Immutable;</span><br><span class=\"line\">  setImmutableValue()&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Hide-Method（隐藏函数）\"><a href=\"#Hide-Method（隐藏函数）\" class=\"headerlink\" title=\"Hide Method（隐藏函数）\"></a>Hide Method（隐藏函数）</h5><p>有一个函数，从来没有被其他任何类用到。（将这个函数修改为private）</p>\n<h5 id=\"Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）\"><a href=\"#Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）\" class=\"headerlink\" title=\"Replace Constructor with Factory Method（以工厂函数取代构造函数）\"></a>Replace Constructor with Factory Method（以工厂函数取代构造函数）</h5><p>你希望在创建对象时不仅仅是做简单的构建动作。（将构造函数替换为工厂函数。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Employee(<span class=\"keyword\">int</span> type) &#123;</span><br><span class=\"line\">  _type = type</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> Employee <span class=\"title\">create</span><span class=\"params\">(<span class=\"keyword\">int</span> type)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Employee(type);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Encapsulate-Downcast（封装向下转型）\"><a href=\"#Encapsulate-Downcast（封装向下转型）\" class=\"headerlink\" title=\"Encapsulate Downcast（封装向下转型）\"></a>Encapsulate Downcast（封装向下转型）</h5><p>某个函数返回的对象，需要由函数调用者执行向下转型(downcast)。（将向下转型动作移到函数中）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">Object <span class=\"title\">lastReading</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> readings.lastElement();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\">Reading <span class=\"title\">lastReading</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (Reading) readings.lastElement();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Error-Code-with-Exception（以异常取代错误码）\"><a href=\"#Replace-Error-Code-with-Exception（以异常取代错误码）\" class=\"headerlink\" title=\"Replace Error Code with Exception（以异常取代错误码）\"></a>Replace Error Code with Exception（以异常取代错误码）</h5><p>某个函数返回一个特定的代码，用以表示某种错误情况。（改用异常）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">withdraw</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (amount &gt; _balance) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    _balance -= amount;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">withdraw</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span> <span class=\"keyword\">throws</span> BalanceException </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (amount &gt; _balance) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> BalanceException();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  _balance -= amount;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Exception-with-Test（以测试取代异常）\"><a href=\"#Replace-Exception-with-Test（以测试取代异常）\" class=\"headerlink\" title=\"Replace Exception with Test（以测试取代异常）\"></a>Replace Exception with Test（以测试取代异常）</h5><p>面对一个调用者可以预先检查的条件，你抛出了一个异常。(修改调用者，使它在调用函数之前先做检查)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getValueForPeriod</span><span class=\"params\">(<span class=\"keyword\">int</span> periodNumber)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> _values[periodNumber];</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span>(ArrayIndexOutOfBoundsException e) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getValueForPeriod</span><span class=\"params\">(<span class=\"keyword\">int</span> periodNumber)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (periodNumber &gt;= _values.length) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> _values[periodNumber];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理概括关系\"><a href=\"#处理概括关系\" class=\"headerlink\" title=\"处理概括关系\"></a>处理概括关系</h3><h5 id=\"Pull-Up-Field（字段上移）\"><a href=\"#Pull-Up-Field（字段上移）\" class=\"headerlink\" title=\"Pull Up Field（字段上移）\"></a>Pull Up Field（字段上移）</h5><p>两个子类拥有相同的字段。（将该字段移至超类）</p>\n<h5 id=\"Pull-Up-Method（函数上移）\"><a href=\"#Pull-Up-Method（函数上移）\" class=\"headerlink\" title=\"Pull Up Method（函数上移）\"></a>Pull Up Method（函数上移）</h5><p>有些函数，在各个子类中产生完全相同的结果。（将该函数移至超类）</p>\n<h5 id=\"Pull-Up-Constructor-Body（构造函数本体上移）\"><a href=\"#Pull-Up-Constructor-Body（构造函数本体上移）\" class=\"headerlink\" title=\"Pull Up Constructor Body（构造函数本体上移）\"></a>Pull Up Constructor Body（构造函数本体上移）</h5><p>你在各个子类中拥有一些构造函数，它们的本体几乎完全一致。（在超类中新建一个构造函数，并在子类的构造函数中调用它）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Manager</span> <span class=\"keyword\">extends</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Manager</span><span class=\"params\">(String name,String id,<span class=\"keyword\">int</span> grade)</span> </span>&#123;</span><br><span class=\"line\">    _name = name;</span><br><span class=\"line\">    _id = id;</span><br><span class=\"line\">    _grade = grade;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Manager</span><span class=\"params\">(String name, String id, <span class=\"keyword\">int</span> grade)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">super</span>(name, id);</span><br><span class=\"line\">  _grade = grade;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Push-Down-Method（函数下移）\"><a href=\"#Push-Down-Method（函数下移）\" class=\"headerlink\" title=\"Push Down Method（函数下移）\"></a>Push Down Method（函数下移）</h5><p>超类中的某个函数只与部分（而非全部）子类有关。（将这个函数移到相关子类去）</p>\n<h5 id=\"Push-Down-Field（字段下移）\"><a href=\"#Push-Down-Field（字段下移）\" class=\"headerlink\" title=\"Push Down Field（字段下移）\"></a>Push Down Field（字段下移）</h5><p>超类中的某个字段只被部分（而非全部）子类用到。（将这个字段移到需要它的那些子类去）</p>\n<h5 id=\"Extract-Subclass（提炼子类）\"><a href=\"#Extract-Subclass（提炼子类）\" class=\"headerlink\" title=\"Extract Subclass（提炼子类）\"></a>Extract Subclass（提炼子类）</h5><p>类中的某些特性只被某些（而非全部）实例用到。（新建一个子类，将上面所说的那一部分特性移到子类中）</p>\n<h5 id=\"Extract-SuperClass（提炼超类）\"><a href=\"#Extract-SuperClass（提炼超类）\" class=\"headerlink\" title=\"Extract SuperClass（提炼超类）\"></a>Extract SuperClass（提炼超类）</h5><p>两个类有相似特性。（为这两个类建立一个超类，将相同特性移至超类）</p>\n<h5 id=\"Extract-Interface（提炼接口）\"><a href=\"#Extract-Interface（提炼接口）\" class=\"headerlink\" title=\"Extract Interface（提炼接口）\"></a>Extract Interface（提炼接口）</h5><p>若干客户使用类接口中的同一子集，或者两个类的接口有部分相同。（将相同的子集提炼到一个独立接口中）</p>\n<h5 id=\"Collapse-Hierarchy（折叠继承体系）\"><a href=\"#Collapse-Hierarchy（折叠继承体系）\" class=\"headerlink\" title=\"Collapse Hierarchy（折叠继承体系）\"></a>Collapse Hierarchy（折叠继承体系）</h5><p>超类和子类之间无太大区别。（将它们合为一体）</p>\n<h5 id=\"Form-Template-Method（塑造模板函数）\"><a href=\"#Form-Template-Method（塑造模板函数）\" class=\"headerlink\" title=\"Form Template Method（塑造模板函数）\"></a>Form Template Method（塑造模板函数）</h5><p>你有一些子类，其中相应的某些函数以相同顺序执行类似的操作，但各个操作的细节上有所不同。（将这些操作分别放进独立函数中，并保持它们都有相同的签名，于是原函数也就变得相同了。然后将原函数上移至超类）</p>\n<h5 id=\"Replace-Inheritance-with-Delegation（以委托取代继承）\"><a href=\"#Replace-Inheritance-with-Delegation（以委托取代继承）\" class=\"headerlink\" title=\"Replace Inheritance with Delegation（以委托取代继承）\"></a>Replace Inheritance with Delegation（以委托取代继承）</h5><p>某个子类只使用超类接口中的一部分，或是根本不需要继承而来的数据。（在子类中新建一个字段用以保存超类；调整子类函数，令它改而委托超类；然后去掉两者之间的继承关系）</p>\n<h5 id=\"Replace-Delegation-with-Inheritance（以继承取代委托）\"><a href=\"#Replace-Delegation-with-Inheritance（以继承取代委托）\" class=\"headerlink\" title=\"Replace Delegation with Inheritance（以继承取代委托）\"></a>Replace Delegation with Inheritance（以继承取代委托）</h5><p>你在两个类之间使用委托关系，并经常为整个接口编写许多极简单的委托函数。（让委托类继承受托类）</p>\n<h3 id=\"大型重构\"><a href=\"#大型重构\" class=\"headerlink\" title=\"大型重构\"></a>大型重构</h3><h5 id=\"Tease-Apart-Inheritance（梳理并分解继承体系）\"><a href=\"#Tease-Apart-Inheritance（梳理并分解继承体系）\" class=\"headerlink\" title=\"Tease Apart Inheritance（梳理并分解继承体系）\"></a>Tease Apart Inheritance（梳理并分解继承体系）</h5><p>某个继承体系同时承担两项责任。（建立两个继承体系，并通过委托关系让其中一个可以调用另一个）</p>\n<h5 id=\"Convert-Procedural-Design-to-Objects（将过程化设计转化为对象设计）\"><a href=\"#Convert-Procedural-Design-to-Objects（将过程化设计转化为对象设计）\" class=\"headerlink\" title=\"Convert Procedural Design to Objects（将过程化设计转化为对象设计）\"></a>Convert Procedural Design to Objects（将过程化设计转化为对象设计）</h5><p>你手上有一些传统过程化风格的代码。（将数据记录变成对象，将大块的行为分成小块，并将行为移入相关对象之中。）</p>\n<h5 id=\"Separate-Domain-from-Presentation（将领域和表述、显示分离）\"><a href=\"#Separate-Domain-from-Presentation（将领域和表述、显示分离）\" class=\"headerlink\" title=\"Separate Domain from Presentation（将领域和表述、显示分离）\"></a>Separate Domain from Presentation（将领域和表述、显示分离）</h5><p>某些GUI类之中包含了领域逻辑。（将领域逻辑分离出来，为它们建立独立的领域类）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OrderWindow</span> </span>&#123;&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OrderWindow</span></span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Extract-Hierarchy（提炼继承体系）\"><a href=\"#Extract-Hierarchy（提炼继承体系）\" class=\"headerlink\" title=\"Extract Hierarchy（提炼继承体系）\"></a>Extract Hierarchy（提炼继承体系）</h5><p>你有某个类做了太多工作，其中一部分工作是以大量条件表达式完成的。（建立继承体系，以一个子类表示一特殊情况）</p>\n","site":{"data":{}},"excerpt":"<h3 id=\"重新组织函数\"><a href=\"#重新组织函数\" class=\"headerlink\" title=\"重新组织函数\"></a>重新组织函数</h3><h5 id=\"Extract-Method-提炼函数\"><a href=\"#Extract-Method-提炼函数\" class=\"headerlink\" title=\"Extract Method (提炼函数)\"></a>Extract Method (提炼函数)</h5><p>(将这段代码放进一个独立函数中，并让函数名称解释该函数的用途)<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">printOwing</span><span class=\"params\">(<span class=\"keyword\">double</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  printBanner();</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">// print details</span></span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"name: \"</span> + _name);</span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"amout: \"</span> + amount);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">printOwing</span><span class=\"params\">(<span class=\"keyword\">double</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  printBanner();</span><br><span class=\"line\">  printDetails(amount);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span>  <span class=\"title\">printDetails</span><span class=\"params\">(<span class=\"keyword\">double</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"name: \"</span> + _name);</span><br><span class=\"line\">  System.out.println(<span class=\"string\">\"amout: \"</span> + amount);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>","more":"<h5 id=\"Inline-Method-内联函数\"><a href=\"#Inline-Method-内联函数\" class=\"headerlink\" title=\"Inline Method (内联函数)\"></a>Inline Method (内联函数)</h5><p>（在函数调用点插入函数体，然后移除该函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getRating</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (moreThanFiveLateDeliveries()) ? <span class=\"number\">2</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">moreThanFiveLateDeliveries</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> _numberOfLateDeliveries &gt; <span class=\"number\">5</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getRating</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (_numberOfLateDeliveries &gt; <span class=\"number\">5</span>) ? <span class=\"number\">2</span> : <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Inline-Temp-内联临时变量\"><a href=\"#Inline-Temp-内联临时变量\" class=\"headerlink\" title=\"Inline Temp (内联临时变量)\"></a>Inline Temp (内联临时变量)</h5><p>（将所有对该变量的引用动作，替换为对它赋值的那个表达式自身。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">double</span> basePrice = anOrder.basePrice();</span><br><span class=\"line\"><span class=\"keyword\">return</span> (basePrice &gt; <span class=\"number\">1000</span>);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">return</span> (anOrder.basePrice() &gt; <span class=\"number\">1000</span>);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Temp-with-Query（以查询取代临时变量）\"><a href=\"#Replace-Temp-with-Query（以查询取代临时变量）\" class=\"headerlink\" title=\"Replace Temp with Query（以查询取代临时变量）\"></a>Replace Temp with Query（以查询取代临时变量）</h5><p>(将这个表达式提炼到一个独立函数中，将这个临时变量的所有引用点替换为对新函数的调用。此后，新函数就可被其他函数使用。)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">double</span> basePrice = _quantity * _itemPrice;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (basePrice &gt; <span class=\"number\">1000</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (basePrice() &gt; <span class=\"number\">1000</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice() * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> basePrice * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">basePrice</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> _quantity * _itemPrice;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Explaining-Variable（引用解释性变量）\"><a href=\"#Introduce-Explaining-Variable（引用解释性变量）\" class=\"headerlink\" title=\"Introduce Explaining Variable（引用解释性变量）\"></a>Introduce Explaining Variable（引用解释性变量）</h5><p>(将该复杂表达或其中一部分的结果放进一个临时变量，以此变量名称来解释表达式的用途。)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> ((platform.toUpperCase().indexOf(<span class=\"string\">\"MAC\"</span>) &gt; -<span class=\"number\">1</span>) &amp;&amp;</span><br><span class=\"line\">    (browser.toUpperCase().indexOf(<span class=\"string\">\"IE\"</span>) &gt; -<span class=\"number\">1</span>) &amp;&amp;</span><br><span class=\"line\">    wasInitialized() &amp;&amp; resize &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">      </span><br><span class=\"line\">   <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> isMacOs = platform.toUpperCase().indexOf(<span class=\"string\">\"MAC\"</span>) &gt; -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> isIEBrowser = browser.toUpperCase().indexOf(<span class=\"string\">\"IE\"</span>) &gt; -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> wasResized = resize &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (isMacOs &amp;&amp; isIEBrowser &amp;&amp; wasInitialized() &amp;&amp; wasResized) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// do something</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Split-Temporary-Variable（分解临时变量）\"><a href=\"#Split-Temporary-Variable（分解临时变量）\" class=\"headerlink\" title=\"Split Temporary Variable（分解临时变量）\"></a>Split Temporary Variable（分解临时变量）</h5><p>（针对每次赋值，创造一个独立、对应的临时变量）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">double</span> temp = <span class=\"number\">2</span> * (_height + _width);</span><br><span class=\"line\">System.out.println(temp);</span><br><span class=\"line\">temp = _height * _width;</span><br><span class=\"line\">System.out.println(temp);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">double</span> perimeter = <span class=\"number\">2</span> * (_height + _width);</span><br><span class=\"line\">System.out.println(perimeter);</span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"keyword\">double</span> area = _height * _width;</span><br><span class=\"line\">System.out.println(area);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Remove-Assignments-to-Parameters\"><a href=\"#Remove-Assignments-to-Parameters\" class=\"headerlink\" title=\"Remove Assignments to Parameters\"></a>Remove Assignments to Parameters</h5><p>(以一个临时变量取代该参数的位置)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">discount</span><span class=\"params\">(<span class=\"keyword\">int</span> inputVal, <span class=\"keyword\">int</span> quantity, <span class=\"keyword\">int</span> yearToDate)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (inputVal &gt; <span class=\"number\">50</span>) &#123;</span><br><span class=\"line\">    inputVal -= <span class=\"number\">2</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">discount</span><span class=\"params\">(<span class=\"keyword\">int</span> inputVal, <span class=\"keyword\">int</span> quantity, <span class=\"keyword\">int</span> yearToDate)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> result = inputVal;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (inputVal &gt; <span class=\"number\">50</span>) &#123;</span><br><span class=\"line\">    result -= <span class=\"number\">2</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Method-with-Method-Object-以函数对象取代函数\"><a href=\"#Replace-Method-with-Method-Object-以函数对象取代函数\" class=\"headerlink\" title=\"Replace Method with Method Object(以函数对象取代函数)\"></a>Replace Method with Method Object(以函数对象取代函数)</h5><p>(将这个函数放进一个单独对象中，如此一来局部变量就成了对象内的字段。然后你可以在同一个对象中将这个大型函数分解为多个小型函数)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">price</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">double</span> primaryBasePrice</span><br><span class=\"line\">    <span class=\"keyword\">double</span> secondaryBasePrice</span><br><span class=\"line\">    ....</span><br><span class=\"line\">    <span class=\"keyword\">return</span> primaryBasePrice + secondaryBasePrice + ...</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">price</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> PriceCalculator(<span class=\"keyword\">this</span>).compute();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PriceCalculator</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">double</span> primaryBasePrice</span><br><span class=\"line\">  <span class=\"keyword\">double</span> secondaryBasePrice</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">compute</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> primaryBasePrice + secondaryBasePrice + ...</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Substitute-Algorithm（替换算法）\"><a href=\"#Substitute-Algorithm（替换算法）\" class=\"headerlink\" title=\"Substitute Algorithm（替换算法）\"></a>Substitute Algorithm（替换算法）</h5><p>（将函数本体替换为另一个算法）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">String <span class=\"title\">foundPerson</span><span class=\"params\">(String[] people)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; people.length;i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (people[i].equals(<span class=\"string\">\"Don\"</span>)) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"string\">\"Don\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\">String <span class=\"title\">foundPerson</span><span class=\"params\">(String[] people)</span> </span>&#123;</span><br><span class=\"line\">  List candidates = Arrays.asList(<span class=\"keyword\">new</span> String[] &#123;<span class=\"string\">\"Don\"</span>,<span class=\"string\">\"John\"</span>,<span class=\"string\">\"Kent\"</span>&#125;);</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; people.length;i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (candidates.contains(people[i])) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> people[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"在对象之间搬移特性\"><a href=\"#在对象之间搬移特性\" class=\"headerlink\" title=\"在对象之间搬移特性\"></a>在对象之间搬移特性</h3><h5 id=\"Move-Method-（搬移函数）\"><a href=\"#Move-Method-（搬移函数）\" class=\"headerlink\" title=\"Move Method （搬移函数）\"></a>Move Method （搬移函数）</h5><p>“搬移函数”是重构理论的支柱。如是一个类有太多行为，或如果一个类与另一个类有太多合作而形成高度耦合，我就会搬移函数。通过这种手段，可以使系统中的类更简单，这些类最终也将更干净利落地实现系统交付的任务。</p>\n<h5 id=\"Move-File-搬移字段\"><a href=\"#Move-File-搬移字段\" class=\"headerlink\" title=\"Move File (搬移字段)\"></a>Move File (搬移字段)</h5><p>在类之间移动状态和行为，是重构过程中必不可少的措施。随着系统的发展，你会发现自己需要新的类，并需要将现有的工作责任拖到新的类中。在这个星期看似合理而正确的设计决策，到了下个星期可能不再正确。这没问题。如果你从来没遇到这种情况，那才有问题。</p>\n<h5 id=\"Extract-Class（提炼类）\"><a href=\"#Extract-Class（提炼类）\" class=\"headerlink\" title=\"Extract Class（提炼类）\"></a>Extract Class（提炼类）</h5><p>（建立一个新类，将相关的字段和函数从旧类搬移到新类）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">  String name, officeAreaCode, officeNumber;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">getTelephoneNumber</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">  String name;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">getTelephoneNumber</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TelephoneNumber</span> </span>&#123;</span><br><span class=\"line\">  String areaCode, number;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">getTelephoneNumber</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Inline-Class（将类内联化）\"><a href=\"#Inline-Class（将类内联化）\" class=\"headerlink\" title=\"Inline Class（将类内联化）\"></a>Inline Class（将类内联化）</h5><p>将这个类的所有特性搬移到别一个类中，然后移除原类。</p>\n<h5 id=\"Hide-Delegate（隐藏”委托关系”）\"><a href=\"#Hide-Delegate（隐藏”委托关系”）\" class=\"headerlink\" title=\"Hide Delegate（隐藏”委托关系”）\"></a>Hide Delegate（隐藏”委托关系”）</h5><p>在服务类上建立客户所需的所有函数，用以隐藏委托关系。</p>\n<h5 id=\"Remove-Middle-Man（移除中间人）\"><a href=\"#Remove-Middle-Man（移除中间人）\" class=\"headerlink\" title=\"Remove Middle Man（移除中间人）\"></a>Remove Middle Man（移除中间人）</h5><p>让客户直接调用受托类</p>\n<h5 id=\"Introduce-Foreign-Method（引入外加函数）\"><a href=\"#Introduce-Foreign-Method（引入外加函数）\" class=\"headerlink\" title=\"Introduce Foreign Method（引入外加函数）\"></a>Introduce Foreign Method（引入外加函数）</h5><p>（在客户类中建立一个函数，并以第一参数形式传入一个服务类实例）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Date newStart = <span class=\"keyword\">new</span> Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate() + <span class=\"number\">1</span>);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">Date newStart = nextDay(previousEnd);</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Date <span class=\"title\">nextDay</span><span class=\"params\">(Date arg)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Date(previousEnd.getYear(), previousEnd.getMonth(), previousEnd.getDate());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Local-Extension（引入本地扩展）\"><a href=\"#Introduce-Local-Extension（引入本地扩展）\" class=\"headerlink\" title=\"Introduce Local Extension（引入本地扩展）\"></a>Introduce Local Extension（引入本地扩展）</h5><p>建立一个新类，使它包含这些额外函数。让这个扩展品成为源类的子类或包装类。</p>\n<h3 id=\"重新组织数据\"><a href=\"#重新组织数据\" class=\"headerlink\" title=\"重新组织数据\"></a>重新组织数据</h3><h5 id=\"Self-Encapsulate-Field（自封装字段）\"><a href=\"#Self-Encapsulate-Field（自封装字段）\" class=\"headerlink\" title=\"Self Encapsulate Field（自封装字段）\"></a>Self Encapsulate Field（自封装字段）</h5><p>（为这个字段建立取值/设值函数，并且只以这些函数来访问字段）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _low, _hight;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">includes</span> <span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> arg &gt;= _low &amp;&amp; arg &lt;= _high;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> _low, _hight;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">boolean</span> <span class=\"title\">includes</span> <span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> arg &gt;= getLow() &amp;&amp; arg &lt;= getHigh();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getLow</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> _low;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">getHight</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> _hight;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Data-Value-with-Object（以对象取代数据值）\"><a href=\"#Replace-Data-Value-with-Object（以对象取代数据值）\" class=\"headerlink\" title=\"Replace Data Value with Object（以对象取代数据值）\"></a>Replace Data Value with Object（以对象取代数据值）</h5><p>你有一个数据，需要与其他数据和行为一起使用才有意义。</p>\n<h5 id=\"Change-Value-to-Reference（将值对象改为引用对象）\"><a href=\"#Change-Value-to-Reference（将值对象改为引用对象）\" class=\"headerlink\" title=\"Change Value to Reference（将值对象改为引用对象）\"></a>Change Value to Reference（将值对象改为引用对象）</h5><p>你从一个类衍生出许多彼此相等的实例，希望将它们替换为同一个对象。<strong>将这个值对象变世引用对象</strong></p>\n<h5 id=\"Change-Reference-to-Value-（将引用对象改为值对象）\"><a href=\"#Change-Reference-to-Value-（将引用对象改为值对象）\" class=\"headerlink\" title=\"Change Reference to Value （将引用对象改为值对象）\"></a>Change Reference to Value （将引用对象改为值对象）</h5><p>你有一个引用对象，很小且不可变，而且不易管理。<strong>将它变成一个值对象</strong>。</p>\n<h5 id=\"Replace-Array-with-Object（以对象取代数组）\"><a href=\"#Replace-Array-with-Object（以对象取代数组）\" class=\"headerlink\" title=\"Replace Array with Object（以对象取代数组）\"></a>Replace Array with Object（以对象取代数组）</h5><p>你有一个数组，其中的元素各自代表不同的东西。</p>\n<p>(以对象替换数组，对于数组中的每个元素，以一个字段来表示)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String[] row = <span class=\"keyword\">new</span> String[<span class=\"number\">3</span>];</span><br><span class=\"line\">row[<span class=\"number\">0</span>] = <span class=\"string\">\"Liverpool\"</span>;</span><br><span class=\"line\">row[<span class=\"number\">1</span>] = <span class=\"string\">\"15\"</span>;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">Performance row = <span class=\"keyword\">new</span> Performance();</span><br><span class=\"line\">row.setName(<span class=\"string\">\"Liverpool\"</span>);</span><br><span class=\"line\">row.setWins(<span class=\"string\">\"15\"</span>);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Duplicate-Observed-Data（复制”被监视数据”）\"><a href=\"#Duplicate-Observed-Data（复制”被监视数据”）\" class=\"headerlink\" title=\"Duplicate Observed Data（复制”被监视数据”）\"></a>Duplicate Observed Data（复制”被监视数据”）</h5><p>你有一些领域数据置身于GUI控件中，而领域函数需要访问这些数据。（将该数据复制到一个领域对象中。建立一个Observer模式，用以同步领域对象和GUI对象内的重复数据）</p>\n<h5 id=\"Change-Unidirectional-Association-to-Bidirectional（将单向关联改为双向关联）\"><a href=\"#Change-Unidirectional-Association-to-Bidirectional（将单向关联改为双向关联）\" class=\"headerlink\" title=\"Change Unidirectional Association to Bidirectional（将单向关联改为双向关联）\"></a>Change Unidirectional Association to Bidirectional（将单向关联改为双向关联）</h5><p>两个类都需要使用对方特性，但其间只有一条单向连接。（添加一个返回指针，并使修改函数能够同时更新两条连接）</p>\n<p><strong>Change Bidirectional Association to Unidirectional （将双向关联改为单向关联）</strong></p>\n<p>两个类之间有双向关联，但其中一个类如今不再需要另一个类的特性。（去除不必要的关联）</p>\n<p><strong>Replace Magic Number with Symbolic Constant（以字面常量取代魔法数）</strong></p>\n<p>（创建一个常量，根据其意义为它命名，并将上述的字面数值替换为这个常量。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">potentialEnergy</span><span class=\"params\">(<span class=\"keyword\">double</span> mass, <span class=\"keyword\">double</span> height)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> mass * <span class=\"number\">9.81</span> * height;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">potentialEnergy</span><span class=\"params\">(<span class=\"keyword\">double</span> mass, <span class=\"keyword\">double</span> height)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> mass * GRAVITATIONAL_CONSTANT * height;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">double</span> GRAVITATIONAL_CONSTANT = <span class=\"number\">9.81</span>;</span><br></pre></td></tr></table></figure>\n<p><strong>Encapsulate Field（封装字段 ）</strong></p>\n<p>你的类中存在一个public字段。将它声明为private，并提供相应的访问函数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> String _name;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">private</span> String _name;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> _name;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setName</span><span class=\"params\">(String arg)</span> </span>&#123;_name = arg;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Encapsulate-Collection（封装集合）\"><a href=\"#Encapsulate-Collection（封装集合）\" class=\"headerlink\" title=\"Encapsulate Collection（封装集合）\"></a>Encapsulate Collection（封装集合）</h5><p>有个函数返回一个集合。（让这个函数返回该集合的一个只读副本，并在这个类中提供添加、移除集合元素的函数。）</p>\n<h5 id=\"Replace-Recore-with-Data-Class（以数据类取代记录）\"><a href=\"#Replace-Recore-with-Data-Class（以数据类取代记录）\" class=\"headerlink\" title=\"Replace Recore with Data Class（以数据类取代记录）\"></a>Replace Recore with Data Class（以数据类取代记录）</h5><p>你需要面对传统编程环境中的记录结构。为该记录创建一个”哑”数据对象。</p>\n<h5 id=\"Replace-Type-Code-with-Class（以类取代类型码）\"><a href=\"#Replace-Type-Code-with-Class（以类取代类型码）\" class=\"headerlink\" title=\"Replace Type Code with Class（以类取代类型码）\"></a>Replace Type Code with Class（以类取代类型码）</h5><p>类之中有一个数值类型码，但它并不影响类的行为。（以一个新的类替换该数值类型码。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> O, A, B, AB;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> bloodGroup;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BloodGroup</span> </span>&#123;</span><br><span class=\"line\">  BloodGroup O, A, B, AB</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Type-Code-with-Subclasses（以子类取代类型码）\"><a href=\"#Replace-Type-Code-with-Subclasses（以子类取代类型码）\" class=\"headerlink\" title=\"Replace Type Code with Subclasses（以子类取代类型码）\"></a>Replace Type Code with Subclasses（以子类取代类型码）</h5><p>你有一个不可变的类型码，它会影响类的行为：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> ENGINEER;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> SALESMAN;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Engineer</span> </span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Salesman</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Type-Code-with-State-Strategy（以State-Strategy取代类型码）\"><a href=\"#Replace-Type-Code-with-State-Strategy（以State-Strategy取代类型码）\" class=\"headerlink\" title=\"Replace Type Code with State/Strategy（以State/Strategy取代类型码）\"></a>Replace Type Code with State/Strategy（以State/Strategy取代类型码）</h5><p>你有一个类型码，它会影响类的行为，但你无法通过继承手法消除它。（以状态对象取代类型码）</p>\n<h5 id=\"Replace-Subclass-with-Fields（以字段取代子类）\"><a href=\"#Replace-Subclass-with-Fields（以字段取代子类）\" class=\"headerlink\" title=\"Replace Subclass with Fields（以字段取代子类）\"></a>Replace Subclass with Fields（以字段取代子类）</h5><p>你的各个子类的唯一差别只在”返回常量数据”的函数身上。修改这些函数，使它们返回超类中的某个（新增）字段，然后销毁子类</p>\n<h3 id=\"简化条件表达式\"><a href=\"#简化条件表达式\" class=\"headerlink\" title=\"简化条件表达式\"></a>简化条件表达式</h3><h5 id=\"Decompose-Conditional（分解条件表达式）\"><a href=\"#Decompose-Conditional（分解条件表达式）\" class=\"headerlink\" title=\"Decompose Conditional（分解条件表达式）\"></a>Decompose Conditional（分解条件表达式）</h5><p>（从if、then、else三个段落中分别提炼出独立函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (date.before (SUMMER_START) || date.after(SUMMER_END)) &#123;</span><br><span class=\"line\">  charge = quantity * _winterRate + _winterServiceCharge;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  charge = quantity * _summberRate;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (notSummer(date)) &#123;</span><br><span class=\"line\">  charge = winterCharge(quantity);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  charge = summerCharge(quantity);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Consolidate-Conditional-Expression（合并条件表达式）\"><a href=\"#Consolidate-Conditional-Expression（合并条件表达式）\" class=\"headerlink\" title=\"Consolidate Conditional Expression（合并条件表达式）\"></a>Consolidate Conditional Expression（合并条件表达式）</h5><p>你有一系列条件测试，都得到相同结果。（将这些测试合并为一个条件表达式，并将这个条件表达式提炼成为一个独立函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">disabilityAmount</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_seniority &lt; <span class=\"number\">2</span>) &#123; <span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_monthsDisabled &gt; <span class=\"number\">12</span>) &#123; <span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isPartTime) &#123; <span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">disabilityAmount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (isNotEligibleForDisability()) &#123;<span class=\"keyword\">return</span> <span class=\"number\">0</span>;&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Consolidate-Duplicate-Conditional-Fragments（合并重复的条件片段）\"><a href=\"#Consolidate-Duplicate-Conditional-Fragments（合并重复的条件片段）\" class=\"headerlink\" title=\"Consolidate Duplicate Conditional Fragments（合并重复的条件片段）\"></a>Consolidate Duplicate Conditional Fragments（合并重复的条件片段）</h5><p>将下面这段重复代码搬移到条件表达式之外。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (isSpecialDeal()) &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">  send();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">  send();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (isSpecialDeal()) &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.95</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  total = price * <span class=\"number\">0.98</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">send();</span><br></pre></td></tr></table></figure>\n<h5 id=\"Remove-Control-Flag（移除控制标记）\"><a href=\"#Remove-Control-Flag（移除控制标记）\" class=\"headerlink\" title=\"Remove Control Flag（移除控制标记）\"></a>Remove Control Flag（移除控制标记）</h5><p>以break语句或return语句取代控制标记</p>\n<h5 id=\"Replace-Nested-Conditional-with-Guard-Clauses（以卫语句取代嵌套条件表达式）\"><a href=\"#Replace-Nested-Conditional-with-Guard-Clauses（以卫语句取代嵌套条件表达式）\" class=\"headerlink\" title=\"Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件表达式）\"></a>Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件表达式）</h5><p>函数中的条件逻辑使人难以看清正常的执行路径。（使用卫语句表现所有特殊情况）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getPayAmount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">double</span> result;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isDead) &#123;</span><br><span class=\"line\">    result = deadAmount();</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (_isSeparated) &#123;</span><br><span class=\"line\">      result = separatedAmount();</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (_isRetired) &#123;</span><br><span class=\"line\">        result = retiredAmount();</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        result = normalPayAmount();</span><br><span class=\"line\">      &#125; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getPayAmount</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isDead) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> deadAmount();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isSeparated) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> separatedAmount();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (_isRetired) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> retiredAmount();</span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">  <span class=\"keyword\">return</span> normalPayAmount();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Conditional-with-Polymorphism（以多态取代条件表达式）\"><a href=\"#Replace-Conditional-with-Polymorphism（以多态取代条件表达式）\" class=\"headerlink\" title=\"Replace Conditional with Polymorphism（以多态取代条件表达式）\"></a>Replace Conditional with Polymorphism（以多态取代条件表达式）</h5><p>你手上有个条件表达式，它根据对象类型的不同而选择不同的行为。（将这个条件表达式的每个分支放进一个子类内的覆写函数中，然后将原始函数声明为抽象函数。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getSpeed</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">switch</span>(_type) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> EUROPEAN:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> getBaseSpeed;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> AFRICAN:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> getBaseSpeed() - getLoadFactor() * _numberOfCoconuts;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> NORWEGINA_BLUE:</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (_isNailed) ? <span class=\"number\">0</span> : getBaseSpeed(_voltage);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">\"Should be unreachable\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Bird</span> </span>&#123; <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"title\">getSpeed</span><span class=\"params\">()</span>&#125;</span></span><br><span class=\"line\"><span class=\"function\">class European extends Bird </span>&#123; getSpeed()&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">African</span> <span class=\"keyword\">extends</span> <span class=\"title\">Bird</span> </span>&#123; getSpeed()&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NorwegianBlue</span> <span class=\"keyword\">extends</span> <span class=\"title\">Bird</span> </span>&#123; getSpeed()&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Null-Object（引用Null对象）\"><a href=\"#Introduce-Null-Object（引用Null对象）\" class=\"headerlink\" title=\"Introduce Null Object（引用Null对象）\"></a>Introduce Null Object（引用Null对象）</h5><p>你需要再三检查某个对象是否为null。（将null值替换为null对象）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (customer == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">  plan = BillingPlan.basic();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  plan = customer.getPlan();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123; getPlan()&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NullCustomer</span> <span class=\"keyword\">extends</span> <span class=\"title\">Customer</span> </span>&#123;getPlan()&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Assertion（引入断言）\"><a href=\"#Introduce-Assertion（引入断言）\" class=\"headerlink\" title=\"Introduce Assertion（引入断言）\"></a>Introduce Assertion（引入断言）</h5><p>某一段代码需要对程序状态做出某种假设。以断言明确表现这种假设。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getExpenseLimit</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getExpenseLimit</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  Assert.isTrue (_expenseLimit != NULL_EXPENSE || _primaryProject != <span class=\"keyword\">null</span>);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (_expenseLimit != NULL_EXPENSE) ? _expenseLimit : _primaryProject.getMemberExpenseLimit();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"简化函数调用\"><a href=\"#简化函数调用\" class=\"headerlink\" title=\"简化函数调用\"></a>简化函数调用</h3><h5 id=\"Rename-Method（函数改名）\"><a href=\"#Rename-Method（函数改名）\" class=\"headerlink\" title=\"Rename Method（函数改名）\"></a>Rename Method（函数改名）</h5><p>函数的名称未能指示函数的用途。修改函数名称。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;getinvcdtlmt()&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;getInvoiceableCreditLimit()&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Add-Parameter（添加函数）\"><a href=\"#Add-Parameter（添加函数）\" class=\"headerlink\" title=\"Add Parameter（添加函数）\"></a>Add Parameter（添加函数）</h5><p>某个函数需要从调用端得到更多信息。（为些函数添加一个对象参数，让该对象带进函数所需的信息）</p>\n<h5 id=\"Remove-Parameter（移除参数）\"><a href=\"#Remove-Parameter（移除参数）\" class=\"headerlink\" title=\"Remove Parameter（移除参数）\"></a>Remove Parameter（移除参数）</h5><p>函数本体不再需要某个参数。将该参数去除。</p>\n<h5 id=\"Separate-Query-from-Modifier（将查询函数和修改函数分离）\"><a href=\"#Separate-Query-from-Modifier（将查询函数和修改函数分离）\" class=\"headerlink\" title=\"Separate Query from Modifier（将查询函数和修改函数分离）\"></a>Separate Query from Modifier（将查询函数和修改函数分离）</h5><p>某个函数既返回对象状态值，又修改对象状态。（建立两个不同的函数，其中一个负责查询，别一个负责修改。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;getTotalOutstandingAndSetReadyForSummaries()&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;</span><br><span class=\"line\">  getTotalOutstanding()</span><br><span class=\"line\">  setReadyForSummaries()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Parameterize-Method（令函数携带参数）\"><a href=\"#Parameterize-Method（令函数携带参数）\" class=\"headerlink\" title=\"Parameterize Method（令函数携带参数）\"></a>Parameterize Method（令函数携带参数）</h5><p>若干函数做了类似的工作，但在函数本体中却包含了不同的值。（建立单一函数，以参数表达那些不同的值。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123; </span><br><span class=\"line\">  fivePercentRaise();</span><br><span class=\"line\">  tenPercentRaise();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  raise(percentage);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）\"><a href=\"#Replace-Parameter-with-Explicit-Methods（以明确函数取代参数）\" class=\"headerlink\" title=\"Replace Parameter with Explicit Methods（以明确函数取代参数）\"></a>Replace Parameter with Explicit Methods（以明确函数取代参数）</h5><p>你有一个函数，其中完全取决于参数值而采取不同行为。（针对该参数的每一个可能值，建立一个独立函数。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setValue</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> value)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (name.equals(<span class=\"string\">\"height\"</span>)) &#123;</span><br><span class=\"line\">    _height = value;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (name.equals(<span class=\"string\">\"width\"</span>)) &#123;</span><br><span class=\"line\">    _width = value;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  Assert.shouldNeverReachHere();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setHeight</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  _height = arg;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">setWidth</span><span class=\"params\">(<span class=\"keyword\">int</span> arg)</span> </span>&#123;</span><br><span class=\"line\">  _width = arg;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Preserve-Whole-Object（保持对象完整）\"><a href=\"#Preserve-Whole-Object（保持对象完整）\" class=\"headerlink\" title=\"Preserve Whole Object（保持对象完整）\"></a>Preserve Whole Object（保持对象完整）</h5><p>你从某个对象中取出若干值，将它们作为某一次函数调用的参数。改为传递整个对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> low = daysTempRange().getLow();</span><br><span class=\"line\"><span class=\"keyword\">int</span> hight = daysTempRange().getHeight;</span><br><span class=\"line\">withinPlan = plan.withinRange(low, hight);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\">withinPlan = plan.withinRange(daysTempRange());</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Parameter-with-Methods（以函数取代参数）\"><a href=\"#Replace-Parameter-with-Methods（以函数取代参数）\" class=\"headerlink\" title=\"Replace Parameter with Methods（以函数取代参数）\"></a>Replace Parameter with Methods（以函数取代参数）</h5><p>对象调用某个函数，并将所得结果作为参数，传递给另一个函数。而接受该参数的函数本身也能够调用前一个函数。（让参数接受者去除该项参数，并直接调用前一个函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> basePrice = _quantity * _itemPrice;</span><br><span class=\"line\">discountLevel = getDiscountLevel();</span><br><span class=\"line\"><span class=\"keyword\">double</span> finalPrice = discountedPrice(basePrice, discountLevel);</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"keyword\">int</span> basePrice = _quantity * _itemPrice;</span><br><span class=\"line\"><span class=\"keyword\">double</span> finalPrice = discountedPrice(basePrice);</span><br></pre></td></tr></table></figure>\n<h5 id=\"Introduce-Parameter-Object（引入参数对象）\"><a href=\"#Introduce-Parameter-Object（引入参数对象）\" class=\"headerlink\" title=\"Introduce Parameter Object（引入参数对象）\"></a>Introduce Parameter Object（引入参数对象）</h5><p>某些参数总是很自然地同时出现。以一个对象取代这些参数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;</span><br><span class=\"line\">  amountInvoicedIn(start:Date, end: Date);</span><br><span class=\"line\">  amountReceived(start:Date, end: Date);</span><br><span class=\"line\">  amountOverdueln(start:Date, end: Date);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span> </span>&#123;</span><br><span class=\"line\">  amountInvoicedIn(DateRange);</span><br><span class=\"line\">  amountReceived(DateRange);</span><br><span class=\"line\">  amountOverdueln(DateRange);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Remove-Setting-Method（移除设值函数）\"><a href=\"#Remove-Setting-Method（移除设值函数）\" class=\"headerlink\" title=\"Remove Setting Method（移除设值函数）\"></a>Remove Setting Method（移除设值函数）</h5><p>类中的某个字段应该在对象创建时候被设值，然后就不再改变。（去掉该字段的所有设值函数）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  Immutable;</span><br><span class=\"line\">  setImmutableValue()&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Employee</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Hide-Method（隐藏函数）\"><a href=\"#Hide-Method（隐藏函数）\" class=\"headerlink\" title=\"Hide Method（隐藏函数）\"></a>Hide Method（隐藏函数）</h5><p>有一个函数，从来没有被其他任何类用到。（将这个函数修改为private）</p>\n<h5 id=\"Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）\"><a href=\"#Replace-Constructor-with-Factory-Method（以工厂函数取代构造函数）\" class=\"headerlink\" title=\"Replace Constructor with Factory Method（以工厂函数取代构造函数）\"></a>Replace Constructor with Factory Method（以工厂函数取代构造函数）</h5><p>你希望在创建对象时不仅仅是做简单的构建动作。（将构造函数替换为工厂函数。）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Employee(<span class=\"keyword\">int</span> type) &#123;</span><br><span class=\"line\">  _type = type</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> Employee <span class=\"title\">create</span><span class=\"params\">(<span class=\"keyword\">int</span> type)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Employee(type);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Encapsulate-Downcast（封装向下转型）\"><a href=\"#Encapsulate-Downcast（封装向下转型）\" class=\"headerlink\" title=\"Encapsulate Downcast（封装向下转型）\"></a>Encapsulate Downcast（封装向下转型）</h5><p>某个函数返回的对象，需要由函数调用者执行向下转型(downcast)。（将向下转型动作移到函数中）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">Object <span class=\"title\">lastReading</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> readings.lastElement();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\">Reading <span class=\"title\">lastReading</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (Reading) readings.lastElement();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Error-Code-with-Exception（以异常取代错误码）\"><a href=\"#Replace-Error-Code-with-Exception（以异常取代错误码）\" class=\"headerlink\" title=\"Replace Error Code with Exception（以异常取代错误码）\"></a>Replace Error Code with Exception（以异常取代错误码）</h5><p>某个函数返回一个特定的代码，用以表示某种错误情况。（改用异常）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">withdraw</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (amount &gt; _balance) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    _balance -= amount;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">withdraw</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span> <span class=\"keyword\">throws</span> BalanceException </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (amount &gt; _balance) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> BalanceException();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  _balance -= amount;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Replace-Exception-with-Test（以测试取代异常）\"><a href=\"#Replace-Exception-with-Test（以测试取代异常）\" class=\"headerlink\" title=\"Replace Exception with Test（以测试取代异常）\"></a>Replace Exception with Test（以测试取代异常）</h5><p>面对一个调用者可以预先检查的条件，你抛出了一个异常。(修改调用者，使它在调用函数之前先做检查)</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getValueForPeriod</span><span class=\"params\">(<span class=\"keyword\">int</span> periodNumber)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> _values[periodNumber];</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span>(ArrayIndexOutOfBoundsException e) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">double</span> <span class=\"title\">getValueForPeriod</span><span class=\"params\">(<span class=\"keyword\">int</span> periodNumber)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (periodNumber &gt;= _values.length) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> _values[periodNumber];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"处理概括关系\"><a href=\"#处理概括关系\" class=\"headerlink\" title=\"处理概括关系\"></a>处理概括关系</h3><h5 id=\"Pull-Up-Field（字段上移）\"><a href=\"#Pull-Up-Field（字段上移）\" class=\"headerlink\" title=\"Pull Up Field（字段上移）\"></a>Pull Up Field（字段上移）</h5><p>两个子类拥有相同的字段。（将该字段移至超类）</p>\n<h5 id=\"Pull-Up-Method（函数上移）\"><a href=\"#Pull-Up-Method（函数上移）\" class=\"headerlink\" title=\"Pull Up Method（函数上移）\"></a>Pull Up Method（函数上移）</h5><p>有些函数，在各个子类中产生完全相同的结果。（将该函数移至超类）</p>\n<h5 id=\"Pull-Up-Constructor-Body（构造函数本体上移）\"><a href=\"#Pull-Up-Constructor-Body（构造函数本体上移）\" class=\"headerlink\" title=\"Pull Up Constructor Body（构造函数本体上移）\"></a>Pull Up Constructor Body（构造函数本体上移）</h5><p>你在各个子类中拥有一些构造函数，它们的本体几乎完全一致。（在超类中新建一个构造函数，并在子类的构造函数中调用它）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Manager</span> <span class=\"keyword\">extends</span> <span class=\"title\">Employee</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Manager</span><span class=\"params\">(String name,String id,<span class=\"keyword\">int</span> grade)</span> </span>&#123;</span><br><span class=\"line\">    _name = name;</span><br><span class=\"line\">    _id = id;</span><br><span class=\"line\">    _grade = grade;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Manager</span><span class=\"params\">(String name, String id, <span class=\"keyword\">int</span> grade)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">super</span>(name, id);</span><br><span class=\"line\">  _grade = grade;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Push-Down-Method（函数下移）\"><a href=\"#Push-Down-Method（函数下移）\" class=\"headerlink\" title=\"Push Down Method（函数下移）\"></a>Push Down Method（函数下移）</h5><p>超类中的某个函数只与部分（而非全部）子类有关。（将这个函数移到相关子类去）</p>\n<h5 id=\"Push-Down-Field（字段下移）\"><a href=\"#Push-Down-Field（字段下移）\" class=\"headerlink\" title=\"Push Down Field（字段下移）\"></a>Push Down Field（字段下移）</h5><p>超类中的某个字段只被部分（而非全部）子类用到。（将这个字段移到需要它的那些子类去）</p>\n<h5 id=\"Extract-Subclass（提炼子类）\"><a href=\"#Extract-Subclass（提炼子类）\" class=\"headerlink\" title=\"Extract Subclass（提炼子类）\"></a>Extract Subclass（提炼子类）</h5><p>类中的某些特性只被某些（而非全部）实例用到。（新建一个子类，将上面所说的那一部分特性移到子类中）</p>\n<h5 id=\"Extract-SuperClass（提炼超类）\"><a href=\"#Extract-SuperClass（提炼超类）\" class=\"headerlink\" title=\"Extract SuperClass（提炼超类）\"></a>Extract SuperClass（提炼超类）</h5><p>两个类有相似特性。（为这两个类建立一个超类，将相同特性移至超类）</p>\n<h5 id=\"Extract-Interface（提炼接口）\"><a href=\"#Extract-Interface（提炼接口）\" class=\"headerlink\" title=\"Extract Interface（提炼接口）\"></a>Extract Interface（提炼接口）</h5><p>若干客户使用类接口中的同一子集，或者两个类的接口有部分相同。（将相同的子集提炼到一个独立接口中）</p>\n<h5 id=\"Collapse-Hierarchy（折叠继承体系）\"><a href=\"#Collapse-Hierarchy（折叠继承体系）\" class=\"headerlink\" title=\"Collapse Hierarchy（折叠继承体系）\"></a>Collapse Hierarchy（折叠继承体系）</h5><p>超类和子类之间无太大区别。（将它们合为一体）</p>\n<h5 id=\"Form-Template-Method（塑造模板函数）\"><a href=\"#Form-Template-Method（塑造模板函数）\" class=\"headerlink\" title=\"Form Template Method（塑造模板函数）\"></a>Form Template Method（塑造模板函数）</h5><p>你有一些子类，其中相应的某些函数以相同顺序执行类似的操作，但各个操作的细节上有所不同。（将这些操作分别放进独立函数中，并保持它们都有相同的签名，于是原函数也就变得相同了。然后将原函数上移至超类）</p>\n<h5 id=\"Replace-Inheritance-with-Delegation（以委托取代继承）\"><a href=\"#Replace-Inheritance-with-Delegation（以委托取代继承）\" class=\"headerlink\" title=\"Replace Inheritance with Delegation（以委托取代继承）\"></a>Replace Inheritance with Delegation（以委托取代继承）</h5><p>某个子类只使用超类接口中的一部分，或是根本不需要继承而来的数据。（在子类中新建一个字段用以保存超类；调整子类函数，令它改而委托超类；然后去掉两者之间的继承关系）</p>\n<h5 id=\"Replace-Delegation-with-Inheritance（以继承取代委托）\"><a href=\"#Replace-Delegation-with-Inheritance（以继承取代委托）\" class=\"headerlink\" title=\"Replace Delegation with Inheritance（以继承取代委托）\"></a>Replace Delegation with Inheritance（以继承取代委托）</h5><p>你在两个类之间使用委托关系，并经常为整个接口编写许多极简单的委托函数。（让委托类继承受托类）</p>\n<h3 id=\"大型重构\"><a href=\"#大型重构\" class=\"headerlink\" title=\"大型重构\"></a>大型重构</h3><h5 id=\"Tease-Apart-Inheritance（梳理并分解继承体系）\"><a href=\"#Tease-Apart-Inheritance（梳理并分解继承体系）\" class=\"headerlink\" title=\"Tease Apart Inheritance（梳理并分解继承体系）\"></a>Tease Apart Inheritance（梳理并分解继承体系）</h5><p>某个继承体系同时承担两项责任。（建立两个继承体系，并通过委托关系让其中一个可以调用另一个）</p>\n<h5 id=\"Convert-Procedural-Design-to-Objects（将过程化设计转化为对象设计）\"><a href=\"#Convert-Procedural-Design-to-Objects（将过程化设计转化为对象设计）\" class=\"headerlink\" title=\"Convert Procedural Design to Objects（将过程化设计转化为对象设计）\"></a>Convert Procedural Design to Objects（将过程化设计转化为对象设计）</h5><p>你手上有一些传统过程化风格的代码。（将数据记录变成对象，将大块的行为分成小块，并将行为移入相关对象之中。）</p>\n<h5 id=\"Separate-Domain-from-Presentation（将领域和表述、显示分离）\"><a href=\"#Separate-Domain-from-Presentation（将领域和表述、显示分离）\" class=\"headerlink\" title=\"Separate Domain from Presentation（将领域和表述、显示分离）\"></a>Separate Domain from Presentation（将领域和表述、显示分离）</h5><p>某些GUI类之中包含了领域逻辑。（将领域逻辑分离出来，为它们建立独立的领域类）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OrderWindow</span> </span>&#123;&#125;</span><br><span class=\"line\">==&gt;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">OrderWindow</span></span>&#123;&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Order</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"Extract-Hierarchy（提炼继承体系）\"><a href=\"#Extract-Hierarchy（提炼继承体系）\" class=\"headerlink\" title=\"Extract Hierarchy（提炼继承体系）\"></a>Extract Hierarchy（提炼继承体系）</h5><p>你有某个类做了太多工作，其中一部分工作是以大量条件表达式完成的。（建立继承体系，以一个子类表示一特殊情况）</p>"},{"title":"refactor","date":"2017-02-09T08:53:10.000Z","_content":"\n## 重构\n\n- 如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构那个程序，使特性的添加比较容易进行，然后现添加特性\n- 重构前，先检查自己是否有一套可靠的测试机制，这些测试必须有自我检验能力\n- 重构技术就是以微小的步伐修改程序，如果你犯下错误，很容易使可发现它。\n- 任何一个傻瓜都能写出计算机可以理解的代码。唯有写出人类容易理解的代码，才是优秀的程序员。\n- 当你感觉需要撰写注释时，请先尝试重构，试着让所有注释都变得多余。\n\n\n<!--more-->\n\n## 重构原则\n\n#### 何为重构\n\n> **重构(名词)**：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本\n>\n> **重构(动词)**：使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。\n\n#### 为何重构\n\n- 重构改进软件设计\n- 重构使软件更容易理解\n- 重构帮助找到BUG\n- 重构提高编程速度\n\n#### 何时重构\n**三次法则（事不过三，三则重构）**\n- 添加功能时重构\n- 修补错误时重构\n- 复审代码时重构\n\n## 代码的坏味道\n\n- **Duplicated Code(重复代码)**\n\n- **Long Method(过长函数)**\n\n- **Large Class(过大的类)**\n\n- **Long Parameter List(过长参数列)**\n\n- **Divergent Change(发散式变化)**\n\n  （如果某个类经常因为不同的原因在不同的方向上发生变化，Divergent Change就出现了）\n\n- **Shotgun Surgery(霰弹式修改)**\n\n  （Shotgun Surgery类亿Divergent Change，但恰恰相反。如果每遇到某种变化，你都必须在许多不同的类内做许多小修改，你所面临的坏味道就是Shotgun Surgery）\n\n- **Feature Envy(依恋情结)**\n\n  （函数对某个类的兴趣高过对自己所处类的兴趣）\n\n- **Data Clumps(数据泥团)**\n\n  （两个类中相同的字段、许多函数签名中相同的参数。这些总是绑在一起出现的数据真应该拥有属于它们自己的对象。）\n\n- **Primitive Obsession(基本类型偏执)**\n\n  （对象技术的新手通常不愿意在小任务上运用小对象—像是结合数值和币种的money类、由一个超始值和一个结束值组成的range类、电话号码或邮政编码）\n\n- **Switch Statements(switch惊悚现身)**\n\n  （你常会发现同样的switch语句散布于不同地点。如果要为它添加一个新的case子句，就必须找到所有switch语句并修改它们。面向对象中的多态概念可为此带来优雅的解决办法。）\n\n- **Parallel Inheritance Hierarchies(平行继承体系)**\n\n  （Parallel Inheritance Hierarchies其实是Shotgun Surgery的特殊情况。在这种情况下，每当你为某个类增加一个子类，必须也为另一相类增加一个子类。如果你发现某个继承体系的类名称前缀和别一个继承体系的类名称前缀完全相同，便是闻到了这种坏味道。）\n\n- **Lazy Class(冗赘类)**\n\n  （你所创建的每一个类，都得有人去理解它、维护它，这些工作都是要花钱的。如果一个类的所得不值其身价，它就应该消失。）\n\n- **Speculative Generality(夸夸其谈未来性)**\n\n  （企图以各式各样的钩子和特殊情况来处理一些非必要的事情，这种坏味道就出现了。）\n\n- **Temporary Field(令人迷惑的暂时字段)**\n\n  （某个实例变量仅为某种特定情况而设。这样的代码让人不易理解，因为你通常认为对象在所有时候都需要它的所有变量。）\n\n- **Message Chains(过度耦合的消息链)**\n\n  （向一个对象请求另一个对象，然后再向后者请求另一个对象，然后再请求别一个对象……这就是消息链。采取这种方式，意味客户代码将与查找过程中的导航结构紧密耦合。一旦对象间的关系发生变化，客户端就不得不做了相应修改。）\n\n- **Middle Man(中间人)**\n\n  （对象的基本特征之一就是封装—对外部世界隐藏其内部细节。封装往往伴随委托。但是人们可能过度运用委托。你也许会看到某个类接口有一关的函数都委托给其他类，这样就是过度运用。）\n\n- **Inappropriate Intimacy(狎昵关系)**\n\n  （有时你会看到两个类过于亲密，花费太多时间去探究彼此的private成分。对于这样过分狎昵的类必须拆散。）\n\n- **Alternative Classes with Different Interfaces(异曲同工的类)**\n\n  （两个函数做同一件事，却有着不同的签名）\n\n- **Incomplete Library Class(不完美的库类)**\n\n- **Data Class(纯稚的数据类)**\n\n  （它们拥有一些字段，以及用于访问、读写这些字段的函数，除此之外一无长物。这样的类只是一种不会说话的数据容器，它们几乎一定被其它类过分细琐地操控着。对于那些不该被其他类修改的字段。请提示get/set）\n\n- **Refused Bequest(被拒绝的遗赠)**\n\n  (子类应该继承超类的函数和数据。但有时子类不需要继承一些无关的数据。这样一来，超类就只持有所有子类共享的东西。—所有超类都应该是抽象的)\n\n- **Comments(过多的注释)**\n\n  ​\n## 构筑测试体系 \n\n- 确保所有测试都完全自动化，让它们检查自己的测试结果。\n- 一套测试就是一个强大的bug侦测器，能够大大缩减查找bug所需要的时间。\n- 频繁地运行测试。每次编译请把测试也考虑进去—每天至少执行每个测试一次。\n- 每当你收到bug报告，请先写一个单元测试来暴露这个bug。\n- 编写未臻完善的测试并实际运行，好过对完美测试的无尽等待。\n- 考虑可能出错的边界条件，把测试火力集中在那儿。\n- 当事情被认为应该会出错时，别忘了检查是否抛出了预期的异常。\n- 不要因为测试无法捕捉所有bug就不写测试，因为测试的确可以捕捉到大多数bug。\n\n## 重构列表\n\n重构的基本技巧———小步前进，频繁测试","source":"_posts/refactor/refactor.md","raw":"---\ntitle: refactor\ndate: 2017-02-09 16:53:10\ntags: read\n---\n\n## 重构\n\n- 如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构那个程序，使特性的添加比较容易进行，然后现添加特性\n- 重构前，先检查自己是否有一套可靠的测试机制，这些测试必须有自我检验能力\n- 重构技术就是以微小的步伐修改程序，如果你犯下错误，很容易使可发现它。\n- 任何一个傻瓜都能写出计算机可以理解的代码。唯有写出人类容易理解的代码，才是优秀的程序员。\n- 当你感觉需要撰写注释时，请先尝试重构，试着让所有注释都变得多余。\n\n\n<!--more-->\n\n## 重构原则\n\n#### 何为重构\n\n> **重构(名词)**：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本\n>\n> **重构(动词)**：使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。\n\n#### 为何重构\n\n- 重构改进软件设计\n- 重构使软件更容易理解\n- 重构帮助找到BUG\n- 重构提高编程速度\n\n#### 何时重构\n**三次法则（事不过三，三则重构）**\n- 添加功能时重构\n- 修补错误时重构\n- 复审代码时重构\n\n## 代码的坏味道\n\n- **Duplicated Code(重复代码)**\n\n- **Long Method(过长函数)**\n\n- **Large Class(过大的类)**\n\n- **Long Parameter List(过长参数列)**\n\n- **Divergent Change(发散式变化)**\n\n  （如果某个类经常因为不同的原因在不同的方向上发生变化，Divergent Change就出现了）\n\n- **Shotgun Surgery(霰弹式修改)**\n\n  （Shotgun Surgery类亿Divergent Change，但恰恰相反。如果每遇到某种变化，你都必须在许多不同的类内做许多小修改，你所面临的坏味道就是Shotgun Surgery）\n\n- **Feature Envy(依恋情结)**\n\n  （函数对某个类的兴趣高过对自己所处类的兴趣）\n\n- **Data Clumps(数据泥团)**\n\n  （两个类中相同的字段、许多函数签名中相同的参数。这些总是绑在一起出现的数据真应该拥有属于它们自己的对象。）\n\n- **Primitive Obsession(基本类型偏执)**\n\n  （对象技术的新手通常不愿意在小任务上运用小对象—像是结合数值和币种的money类、由一个超始值和一个结束值组成的range类、电话号码或邮政编码）\n\n- **Switch Statements(switch惊悚现身)**\n\n  （你常会发现同样的switch语句散布于不同地点。如果要为它添加一个新的case子句，就必须找到所有switch语句并修改它们。面向对象中的多态概念可为此带来优雅的解决办法。）\n\n- **Parallel Inheritance Hierarchies(平行继承体系)**\n\n  （Parallel Inheritance Hierarchies其实是Shotgun Surgery的特殊情况。在这种情况下，每当你为某个类增加一个子类，必须也为另一相类增加一个子类。如果你发现某个继承体系的类名称前缀和别一个继承体系的类名称前缀完全相同，便是闻到了这种坏味道。）\n\n- **Lazy Class(冗赘类)**\n\n  （你所创建的每一个类，都得有人去理解它、维护它，这些工作都是要花钱的。如果一个类的所得不值其身价，它就应该消失。）\n\n- **Speculative Generality(夸夸其谈未来性)**\n\n  （企图以各式各样的钩子和特殊情况来处理一些非必要的事情，这种坏味道就出现了。）\n\n- **Temporary Field(令人迷惑的暂时字段)**\n\n  （某个实例变量仅为某种特定情况而设。这样的代码让人不易理解，因为你通常认为对象在所有时候都需要它的所有变量。）\n\n- **Message Chains(过度耦合的消息链)**\n\n  （向一个对象请求另一个对象，然后再向后者请求另一个对象，然后再请求别一个对象……这就是消息链。采取这种方式，意味客户代码将与查找过程中的导航结构紧密耦合。一旦对象间的关系发生变化，客户端就不得不做了相应修改。）\n\n- **Middle Man(中间人)**\n\n  （对象的基本特征之一就是封装—对外部世界隐藏其内部细节。封装往往伴随委托。但是人们可能过度运用委托。你也许会看到某个类接口有一关的函数都委托给其他类，这样就是过度运用。）\n\n- **Inappropriate Intimacy(狎昵关系)**\n\n  （有时你会看到两个类过于亲密，花费太多时间去探究彼此的private成分。对于这样过分狎昵的类必须拆散。）\n\n- **Alternative Classes with Different Interfaces(异曲同工的类)**\n\n  （两个函数做同一件事，却有着不同的签名）\n\n- **Incomplete Library Class(不完美的库类)**\n\n- **Data Class(纯稚的数据类)**\n\n  （它们拥有一些字段，以及用于访问、读写这些字段的函数，除此之外一无长物。这样的类只是一种不会说话的数据容器，它们几乎一定被其它类过分细琐地操控着。对于那些不该被其他类修改的字段。请提示get/set）\n\n- **Refused Bequest(被拒绝的遗赠)**\n\n  (子类应该继承超类的函数和数据。但有时子类不需要继承一些无关的数据。这样一来，超类就只持有所有子类共享的东西。—所有超类都应该是抽象的)\n\n- **Comments(过多的注释)**\n\n  ​\n## 构筑测试体系 \n\n- 确保所有测试都完全自动化，让它们检查自己的测试结果。\n- 一套测试就是一个强大的bug侦测器，能够大大缩减查找bug所需要的时间。\n- 频繁地运行测试。每次编译请把测试也考虑进去—每天至少执行每个测试一次。\n- 每当你收到bug报告，请先写一个单元测试来暴露这个bug。\n- 编写未臻完善的测试并实际运行，好过对完美测试的无尽等待。\n- 考虑可能出错的边界条件，把测试火力集中在那儿。\n- 当事情被认为应该会出错时，别忘了检查是否抛出了预期的异常。\n- 不要因为测试无法捕捉所有bug就不写测试，因为测试的确可以捕捉到大多数bug。\n\n## 重构列表\n\n重构的基本技巧———小步前进，频繁测试","slug":"refactor/refactor","published":1,"updated":"2018-01-31T09:35:37.819Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fu003wizcbanoa4je6","content":"<h2 id=\"重构\"><a href=\"#重构\" class=\"headerlink\" title=\"重构\"></a>重构</h2><ul>\n<li>如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构那个程序，使特性的添加比较容易进行，然后现添加特性</li>\n<li>重构前，先检查自己是否有一套可靠的测试机制，这些测试必须有自我检验能力</li>\n<li>重构技术就是以微小的步伐修改程序，如果你犯下错误，很容易使可发现它。</li>\n<li>任何一个傻瓜都能写出计算机可以理解的代码。唯有写出人类容易理解的代码，才是优秀的程序员。</li>\n<li>当你感觉需要撰写注释时，请先尝试重构，试着让所有注释都变得多余。</li>\n</ul>\n<a id=\"more\"></a>\n<h2 id=\"重构原则\"><a href=\"#重构原则\" class=\"headerlink\" title=\"重构原则\"></a>重构原则</h2><h4 id=\"何为重构\"><a href=\"#何为重构\" class=\"headerlink\" title=\"何为重构\"></a>何为重构</h4><blockquote>\n<p><strong>重构(名词)</strong>：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本</p>\n<p><strong>重构(动词)</strong>：使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。</p>\n</blockquote>\n<h4 id=\"为何重构\"><a href=\"#为何重构\" class=\"headerlink\" title=\"为何重构\"></a>为何重构</h4><ul>\n<li>重构改进软件设计</li>\n<li>重构使软件更容易理解</li>\n<li>重构帮助找到BUG</li>\n<li>重构提高编程速度</li>\n</ul>\n<h4 id=\"何时重构\"><a href=\"#何时重构\" class=\"headerlink\" title=\"何时重构\"></a>何时重构</h4><p><strong>三次法则（事不过三，三则重构）</strong></p>\n<ul>\n<li>添加功能时重构</li>\n<li>修补错误时重构</li>\n<li>复审代码时重构</li>\n</ul>\n<h2 id=\"代码的坏味道\"><a href=\"#代码的坏味道\" class=\"headerlink\" title=\"代码的坏味道\"></a>代码的坏味道</h2><ul>\n<li><p><strong>Duplicated Code(重复代码)</strong></p>\n</li>\n<li><p><strong>Long Method(过长函数)</strong></p>\n</li>\n<li><p><strong>Large Class(过大的类)</strong></p>\n</li>\n<li><p><strong>Long Parameter List(过长参数列)</strong></p>\n</li>\n<li><p><strong>Divergent Change(发散式变化)</strong></p>\n<p>（如果某个类经常因为不同的原因在不同的方向上发生变化，Divergent Change就出现了）</p>\n</li>\n<li><p><strong>Shotgun Surgery(霰弹式修改)</strong></p>\n<p>（Shotgun Surgery类亿Divergent Change，但恰恰相反。如果每遇到某种变化，你都必须在许多不同的类内做许多小修改，你所面临的坏味道就是Shotgun Surgery）</p>\n</li>\n<li><p><strong>Feature Envy(依恋情结)</strong></p>\n<p>（函数对某个类的兴趣高过对自己所处类的兴趣）</p>\n</li>\n<li><p><strong>Data Clumps(数据泥团)</strong></p>\n<p>（两个类中相同的字段、许多函数签名中相同的参数。这些总是绑在一起出现的数据真应该拥有属于它们自己的对象。）</p>\n</li>\n<li><p><strong>Primitive Obsession(基本类型偏执)</strong></p>\n<p>（对象技术的新手通常不愿意在小任务上运用小对象—像是结合数值和币种的money类、由一个超始值和一个结束值组成的range类、电话号码或邮政编码）</p>\n</li>\n<li><p><strong>Switch Statements(switch惊悚现身)</strong></p>\n<p>（你常会发现同样的switch语句散布于不同地点。如果要为它添加一个新的case子句，就必须找到所有switch语句并修改它们。面向对象中的多态概念可为此带来优雅的解决办法。）</p>\n</li>\n<li><p><strong>Parallel Inheritance Hierarchies(平行继承体系)</strong></p>\n<p>（Parallel Inheritance Hierarchies其实是Shotgun Surgery的特殊情况。在这种情况下，每当你为某个类增加一个子类，必须也为另一相类增加一个子类。如果你发现某个继承体系的类名称前缀和别一个继承体系的类名称前缀完全相同，便是闻到了这种坏味道。）</p>\n</li>\n<li><p><strong>Lazy Class(冗赘类)</strong></p>\n<p>（你所创建的每一个类，都得有人去理解它、维护它，这些工作都是要花钱的。如果一个类的所得不值其身价，它就应该消失。）</p>\n</li>\n<li><p><strong>Speculative Generality(夸夸其谈未来性)</strong></p>\n<p>（企图以各式各样的钩子和特殊情况来处理一些非必要的事情，这种坏味道就出现了。）</p>\n</li>\n<li><p><strong>Temporary Field(令人迷惑的暂时字段)</strong></p>\n<p>（某个实例变量仅为某种特定情况而设。这样的代码让人不易理解，因为你通常认为对象在所有时候都需要它的所有变量。）</p>\n</li>\n<li><p><strong>Message Chains(过度耦合的消息链)</strong></p>\n<p>（向一个对象请求另一个对象，然后再向后者请求另一个对象，然后再请求别一个对象……这就是消息链。采取这种方式，意味客户代码将与查找过程中的导航结构紧密耦合。一旦对象间的关系发生变化，客户端就不得不做了相应修改。）</p>\n</li>\n<li><p><strong>Middle Man(中间人)</strong></p>\n<p>（对象的基本特征之一就是封装—对外部世界隐藏其内部细节。封装往往伴随委托。但是人们可能过度运用委托。你也许会看到某个类接口有一关的函数都委托给其他类，这样就是过度运用。）</p>\n</li>\n<li><p><strong>Inappropriate Intimacy(狎昵关系)</strong></p>\n<p>（有时你会看到两个类过于亲密，花费太多时间去探究彼此的private成分。对于这样过分狎昵的类必须拆散。）</p>\n</li>\n<li><p><strong>Alternative Classes with Different Interfaces(异曲同工的类)</strong></p>\n<p>（两个函数做同一件事，却有着不同的签名）</p>\n</li>\n<li><p><strong>Incomplete Library Class(不完美的库类)</strong></p>\n</li>\n<li><p><strong>Data Class(纯稚的数据类)</strong></p>\n<p>（它们拥有一些字段，以及用于访问、读写这些字段的函数，除此之外一无长物。这样的类只是一种不会说话的数据容器，它们几乎一定被其它类过分细琐地操控着。对于那些不该被其他类修改的字段。请提示get/set）</p>\n</li>\n<li><p><strong>Refused Bequest(被拒绝的遗赠)</strong></p>\n<p>(子类应该继承超类的函数和数据。但有时子类不需要继承一些无关的数据。这样一来，超类就只持有所有子类共享的东西。—所有超类都应该是抽象的)</p>\n</li>\n<li><p><strong>Comments(过多的注释)</strong></p>\n<p>​</p>\n<h2 id=\"构筑测试体系\"><a href=\"#构筑测试体系\" class=\"headerlink\" title=\"构筑测试体系\"></a>构筑测试体系</h2></li>\n<li><p>确保所有测试都完全自动化，让它们检查自己的测试结果。</p>\n</li>\n<li>一套测试就是一个强大的bug侦测器，能够大大缩减查找bug所需要的时间。</li>\n<li>频繁地运行测试。每次编译请把测试也考虑进去—每天至少执行每个测试一次。</li>\n<li>每当你收到bug报告，请先写一个单元测试来暴露这个bug。</li>\n<li>编写未臻完善的测试并实际运行，好过对完美测试的无尽等待。</li>\n<li>考虑可能出错的边界条件，把测试火力集中在那儿。</li>\n<li>当事情被认为应该会出错时，别忘了检查是否抛出了预期的异常。</li>\n<li>不要因为测试无法捕捉所有bug就不写测试，因为测试的确可以捕捉到大多数bug。</li>\n</ul>\n<h2 id=\"重构列表\"><a href=\"#重构列表\" class=\"headerlink\" title=\"重构列表\"></a>重构列表</h2><p>重构的基本技巧———小步前进，频繁测试</p>\n","site":{"data":{}},"excerpt":"<h2 id=\"重构\"><a href=\"#重构\" class=\"headerlink\" title=\"重构\"></a>重构</h2><ul>\n<li>如果你发现自己需要为程序添加一个特性，而代码结构使你无法很方便地达成目的，那就先重构那个程序，使特性的添加比较容易进行，然后现添加特性</li>\n<li>重构前，先检查自己是否有一套可靠的测试机制，这些测试必须有自我检验能力</li>\n<li>重构技术就是以微小的步伐修改程序，如果你犯下错误，很容易使可发现它。</li>\n<li>任何一个傻瓜都能写出计算机可以理解的代码。唯有写出人类容易理解的代码，才是优秀的程序员。</li>\n<li>当你感觉需要撰写注释时，请先尝试重构，试着让所有注释都变得多余。</li>\n</ul>","more":"<h2 id=\"重构原则\"><a href=\"#重构原则\" class=\"headerlink\" title=\"重构原则\"></a>重构原则</h2><h4 id=\"何为重构\"><a href=\"#何为重构\" class=\"headerlink\" title=\"何为重构\"></a>何为重构</h4><blockquote>\n<p><strong>重构(名词)</strong>：对软件内部结构的一种调整，目的是在不改变软件可观察行为的前提下，提高其可理解性，降低其修改成本</p>\n<p><strong>重构(动词)</strong>：使用一系列重构手法，在不改变软件可观察行为的前提下，调整其结构。</p>\n</blockquote>\n<h4 id=\"为何重构\"><a href=\"#为何重构\" class=\"headerlink\" title=\"为何重构\"></a>为何重构</h4><ul>\n<li>重构改进软件设计</li>\n<li>重构使软件更容易理解</li>\n<li>重构帮助找到BUG</li>\n<li>重构提高编程速度</li>\n</ul>\n<h4 id=\"何时重构\"><a href=\"#何时重构\" class=\"headerlink\" title=\"何时重构\"></a>何时重构</h4><p><strong>三次法则（事不过三，三则重构）</strong></p>\n<ul>\n<li>添加功能时重构</li>\n<li>修补错误时重构</li>\n<li>复审代码时重构</li>\n</ul>\n<h2 id=\"代码的坏味道\"><a href=\"#代码的坏味道\" class=\"headerlink\" title=\"代码的坏味道\"></a>代码的坏味道</h2><ul>\n<li><p><strong>Duplicated Code(重复代码)</strong></p>\n</li>\n<li><p><strong>Long Method(过长函数)</strong></p>\n</li>\n<li><p><strong>Large Class(过大的类)</strong></p>\n</li>\n<li><p><strong>Long Parameter List(过长参数列)</strong></p>\n</li>\n<li><p><strong>Divergent Change(发散式变化)</strong></p>\n<p>（如果某个类经常因为不同的原因在不同的方向上发生变化，Divergent Change就出现了）</p>\n</li>\n<li><p><strong>Shotgun Surgery(霰弹式修改)</strong></p>\n<p>（Shotgun Surgery类亿Divergent Change，但恰恰相反。如果每遇到某种变化，你都必须在许多不同的类内做许多小修改，你所面临的坏味道就是Shotgun Surgery）</p>\n</li>\n<li><p><strong>Feature Envy(依恋情结)</strong></p>\n<p>（函数对某个类的兴趣高过对自己所处类的兴趣）</p>\n</li>\n<li><p><strong>Data Clumps(数据泥团)</strong></p>\n<p>（两个类中相同的字段、许多函数签名中相同的参数。这些总是绑在一起出现的数据真应该拥有属于它们自己的对象。）</p>\n</li>\n<li><p><strong>Primitive Obsession(基本类型偏执)</strong></p>\n<p>（对象技术的新手通常不愿意在小任务上运用小对象—像是结合数值和币种的money类、由一个超始值和一个结束值组成的range类、电话号码或邮政编码）</p>\n</li>\n<li><p><strong>Switch Statements(switch惊悚现身)</strong></p>\n<p>（你常会发现同样的switch语句散布于不同地点。如果要为它添加一个新的case子句，就必须找到所有switch语句并修改它们。面向对象中的多态概念可为此带来优雅的解决办法。）</p>\n</li>\n<li><p><strong>Parallel Inheritance Hierarchies(平行继承体系)</strong></p>\n<p>（Parallel Inheritance Hierarchies其实是Shotgun Surgery的特殊情况。在这种情况下，每当你为某个类增加一个子类，必须也为另一相类增加一个子类。如果你发现某个继承体系的类名称前缀和别一个继承体系的类名称前缀完全相同，便是闻到了这种坏味道。）</p>\n</li>\n<li><p><strong>Lazy Class(冗赘类)</strong></p>\n<p>（你所创建的每一个类，都得有人去理解它、维护它，这些工作都是要花钱的。如果一个类的所得不值其身价，它就应该消失。）</p>\n</li>\n<li><p><strong>Speculative Generality(夸夸其谈未来性)</strong></p>\n<p>（企图以各式各样的钩子和特殊情况来处理一些非必要的事情，这种坏味道就出现了。）</p>\n</li>\n<li><p><strong>Temporary Field(令人迷惑的暂时字段)</strong></p>\n<p>（某个实例变量仅为某种特定情况而设。这样的代码让人不易理解，因为你通常认为对象在所有时候都需要它的所有变量。）</p>\n</li>\n<li><p><strong>Message Chains(过度耦合的消息链)</strong></p>\n<p>（向一个对象请求另一个对象，然后再向后者请求另一个对象，然后再请求别一个对象……这就是消息链。采取这种方式，意味客户代码将与查找过程中的导航结构紧密耦合。一旦对象间的关系发生变化，客户端就不得不做了相应修改。）</p>\n</li>\n<li><p><strong>Middle Man(中间人)</strong></p>\n<p>（对象的基本特征之一就是封装—对外部世界隐藏其内部细节。封装往往伴随委托。但是人们可能过度运用委托。你也许会看到某个类接口有一关的函数都委托给其他类，这样就是过度运用。）</p>\n</li>\n<li><p><strong>Inappropriate Intimacy(狎昵关系)</strong></p>\n<p>（有时你会看到两个类过于亲密，花费太多时间去探究彼此的private成分。对于这样过分狎昵的类必须拆散。）</p>\n</li>\n<li><p><strong>Alternative Classes with Different Interfaces(异曲同工的类)</strong></p>\n<p>（两个函数做同一件事，却有着不同的签名）</p>\n</li>\n<li><p><strong>Incomplete Library Class(不完美的库类)</strong></p>\n</li>\n<li><p><strong>Data Class(纯稚的数据类)</strong></p>\n<p>（它们拥有一些字段，以及用于访问、读写这些字段的函数，除此之外一无长物。这样的类只是一种不会说话的数据容器，它们几乎一定被其它类过分细琐地操控着。对于那些不该被其他类修改的字段。请提示get/set）</p>\n</li>\n<li><p><strong>Refused Bequest(被拒绝的遗赠)</strong></p>\n<p>(子类应该继承超类的函数和数据。但有时子类不需要继承一些无关的数据。这样一来，超类就只持有所有子类共享的东西。—所有超类都应该是抽象的)</p>\n</li>\n<li><p><strong>Comments(过多的注释)</strong></p>\n<p>​</p>\n<h2 id=\"构筑测试体系\"><a href=\"#构筑测试体系\" class=\"headerlink\" title=\"构筑测试体系\"></a>构筑测试体系</h2></li>\n<li><p>确保所有测试都完全自动化，让它们检查自己的测试结果。</p>\n</li>\n<li>一套测试就是一个强大的bug侦测器，能够大大缩减查找bug所需要的时间。</li>\n<li>频繁地运行测试。每次编译请把测试也考虑进去—每天至少执行每个测试一次。</li>\n<li>每当你收到bug报告，请先写一个单元测试来暴露这个bug。</li>\n<li>编写未臻完善的测试并实际运行，好过对完美测试的无尽等待。</li>\n<li>考虑可能出错的边界条件，把测试火力集中在那儿。</li>\n<li>当事情被认为应该会出错时，别忘了检查是否抛出了预期的异常。</li>\n<li>不要因为测试无法捕捉所有bug就不写测试，因为测试的确可以捕捉到大多数bug。</li>\n</ul>\n<h2 id=\"重构列表\"><a href=\"#重构列表\" class=\"headerlink\" title=\"重构列表\"></a>重构列表</h2><p>重构的基本技巧———小步前进，频繁测试</p>"},{"title":"开心一刻","date":"2018-05-11T03:28:39.000Z","_content":"\n- 天将降大任于斯人也，必先收其电脑，夺其手机，断其wifi，拒其看叨叨，使其焦躁无聊，百无聊赖，便可用心上班/读书！ \n- 我的兴趣爱好可分为静态和动态两种，静态就是睡觉，动态就是翻身 \n- 你打游戏时，别人在熬夜加班赶项目；你上班摸鱼时，别人在卖命拼酒陪客户；你晚上睡大觉时，别人在废寝忘食地工作；你跟女朋友出去旅游时，别人在通宵做商业计划书；这就是别人二十多岁猝死在工作岗位上而你皮肤好气色好精神好的原因。 ","source":"_posts/smile/smile-global.md","raw":"---\ntitle: 开心一刻\ndate: 2018-05-11 11:28:39\ntags: smile\n---\n\n- 天将降大任于斯人也，必先收其电脑，夺其手机，断其wifi，拒其看叨叨，使其焦躁无聊，百无聊赖，便可用心上班/读书！ \n- 我的兴趣爱好可分为静态和动态两种，静态就是睡觉，动态就是翻身 \n- 你打游戏时，别人在熬夜加班赶项目；你上班摸鱼时，别人在卖命拼酒陪客户；你晚上睡大觉时，别人在废寝忘食地工作；你跟女朋友出去旅游时，别人在通宵做商业计划书；这就是别人二十多岁猝死在工作岗位上而你皮肤好气色好精神好的原因。 ","slug":"smile/smile-global","published":1,"updated":"2018-05-20T13:04:25.688Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fv003xizcb56bbdprl","content":"<ul>\n<li>天将降大任于斯人也，必先收其电脑，夺其手机，断其wifi，拒其看叨叨，使其焦躁无聊，百无聊赖，便可用心上班/读书！ </li>\n<li>我的兴趣爱好可分为静态和动态两种，静态就是睡觉，动态就是翻身 </li>\n<li>你打游戏时，别人在熬夜加班赶项目；你上班摸鱼时，别人在卖命拼酒陪客户；你晚上睡大觉时，别人在废寝忘食地工作；你跟女朋友出去旅游时，别人在通宵做商业计划书；这就是别人二十多岁猝死在工作岗位上而你皮肤好气色好精神好的原因。 </li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li>天将降大任于斯人也，必先收其电脑，夺其手机，断其wifi，拒其看叨叨，使其焦躁无聊，百无聊赖，便可用心上班/读书！ </li>\n<li>我的兴趣爱好可分为静态和动态两种，静态就是睡觉，动态就是翻身 </li>\n<li>你打游戏时，别人在熬夜加班赶项目；你上班摸鱼时，别人在卖命拼酒陪客户；你晚上睡大觉时，别人在废寝忘食地工作；你跟女朋友出去旅游时，别人在通宵做商业计划书；这就是别人二十多岁猝死在工作岗位上而你皮肤好气色好精神好的原因。 </li>\n</ul>\n"},{"title":"程序人生","date":"2018-05-11T03:33:20.000Z","_content":"\n- 两程序员聊天，程序员甲抱怨：“做程序员太辛苦了，我想换行……我该怎么办？”程序员乙：“敲一下回车。”\n- 我很奇怪客栈这个词，难道后入住的必须先退房吗？\n- 佛跳墙 GOD use VPN ","source":"_posts/smile/smile-programmer.md","raw":"---\ntitle: 程序人生\ndate: 2018-05-11 11:33:20\ntags: smile\n---\n\n- 两程序员聊天，程序员甲抱怨：“做程序员太辛苦了，我想换行……我该怎么办？”程序员乙：“敲一下回车。”\n- 我很奇怪客栈这个词，难道后入住的必须先退房吗？\n- 佛跳墙 GOD use VPN ","slug":"smile/smile-programmer","published":1,"updated":"2018-05-20T13:04:25.688Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fw003zizcbfrt8zsu2","content":"<ul>\n<li>两程序员聊天，程序员甲抱怨：“做程序员太辛苦了，我想换行……我该怎么办？”程序员乙：“敲一下回车。”</li>\n<li>我很奇怪客栈这个词，难道后入住的必须先退房吗？</li>\n<li>佛跳墙 GOD use VPN </li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li>两程序员聊天，程序员甲抱怨：“做程序员太辛苦了，我想换行……我该怎么办？”程序员乙：“敲一下回车。”</li>\n<li>我很奇怪客栈这个词，难道后入住的必须先退房吗？</li>\n<li>佛跳墙 GOD use VPN </li>\n</ul>\n"},{"title":"Linux","date":"2018-01-25T02:52:11.000Z","_content":"\n[linux上安装Docker](https://blog.csdn.net/qq_36892341/article/details/73918672)\n\n","source":"_posts/study/Centenos.md","raw":"---\ntitle: Linux\ndate: 2018-01-25 10:52:11\ntags: study\n---\n\n[linux上安装Docker](https://blog.csdn.net/qq_36892341/article/details/73918672)\n\n","slug":"study/Centenos","published":1,"updated":"2018-05-20T13:04:25.688Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fx0041izcb6nlj3mv1","content":"<p><a href=\"https://blog.csdn.net/qq_36892341/article/details/73918672\" target=\"_blank\" rel=\"noopener\">linux上安装Docker</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://blog.csdn.net/qq_36892341/article/details/73918672\" target=\"_blank\" rel=\"noopener\">linux上安装Docker</a></p>\n"},{"title":"Linux","date":"2018-01-25T02:52:11.000Z","_content":"\n[jenkins](https://segmentfault.com/a/1190000007086764)\n\n[shadowsocks](https://shadowsocks.blogspot.com/)\n\n[shadowscocks](https://www.cnblogs.com/gne-hwz/p/6662000.html)\n\n[shadowscocks](https://www.iwwenbo.com/0-1-shadowsocks-start/)\n\n[android sdk](http://www.jb51.net/article/119183.htm)\n\n[jenkins-github](https://www.jianshu.com/p/ee058d067fd9)\n\n[jenkins-github](https://www.jianshu.com/p/38b2e17ced73)\n\n","source":"_posts/study/Linux.md","raw":"---\ntitle: Linux\ndate: 2018-01-25 10:52:11\ntags:\n---\n\n[jenkins](https://segmentfault.com/a/1190000007086764)\n\n[shadowsocks](https://shadowsocks.blogspot.com/)\n\n[shadowscocks](https://www.cnblogs.com/gne-hwz/p/6662000.html)\n\n[shadowscocks](https://www.iwwenbo.com/0-1-shadowsocks-start/)\n\n[android sdk](http://www.jb51.net/article/119183.htm)\n\n[jenkins-github](https://www.jianshu.com/p/ee058d067fd9)\n\n[jenkins-github](https://www.jianshu.com/p/38b2e17ced73)\n\n","slug":"study/Linux","published":1,"updated":"2018-01-31T09:35:37.820Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fy0044izcbwb6c5xfr","content":"<p><a href=\"https://segmentfault.com/a/1190000007086764\" target=\"_blank\" rel=\"noopener\">jenkins</a></p>\n<p><a href=\"https://shadowsocks.blogspot.com/\" target=\"_blank\" rel=\"noopener\">shadowsocks</a></p>\n<p><a href=\"https://www.cnblogs.com/gne-hwz/p/6662000.html\" target=\"_blank\" rel=\"noopener\">shadowscocks</a></p>\n<p><a href=\"https://www.iwwenbo.com/0-1-shadowsocks-start/\" target=\"_blank\" rel=\"noopener\">shadowscocks</a></p>\n<p><a href=\"http://www.jb51.net/article/119183.htm\" target=\"_blank\" rel=\"noopener\">android sdk</a></p>\n<p><a href=\"https://www.jianshu.com/p/ee058d067fd9\" target=\"_blank\" rel=\"noopener\">jenkins-github</a></p>\n<p><a href=\"https://www.jianshu.com/p/38b2e17ced73\" target=\"_blank\" rel=\"noopener\">jenkins-github</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"https://segmentfault.com/a/1190000007086764\" target=\"_blank\" rel=\"noopener\">jenkins</a></p>\n<p><a href=\"https://shadowsocks.blogspot.com/\" target=\"_blank\" rel=\"noopener\">shadowsocks</a></p>\n<p><a href=\"https://www.cnblogs.com/gne-hwz/p/6662000.html\" target=\"_blank\" rel=\"noopener\">shadowscocks</a></p>\n<p><a href=\"https://www.iwwenbo.com/0-1-shadowsocks-start/\" target=\"_blank\" rel=\"noopener\">shadowscocks</a></p>\n<p><a href=\"http://www.jb51.net/article/119183.htm\" target=\"_blank\" rel=\"noopener\">android sdk</a></p>\n<p><a href=\"https://www.jianshu.com/p/ee058d067fd9\" target=\"_blank\" rel=\"noopener\">jenkins-github</a></p>\n<p><a href=\"https://www.jianshu.com/p/38b2e17ced73\" target=\"_blank\" rel=\"noopener\">jenkins-github</a></p>\n"},{"title":"hexo","date":"2016-08-22T08:11:51.000Z","_content":"\n### Hexo简介\n\n> 官网：https://hexo.io/zh-cn/\n\n主题：[yilia](https://github.com/litten/hexo-theme-yilia)\n\nMARKDOWN EDITOR: [typora](https://typora.io)\n\n### TIPS\n\n```java\nnpm install hexo-deployer-git --save\n```\n\n其它命令不确定，部署这个命令一定要用git bash，否则会提示\n\n`Permission denied (publickey).`\n\n推荐博客：\n\nhttp://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html\n\n[最适合新手的 GitHub + Hexo 「大话」博客搭建教程](https://smartbeng.github.io/2017/03/26/blogFinish/)\n\n[新手搭建博客过程](http://liuqingwen.me/blog/2017/04/11/hexo-blog-creation-work-progress/)\n\n### Hexo常用命令\n\n- 安装Hexo\n\n  `sudo npm install -g hexo`\n\n- 初始化\n\n  `hexo init`\n\n- 生成静态页面\n\n  `hexo generate`(hexo g也可以)\n\n- 本地启动\n\n  `hexo server`\n\n- 执行配置命令上传到github\n\n  `hexo deploy`\n\n- 新建文章\n\n  `hexo new 'postName'`\n\n- 新建页面\n\n  `hexo new page 'pageName'`\n\n- 查盾帮助\n\n  `hexo help`\n\n- 查看Hexo的版本\n\n  `hexo version`\n\n- 每次部署的步骤，可按以下三步来进行\n\n  hexo clean\n\n  hexo g\n\n  hexo d\n","source":"_posts/study/hexo.md","raw":"---\ntitle: hexo\ndate: 2016-08-22 16:11:51\ntags: study\n---\n\n### Hexo简介\n\n> 官网：https://hexo.io/zh-cn/\n\n主题：[yilia](https://github.com/litten/hexo-theme-yilia)\n\nMARKDOWN EDITOR: [typora](https://typora.io)\n\n### TIPS\n\n```java\nnpm install hexo-deployer-git --save\n```\n\n其它命令不确定，部署这个命令一定要用git bash，否则会提示\n\n`Permission denied (publickey).`\n\n推荐博客：\n\nhttp://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html\n\n[最适合新手的 GitHub + Hexo 「大话」博客搭建教程](https://smartbeng.github.io/2017/03/26/blogFinish/)\n\n[新手搭建博客过程](http://liuqingwen.me/blog/2017/04/11/hexo-blog-creation-work-progress/)\n\n### Hexo常用命令\n\n- 安装Hexo\n\n  `sudo npm install -g hexo`\n\n- 初始化\n\n  `hexo init`\n\n- 生成静态页面\n\n  `hexo generate`(hexo g也可以)\n\n- 本地启动\n\n  `hexo server`\n\n- 执行配置命令上传到github\n\n  `hexo deploy`\n\n- 新建文章\n\n  `hexo new 'postName'`\n\n- 新建页面\n\n  `hexo new page 'pageName'`\n\n- 查盾帮助\n\n  `hexo help`\n\n- 查看Hexo的版本\n\n  `hexo version`\n\n- 每次部署的步骤，可按以下三步来进行\n\n  hexo clean\n\n  hexo g\n\n  hexo d\n","slug":"study/hexo","published":1,"updated":"2018-05-20T13:04:25.688Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61fy0046izcb4bih661s","content":"<h3 id=\"Hexo简介\"><a href=\"#Hexo简介\" class=\"headerlink\" title=\"Hexo简介\"></a>Hexo简介</h3><blockquote>\n<p>官网：<a href=\"https://hexo.io/zh-cn/\" target=\"_blank\" rel=\"noopener\">https://hexo.io/zh-cn/</a></p>\n</blockquote>\n<p>主题：<a href=\"https://github.com/litten/hexo-theme-yilia\" target=\"_blank\" rel=\"noopener\">yilia</a></p>\n<p>MARKDOWN EDITOR: <a href=\"https://typora.io\" target=\"_blank\" rel=\"noopener\">typora</a></p>\n<h3 id=\"TIPS\"><a href=\"#TIPS\" class=\"headerlink\" title=\"TIPS\"></a>TIPS</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n<p>其它命令不确定，部署这个命令一定要用git bash，否则会提示</p>\n<p><code>Permission denied (publickey).</code></p>\n<p>推荐博客：</p>\n<p><a href=\"http://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html</a></p>\n<p><a href=\"https://smartbeng.github.io/2017/03/26/blogFinish/\" target=\"_blank\" rel=\"noopener\">最适合新手的 GitHub + Hexo 「大话」博客搭建教程</a></p>\n<p><a href=\"http://liuqingwen.me/blog/2017/04/11/hexo-blog-creation-work-progress/\" target=\"_blank\" rel=\"noopener\">新手搭建博客过程</a></p>\n<h3 id=\"Hexo常用命令\"><a href=\"#Hexo常用命令\" class=\"headerlink\" title=\"Hexo常用命令\"></a>Hexo常用命令</h3><ul>\n<li><p>安装Hexo</p>\n<p><code>sudo npm install -g hexo</code></p>\n</li>\n<li><p>初始化</p>\n<p><code>hexo init</code></p>\n</li>\n<li><p>生成静态页面</p>\n<p><code>hexo generate</code>(hexo g也可以)</p>\n</li>\n<li><p>本地启动</p>\n<p><code>hexo server</code></p>\n</li>\n<li><p>执行配置命令上传到github</p>\n<p><code>hexo deploy</code></p>\n</li>\n<li><p>新建文章</p>\n<p><code>hexo new &#39;postName&#39;</code></p>\n</li>\n<li><p>新建页面</p>\n<p><code>hexo new page &#39;pageName&#39;</code></p>\n</li>\n<li><p>查盾帮助</p>\n<p><code>hexo help</code></p>\n</li>\n<li><p>查看Hexo的版本</p>\n<p><code>hexo version</code></p>\n</li>\n<li><p>每次部署的步骤，可按以下三步来进行</p>\n<p>hexo clean</p>\n<p>hexo g</p>\n<p>hexo d</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Hexo简介\"><a href=\"#Hexo简介\" class=\"headerlink\" title=\"Hexo简介\"></a>Hexo简介</h3><blockquote>\n<p>官网：<a href=\"https://hexo.io/zh-cn/\" target=\"_blank\" rel=\"noopener\">https://hexo.io/zh-cn/</a></p>\n</blockquote>\n<p>主题：<a href=\"https://github.com/litten/hexo-theme-yilia\" target=\"_blank\" rel=\"noopener\">yilia</a></p>\n<p>MARKDOWN EDITOR: <a href=\"https://typora.io\" target=\"_blank\" rel=\"noopener\">typora</a></p>\n<h3 id=\"TIPS\"><a href=\"#TIPS\" class=\"headerlink\" title=\"TIPS\"></a>TIPS</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n<p>其它命令不确定，部署这个命令一定要用git bash，否则会提示</p>\n<p><code>Permission denied (publickey).</code></p>\n<p>推荐博客：</p>\n<p><a href=\"http://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html\" target=\"_blank\" rel=\"noopener\">http://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html</a></p>\n<p><a href=\"https://smartbeng.github.io/2017/03/26/blogFinish/\" target=\"_blank\" rel=\"noopener\">最适合新手的 GitHub + Hexo 「大话」博客搭建教程</a></p>\n<p><a href=\"http://liuqingwen.me/blog/2017/04/11/hexo-blog-creation-work-progress/\" target=\"_blank\" rel=\"noopener\">新手搭建博客过程</a></p>\n<h3 id=\"Hexo常用命令\"><a href=\"#Hexo常用命令\" class=\"headerlink\" title=\"Hexo常用命令\"></a>Hexo常用命令</h3><ul>\n<li><p>安装Hexo</p>\n<p><code>sudo npm install -g hexo</code></p>\n</li>\n<li><p>初始化</p>\n<p><code>hexo init</code></p>\n</li>\n<li><p>生成静态页面</p>\n<p><code>hexo generate</code>(hexo g也可以)</p>\n</li>\n<li><p>本地启动</p>\n<p><code>hexo server</code></p>\n</li>\n<li><p>执行配置命令上传到github</p>\n<p><code>hexo deploy</code></p>\n</li>\n<li><p>新建文章</p>\n<p><code>hexo new &#39;postName&#39;</code></p>\n</li>\n<li><p>新建页面</p>\n<p><code>hexo new page &#39;pageName&#39;</code></p>\n</li>\n<li><p>查盾帮助</p>\n<p><code>hexo help</code></p>\n</li>\n<li><p>查看Hexo的版本</p>\n<p><code>hexo version</code></p>\n</li>\n<li><p>每次部署的步骤，可按以下三步来进行</p>\n<p>hexo clean</p>\n<p>hexo g</p>\n<p>hexo d</p>\n</li>\n</ul>\n"},{"title":"mac-os-tips","date":"2017-02-10T07:28:39.000Z","_content":"\n### Tips\n\n有时候，我们安装程序时，会提示文件已损坏，需要打开安全性与隐私中的任何来源选项\n\n```java\nsudo spctl --master-disable\n```\n**显示文件隐藏文件夹**\n\n```\ncommand + shift + .\n```\n\n","source":"_posts/study/mac-os-tips.md","raw":"---\ntitle: mac-os-tips\ndate: 2017-02-10 15:28:39\ntags: study\n---\n\n### Tips\n\n有时候，我们安装程序时，会提示文件已损坏，需要打开安全性与隐私中的任何来源选项\n\n```java\nsudo spctl --master-disable\n```\n**显示文件隐藏文件夹**\n\n```\ncommand + shift + .\n```\n\n","slug":"study/mac-os-tips","published":1,"updated":"2018-05-20T13:04:25.688Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g00048izcbkmzs5t58","content":"<h3 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h3><p>有时候，我们安装程序时，会提示文件已损坏，需要打开安全性与隐私中的任何来源选项</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo spctl --master-disable</span><br></pre></td></tr></table></figure>\n<p><strong>显示文件隐藏文件夹</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">command + shift + .</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h3><p>有时候，我们安装程序时，会提示文件已损坏，需要打开安全性与隐私中的任何来源选项</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo spctl --master-disable</span><br></pre></td></tr></table></figure>\n<p><strong>显示文件隐藏文件夹</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">command + shift + .</span><br></pre></td></tr></table></figure>\n"},{"title":"shadowsocks多用户配置","date":"2018-01-26T07:55:52.000Z","_content":"\n### 前言\n\n之前一篇文章，我们讲了[合适懒人的搬瓦工+ShadowsocksX教程](/2018/02/26/study/study-bwh-ssr/)，我们使用的是`搬瓦工`自己的服务进行安装的，还没有看的同学请先看下。本篇主要讲解如何使用命令行的方式进行安装`shadowsocks`，配置单用户和多用户。\n\n如何进入服务器: [使用SSH客户端(Termius)连接服务器](/2018/01/30/study/study-centos-ssh/)\n\n<!-- More -->\n\n### shadowsocks服务器配置\n\n这里我们安装的是python版本，首先进入官网:https://github.com/shadowsocks/shadowsocks/tree/master\n\n进入后拖动页面，找到自己的服务器版本，我们这里以`CentOS`为例:\n\n#### 安装Git\n\n安装shadowsocks，需要先安装`git`\n\n**CentOS**\n\n```python\nyum install -y git\n```\n\n**Debian / Ubuntu**\n\n```python\napt-get install -y git\n```\n\n#### 安装shadowsocks\n\n**CentOS**\n\n```python\nyum install python-setuptools && easy_install pip\npip install git+https://github.com/shadowsocks/shadowsocks.git@master\n```\n\n**Debian / Ubuntu**\n\n```python\napt-get install python-pip\npip install git+https://github.com/shadowsocks/shadowsocks.git@master\n```\n\n安装完成后，打开 https://github.com/shadowsocks/shadowsocks/wiki/Configuration-via-Config-File\n\n我们可以看到官网的一些描述，这里简单说明一下：\n\n**第一步**，创建一个`shadowsocks.json`文件并打开，使用以下命令\n\n```python\nvi /etc/shadowsocks.json\n```\n\n**第二步**，按`i`键进入编辑模式，当按下`i`时，这时左下角会显示 `INSERT`字样，表示当前处于编辑模式。输入以下内容(因为是命令行模式，所以大家可以先使用文本编辑器，写好下面的文字，然后复制一下，贴到你的命令行)\n\n**单用户配置**\n\n```python\n{\n    \"server\":\"my_server_ip\",\n    \"server_port\":8388,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\":1080,\n    \"password\":\"mypassword\",\n    \"timeout\":300,\n    \"method\":\"rc4-md5\",\n    \"fast_open\": false\n}\n```\n\n> `my_server_ip `填你的服务器地址\n>\n> 8388填你的端口(自定义的，可能不更改，保留8388)\n>\n> `mypassword`填写你要设置的密码\n\n**多用户配置**\n\n```python\n{\n    \"server\":\"my_server_ip\",\n    \"local_address\":\"127.0.0.1\",\n    \"local_port\":1080,\n    \"port_password\":{\n    \t\"端口1\":\"密码1\",\n    \t\"端口2\":\"密码2\",\n    \t\"端口3\":\"密码3\"\n    },\n    \"timeout\":600,\n    \"method\":\"rc4-md5\",\n  \t\"fast_open\": false\n}\n```\n\n> `my_server_ip `填你的服务器地址\n>\n> `端口1、密码1`填你要分配给客户端的端口和密码，比如'8388':\"123456\"，后面的端口、密码同理\n\n**注意**：`method`一栏，默认是`aes-256-cfb`，这里改为`rc4-md5`，这样上网会快一些，相应的客户端加密也要改成`rc4-md5`，别忘了\n\n这里设置的项都是给你客户端连接时使用的\n\n填好后，按`ESC`键退出编辑模式，输出`:wq`保存退出\n\n**第三步**，开启或关闭服务\n\n使用以下命令\n\n开启服务\n\n```python\nssserver -c /etc/shadowsocks.json -d start\n```\n\n关闭服务\n\n```python\nssserver -c /etc/shadowsocks.json -d stop\n```\n\n**开机自启动**\n\n```\nvi /etc/rc.local\n```\n\n在`rc.local`中添加\n\n```\nsudo ssserver -c /etc/shadowsocks.json -d start\n```\n\n\n\n大功告成，愉快的玩耍吧(^^)","source":"_posts/study/study-bwh-ss.md","raw":"---\ntitle: shadowsocks多用户配置\ndate: 2018-01-26 15:55:52\ntags: study\n---\n\n### 前言\n\n之前一篇文章，我们讲了[合适懒人的搬瓦工+ShadowsocksX教程](/2018/02/26/study/study-bwh-ssr/)，我们使用的是`搬瓦工`自己的服务进行安装的，还没有看的同学请先看下。本篇主要讲解如何使用命令行的方式进行安装`shadowsocks`，配置单用户和多用户。\n\n如何进入服务器: [使用SSH客户端(Termius)连接服务器](/2018/01/30/study/study-centos-ssh/)\n\n<!-- More -->\n\n### shadowsocks服务器配置\n\n这里我们安装的是python版本，首先进入官网:https://github.com/shadowsocks/shadowsocks/tree/master\n\n进入后拖动页面，找到自己的服务器版本，我们这里以`CentOS`为例:\n\n#### 安装Git\n\n安装shadowsocks，需要先安装`git`\n\n**CentOS**\n\n```python\nyum install -y git\n```\n\n**Debian / Ubuntu**\n\n```python\napt-get install -y git\n```\n\n#### 安装shadowsocks\n\n**CentOS**\n\n```python\nyum install python-setuptools && easy_install pip\npip install git+https://github.com/shadowsocks/shadowsocks.git@master\n```\n\n**Debian / Ubuntu**\n\n```python\napt-get install python-pip\npip install git+https://github.com/shadowsocks/shadowsocks.git@master\n```\n\n安装完成后，打开 https://github.com/shadowsocks/shadowsocks/wiki/Configuration-via-Config-File\n\n我们可以看到官网的一些描述，这里简单说明一下：\n\n**第一步**，创建一个`shadowsocks.json`文件并打开，使用以下命令\n\n```python\nvi /etc/shadowsocks.json\n```\n\n**第二步**，按`i`键进入编辑模式，当按下`i`时，这时左下角会显示 `INSERT`字样，表示当前处于编辑模式。输入以下内容(因为是命令行模式，所以大家可以先使用文本编辑器，写好下面的文字，然后复制一下，贴到你的命令行)\n\n**单用户配置**\n\n```python\n{\n    \"server\":\"my_server_ip\",\n    \"server_port\":8388,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\":1080,\n    \"password\":\"mypassword\",\n    \"timeout\":300,\n    \"method\":\"rc4-md5\",\n    \"fast_open\": false\n}\n```\n\n> `my_server_ip `填你的服务器地址\n>\n> 8388填你的端口(自定义的，可能不更改，保留8388)\n>\n> `mypassword`填写你要设置的密码\n\n**多用户配置**\n\n```python\n{\n    \"server\":\"my_server_ip\",\n    \"local_address\":\"127.0.0.1\",\n    \"local_port\":1080,\n    \"port_password\":{\n    \t\"端口1\":\"密码1\",\n    \t\"端口2\":\"密码2\",\n    \t\"端口3\":\"密码3\"\n    },\n    \"timeout\":600,\n    \"method\":\"rc4-md5\",\n  \t\"fast_open\": false\n}\n```\n\n> `my_server_ip `填你的服务器地址\n>\n> `端口1、密码1`填你要分配给客户端的端口和密码，比如'8388':\"123456\"，后面的端口、密码同理\n\n**注意**：`method`一栏，默认是`aes-256-cfb`，这里改为`rc4-md5`，这样上网会快一些，相应的客户端加密也要改成`rc4-md5`，别忘了\n\n这里设置的项都是给你客户端连接时使用的\n\n填好后，按`ESC`键退出编辑模式，输出`:wq`保存退出\n\n**第三步**，开启或关闭服务\n\n使用以下命令\n\n开启服务\n\n```python\nssserver -c /etc/shadowsocks.json -d start\n```\n\n关闭服务\n\n```python\nssserver -c /etc/shadowsocks.json -d stop\n```\n\n**开机自启动**\n\n```\nvi /etc/rc.local\n```\n\n在`rc.local`中添加\n\n```\nsudo ssserver -c /etc/shadowsocks.json -d start\n```\n\n\n\n大功告成，愉快的玩耍吧(^^)","slug":"study/study-bwh-ss","published":1,"updated":"2018-05-20T13:04:25.689Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g0004aizcbklx5jaiz","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>之前一篇文章，我们讲了<a href=\"/2018/02/26/study/study-bwh-ssr/\">合适懒人的搬瓦工+ShadowsocksX教程</a>，我们使用的是<code>搬瓦工</code>自己的服务进行安装的，还没有看的同学请先看下。本篇主要讲解如何使用命令行的方式进行安装<code>shadowsocks</code>，配置单用户和多用户。</p>\n<p>如何进入服务器: <a href=\"/2018/01/30/study/study-centos-ssh/\">使用SSH客户端(Termius)连接服务器</a></p>\n<a id=\"more\"></a>\n<h3 id=\"shadowsocks服务器配置\"><a href=\"#shadowsocks服务器配置\" class=\"headerlink\" title=\"shadowsocks服务器配置\"></a>shadowsocks服务器配置</h3><p>这里我们安装的是python版本，首先进入官网:<a href=\"https://github.com/shadowsocks/shadowsocks/tree/master\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks/tree/master</a></p>\n<p>进入后拖动页面，找到自己的服务器版本，我们这里以<code>CentOS</code>为例:</p>\n<h4 id=\"安装Git\"><a href=\"#安装Git\" class=\"headerlink\" title=\"安装Git\"></a>安装Git</h4><p>安装shadowsocks，需要先安装<code>git</code></p>\n<p><strong>CentOS</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y git</span><br></pre></td></tr></table></figure>\n<p><strong>Debian / Ubuntu</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install -y git</span><br></pre></td></tr></table></figure>\n<h4 id=\"安装shadowsocks\"><a href=\"#安装shadowsocks\" class=\"headerlink\" title=\"安装shadowsocks\"></a>安装shadowsocks</h4><p><strong>CentOS</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install python-setuptools &amp;&amp; easy_install pip</span><br><span class=\"line\">pip install git+https://github.com/shadowsocks/shadowsocks.git@master</span><br></pre></td></tr></table></figure>\n<p><strong>Debian / Ubuntu</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install python-pip</span><br><span class=\"line\">pip install git+https://github.com/shadowsocks/shadowsocks.git@master</span><br></pre></td></tr></table></figure>\n<p>安装完成后，打开 <a href=\"https://github.com/shadowsocks/shadowsocks/wiki/Configuration-via-Config-File\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks/wiki/Configuration-via-Config-File</a></p>\n<p>我们可以看到官网的一些描述，这里简单说明一下：</p>\n<p><strong>第一步</strong>，创建一个<code>shadowsocks.json</code>文件并打开，使用以下命令</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/shadowsocks.json</span><br></pre></td></tr></table></figure>\n<p><strong>第二步</strong>，按<code>i</code>键进入编辑模式，当按下<code>i</code>时，这时左下角会显示 <code>INSERT</code>字样，表示当前处于编辑模式。输入以下内容(因为是命令行模式，所以大家可以先使用文本编辑器，写好下面的文字，然后复制一下，贴到你的命令行)</p>\n<p><strong>单用户配置</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"server\"</span>:<span class=\"string\">\"my_server_ip\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"server_port\"</span>:<span class=\"number\">8388</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_port\"</span>:<span class=\"number\">1080</span>,</span><br><span class=\"line\">    <span class=\"string\">\"password\"</span>:<span class=\"string\">\"mypassword\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"timeout\"</span>:<span class=\"number\">300</span>,</span><br><span class=\"line\">    <span class=\"string\">\"method\"</span>:<span class=\"string\">\"rc4-md5\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"fast_open\"</span>: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>my_server_ip</code>填你的服务器地址</p>\n<p>8388填你的端口(自定义的，可能不更改，保留8388)</p>\n<p><code>mypassword</code>填写你要设置的密码</p>\n</blockquote>\n<p><strong>多用户配置</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"server\"</span>:<span class=\"string\">\"my_server_ip\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_address\"</span>:<span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_port\"</span>:<span class=\"number\">1080</span>,</span><br><span class=\"line\">    <span class=\"string\">\"port_password\"</span>:&#123;</span><br><span class=\"line\">    \t<span class=\"string\">\"端口1\"</span>:<span class=\"string\">\"密码1\"</span>,</span><br><span class=\"line\">    \t<span class=\"string\">\"端口2\"</span>:<span class=\"string\">\"密码2\"</span>,</span><br><span class=\"line\">    \t<span class=\"string\">\"端口3\"</span>:<span class=\"string\">\"密码3\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"string\">\"timeout\"</span>:<span class=\"number\">600</span>,</span><br><span class=\"line\">    <span class=\"string\">\"method\"</span>:<span class=\"string\">\"rc4-md5\"</span>,</span><br><span class=\"line\">  \t<span class=\"string\">\"fast_open\"</span>: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>my_server_ip</code>填你的服务器地址</p>\n<p><code>端口1、密码1</code>填你要分配给客户端的端口和密码，比如’8388’:”123456”，后面的端口、密码同理</p>\n</blockquote>\n<p><strong>注意</strong>：<code>method</code>一栏，默认是<code>aes-256-cfb</code>，这里改为<code>rc4-md5</code>，这样上网会快一些，相应的客户端加密也要改成<code>rc4-md5</code>，别忘了</p>\n<p>这里设置的项都是给你客户端连接时使用的</p>\n<p>填好后，按<code>ESC</code>键退出编辑模式，输出<code>:wq</code>保存退出</p>\n<p><strong>第三步</strong>，开启或关闭服务</p>\n<p>使用以下命令</p>\n<p>开启服务</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssserver -c /etc/shadowsocks.json -d start</span><br></pre></td></tr></table></figure>\n<p>关闭服务</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssserver -c /etc/shadowsocks.json -d stop</span><br></pre></td></tr></table></figure>\n<p><strong>开机自启动</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/rc.local</span><br></pre></td></tr></table></figure>\n<p>在<code>rc.local</code>中添加</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ssserver -c /etc/shadowsocks.json -d start</span><br></pre></td></tr></table></figure>\n<p>大功告成，愉快的玩耍吧(^^)</p>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>之前一篇文章，我们讲了<a href=\"/2018/02/26/study/study-bwh-ssr/\">合适懒人的搬瓦工+ShadowsocksX教程</a>，我们使用的是<code>搬瓦工</code>自己的服务进行安装的，还没有看的同学请先看下。本篇主要讲解如何使用命令行的方式进行安装<code>shadowsocks</code>，配置单用户和多用户。</p>\n<p>如何进入服务器: <a href=\"/2018/01/30/study/study-centos-ssh/\">使用SSH客户端(Termius)连接服务器</a></p>","more":"<h3 id=\"shadowsocks服务器配置\"><a href=\"#shadowsocks服务器配置\" class=\"headerlink\" title=\"shadowsocks服务器配置\"></a>shadowsocks服务器配置</h3><p>这里我们安装的是python版本，首先进入官网:<a href=\"https://github.com/shadowsocks/shadowsocks/tree/master\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks/tree/master</a></p>\n<p>进入后拖动页面，找到自己的服务器版本，我们这里以<code>CentOS</code>为例:</p>\n<h4 id=\"安装Git\"><a href=\"#安装Git\" class=\"headerlink\" title=\"安装Git\"></a>安装Git</h4><p>安装shadowsocks，需要先安装<code>git</code></p>\n<p><strong>CentOS</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y git</span><br></pre></td></tr></table></figure>\n<p><strong>Debian / Ubuntu</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install -y git</span><br></pre></td></tr></table></figure>\n<h4 id=\"安装shadowsocks\"><a href=\"#安装shadowsocks\" class=\"headerlink\" title=\"安装shadowsocks\"></a>安装shadowsocks</h4><p><strong>CentOS</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install python-setuptools &amp;&amp; easy_install pip</span><br><span class=\"line\">pip install git+https://github.com/shadowsocks/shadowsocks.git@master</span><br></pre></td></tr></table></figure>\n<p><strong>Debian / Ubuntu</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install python-pip</span><br><span class=\"line\">pip install git+https://github.com/shadowsocks/shadowsocks.git@master</span><br></pre></td></tr></table></figure>\n<p>安装完成后，打开 <a href=\"https://github.com/shadowsocks/shadowsocks/wiki/Configuration-via-Config-File\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks/wiki/Configuration-via-Config-File</a></p>\n<p>我们可以看到官网的一些描述，这里简单说明一下：</p>\n<p><strong>第一步</strong>，创建一个<code>shadowsocks.json</code>文件并打开，使用以下命令</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/shadowsocks.json</span><br></pre></td></tr></table></figure>\n<p><strong>第二步</strong>，按<code>i</code>键进入编辑模式，当按下<code>i</code>时，这时左下角会显示 <code>INSERT</code>字样，表示当前处于编辑模式。输入以下内容(因为是命令行模式，所以大家可以先使用文本编辑器，写好下面的文字，然后复制一下，贴到你的命令行)</p>\n<p><strong>单用户配置</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"server\"</span>:<span class=\"string\">\"my_server_ip\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"server_port\"</span>:<span class=\"number\">8388</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_port\"</span>:<span class=\"number\">1080</span>,</span><br><span class=\"line\">    <span class=\"string\">\"password\"</span>:<span class=\"string\">\"mypassword\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"timeout\"</span>:<span class=\"number\">300</span>,</span><br><span class=\"line\">    <span class=\"string\">\"method\"</span>:<span class=\"string\">\"rc4-md5\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"fast_open\"</span>: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>my_server_ip</code>填你的服务器地址</p>\n<p>8388填你的端口(自定义的，可能不更改，保留8388)</p>\n<p><code>mypassword</code>填写你要设置的密码</p>\n</blockquote>\n<p><strong>多用户配置</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"server\"</span>:<span class=\"string\">\"my_server_ip\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_address\"</span>:<span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_port\"</span>:<span class=\"number\">1080</span>,</span><br><span class=\"line\">    <span class=\"string\">\"port_password\"</span>:&#123;</span><br><span class=\"line\">    \t<span class=\"string\">\"端口1\"</span>:<span class=\"string\">\"密码1\"</span>,</span><br><span class=\"line\">    \t<span class=\"string\">\"端口2\"</span>:<span class=\"string\">\"密码2\"</span>,</span><br><span class=\"line\">    \t<span class=\"string\">\"端口3\"</span>:<span class=\"string\">\"密码3\"</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"string\">\"timeout\"</span>:<span class=\"number\">600</span>,</span><br><span class=\"line\">    <span class=\"string\">\"method\"</span>:<span class=\"string\">\"rc4-md5\"</span>,</span><br><span class=\"line\">  \t<span class=\"string\">\"fast_open\"</span>: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>my_server_ip</code>填你的服务器地址</p>\n<p><code>端口1、密码1</code>填你要分配给客户端的端口和密码，比如’8388’:”123456”，后面的端口、密码同理</p>\n</blockquote>\n<p><strong>注意</strong>：<code>method</code>一栏，默认是<code>aes-256-cfb</code>，这里改为<code>rc4-md5</code>，这样上网会快一些，相应的客户端加密也要改成<code>rc4-md5</code>，别忘了</p>\n<p>这里设置的项都是给你客户端连接时使用的</p>\n<p>填好后，按<code>ESC</code>键退出编辑模式，输出<code>:wq</code>保存退出</p>\n<p><strong>第三步</strong>，开启或关闭服务</p>\n<p>使用以下命令</p>\n<p>开启服务</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssserver -c /etc/shadowsocks.json -d start</span><br></pre></td></tr></table></figure>\n<p>关闭服务</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssserver -c /etc/shadowsocks.json -d stop</span><br></pre></td></tr></table></figure>\n<p><strong>开机自启动</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/rc.local</span><br></pre></td></tr></table></figure>\n<p>在<code>rc.local</code>中添加</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ssserver -c /etc/shadowsocks.json -d start</span><br></pre></td></tr></table></figure>\n<p>大功告成，愉快的玩耍吧(^^)</p>"},{"title":"合适懒人的搬瓦工+ShadowsocksX教程","date":"2018-02-26T06:09:55.000Z","_content":"\n**建议大家自行安装shadowsocks(可以配置单、多用户)，传送门：[shadowsocks多用户配置](/2018/01/26/study/study-bwh-ss/)，不喜欢折腾的，可以继续往下看**\n\n### VPS服务器搭建\n\n通过之前一篇文章[多图详解搬瓦工(Bandwagon)购买流程](/2018/01/25/study/study-bwh/)，我们已经完成了VPS的购买，接下来我们开始搭建自己的服务器\n\n我们先回到首页，点击`Client Area`，`Client Area`会出现在下面2个地方\n\n![bwh_home_client_area_top](/img/study/bwh_home_client_area_top.jpg)\n\n![bwh_home_client_ares](/img/study/bwh_home_client_ares.jpg)\n\n点击后进入到下面的界面\n\n![bwh_home_services](/img/study/bwh_home_services.jpg)\n\n依次点击`Services` -> `My Services`，进入到下面的界面\n\n![bwh_home_services_detail](/img/study/bwh_home_services_detail.jpg)\n\n这里我们点击`KiwiVM Control Panel`进入到服务器控制面版。进入到服务器控制面版后，先把服务停掉(待会要重装系统)。\n\n![bwh_kiwi_main](/img/study/bwh_kiwi_main.jpg)\n\n搬瓦工提供无限次重装系统，这里我们先把服务停掉，重装一下系统。停掉服务后，点击左侧的`ShadowsocksR Server`，进入到`ShadowsocksR Server`界面，查看一下支持的`系统版本`\n\n![bwh_kiwi_ss](/img/study/bwh_kiwi_ss.jpg)\n\n从图中，我们可以看过，`ShadowsocksR Server`只支持`Centos 6 (32 or 64 bit)`的系统 ，所以我们需要重装一个`Centos 6 (32 or 64 bit) `的系统。\n\n点击左边的`Install new OS`，选择`centos-6-x86_64-bbr`，进行重装系统\n\n![bwh_kiwi_new_os](/img/study/bwh_kiwi_new_os.jpg)\n\n点击`reload`，进行重装系统 ，同时会进入下面的界面\n\n![bwh_kiwi_new_os_info](/img/study/bwh_kiwi_new_os_info.jpg)\n\n这里的`端口`和`服务器密码`需要记下来，方便以后使用ssh连接服务器使用\n\n如何进入服务器: [使用SSH客户端(Termius)连接服务器](/2018/01/30/study/study-centenos-ssh/)\n\n稍等一会，刷新页面，点击左侧的`Main controls`，出现下面的界面，表示系统安装成功\n\n![bwh_kiwi_main_new](/img/study/bwh_kiwi_main_new.jpg)\n\n接下来，我们要安装`ShadowsocksX`服务\n\n### ShadowsocksX服务安装\n\n点击左侧的`ShadowsocksR Server`\n\n![bwh_kiwi_ss_install](/img/study/bwh_kiwi_ss_install.jpg)\n\n等待安装完成，出现下面界面，表示安装成功\n\n![bwh_kiwi_ss_completed](/img/study/bwh_kiwi_ss_completed.jpg)\n\n点击`Go back`，进入详情页，拖到到页面到`Step 2`。不要关闭这个界面，后面会用到\n\n![bwh_kiwi_ss_info](/img/study/bwh_kiwi_ss_info.jpg)\n\n至此，我们的ShadowsocksX服务安装完成，接下来，我们需要安装`ShadowsocksX`客户端\n\n### ShadowsocksX客户端安装\n\n这里以`Mac OS`系统为例，其它平台可以参考下面文章\n\n##### Mac平台\n\n点击https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-Help\n\n![bwh_ss_mac_os](/img/study/bwh_ss_mac_os.jpg)\n\n点击图中标示的链接，会进入到一个下载页，点击`Download`开始下载，下载完成后安装，安装成功后，打开`ShadowsocksX`，打开后，会在菜单出现一个`纸飞机图标`，点击它\n\n![bwh_ss_client](/img/study/bwh_ss_client.jpg)\n\n因为我之前配过2个服务器，所以上面会显示2条记录。点击`打开服务器设定`\n\n![bwh_kiwi_all](/img/study/bwh_kiwi_all.jpg)\n\n照着填就可以了，填完点击`确定`。大功告成，可以科学上网啦！(依然上不了的，可以把客户端软件关了，再重开)\n\n![bwh_ss_complete](/img/study/bwh_ss_complete.jpg)\n\n##### Windows平台\n\n点击https://github.com/shadowsocks/shadowsocks-windows/releases\n\n![bwh_ss_windows](/img/study/bwh_ss_windows.jpg)\n\n##### 其它平台\n\n地址：https://github.com/shadowsocks?page=1\n\n自己慢慢找吧(^^)","source":"_posts/study/study-bwh-ssr.md","raw":"---\ntitle: 合适懒人的搬瓦工+ShadowsocksX教程\ndate: 2018-02-26 14:09:55\ntags: study\n---\n\n**建议大家自行安装shadowsocks(可以配置单、多用户)，传送门：[shadowsocks多用户配置](/2018/01/26/study/study-bwh-ss/)，不喜欢折腾的，可以继续往下看**\n\n### VPS服务器搭建\n\n通过之前一篇文章[多图详解搬瓦工(Bandwagon)购买流程](/2018/01/25/study/study-bwh/)，我们已经完成了VPS的购买，接下来我们开始搭建自己的服务器\n\n我们先回到首页，点击`Client Area`，`Client Area`会出现在下面2个地方\n\n![bwh_home_client_area_top](/img/study/bwh_home_client_area_top.jpg)\n\n![bwh_home_client_ares](/img/study/bwh_home_client_ares.jpg)\n\n点击后进入到下面的界面\n\n![bwh_home_services](/img/study/bwh_home_services.jpg)\n\n依次点击`Services` -> `My Services`，进入到下面的界面\n\n![bwh_home_services_detail](/img/study/bwh_home_services_detail.jpg)\n\n这里我们点击`KiwiVM Control Panel`进入到服务器控制面版。进入到服务器控制面版后，先把服务停掉(待会要重装系统)。\n\n![bwh_kiwi_main](/img/study/bwh_kiwi_main.jpg)\n\n搬瓦工提供无限次重装系统，这里我们先把服务停掉，重装一下系统。停掉服务后，点击左侧的`ShadowsocksR Server`，进入到`ShadowsocksR Server`界面，查看一下支持的`系统版本`\n\n![bwh_kiwi_ss](/img/study/bwh_kiwi_ss.jpg)\n\n从图中，我们可以看过，`ShadowsocksR Server`只支持`Centos 6 (32 or 64 bit)`的系统 ，所以我们需要重装一个`Centos 6 (32 or 64 bit) `的系统。\n\n点击左边的`Install new OS`，选择`centos-6-x86_64-bbr`，进行重装系统\n\n![bwh_kiwi_new_os](/img/study/bwh_kiwi_new_os.jpg)\n\n点击`reload`，进行重装系统 ，同时会进入下面的界面\n\n![bwh_kiwi_new_os_info](/img/study/bwh_kiwi_new_os_info.jpg)\n\n这里的`端口`和`服务器密码`需要记下来，方便以后使用ssh连接服务器使用\n\n如何进入服务器: [使用SSH客户端(Termius)连接服务器](/2018/01/30/study/study-centenos-ssh/)\n\n稍等一会，刷新页面，点击左侧的`Main controls`，出现下面的界面，表示系统安装成功\n\n![bwh_kiwi_main_new](/img/study/bwh_kiwi_main_new.jpg)\n\n接下来，我们要安装`ShadowsocksX`服务\n\n### ShadowsocksX服务安装\n\n点击左侧的`ShadowsocksR Server`\n\n![bwh_kiwi_ss_install](/img/study/bwh_kiwi_ss_install.jpg)\n\n等待安装完成，出现下面界面，表示安装成功\n\n![bwh_kiwi_ss_completed](/img/study/bwh_kiwi_ss_completed.jpg)\n\n点击`Go back`，进入详情页，拖到到页面到`Step 2`。不要关闭这个界面，后面会用到\n\n![bwh_kiwi_ss_info](/img/study/bwh_kiwi_ss_info.jpg)\n\n至此，我们的ShadowsocksX服务安装完成，接下来，我们需要安装`ShadowsocksX`客户端\n\n### ShadowsocksX客户端安装\n\n这里以`Mac OS`系统为例，其它平台可以参考下面文章\n\n##### Mac平台\n\n点击https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-Help\n\n![bwh_ss_mac_os](/img/study/bwh_ss_mac_os.jpg)\n\n点击图中标示的链接，会进入到一个下载页，点击`Download`开始下载，下载完成后安装，安装成功后，打开`ShadowsocksX`，打开后，会在菜单出现一个`纸飞机图标`，点击它\n\n![bwh_ss_client](/img/study/bwh_ss_client.jpg)\n\n因为我之前配过2个服务器，所以上面会显示2条记录。点击`打开服务器设定`\n\n![bwh_kiwi_all](/img/study/bwh_kiwi_all.jpg)\n\n照着填就可以了，填完点击`确定`。大功告成，可以科学上网啦！(依然上不了的，可以把客户端软件关了，再重开)\n\n![bwh_ss_complete](/img/study/bwh_ss_complete.jpg)\n\n##### Windows平台\n\n点击https://github.com/shadowsocks/shadowsocks-windows/releases\n\n![bwh_ss_windows](/img/study/bwh_ss_windows.jpg)\n\n##### 其它平台\n\n地址：https://github.com/shadowsocks?page=1\n\n自己慢慢找吧(^^)","slug":"study/study-bwh-ssr","published":1,"updated":"2018-05-20T13:04:25.689Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g2004dizcbajb043lk","content":"<p><strong>建议大家自行安装shadowsocks(可以配置单、多用户)，传送门：<a href=\"/2018/01/26/study/study-bwh-ss/\">shadowsocks多用户配置</a>，不喜欢折腾的，可以继续往下看</strong></p>\n<h3 id=\"VPS服务器搭建\"><a href=\"#VPS服务器搭建\" class=\"headerlink\" title=\"VPS服务器搭建\"></a>VPS服务器搭建</h3><p>通过之前一篇文章<a href=\"/2018/01/25/study/study-bwh/\">多图详解搬瓦工(Bandwagon)购买流程</a>，我们已经完成了VPS的购买，接下来我们开始搭建自己的服务器</p>\n<p>我们先回到首页，点击<code>Client Area</code>，<code>Client Area</code>会出现在下面2个地方</p>\n<p><img src=\"/img/study/bwh_home_client_area_top.jpg\" alt=\"bwh_home_client_area_top\"></p>\n<p><img src=\"/img/study/bwh_home_client_ares.jpg\" alt=\"bwh_home_client_ares\"></p>\n<p>点击后进入到下面的界面</p>\n<p><img src=\"/img/study/bwh_home_services.jpg\" alt=\"bwh_home_services\"></p>\n<p>依次点击<code>Services</code> -&gt; <code>My Services</code>，进入到下面的界面</p>\n<p><img src=\"/img/study/bwh_home_services_detail.jpg\" alt=\"bwh_home_services_detail\"></p>\n<p>这里我们点击<code>KiwiVM Control Panel</code>进入到服务器控制面版。进入到服务器控制面版后，先把服务停掉(待会要重装系统)。</p>\n<p><img src=\"/img/study/bwh_kiwi_main.jpg\" alt=\"bwh_kiwi_main\"></p>\n<p>搬瓦工提供无限次重装系统，这里我们先把服务停掉，重装一下系统。停掉服务后，点击左侧的<code>ShadowsocksR Server</code>，进入到<code>ShadowsocksR Server</code>界面，查看一下支持的<code>系统版本</code></p>\n<p><img src=\"/img/study/bwh_kiwi_ss.jpg\" alt=\"bwh_kiwi_ss\"></p>\n<p>从图中，我们可以看过，<code>ShadowsocksR Server</code>只支持<code>Centos 6 (32 or 64 bit)</code>的系统 ，所以我们需要重装一个<code>Centos 6 (32 or 64 bit)</code>的系统。</p>\n<p>点击左边的<code>Install new OS</code>，选择<code>centos-6-x86_64-bbr</code>，进行重装系统</p>\n<p><img src=\"/img/study/bwh_kiwi_new_os.jpg\" alt=\"bwh_kiwi_new_os\"></p>\n<p>点击<code>reload</code>，进行重装系统 ，同时会进入下面的界面</p>\n<p><img src=\"/img/study/bwh_kiwi_new_os_info.jpg\" alt=\"bwh_kiwi_new_os_info\"></p>\n<p>这里的<code>端口</code>和<code>服务器密码</code>需要记下来，方便以后使用ssh连接服务器使用</p>\n<p>如何进入服务器: <a href=\"/2018/01/30/study/study-centenos-ssh/\">使用SSH客户端(Termius)连接服务器</a></p>\n<p>稍等一会，刷新页面，点击左侧的<code>Main controls</code>，出现下面的界面，表示系统安装成功</p>\n<p><img src=\"/img/study/bwh_kiwi_main_new.jpg\" alt=\"bwh_kiwi_main_new\"></p>\n<p>接下来，我们要安装<code>ShadowsocksX</code>服务</p>\n<h3 id=\"ShadowsocksX服务安装\"><a href=\"#ShadowsocksX服务安装\" class=\"headerlink\" title=\"ShadowsocksX服务安装\"></a>ShadowsocksX服务安装</h3><p>点击左侧的<code>ShadowsocksR Server</code></p>\n<p><img src=\"/img/study/bwh_kiwi_ss_install.jpg\" alt=\"bwh_kiwi_ss_install\"></p>\n<p>等待安装完成，出现下面界面，表示安装成功</p>\n<p><img src=\"/img/study/bwh_kiwi_ss_completed.jpg\" alt=\"bwh_kiwi_ss_completed\"></p>\n<p>点击<code>Go back</code>，进入详情页，拖到到页面到<code>Step 2</code>。不要关闭这个界面，后面会用到</p>\n<p><img src=\"/img/study/bwh_kiwi_ss_info.jpg\" alt=\"bwh_kiwi_ss_info\"></p>\n<p>至此，我们的ShadowsocksX服务安装完成，接下来，我们需要安装<code>ShadowsocksX</code>客户端</p>\n<h3 id=\"ShadowsocksX客户端安装\"><a href=\"#ShadowsocksX客户端安装\" class=\"headerlink\" title=\"ShadowsocksX客户端安装\"></a>ShadowsocksX客户端安装</h3><p>这里以<code>Mac OS</code>系统为例，其它平台可以参考下面文章</p>\n<h5 id=\"Mac平台\"><a href=\"#Mac平台\" class=\"headerlink\" title=\"Mac平台\"></a>Mac平台</h5><p>点击<a href=\"https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-Help\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-Help</a></p>\n<p><img src=\"/img/study/bwh_ss_mac_os.jpg\" alt=\"bwh_ss_mac_os\"></p>\n<p>点击图中标示的链接，会进入到一个下载页，点击<code>Download</code>开始下载，下载完成后安装，安装成功后，打开<code>ShadowsocksX</code>，打开后，会在菜单出现一个<code>纸飞机图标</code>，点击它</p>\n<p><img src=\"/img/study/bwh_ss_client.jpg\" alt=\"bwh_ss_client\"></p>\n<p>因为我之前配过2个服务器，所以上面会显示2条记录。点击<code>打开服务器设定</code></p>\n<p><img src=\"/img/study/bwh_kiwi_all.jpg\" alt=\"bwh_kiwi_all\"></p>\n<p>照着填就可以了，填完点击<code>确定</code>。大功告成，可以科学上网啦！(依然上不了的，可以把客户端软件关了，再重开)</p>\n<p><img src=\"/img/study/bwh_ss_complete.jpg\" alt=\"bwh_ss_complete\"></p>\n<h5 id=\"Windows平台\"><a href=\"#Windows平台\" class=\"headerlink\" title=\"Windows平台\"></a>Windows平台</h5><p>点击<a href=\"https://github.com/shadowsocks/shadowsocks-windows/releases\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks-windows/releases</a></p>\n<p><img src=\"/img/study/bwh_ss_windows.jpg\" alt=\"bwh_ss_windows\"></p>\n<h5 id=\"其它平台\"><a href=\"#其它平台\" class=\"headerlink\" title=\"其它平台\"></a>其它平台</h5><p>地址：<a href=\"https://github.com/shadowsocks?page=1\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks?page=1</a></p>\n<p>自己慢慢找吧(^^)</p>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>建议大家自行安装shadowsocks(可以配置单、多用户)，传送门：<a href=\"/2018/01/26/study/study-bwh-ss/\">shadowsocks多用户配置</a>，不喜欢折腾的，可以继续往下看</strong></p>\n<h3 id=\"VPS服务器搭建\"><a href=\"#VPS服务器搭建\" class=\"headerlink\" title=\"VPS服务器搭建\"></a>VPS服务器搭建</h3><p>通过之前一篇文章<a href=\"/2018/01/25/study/study-bwh/\">多图详解搬瓦工(Bandwagon)购买流程</a>，我们已经完成了VPS的购买，接下来我们开始搭建自己的服务器</p>\n<p>我们先回到首页，点击<code>Client Area</code>，<code>Client Area</code>会出现在下面2个地方</p>\n<p><img src=\"/img/study/bwh_home_client_area_top.jpg\" alt=\"bwh_home_client_area_top\"></p>\n<p><img src=\"/img/study/bwh_home_client_ares.jpg\" alt=\"bwh_home_client_ares\"></p>\n<p>点击后进入到下面的界面</p>\n<p><img src=\"/img/study/bwh_home_services.jpg\" alt=\"bwh_home_services\"></p>\n<p>依次点击<code>Services</code> -&gt; <code>My Services</code>，进入到下面的界面</p>\n<p><img src=\"/img/study/bwh_home_services_detail.jpg\" alt=\"bwh_home_services_detail\"></p>\n<p>这里我们点击<code>KiwiVM Control Panel</code>进入到服务器控制面版。进入到服务器控制面版后，先把服务停掉(待会要重装系统)。</p>\n<p><img src=\"/img/study/bwh_kiwi_main.jpg\" alt=\"bwh_kiwi_main\"></p>\n<p>搬瓦工提供无限次重装系统，这里我们先把服务停掉，重装一下系统。停掉服务后，点击左侧的<code>ShadowsocksR Server</code>，进入到<code>ShadowsocksR Server</code>界面，查看一下支持的<code>系统版本</code></p>\n<p><img src=\"/img/study/bwh_kiwi_ss.jpg\" alt=\"bwh_kiwi_ss\"></p>\n<p>从图中，我们可以看过，<code>ShadowsocksR Server</code>只支持<code>Centos 6 (32 or 64 bit)</code>的系统 ，所以我们需要重装一个<code>Centos 6 (32 or 64 bit)</code>的系统。</p>\n<p>点击左边的<code>Install new OS</code>，选择<code>centos-6-x86_64-bbr</code>，进行重装系统</p>\n<p><img src=\"/img/study/bwh_kiwi_new_os.jpg\" alt=\"bwh_kiwi_new_os\"></p>\n<p>点击<code>reload</code>，进行重装系统 ，同时会进入下面的界面</p>\n<p><img src=\"/img/study/bwh_kiwi_new_os_info.jpg\" alt=\"bwh_kiwi_new_os_info\"></p>\n<p>这里的<code>端口</code>和<code>服务器密码</code>需要记下来，方便以后使用ssh连接服务器使用</p>\n<p>如何进入服务器: <a href=\"/2018/01/30/study/study-centenos-ssh/\">使用SSH客户端(Termius)连接服务器</a></p>\n<p>稍等一会，刷新页面，点击左侧的<code>Main controls</code>，出现下面的界面，表示系统安装成功</p>\n<p><img src=\"/img/study/bwh_kiwi_main_new.jpg\" alt=\"bwh_kiwi_main_new\"></p>\n<p>接下来，我们要安装<code>ShadowsocksX</code>服务</p>\n<h3 id=\"ShadowsocksX服务安装\"><a href=\"#ShadowsocksX服务安装\" class=\"headerlink\" title=\"ShadowsocksX服务安装\"></a>ShadowsocksX服务安装</h3><p>点击左侧的<code>ShadowsocksR Server</code></p>\n<p><img src=\"/img/study/bwh_kiwi_ss_install.jpg\" alt=\"bwh_kiwi_ss_install\"></p>\n<p>等待安装完成，出现下面界面，表示安装成功</p>\n<p><img src=\"/img/study/bwh_kiwi_ss_completed.jpg\" alt=\"bwh_kiwi_ss_completed\"></p>\n<p>点击<code>Go back</code>，进入详情页，拖到到页面到<code>Step 2</code>。不要关闭这个界面，后面会用到</p>\n<p><img src=\"/img/study/bwh_kiwi_ss_info.jpg\" alt=\"bwh_kiwi_ss_info\"></p>\n<p>至此，我们的ShadowsocksX服务安装完成，接下来，我们需要安装<code>ShadowsocksX</code>客户端</p>\n<h3 id=\"ShadowsocksX客户端安装\"><a href=\"#ShadowsocksX客户端安装\" class=\"headerlink\" title=\"ShadowsocksX客户端安装\"></a>ShadowsocksX客户端安装</h3><p>这里以<code>Mac OS</code>系统为例，其它平台可以参考下面文章</p>\n<h5 id=\"Mac平台\"><a href=\"#Mac平台\" class=\"headerlink\" title=\"Mac平台\"></a>Mac平台</h5><p>点击<a href=\"https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-Help\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks-iOS/wiki/Shadowsocks-for-OSX-Help</a></p>\n<p><img src=\"/img/study/bwh_ss_mac_os.jpg\" alt=\"bwh_ss_mac_os\"></p>\n<p>点击图中标示的链接，会进入到一个下载页，点击<code>Download</code>开始下载，下载完成后安装，安装成功后，打开<code>ShadowsocksX</code>，打开后，会在菜单出现一个<code>纸飞机图标</code>，点击它</p>\n<p><img src=\"/img/study/bwh_ss_client.jpg\" alt=\"bwh_ss_client\"></p>\n<p>因为我之前配过2个服务器，所以上面会显示2条记录。点击<code>打开服务器设定</code></p>\n<p><img src=\"/img/study/bwh_kiwi_all.jpg\" alt=\"bwh_kiwi_all\"></p>\n<p>照着填就可以了，填完点击<code>确定</code>。大功告成，可以科学上网啦！(依然上不了的，可以把客户端软件关了，再重开)</p>\n<p><img src=\"/img/study/bwh_ss_complete.jpg\" alt=\"bwh_ss_complete\"></p>\n<h5 id=\"Windows平台\"><a href=\"#Windows平台\" class=\"headerlink\" title=\"Windows平台\"></a>Windows平台</h5><p>点击<a href=\"https://github.com/shadowsocks/shadowsocks-windows/releases\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks-windows/releases</a></p>\n<p><img src=\"/img/study/bwh_ss_windows.jpg\" alt=\"bwh_ss_windows\"></p>\n<h5 id=\"其它平台\"><a href=\"#其它平台\" class=\"headerlink\" title=\"其它平台\"></a>其它平台</h5><p>地址：<a href=\"https://github.com/shadowsocks?page=1\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks?page=1</a></p>\n<p>自己慢慢找吧(^^)</p>\n"},{"title":"多图详解搬瓦工(Bandwagon)购买流程","date":"2018-01-25T02:52:11.000Z","_content":"\n（温馨提示：本文图片较多，请在WIFI情况下阅读）\n\n### 前言\n\n在天朝，因为qian的原因，很多外网是访问不了的。身为程序员，很多时候是需要访问`google`进行问题搜索，这时候就需要fan qiang进行科学上网了。\n\n可能有相当一部分人是买的VPN进行科学上网，但VPN一般比较贵，也不稳定，不如自己搭建VPS（相当于自己买一台海外服务器），一方面可以可以学习一下Linux，一方面还可以科学上网，还比VPN便宜不少。\n\n<!-- More -->\n\n### VPS购买\n\n其实VPS搭建还是比较简单的，本文使用搬瓦工(Bandwagon)，搬瓦工对新手比较友好，而且官方支持ShadowsocksX，最重要的是支持`支付宝`，省去了很多麻烦，官网：https://bwh1.net\n\n首先进入官网\n\n![bwh_home](/img/study/bwh_home.jpg)\n\n点击`VPS Hosting`，进入到VPS Hosting页面，我们先选择最便宜的一款，购买完成后可以根据自身情况进行升降服务器，后续会介绍如何升降。KVM是新的架构，OVZ是老的架构，大家要选Order KVM，不要选错了。\n\n> 大家不知道选哪个的话，可以网上搜一搜，推荐个地方：\n>\n> http://banwagong.cn/gonglue.html\n>\n\n![bwh_host](/img/study/bwh_host.jpg)\n\n点击`Order KVM`，进入到详情页面，因为`搬瓦工`的VPS是经常变换的，可能你看到的页面和我的不太一样，不过没关系，下面我们会说到。\n\n![bwh_order_cycle](/img/study/bwh_order_cycle.jpg)\n\n因为我选的这个VPS，只支持年付，所有`Billing CyCle`只有一个选项。你的VPS可能是下面的这种情况，我这里的截图是20G VPS的，因为10G VPS的只支持年付，没法截下面的图\n\n![bwh_order_cycle_more](/img/study/bwh_order_cycle_more.jpg)\n\n> 注意：\n>\n> Monthly 表示月付，就是使用一个月\n>\n> Quarterly 表示季付，就是使用三个月\n>\n> Semi-Annually 表示半年\n>\n> Annually 表示一年\n\n建议大家选择一年，相对便宜，选完`Billing Cycle`，接下来选机房\n\n![bwh_order_location](/img/study/bwh_order_location.jpg)\n\n这里我们选择洛杉矶机机房，上面的第二项(后续可以在控制面板切换)，选完之后点击下方的`Add to Cart`，进入到`订单汇总页面`\n\n![bwh_order_detail](/img/study/bwh_order_detail.jpg)\n\n这里我们使用`BWH1ZBPVK`这个优惠码(随时失效，大家可以百度搜一搜优惠码)，输入完优惠码后，点击右边的`Validate Code>>`，出现下面的界面，表示优惠码有效\n\n![bwh_order_detail_pc](/img/study/bwh_order_detail_pc.jpg)\n\n确认没问题后，点击`Checkout`去结账\n\n![bwh_order_complete](/img/study/bwh_order_complete.jpg)\n\n如果有账号的话，点击`Click me to login`进行登录。没有的话，填写下面的项，后面标了`红色`字体的尽量都填上，最好真实的，防止被误认为`订单欺诈`\n\n> 重要提示：不要填中文，使用拼音代替。比如：姓名叫李白，LastName填`li`，FirstName填`bai`\n>\n> ，还有State/Region一栏，要先选择Country，这样State/Region才会变\n\n输入完成之后，点击`Update`。\n\n接下来选择支付方式，我们这里选择`支付宝`\n\n![bwh_order_pay](/img/study/bwh_order_pay.jpg)\n\n点击`Complete Order`，会进入到`支付宝`支付界面\n\n![bwh_order_pay_complete](/img/study/bwh_order_pay_complete.jpg)\n\n扫描完成支付(不要扫图中的码哦)，支付成功后会收到邮件通知，里面会有你的服务器ip地址等信息。\n\n### 科学上网\n\n传送门：[合适懒人的搬瓦工+ShadowsocksX教程](/2018/02/26/study/study-bwh-ssr/)\n\n### VPS服务器升降\n\n还记得文章上述的这个界面吗\n\n![bwh_home_services_detail](/img/study/bwh_home_services_detail.jpg)\n\n点击`Manage`，进入到服务器管理页\n\n![bwh_service_info](/img/study/bwh_service_info.jpg)\n\n点击后，进入下面的界面，大家可以按需选择\n\n![bwh_service_detail](/img/study/bwh_service_detail.jpg)","source":"_posts/study/study-bwh.md","raw":"---\ntitle: 多图详解搬瓦工(Bandwagon)购买流程\ndate: 2018-01-25 10:52:11\ntags: study\n---\n\n（温馨提示：本文图片较多，请在WIFI情况下阅读）\n\n### 前言\n\n在天朝，因为qian的原因，很多外网是访问不了的。身为程序员，很多时候是需要访问`google`进行问题搜索，这时候就需要fan qiang进行科学上网了。\n\n可能有相当一部分人是买的VPN进行科学上网，但VPN一般比较贵，也不稳定，不如自己搭建VPS（相当于自己买一台海外服务器），一方面可以可以学习一下Linux，一方面还可以科学上网，还比VPN便宜不少。\n\n<!-- More -->\n\n### VPS购买\n\n其实VPS搭建还是比较简单的，本文使用搬瓦工(Bandwagon)，搬瓦工对新手比较友好，而且官方支持ShadowsocksX，最重要的是支持`支付宝`，省去了很多麻烦，官网：https://bwh1.net\n\n首先进入官网\n\n![bwh_home](/img/study/bwh_home.jpg)\n\n点击`VPS Hosting`，进入到VPS Hosting页面，我们先选择最便宜的一款，购买完成后可以根据自身情况进行升降服务器，后续会介绍如何升降。KVM是新的架构，OVZ是老的架构，大家要选Order KVM，不要选错了。\n\n> 大家不知道选哪个的话，可以网上搜一搜，推荐个地方：\n>\n> http://banwagong.cn/gonglue.html\n>\n\n![bwh_host](/img/study/bwh_host.jpg)\n\n点击`Order KVM`，进入到详情页面，因为`搬瓦工`的VPS是经常变换的，可能你看到的页面和我的不太一样，不过没关系，下面我们会说到。\n\n![bwh_order_cycle](/img/study/bwh_order_cycle.jpg)\n\n因为我选的这个VPS，只支持年付，所有`Billing CyCle`只有一个选项。你的VPS可能是下面的这种情况，我这里的截图是20G VPS的，因为10G VPS的只支持年付，没法截下面的图\n\n![bwh_order_cycle_more](/img/study/bwh_order_cycle_more.jpg)\n\n> 注意：\n>\n> Monthly 表示月付，就是使用一个月\n>\n> Quarterly 表示季付，就是使用三个月\n>\n> Semi-Annually 表示半年\n>\n> Annually 表示一年\n\n建议大家选择一年，相对便宜，选完`Billing Cycle`，接下来选机房\n\n![bwh_order_location](/img/study/bwh_order_location.jpg)\n\n这里我们选择洛杉矶机机房，上面的第二项(后续可以在控制面板切换)，选完之后点击下方的`Add to Cart`，进入到`订单汇总页面`\n\n![bwh_order_detail](/img/study/bwh_order_detail.jpg)\n\n这里我们使用`BWH1ZBPVK`这个优惠码(随时失效，大家可以百度搜一搜优惠码)，输入完优惠码后，点击右边的`Validate Code>>`，出现下面的界面，表示优惠码有效\n\n![bwh_order_detail_pc](/img/study/bwh_order_detail_pc.jpg)\n\n确认没问题后，点击`Checkout`去结账\n\n![bwh_order_complete](/img/study/bwh_order_complete.jpg)\n\n如果有账号的话，点击`Click me to login`进行登录。没有的话，填写下面的项，后面标了`红色`字体的尽量都填上，最好真实的，防止被误认为`订单欺诈`\n\n> 重要提示：不要填中文，使用拼音代替。比如：姓名叫李白，LastName填`li`，FirstName填`bai`\n>\n> ，还有State/Region一栏，要先选择Country，这样State/Region才会变\n\n输入完成之后，点击`Update`。\n\n接下来选择支付方式，我们这里选择`支付宝`\n\n![bwh_order_pay](/img/study/bwh_order_pay.jpg)\n\n点击`Complete Order`，会进入到`支付宝`支付界面\n\n![bwh_order_pay_complete](/img/study/bwh_order_pay_complete.jpg)\n\n扫描完成支付(不要扫图中的码哦)，支付成功后会收到邮件通知，里面会有你的服务器ip地址等信息。\n\n### 科学上网\n\n传送门：[合适懒人的搬瓦工+ShadowsocksX教程](/2018/02/26/study/study-bwh-ssr/)\n\n### VPS服务器升降\n\n还记得文章上述的这个界面吗\n\n![bwh_home_services_detail](/img/study/bwh_home_services_detail.jpg)\n\n点击`Manage`，进入到服务器管理页\n\n![bwh_service_info](/img/study/bwh_service_info.jpg)\n\n点击后，进入下面的界面，大家可以按需选择\n\n![bwh_service_detail](/img/study/bwh_service_detail.jpg)","slug":"study/study-bwh","published":1,"updated":"2018-05-20T13:04:25.689Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g2004fizcbq03b79nq","content":"<p>（温馨提示：本文图片较多，请在WIFI情况下阅读）</p>\n<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>在天朝，因为qian的原因，很多外网是访问不了的。身为程序员，很多时候是需要访问<code>google</code>进行问题搜索，这时候就需要fan qiang进行科学上网了。</p>\n<p>可能有相当一部分人是买的VPN进行科学上网，但VPN一般比较贵，也不稳定，不如自己搭建VPS（相当于自己买一台海外服务器），一方面可以可以学习一下Linux，一方面还可以科学上网，还比VPN便宜不少。</p>\n<a id=\"more\"></a>\n<h3 id=\"VPS购买\"><a href=\"#VPS购买\" class=\"headerlink\" title=\"VPS购买\"></a>VPS购买</h3><p>其实VPS搭建还是比较简单的，本文使用搬瓦工(Bandwagon)，搬瓦工对新手比较友好，而且官方支持ShadowsocksX，最重要的是支持<code>支付宝</code>，省去了很多麻烦，官网：<a href=\"https://bwh1.net\" target=\"_blank\" rel=\"noopener\">https://bwh1.net</a></p>\n<p>首先进入官网</p>\n<p><img src=\"/img/study/bwh_home.jpg\" alt=\"bwh_home\"></p>\n<p>点击<code>VPS Hosting</code>，进入到VPS Hosting页面，我们先选择最便宜的一款，购买完成后可以根据自身情况进行升降服务器，后续会介绍如何升降。KVM是新的架构，OVZ是老的架构，大家要选Order KVM，不要选错了。</p>\n<blockquote>\n<p>大家不知道选哪个的话，可以网上搜一搜，推荐个地方：</p>\n<p><a href=\"http://banwagong.cn/gonglue.html\" target=\"_blank\" rel=\"noopener\">http://banwagong.cn/gonglue.html</a></p>\n</blockquote>\n<p><img src=\"/img/study/bwh_host.jpg\" alt=\"bwh_host\"></p>\n<p>点击<code>Order KVM</code>，进入到详情页面，因为<code>搬瓦工</code>的VPS是经常变换的，可能你看到的页面和我的不太一样，不过没关系，下面我们会说到。</p>\n<p><img src=\"/img/study/bwh_order_cycle.jpg\" alt=\"bwh_order_cycle\"></p>\n<p>因为我选的这个VPS，只支持年付，所有<code>Billing CyCle</code>只有一个选项。你的VPS可能是下面的这种情况，我这里的截图是20G VPS的，因为10G VPS的只支持年付，没法截下面的图</p>\n<p><img src=\"/img/study/bwh_order_cycle_more.jpg\" alt=\"bwh_order_cycle_more\"></p>\n<blockquote>\n<p>注意：</p>\n<p>Monthly 表示月付，就是使用一个月</p>\n<p>Quarterly 表示季付，就是使用三个月</p>\n<p>Semi-Annually 表示半年</p>\n<p>Annually 表示一年</p>\n</blockquote>\n<p>建议大家选择一年，相对便宜，选完<code>Billing Cycle</code>，接下来选机房</p>\n<p><img src=\"/img/study/bwh_order_location.jpg\" alt=\"bwh_order_location\"></p>\n<p>这里我们选择洛杉矶机机房，上面的第二项(后续可以在控制面板切换)，选完之后点击下方的<code>Add to Cart</code>，进入到<code>订单汇总页面</code></p>\n<p><img src=\"/img/study/bwh_order_detail.jpg\" alt=\"bwh_order_detail\"></p>\n<p>这里我们使用<code>BWH1ZBPVK</code>这个优惠码(随时失效，大家可以百度搜一搜优惠码)，输入完优惠码后，点击右边的<code>Validate Code&gt;&gt;</code>，出现下面的界面，表示优惠码有效</p>\n<p><img src=\"/img/study/bwh_order_detail_pc.jpg\" alt=\"bwh_order_detail_pc\"></p>\n<p>确认没问题后，点击<code>Checkout</code>去结账</p>\n<p><img src=\"/img/study/bwh_order_complete.jpg\" alt=\"bwh_order_complete\"></p>\n<p>如果有账号的话，点击<code>Click me to login</code>进行登录。没有的话，填写下面的项，后面标了<code>红色</code>字体的尽量都填上，最好真实的，防止被误认为<code>订单欺诈</code></p>\n<blockquote>\n<p>重要提示：不要填中文，使用拼音代替。比如：姓名叫李白，LastName填<code>li</code>，FirstName填<code>bai</code></p>\n<p>，还有State/Region一栏，要先选择Country，这样State/Region才会变</p>\n</blockquote>\n<p>输入完成之后，点击<code>Update</code>。</p>\n<p>接下来选择支付方式，我们这里选择<code>支付宝</code></p>\n<p><img src=\"/img/study/bwh_order_pay.jpg\" alt=\"bwh_order_pay\"></p>\n<p>点击<code>Complete Order</code>，会进入到<code>支付宝</code>支付界面</p>\n<p><img src=\"/img/study/bwh_order_pay_complete.jpg\" alt=\"bwh_order_pay_complete\"></p>\n<p>扫描完成支付(不要扫图中的码哦)，支付成功后会收到邮件通知，里面会有你的服务器ip地址等信息。</p>\n<h3 id=\"科学上网\"><a href=\"#科学上网\" class=\"headerlink\" title=\"科学上网\"></a>科学上网</h3><p>传送门：<a href=\"/2018/02/26/study/study-bwh-ssr/\">合适懒人的搬瓦工+ShadowsocksX教程</a></p>\n<h3 id=\"VPS服务器升降\"><a href=\"#VPS服务器升降\" class=\"headerlink\" title=\"VPS服务器升降\"></a>VPS服务器升降</h3><p>还记得文章上述的这个界面吗</p>\n<p><img src=\"/img/study/bwh_home_services_detail.jpg\" alt=\"bwh_home_services_detail\"></p>\n<p>点击<code>Manage</code>，进入到服务器管理页</p>\n<p><img src=\"/img/study/bwh_service_info.jpg\" alt=\"bwh_service_info\"></p>\n<p>点击后，进入下面的界面，大家可以按需选择</p>\n<p><img src=\"/img/study/bwh_service_detail.jpg\" alt=\"bwh_service_detail\"></p>\n","site":{"data":{}},"excerpt":"<p>（温馨提示：本文图片较多，请在WIFI情况下阅读）</p>\n<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>在天朝，因为qian的原因，很多外网是访问不了的。身为程序员，很多时候是需要访问<code>google</code>进行问题搜索，这时候就需要fan qiang进行科学上网了。</p>\n<p>可能有相当一部分人是买的VPN进行科学上网，但VPN一般比较贵，也不稳定，不如自己搭建VPS（相当于自己买一台海外服务器），一方面可以可以学习一下Linux，一方面还可以科学上网，还比VPN便宜不少。</p>","more":"<h3 id=\"VPS购买\"><a href=\"#VPS购买\" class=\"headerlink\" title=\"VPS购买\"></a>VPS购买</h3><p>其实VPS搭建还是比较简单的，本文使用搬瓦工(Bandwagon)，搬瓦工对新手比较友好，而且官方支持ShadowsocksX，最重要的是支持<code>支付宝</code>，省去了很多麻烦，官网：<a href=\"https://bwh1.net\" target=\"_blank\" rel=\"noopener\">https://bwh1.net</a></p>\n<p>首先进入官网</p>\n<p><img src=\"/img/study/bwh_home.jpg\" alt=\"bwh_home\"></p>\n<p>点击<code>VPS Hosting</code>，进入到VPS Hosting页面，我们先选择最便宜的一款，购买完成后可以根据自身情况进行升降服务器，后续会介绍如何升降。KVM是新的架构，OVZ是老的架构，大家要选Order KVM，不要选错了。</p>\n<blockquote>\n<p>大家不知道选哪个的话，可以网上搜一搜，推荐个地方：</p>\n<p><a href=\"http://banwagong.cn/gonglue.html\" target=\"_blank\" rel=\"noopener\">http://banwagong.cn/gonglue.html</a></p>\n</blockquote>\n<p><img src=\"/img/study/bwh_host.jpg\" alt=\"bwh_host\"></p>\n<p>点击<code>Order KVM</code>，进入到详情页面，因为<code>搬瓦工</code>的VPS是经常变换的，可能你看到的页面和我的不太一样，不过没关系，下面我们会说到。</p>\n<p><img src=\"/img/study/bwh_order_cycle.jpg\" alt=\"bwh_order_cycle\"></p>\n<p>因为我选的这个VPS，只支持年付，所有<code>Billing CyCle</code>只有一个选项。你的VPS可能是下面的这种情况，我这里的截图是20G VPS的，因为10G VPS的只支持年付，没法截下面的图</p>\n<p><img src=\"/img/study/bwh_order_cycle_more.jpg\" alt=\"bwh_order_cycle_more\"></p>\n<blockquote>\n<p>注意：</p>\n<p>Monthly 表示月付，就是使用一个月</p>\n<p>Quarterly 表示季付，就是使用三个月</p>\n<p>Semi-Annually 表示半年</p>\n<p>Annually 表示一年</p>\n</blockquote>\n<p>建议大家选择一年，相对便宜，选完<code>Billing Cycle</code>，接下来选机房</p>\n<p><img src=\"/img/study/bwh_order_location.jpg\" alt=\"bwh_order_location\"></p>\n<p>这里我们选择洛杉矶机机房，上面的第二项(后续可以在控制面板切换)，选完之后点击下方的<code>Add to Cart</code>，进入到<code>订单汇总页面</code></p>\n<p><img src=\"/img/study/bwh_order_detail.jpg\" alt=\"bwh_order_detail\"></p>\n<p>这里我们使用<code>BWH1ZBPVK</code>这个优惠码(随时失效，大家可以百度搜一搜优惠码)，输入完优惠码后，点击右边的<code>Validate Code&gt;&gt;</code>，出现下面的界面，表示优惠码有效</p>\n<p><img src=\"/img/study/bwh_order_detail_pc.jpg\" alt=\"bwh_order_detail_pc\"></p>\n<p>确认没问题后，点击<code>Checkout</code>去结账</p>\n<p><img src=\"/img/study/bwh_order_complete.jpg\" alt=\"bwh_order_complete\"></p>\n<p>如果有账号的话，点击<code>Click me to login</code>进行登录。没有的话，填写下面的项，后面标了<code>红色</code>字体的尽量都填上，最好真实的，防止被误认为<code>订单欺诈</code></p>\n<blockquote>\n<p>重要提示：不要填中文，使用拼音代替。比如：姓名叫李白，LastName填<code>li</code>，FirstName填<code>bai</code></p>\n<p>，还有State/Region一栏，要先选择Country，这样State/Region才会变</p>\n</blockquote>\n<p>输入完成之后，点击<code>Update</code>。</p>\n<p>接下来选择支付方式，我们这里选择<code>支付宝</code></p>\n<p><img src=\"/img/study/bwh_order_pay.jpg\" alt=\"bwh_order_pay\"></p>\n<p>点击<code>Complete Order</code>，会进入到<code>支付宝</code>支付界面</p>\n<p><img src=\"/img/study/bwh_order_pay_complete.jpg\" alt=\"bwh_order_pay_complete\"></p>\n<p>扫描完成支付(不要扫图中的码哦)，支付成功后会收到邮件通知，里面会有你的服务器ip地址等信息。</p>\n<h3 id=\"科学上网\"><a href=\"#科学上网\" class=\"headerlink\" title=\"科学上网\"></a>科学上网</h3><p>传送门：<a href=\"/2018/02/26/study/study-bwh-ssr/\">合适懒人的搬瓦工+ShadowsocksX教程</a></p>\n<h3 id=\"VPS服务器升降\"><a href=\"#VPS服务器升降\" class=\"headerlink\" title=\"VPS服务器升降\"></a>VPS服务器升降</h3><p>还记得文章上述的这个界面吗</p>\n<p><img src=\"/img/study/bwh_home_services_detail.jpg\" alt=\"bwh_home_services_detail\"></p>\n<p>点击<code>Manage</code>，进入到服务器管理页</p>\n<p><img src=\"/img/study/bwh_service_info.jpg\" alt=\"bwh_service_info\"></p>\n<p>点击后，进入下面的界面，大家可以按需选择</p>\n<p><img src=\"/img/study/bwh_service_detail.jpg\" alt=\"bwh_service_detail\"></p>"},{"title":"使用CentOS7安装GitLab","date":"2018-02-01T09:22:33.000Z","_content":"\n### 安装GitLab\n\n首先我们进入官网：https://about.gitlab.com/installation/\n\n找到`CentOS 7`，点击展开\n\n**1.安装和配置必要的依赖项**\n\n```python\nsudo yum install -y curl policycoreutils-python openssh-server \nsudo systemctl enable sshd \nsudo systemctl start sshd sudo firewall-cmd --permanent --add-service=http \nsudo systemctl reload firewalld \n```\n\n安全完成后，输入以下命令安装`Postfix`，用于发邮件\n\n```python\nsudo yum install postfix \nsudo systemctl enable postfix \nsudo systemctl start postfix \n```\n\n**2.安装GitLab仓库和包**\n\n先添加`GitLab`仓库\n\n```python\ncurl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash \n```\n\n再添加`GitLab`包，把`http://gitlab.example.com`改为你自己想要访问的`GitLab`地址，例如：\n\n`http://100.10.10.10`这样的，最好填你服务器的地址\n\n```python\nsudo EXTERNAL_URL=\"http://gitlab.example.com\" yum install -y gitlab-ee \n```\n\n**3.执行下面命令使配置生效**\n\n```python\ngitlab-ctl reconfigure\n```\n\n**4.服务命令**\n\n```python\ngitlab-ctl start\n```\n\n**5.访问页面**\n\nhttp://地址\n\n如果出现以下字样，是因为CentOS7默认使用了firewalld防火墙，你可以直接关闭掉(`systemctl stop firewalld`)\n\n```python\n\t\t\t\t\t502\nWhoops, GitLab is taking too much time to respond.\n```\n\n","source":"_posts/study/study-centos-gitlab.md","raw":"---\ntitle: 使用CentOS7安装GitLab\ndate: 2018-02-01 17:22:33\ntags: study\n---\n\n### 安装GitLab\n\n首先我们进入官网：https://about.gitlab.com/installation/\n\n找到`CentOS 7`，点击展开\n\n**1.安装和配置必要的依赖项**\n\n```python\nsudo yum install -y curl policycoreutils-python openssh-server \nsudo systemctl enable sshd \nsudo systemctl start sshd sudo firewall-cmd --permanent --add-service=http \nsudo systemctl reload firewalld \n```\n\n安全完成后，输入以下命令安装`Postfix`，用于发邮件\n\n```python\nsudo yum install postfix \nsudo systemctl enable postfix \nsudo systemctl start postfix \n```\n\n**2.安装GitLab仓库和包**\n\n先添加`GitLab`仓库\n\n```python\ncurl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash \n```\n\n再添加`GitLab`包，把`http://gitlab.example.com`改为你自己想要访问的`GitLab`地址，例如：\n\n`http://100.10.10.10`这样的，最好填你服务器的地址\n\n```python\nsudo EXTERNAL_URL=\"http://gitlab.example.com\" yum install -y gitlab-ee \n```\n\n**3.执行下面命令使配置生效**\n\n```python\ngitlab-ctl reconfigure\n```\n\n**4.服务命令**\n\n```python\ngitlab-ctl start\n```\n\n**5.访问页面**\n\nhttp://地址\n\n如果出现以下字样，是因为CentOS7默认使用了firewalld防火墙，你可以直接关闭掉(`systemctl stop firewalld`)\n\n```python\n\t\t\t\t\t502\nWhoops, GitLab is taking too much time to respond.\n```\n\n","slug":"study/study-centos-gitlab","published":1,"updated":"2018-02-01T10:04:33.484Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g4004iizcbi6xcqph6","content":"<h3 id=\"安装GitLab\"><a href=\"#安装GitLab\" class=\"headerlink\" title=\"安装GitLab\"></a>安装GitLab</h3><p>首先我们进入官网：<a href=\"https://about.gitlab.com/installation/\" target=\"_blank\" rel=\"noopener\">https://about.gitlab.com/installation/</a></p>\n<p>找到<code>CentOS 7</code>，点击展开</p>\n<p><strong>1.安装和配置必要的依赖项</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y curl policycoreutils-python openssh-server </span><br><span class=\"line\">sudo systemctl enable sshd </span><br><span class=\"line\">sudo systemctl start sshd sudo firewall-cmd --permanent --add-service=http </span><br><span class=\"line\">sudo systemctl reload firewalld</span><br></pre></td></tr></table></figure>\n<p>安全完成后，输入以下命令安装<code>Postfix</code>，用于发邮件</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install postfix </span><br><span class=\"line\">sudo systemctl enable postfix </span><br><span class=\"line\">sudo systemctl start postfix</span><br></pre></td></tr></table></figure>\n<p><strong>2.安装GitLab仓库和包</strong></p>\n<p>先添加<code>GitLab</code>仓库</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></figure>\n<p>再添加<code>GitLab</code>包，把<code>http://gitlab.example.com</code>改为你自己想要访问的<code>GitLab</code>地址，例如：</p>\n<p><code>http://100.10.10.10</code>这样的，最好填你服务器的地址</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo EXTERNAL_URL=<span class=\"string\">\"http://gitlab.example.com\"</span> yum install -y gitlab-ee</span><br></pre></td></tr></table></figure>\n<p><strong>3.执行下面命令使配置生效</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>\n<p><strong>4.服务命令</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gitlab-ctl start</span><br></pre></td></tr></table></figure>\n<p><strong>5.访问页面</strong></p>\n<p><a href=\"http://地址\" target=\"_blank\" rel=\"noopener\">http://地址</a></p>\n<p>如果出现以下字样，是因为CentOS7默认使用了firewalld防火墙，你可以直接关闭掉(<code>systemctl stop firewalld</code>)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\t\t\t\t\t<span class=\"number\">502</span></span><br><span class=\"line\">Whoops, GitLab <span class=\"keyword\">is</span> taking too much time to respond.</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"安装GitLab\"><a href=\"#安装GitLab\" class=\"headerlink\" title=\"安装GitLab\"></a>安装GitLab</h3><p>首先我们进入官网：<a href=\"https://about.gitlab.com/installation/\" target=\"_blank\" rel=\"noopener\">https://about.gitlab.com/installation/</a></p>\n<p>找到<code>CentOS 7</code>，点击展开</p>\n<p><strong>1.安装和配置必要的依赖项</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y curl policycoreutils-python openssh-server </span><br><span class=\"line\">sudo systemctl enable sshd </span><br><span class=\"line\">sudo systemctl start sshd sudo firewall-cmd --permanent --add-service=http </span><br><span class=\"line\">sudo systemctl reload firewalld</span><br></pre></td></tr></table></figure>\n<p>安全完成后，输入以下命令安装<code>Postfix</code>，用于发邮件</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install postfix </span><br><span class=\"line\">sudo systemctl enable postfix </span><br><span class=\"line\">sudo systemctl start postfix</span><br></pre></td></tr></table></figure>\n<p><strong>2.安装GitLab仓库和包</strong></p>\n<p>先添加<code>GitLab</code>仓库</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></figure>\n<p>再添加<code>GitLab</code>包，把<code>http://gitlab.example.com</code>改为你自己想要访问的<code>GitLab</code>地址，例如：</p>\n<p><code>http://100.10.10.10</code>这样的，最好填你服务器的地址</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo EXTERNAL_URL=<span class=\"string\">\"http://gitlab.example.com\"</span> yum install -y gitlab-ee</span><br></pre></td></tr></table></figure>\n<p><strong>3.执行下面命令使配置生效</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>\n<p><strong>4.服务命令</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gitlab-ctl start</span><br></pre></td></tr></table></figure>\n<p><strong>5.访问页面</strong></p>\n<p><a href=\"http://地址\" target=\"_blank\" rel=\"noopener\">http://地址</a></p>\n<p>如果出现以下字样，是因为CentOS7默认使用了firewalld防火墙，你可以直接关闭掉(<code>systemctl stop firewalld</code>)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\t\t\t\t\t<span class=\"number\">502</span></span><br><span class=\"line\">Whoops, GitLab <span class=\"keyword\">is</span> taking too much time to respond.</span><br></pre></td></tr></table></figure>\n"},{"title":"使用CentOS7安装配置Jenkins","date":"2018-01-29T03:51:08.000Z","_content":"\n### 安装Java\n\n`Jenkins`依赖`Java`，如果你的系统没有安装的话，需要先安装`Java`，已安装的话，可以忽略。使用以下命令\n\n安装`Java`\n\n```python\nyum install java\n```\n\n查看`Java`版本\n\n```\njava -version\n```\n\n<!-- More -->\n\n如果显示以下项，表示已安装\n\n```\nopenjdk version \"1.8.0_161\"\nOpenJDK Runtime Environment (build 1.8.0_161-b14)\nOpenJDK 64-Bit Server VM (build 25.161-b14, mixed mode)\n```\n\n如果你显示的是类似以下的界面\n\n```python\njava version \"1.5.0\" \ngij (GNU libgcj) version 4.3.3\n```\n\n你需要先删除`Java`，重新安装`OpenJDK`，因为CentOS的系统，如果`java`版本是`GCJ`的版本，会导致Jenkins不工作(https://issues.jenkins-ci.org/browse/JENKINS-743)\n\n##### 使用如下命令\n\n1、**先删除旧的`java`**\n\n```python\nyum remove java\n```\n\n2、**查看`OpenJDK`版本**\n\n```\nyum search openjdk\n```\n\n显示如下界面\n\n```python\n...\njava-1.8.0-openjdk.i686 : OpenJDK Runtime Environment\njava-1.8.0-openjdk.x86_64 : OpenJDK Runtime Environment\njava-1.8.0-openjdk-accessibility.i686 : OpenJDK accessibility connector\njava-1.8.0-openjdk-accessibility.x86_64 : OpenJDK accessibility connector\n...\n```\n\n3、**安装`OpenJDK`**\n\n```python\nyum install java-1.8.0-openJDK\n```\n\n### 安装Git\n\n如果你需要使用`git`，使用以下命令进行安装(-y表示所有安装时的确认项都选y)\n\n```\nyum install -y git\n```\n\n### 安装Jenkins\n\n首先我们进入到`Jenkins`官网，传送门：https://jenkins.io/download/\n\n这时我们会看到两栏，左边的`Long-term Support (LTS)`是12周发布一版，右边的`Weekly`是每周发布一个版本。\n\n这里我们以`Weekly`为例进行安装，拖动页面找到你自己的系统并点击\n\nCentOS传送门：https://pkg.jenkins.io/redhat/\n\n在这个界面我们可以看到官网教我们安装的步骤，简单说明一下\n\n##### 第一步，输入以下命令\n\n**拉取`Jenkins`库**\n\n```python\nsudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat/jenkins.io.key\n```\n\n> 注意文章所说的2点\n>\n> 1.如果您之前从Jenkins中导入了密钥，那么“rpm—import”将会失败，因为您已经有了一个密钥。请忽略这一点，继续前进。\n>\n> 2.您需要显式地安装Java运行时环境，因为Oracle的Java rpm是不正确的，并且无法注册为提供Java依赖项。因此，在Java中添加显式的依赖项要求将强制安装OpenJDK JVM。(以述步骤已安装了`java` ，忽略此条)\n\n你可能会出现以下现象\n\n```python\n[root@host ~]# sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo\nsudo: wget: command not found\n```\n\n这里，你需要先安装wget\n\n```python\nyum install -y wget\n```\n\n**安装`Jenkins`包**\n\n```python\nyum install -y jenkins\n```\n\n**更新`Jenkins`**\n\n```python\nyum update jenkins\n```\n\n**查看`Jenkins`端口**\n\n```python\ncat /etc/sysconfig/jenkins | more\n```\n\n**查找`JENKINS_PORT`，一般为`\"8080\"`，一屏显示不下的话，按回车查看，按`control+c`退出**\n\n```python\nJENKINS_PORT=\"8080\"\n```\n\n**开启`Jenkins`服务**\n\n```python\nservice jenkins start\n```\n\n浏览器访问: `IP地址:8080`\n\n**关闭`Jenkins`服务**\n\n```python\nservice jenkins stop\n```\n\n### 配置`Jenkin`\n\n首先使用浏览器打开`Jenkin`(ip:8080)，如果你是第一次安装，会出现以下界面\n\n![centenos_jenkins_first](/img/study/jenkins/centenos_jenkins_first.jpg)\n\n我们去图中的地址去查看密码\n\n```\ncat /var/lib/jenkins/secrets/initialAdminPassword\n```\n\n选中密码，按`command+c`复制，然后`command+v`到浏览器`管理员密码`那一栏，点击继续，会出现\n\n![jenkins_install_plugin_first](/img/study/jenkins/jenkins_install_plugin_first.jpg)\n\n我们点击左边的`安装推荐的插件`，等待安装完成，完成后会出现\n\n![jenkins_install_setting](/img/study/jenkins/jenkins_install_setting.jpg)\n\n设置完你的管理员用户，点`保存并完成`进入下个界面，点`准备就绪`，进入下个界面\n\n![jenkins_install_complete](/img/study/jenkins/jenkins_install_complete.jpg)\n\n\n\n**OK，Jenkins安装配置完成！**\n\n### 更多操作\n\n传送门：https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions","source":"_posts/study/study-centos-jenkins.md","raw":"---\ntitle: 使用CentOS7安装配置Jenkins\ndate: 2018-01-29 11:51:08\ntags: study\n---\n\n### 安装Java\n\n`Jenkins`依赖`Java`，如果你的系统没有安装的话，需要先安装`Java`，已安装的话，可以忽略。使用以下命令\n\n安装`Java`\n\n```python\nyum install java\n```\n\n查看`Java`版本\n\n```\njava -version\n```\n\n<!-- More -->\n\n如果显示以下项，表示已安装\n\n```\nopenjdk version \"1.8.0_161\"\nOpenJDK Runtime Environment (build 1.8.0_161-b14)\nOpenJDK 64-Bit Server VM (build 25.161-b14, mixed mode)\n```\n\n如果你显示的是类似以下的界面\n\n```python\njava version \"1.5.0\" \ngij (GNU libgcj) version 4.3.3\n```\n\n你需要先删除`Java`，重新安装`OpenJDK`，因为CentOS的系统，如果`java`版本是`GCJ`的版本，会导致Jenkins不工作(https://issues.jenkins-ci.org/browse/JENKINS-743)\n\n##### 使用如下命令\n\n1、**先删除旧的`java`**\n\n```python\nyum remove java\n```\n\n2、**查看`OpenJDK`版本**\n\n```\nyum search openjdk\n```\n\n显示如下界面\n\n```python\n...\njava-1.8.0-openjdk.i686 : OpenJDK Runtime Environment\njava-1.8.0-openjdk.x86_64 : OpenJDK Runtime Environment\njava-1.8.0-openjdk-accessibility.i686 : OpenJDK accessibility connector\njava-1.8.0-openjdk-accessibility.x86_64 : OpenJDK accessibility connector\n...\n```\n\n3、**安装`OpenJDK`**\n\n```python\nyum install java-1.8.0-openJDK\n```\n\n### 安装Git\n\n如果你需要使用`git`，使用以下命令进行安装(-y表示所有安装时的确认项都选y)\n\n```\nyum install -y git\n```\n\n### 安装Jenkins\n\n首先我们进入到`Jenkins`官网，传送门：https://jenkins.io/download/\n\n这时我们会看到两栏，左边的`Long-term Support (LTS)`是12周发布一版，右边的`Weekly`是每周发布一个版本。\n\n这里我们以`Weekly`为例进行安装，拖动页面找到你自己的系统并点击\n\nCentOS传送门：https://pkg.jenkins.io/redhat/\n\n在这个界面我们可以看到官网教我们安装的步骤，简单说明一下\n\n##### 第一步，输入以下命令\n\n**拉取`Jenkins`库**\n\n```python\nsudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat/jenkins.io.key\n```\n\n> 注意文章所说的2点\n>\n> 1.如果您之前从Jenkins中导入了密钥，那么“rpm—import”将会失败，因为您已经有了一个密钥。请忽略这一点，继续前进。\n>\n> 2.您需要显式地安装Java运行时环境，因为Oracle的Java rpm是不正确的，并且无法注册为提供Java依赖项。因此，在Java中添加显式的依赖项要求将强制安装OpenJDK JVM。(以述步骤已安装了`java` ，忽略此条)\n\n你可能会出现以下现象\n\n```python\n[root@host ~]# sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo\nsudo: wget: command not found\n```\n\n这里，你需要先安装wget\n\n```python\nyum install -y wget\n```\n\n**安装`Jenkins`包**\n\n```python\nyum install -y jenkins\n```\n\n**更新`Jenkins`**\n\n```python\nyum update jenkins\n```\n\n**查看`Jenkins`端口**\n\n```python\ncat /etc/sysconfig/jenkins | more\n```\n\n**查找`JENKINS_PORT`，一般为`\"8080\"`，一屏显示不下的话，按回车查看，按`control+c`退出**\n\n```python\nJENKINS_PORT=\"8080\"\n```\n\n**开启`Jenkins`服务**\n\n```python\nservice jenkins start\n```\n\n浏览器访问: `IP地址:8080`\n\n**关闭`Jenkins`服务**\n\n```python\nservice jenkins stop\n```\n\n### 配置`Jenkin`\n\n首先使用浏览器打开`Jenkin`(ip:8080)，如果你是第一次安装，会出现以下界面\n\n![centenos_jenkins_first](/img/study/jenkins/centenos_jenkins_first.jpg)\n\n我们去图中的地址去查看密码\n\n```\ncat /var/lib/jenkins/secrets/initialAdminPassword\n```\n\n选中密码，按`command+c`复制，然后`command+v`到浏览器`管理员密码`那一栏，点击继续，会出现\n\n![jenkins_install_plugin_first](/img/study/jenkins/jenkins_install_plugin_first.jpg)\n\n我们点击左边的`安装推荐的插件`，等待安装完成，完成后会出现\n\n![jenkins_install_setting](/img/study/jenkins/jenkins_install_setting.jpg)\n\n设置完你的管理员用户，点`保存并完成`进入下个界面，点`准备就绪`，进入下个界面\n\n![jenkins_install_complete](/img/study/jenkins/jenkins_install_complete.jpg)\n\n\n\n**OK，Jenkins安装配置完成！**\n\n### 更多操作\n\n传送门：https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions","slug":"study/study-centos-jenkins","published":1,"updated":"2018-05-20T13:04:25.689Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g5004kizcbqqszgh1t","content":"<h3 id=\"安装Java\"><a href=\"#安装Java\" class=\"headerlink\" title=\"安装Java\"></a>安装Java</h3><p><code>Jenkins</code>依赖<code>Java</code>，如果你的系统没有安装的话，需要先安装<code>Java</code>，已安装的话，可以忽略。使用以下命令</p>\n<p>安装<code>Java</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install java</span><br></pre></td></tr></table></figure>\n<p>查看<code>Java</code>版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -version</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<p>如果显示以下项，表示已安装</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openjdk version &quot;1.8.0_161&quot;</span><br><span class=\"line\">OpenJDK Runtime Environment (build 1.8.0_161-b14)</span><br><span class=\"line\">OpenJDK 64-Bit Server VM (build 25.161-b14, mixed mode)</span><br></pre></td></tr></table></figure>\n<p>如果你显示的是类似以下的界面</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java version <span class=\"string\">\"1.5.0\"</span> </span><br><span class=\"line\">gij (GNU libgcj) version <span class=\"number\">4.3</span><span class=\"number\">.3</span></span><br></pre></td></tr></table></figure>\n<p>你需要先删除<code>Java</code>，重新安装<code>OpenJDK</code>，因为CentOS的系统，如果<code>java</code>版本是<code>GCJ</code>的版本，会导致Jenkins不工作(<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-743\" target=\"_blank\" rel=\"noopener\">https://issues.jenkins-ci.org/browse/JENKINS-743</a>)</p>\n<h5 id=\"使用如下命令\"><a href=\"#使用如下命令\" class=\"headerlink\" title=\"使用如下命令\"></a>使用如下命令</h5><p>1、<strong>先删除旧的<code>java</code></strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove java</span><br></pre></td></tr></table></figure>\n<p>2、<strong>查看<code>OpenJDK</code>版本</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum search openjdk</span><br></pre></td></tr></table></figure>\n<p>显示如下界面</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk.i686 : OpenJDK Runtime Environment</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk.x86_64 : OpenJDK Runtime Environment</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk-accessibility.i686 : OpenJDK accessibility connector</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk-accessibility.x86_64 : OpenJDK accessibility connector</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>3、<strong>安装<code>OpenJDK</code></strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openJDK</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装Git\"><a href=\"#安装Git\" class=\"headerlink\" title=\"安装Git\"></a>安装Git</h3><p>如果你需要使用<code>git</code>，使用以下命令进行安装(-y表示所有安装时的确认项都选y)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y git</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装Jenkins\"><a href=\"#安装Jenkins\" class=\"headerlink\" title=\"安装Jenkins\"></a>安装Jenkins</h3><p>首先我们进入到<code>Jenkins</code>官网，传送门：<a href=\"https://jenkins.io/download/\" target=\"_blank\" rel=\"noopener\">https://jenkins.io/download/</a></p>\n<p>这时我们会看到两栏，左边的<code>Long-term Support (LTS)</code>是12周发布一版，右边的<code>Weekly</code>是每周发布一个版本。</p>\n<p>这里我们以<code>Weekly</code>为例进行安装，拖动页面找到你自己的系统并点击</p>\n<p>CentOS传送门：<a href=\"https://pkg.jenkins.io/redhat/\" target=\"_blank\" rel=\"noopener\">https://pkg.jenkins.io/redhat/</a></p>\n<p>在这个界面我们可以看到官网教我们安装的步骤，简单说明一下</p>\n<h5 id=\"第一步，输入以下命令\"><a href=\"#第一步，输入以下命令\" class=\"headerlink\" title=\"第一步，输入以下命令\"></a>第一步，输入以下命令</h5><p><strong>拉取<code>Jenkins</code>库</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo</span><br><span class=\"line\">sudo rpm --<span class=\"keyword\">import</span> https://pkg.jenkins.io/redhat/jenkins.io.key</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>注意文章所说的2点</p>\n<p>1.如果您之前从Jenkins中导入了密钥，那么“rpm—import”将会失败，因为您已经有了一个密钥。请忽略这一点，继续前进。</p>\n<p>2.您需要显式地安装Java运行时环境，因为Oracle的Java rpm是不正确的，并且无法注册为提供Java依赖项。因此，在Java中添加显式的依赖项要求将强制安装OpenJDK JVM。(以述步骤已安装了<code>java</code> ，忽略此条)</p>\n</blockquote>\n<p>你可能会出现以下现象</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@host ~]<span class=\"comment\"># sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo</span></span><br><span class=\"line\">sudo: wget: command <span class=\"keyword\">not</span> found</span><br></pre></td></tr></table></figure>\n<p>这里，你需要先安装wget</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y wget</span><br></pre></td></tr></table></figure>\n<p><strong>安装<code>Jenkins</code>包</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y jenkins</span><br></pre></td></tr></table></figure>\n<p><strong>更新<code>Jenkins</code></strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum update jenkins</span><br></pre></td></tr></table></figure>\n<p><strong>查看<code>Jenkins</code>端口</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/sysconfig/jenkins | more</span><br></pre></td></tr></table></figure>\n<p><strong>查找<code>JENKINS_PORT</code>，一般为<code>&quot;8080&quot;</code>，一屏显示不下的话，按回车查看，按<code>control+c</code>退出</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JENKINS_PORT=<span class=\"string\">\"8080\"</span></span><br></pre></td></tr></table></figure>\n<p><strong>开启<code>Jenkins</code>服务</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service jenkins start</span><br></pre></td></tr></table></figure>\n<p>浏览器访问: <code>IP地址:8080</code></p>\n<p><strong>关闭<code>Jenkins</code>服务</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service jenkins stop</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置Jenkin\"><a href=\"#配置Jenkin\" class=\"headerlink\" title=\"配置Jenkin\"></a>配置<code>Jenkin</code></h3><p>首先使用浏览器打开<code>Jenkin</code>(ip:8080)，如果你是第一次安装，会出现以下界面</p>\n<p><img src=\"/img/study/jenkins/centenos_jenkins_first.jpg\" alt=\"centenos_jenkins_first\"></p>\n<p>我们去图中的地址去查看密码</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /var/lib/jenkins/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>\n<p>选中密码，按<code>command+c</code>复制，然后<code>command+v</code>到浏览器<code>管理员密码</code>那一栏，点击继续，会出现</p>\n<p><img src=\"/img/study/jenkins/jenkins_install_plugin_first.jpg\" alt=\"jenkins_install_plugin_first\"></p>\n<p>我们点击左边的<code>安装推荐的插件</code>，等待安装完成，完成后会出现</p>\n<p><img src=\"/img/study/jenkins/jenkins_install_setting.jpg\" alt=\"jenkins_install_setting\"></p>\n<p>设置完你的管理员用户，点<code>保存并完成</code>进入下个界面，点<code>准备就绪</code>，进入下个界面</p>\n<p><img src=\"/img/study/jenkins/jenkins_install_complete.jpg\" alt=\"jenkins_install_complete\"></p>\n<p><strong>OK，Jenkins安装配置完成！</strong></p>\n<h3 id=\"更多操作\"><a href=\"#更多操作\" class=\"headerlink\" title=\"更多操作\"></a>更多操作</h3><p>传送门：<a href=\"https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions\" target=\"_blank\" rel=\"noopener\">https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions</a></p>\n","site":{"data":{}},"excerpt":"<h3 id=\"安装Java\"><a href=\"#安装Java\" class=\"headerlink\" title=\"安装Java\"></a>安装Java</h3><p><code>Jenkins</code>依赖<code>Java</code>，如果你的系统没有安装的话，需要先安装<code>Java</code>，已安装的话，可以忽略。使用以下命令</p>\n<p>安装<code>Java</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install java</span><br></pre></td></tr></table></figure>\n<p>查看<code>Java</code>版本</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -version</span><br></pre></td></tr></table></figure>","more":"<p>如果显示以下项，表示已安装</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openjdk version &quot;1.8.0_161&quot;</span><br><span class=\"line\">OpenJDK Runtime Environment (build 1.8.0_161-b14)</span><br><span class=\"line\">OpenJDK 64-Bit Server VM (build 25.161-b14, mixed mode)</span><br></pre></td></tr></table></figure>\n<p>如果你显示的是类似以下的界面</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java version <span class=\"string\">\"1.5.0\"</span> </span><br><span class=\"line\">gij (GNU libgcj) version <span class=\"number\">4.3</span><span class=\"number\">.3</span></span><br></pre></td></tr></table></figure>\n<p>你需要先删除<code>Java</code>，重新安装<code>OpenJDK</code>，因为CentOS的系统，如果<code>java</code>版本是<code>GCJ</code>的版本，会导致Jenkins不工作(<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-743\" target=\"_blank\" rel=\"noopener\">https://issues.jenkins-ci.org/browse/JENKINS-743</a>)</p>\n<h5 id=\"使用如下命令\"><a href=\"#使用如下命令\" class=\"headerlink\" title=\"使用如下命令\"></a>使用如下命令</h5><p>1、<strong>先删除旧的<code>java</code></strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove java</span><br></pre></td></tr></table></figure>\n<p>2、<strong>查看<code>OpenJDK</code>版本</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum search openjdk</span><br></pre></td></tr></table></figure>\n<p>显示如下界面</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk.i686 : OpenJDK Runtime Environment</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk.x86_64 : OpenJDK Runtime Environment</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk-accessibility.i686 : OpenJDK accessibility connector</span><br><span class=\"line\">java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openjdk-accessibility.x86_64 : OpenJDK accessibility connector</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>3、<strong>安装<code>OpenJDK</code></strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install java<span class=\"number\">-1.8</span><span class=\"number\">.0</span>-openJDK</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装Git\"><a href=\"#安装Git\" class=\"headerlink\" title=\"安装Git\"></a>安装Git</h3><p>如果你需要使用<code>git</code>，使用以下命令进行安装(-y表示所有安装时的确认项都选y)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y git</span><br></pre></td></tr></table></figure>\n<h3 id=\"安装Jenkins\"><a href=\"#安装Jenkins\" class=\"headerlink\" title=\"安装Jenkins\"></a>安装Jenkins</h3><p>首先我们进入到<code>Jenkins</code>官网，传送门：<a href=\"https://jenkins.io/download/\" target=\"_blank\" rel=\"noopener\">https://jenkins.io/download/</a></p>\n<p>这时我们会看到两栏，左边的<code>Long-term Support (LTS)</code>是12周发布一版，右边的<code>Weekly</code>是每周发布一个版本。</p>\n<p>这里我们以<code>Weekly</code>为例进行安装，拖动页面找到你自己的系统并点击</p>\n<p>CentOS传送门：<a href=\"https://pkg.jenkins.io/redhat/\" target=\"_blank\" rel=\"noopener\">https://pkg.jenkins.io/redhat/</a></p>\n<p>在这个界面我们可以看到官网教我们安装的步骤，简单说明一下</p>\n<h5 id=\"第一步，输入以下命令\"><a href=\"#第一步，输入以下命令\" class=\"headerlink\" title=\"第一步，输入以下命令\"></a>第一步，输入以下命令</h5><p><strong>拉取<code>Jenkins</code>库</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo</span><br><span class=\"line\">sudo rpm --<span class=\"keyword\">import</span> https://pkg.jenkins.io/redhat/jenkins.io.key</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>注意文章所说的2点</p>\n<p>1.如果您之前从Jenkins中导入了密钥，那么“rpm—import”将会失败，因为您已经有了一个密钥。请忽略这一点，继续前进。</p>\n<p>2.您需要显式地安装Java运行时环境，因为Oracle的Java rpm是不正确的，并且无法注册为提供Java依赖项。因此，在Java中添加显式的依赖项要求将强制安装OpenJDK JVM。(以述步骤已安装了<code>java</code> ，忽略此条)</p>\n</blockquote>\n<p>你可能会出现以下现象</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@host ~]<span class=\"comment\"># sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat/jenkins.repo</span></span><br><span class=\"line\">sudo: wget: command <span class=\"keyword\">not</span> found</span><br></pre></td></tr></table></figure>\n<p>这里，你需要先安装wget</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y wget</span><br></pre></td></tr></table></figure>\n<p><strong>安装<code>Jenkins</code>包</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y jenkins</span><br></pre></td></tr></table></figure>\n<p><strong>更新<code>Jenkins</code></strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum update jenkins</span><br></pre></td></tr></table></figure>\n<p><strong>查看<code>Jenkins</code>端口</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/sysconfig/jenkins | more</span><br></pre></td></tr></table></figure>\n<p><strong>查找<code>JENKINS_PORT</code>，一般为<code>&quot;8080&quot;</code>，一屏显示不下的话，按回车查看，按<code>control+c</code>退出</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JENKINS_PORT=<span class=\"string\">\"8080\"</span></span><br></pre></td></tr></table></figure>\n<p><strong>开启<code>Jenkins</code>服务</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service jenkins start</span><br></pre></td></tr></table></figure>\n<p>浏览器访问: <code>IP地址:8080</code></p>\n<p><strong>关闭<code>Jenkins</code>服务</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service jenkins stop</span><br></pre></td></tr></table></figure>\n<h3 id=\"配置Jenkin\"><a href=\"#配置Jenkin\" class=\"headerlink\" title=\"配置Jenkin\"></a>配置<code>Jenkin</code></h3><p>首先使用浏览器打开<code>Jenkin</code>(ip:8080)，如果你是第一次安装，会出现以下界面</p>\n<p><img src=\"/img/study/jenkins/centenos_jenkins_first.jpg\" alt=\"centenos_jenkins_first\"></p>\n<p>我们去图中的地址去查看密码</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /var/lib/jenkins/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>\n<p>选中密码，按<code>command+c</code>复制，然后<code>command+v</code>到浏览器<code>管理员密码</code>那一栏，点击继续，会出现</p>\n<p><img src=\"/img/study/jenkins/jenkins_install_plugin_first.jpg\" alt=\"jenkins_install_plugin_first\"></p>\n<p>我们点击左边的<code>安装推荐的插件</code>，等待安装完成，完成后会出现</p>\n<p><img src=\"/img/study/jenkins/jenkins_install_setting.jpg\" alt=\"jenkins_install_setting\"></p>\n<p>设置完你的管理员用户，点<code>保存并完成</code>进入下个界面，点<code>准备就绪</code>，进入下个界面</p>\n<p><img src=\"/img/study/jenkins/jenkins_install_complete.jpg\" alt=\"jenkins_install_complete\"></p>\n<p><strong>OK，Jenkins安装配置完成！</strong></p>\n<h3 id=\"更多操作\"><a href=\"#更多操作\" class=\"headerlink\" title=\"更多操作\"></a>更多操作</h3><p>传送门：<a href=\"https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions\" target=\"_blank\" rel=\"noopener\">https://wiki.jenkins.io/display/JENKINS/Installing+Jenkins+on+Red+Hat+distributions</a></p>"},{"title":"CentOS7安装ownCloud","date":"2018-02-07T08:16:50.000Z","_content":"\n你可能会出现下面的错误：\n\n```\nFailed to start httpd.service: Unit not found.\n```\n\n执行`yum install httpd`","source":"_posts/study/study-centos-owncloud.md","raw":"---\ntitle: CentOS7安装ownCloud\ndate: 2018-02-07 16:16:50\ntags: study\n---\n\n你可能会出现下面的错误：\n\n```\nFailed to start httpd.service: Unit not found.\n```\n\n执行`yum install httpd`","slug":"study/study-centos-owncloud","published":1,"updated":"2018-05-20T13:04:25.689Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g7004nizcbiauxy5o9","content":"<p>你可能会出现下面的错误：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Failed to start httpd.service: Unit not found.</span><br></pre></td></tr></table></figure>\n<p>执行<code>yum install httpd</code></p>\n","site":{"data":{}},"excerpt":"","more":"<p>你可能会出现下面的错误：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Failed to start httpd.service: Unit not found.</span><br></pre></td></tr></table></figure>\n<p>执行<code>yum install httpd</code></p>\n"},{"title":"使用SSH客户端(Termius)连接服务器","date":"2018-01-30T06:20:34.000Z","_content":"\n### 前言\n\n我们买的是远端服务器，没有用户界面的，只能通过命令行去操作我们的系统，那么如何进入我们的服务器呢\n\n<!-- More -->\n\n### SSH连接服务器\n\n**有二种方式：**\n\n**第一种**\n\n点击搬瓦工的`KiwiVM Control Panel`，进入到服务器控制面板，点击左侧的`Roo shell - basic`进入服务器\n\n![bwh_kiwivm_command](/img/study/command/bwh_kiwivm_command.jpg)\n\n**第二种**\n\n如果嫌每次都要从浏览器进入比较麻烦，可以选择使用`SSH`连接我们的服务器\n\n先下载`ssh`客户端：http://www.termius.com\n\n下载完成后打开\n\n![termius_connect](/img/study/command/termius_connect.jpg)\n\n1. 界面上看到`ssh user@hostname -p port`这行字没，你可以直接使用下面的方式进行连接\n\n```python\nssh root@170.1.2.3 -p 8388\n```\n\n> hostname: 这里我写的是170.1.2.3，你需要填写你的服务器ip\n>\n> port: 同理，你需要填写你的服务器端口\n\n点击`connect`后，会弹出框，要你输入服务器密码，输入正确后进入服务器\n\n2. 或者你可以点击右下角的`+ New Host`，输入你的配置信息，点击保存开始连接\n\n> Address：服务器的ip地址，类似这样: 170.1.2.3\n>\n> Port: 服务器的端口，类似这样: 8388\n>\n> Username: 这里填`root`\n>\n> Password：这里为你安装服务器时的密码，就是之前你使用搬瓦工重装系统后的服务器密码\n\n**如果你忘记了服务器密码怎么办，没有关系，从下面步骤重新获取**\n\n进入到搬瓦工服务器控制面板，先到`Main controls`点击`stop`停掉你的服务器，再点击左侧的`Root password modification`从新获取，获取完成后，别忘了到`Main controls`点击`start`打开你的服务器","source":"_posts/study/study-centos-ssh.md","raw":"---\ntitle: 使用SSH客户端(Termius)连接服务器\ndate: 2018-01-30 14:20:34\ntags: study\n---\n\n### 前言\n\n我们买的是远端服务器，没有用户界面的，只能通过命令行去操作我们的系统，那么如何进入我们的服务器呢\n\n<!-- More -->\n\n### SSH连接服务器\n\n**有二种方式：**\n\n**第一种**\n\n点击搬瓦工的`KiwiVM Control Panel`，进入到服务器控制面板，点击左侧的`Roo shell - basic`进入服务器\n\n![bwh_kiwivm_command](/img/study/command/bwh_kiwivm_command.jpg)\n\n**第二种**\n\n如果嫌每次都要从浏览器进入比较麻烦，可以选择使用`SSH`连接我们的服务器\n\n先下载`ssh`客户端：http://www.termius.com\n\n下载完成后打开\n\n![termius_connect](/img/study/command/termius_connect.jpg)\n\n1. 界面上看到`ssh user@hostname -p port`这行字没，你可以直接使用下面的方式进行连接\n\n```python\nssh root@170.1.2.3 -p 8388\n```\n\n> hostname: 这里我写的是170.1.2.3，你需要填写你的服务器ip\n>\n> port: 同理，你需要填写你的服务器端口\n\n点击`connect`后，会弹出框，要你输入服务器密码，输入正确后进入服务器\n\n2. 或者你可以点击右下角的`+ New Host`，输入你的配置信息，点击保存开始连接\n\n> Address：服务器的ip地址，类似这样: 170.1.2.3\n>\n> Port: 服务器的端口，类似这样: 8388\n>\n> Username: 这里填`root`\n>\n> Password：这里为你安装服务器时的密码，就是之前你使用搬瓦工重装系统后的服务器密码\n\n**如果你忘记了服务器密码怎么办，没有关系，从下面步骤重新获取**\n\n进入到搬瓦工服务器控制面板，先到`Main controls`点击`stop`停掉你的服务器，再点击左侧的`Root password modification`从新获取，获取完成后，别忘了到`Main controls`点击`start`打开你的服务器","slug":"study/study-centos-ssh","published":1,"updated":"2018-05-20T13:04:25.690Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g7004pizcbov0vb78v","content":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>我们买的是远端服务器，没有用户界面的，只能通过命令行去操作我们的系统，那么如何进入我们的服务器呢</p>\n<a id=\"more\"></a>\n<h3 id=\"SSH连接服务器\"><a href=\"#SSH连接服务器\" class=\"headerlink\" title=\"SSH连接服务器\"></a>SSH连接服务器</h3><p><strong>有二种方式：</strong></p>\n<p><strong>第一种</strong></p>\n<p>点击搬瓦工的<code>KiwiVM Control Panel</code>，进入到服务器控制面板，点击左侧的<code>Roo shell - basic</code>进入服务器</p>\n<p><img src=\"/img/study/command/bwh_kiwivm_command.jpg\" alt=\"bwh_kiwivm_command\"></p>\n<p><strong>第二种</strong></p>\n<p>如果嫌每次都要从浏览器进入比较麻烦，可以选择使用<code>SSH</code>连接我们的服务器</p>\n<p>先下载<code>ssh</code>客户端：<a href=\"http://www.termius.com\" target=\"_blank\" rel=\"noopener\">http://www.termius.com</a></p>\n<p>下载完成后打开</p>\n<p><img src=\"/img/study/command/termius_connect.jpg\" alt=\"termius_connect\"></p>\n<ol>\n<li>界面上看到<code>ssh user@hostname -p port</code>这行字没，你可以直接使用下面的方式进行连接</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@<span class=\"number\">170.1</span><span class=\"number\">.2</span><span class=\"number\">.3</span> -p <span class=\"number\">8388</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>hostname: 这里我写的是170.1.2.3，你需要填写你的服务器ip</p>\n<p>port: 同理，你需要填写你的服务器端口</p>\n</blockquote>\n<p>点击<code>connect</code>后，会弹出框，要你输入服务器密码，输入正确后进入服务器</p>\n<ol>\n<li>或者你可以点击右下角的<code>+ New Host</code>，输入你的配置信息，点击保存开始连接</li>\n</ol>\n<blockquote>\n<p>Address：服务器的ip地址，类似这样: 170.1.2.3</p>\n<p>Port: 服务器的端口，类似这样: 8388</p>\n<p>Username: 这里填<code>root</code></p>\n<p>Password：这里为你安装服务器时的密码，就是之前你使用搬瓦工重装系统后的服务器密码</p>\n</blockquote>\n<p><strong>如果你忘记了服务器密码怎么办，没有关系，从下面步骤重新获取</strong></p>\n<p>进入到搬瓦工服务器控制面板，先到<code>Main controls</code>点击<code>stop</code>停掉你的服务器，再点击左侧的<code>Root password modification</code>从新获取，获取完成后，别忘了到<code>Main controls</code>点击<code>start</code>打开你的服务器</p>\n","site":{"data":{}},"excerpt":"<h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>我们买的是远端服务器，没有用户界面的，只能通过命令行去操作我们的系统，那么如何进入我们的服务器呢</p>","more":"<h3 id=\"SSH连接服务器\"><a href=\"#SSH连接服务器\" class=\"headerlink\" title=\"SSH连接服务器\"></a>SSH连接服务器</h3><p><strong>有二种方式：</strong></p>\n<p><strong>第一种</strong></p>\n<p>点击搬瓦工的<code>KiwiVM Control Panel</code>，进入到服务器控制面板，点击左侧的<code>Roo shell - basic</code>进入服务器</p>\n<p><img src=\"/img/study/command/bwh_kiwivm_command.jpg\" alt=\"bwh_kiwivm_command\"></p>\n<p><strong>第二种</strong></p>\n<p>如果嫌每次都要从浏览器进入比较麻烦，可以选择使用<code>SSH</code>连接我们的服务器</p>\n<p>先下载<code>ssh</code>客户端：<a href=\"http://www.termius.com\" target=\"_blank\" rel=\"noopener\">http://www.termius.com</a></p>\n<p>下载完成后打开</p>\n<p><img src=\"/img/study/command/termius_connect.jpg\" alt=\"termius_connect\"></p>\n<ol>\n<li>界面上看到<code>ssh user@hostname -p port</code>这行字没，你可以直接使用下面的方式进行连接</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@<span class=\"number\">170.1</span><span class=\"number\">.2</span><span class=\"number\">.3</span> -p <span class=\"number\">8388</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>hostname: 这里我写的是170.1.2.3，你需要填写你的服务器ip</p>\n<p>port: 同理，你需要填写你的服务器端口</p>\n</blockquote>\n<p>点击<code>connect</code>后，会弹出框，要你输入服务器密码，输入正确后进入服务器</p>\n<ol>\n<li>或者你可以点击右下角的<code>+ New Host</code>，输入你的配置信息，点击保存开始连接</li>\n</ol>\n<blockquote>\n<p>Address：服务器的ip地址，类似这样: 170.1.2.3</p>\n<p>Port: 服务器的端口，类似这样: 8388</p>\n<p>Username: 这里填<code>root</code></p>\n<p>Password：这里为你安装服务器时的密码，就是之前你使用搬瓦工重装系统后的服务器密码</p>\n</blockquote>\n<p><strong>如果你忘记了服务器密码怎么办，没有关系，从下面步骤重新获取</strong></p>\n<p>进入到搬瓦工服务器控制面板，先到<code>Main controls</code>点击<code>stop</code>停掉你的服务器，再点击左侧的<code>Root password modification</code>从新获取，获取完成后，别忘了到<code>Main controls</code>点击<code>start</code>打开你的服务器</p>"},{"title":"Ubuntu开启BBR","date":"2018-03-30T03:02:35.000Z","_content":"\n原文地址：[Ubuntu开启BBR加速Shadowsocks](https://www.flyzy2005.com/fan-qiang/shadowsocks/ubuntu-bbr-shadowsocks/)\n\n### 升级内核\n\nubuntu开启BBR加速需要内核高于4.9，先检查内核版本:\n\n```python\nuname -a\n```\n\n如果版本高于4.9，那就可以直接开启BBR，否则需要先升级内核（需要root权限）\n\n1.首先查看系统是32位还是64位\n\n```bash\ngetconf LONG_BIT\n```\n\n2.去[官网](http://kernel.ubuntu.com/~kernel-ppa/mainline/)最新的程序包，这里以`v4.15/`为例\n\n```bash\nwget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.15/linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb\n```\n\n3.执行下面的命令进行升级\n\n```bash\ndpkg -i linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb\n```\n\n4.更新grub引导装入程序\n\n```\nupdate-grub\n```\n\n5.重启机器\n\n```\nreboot\n```\n\n重启后查看自己的内核版本就会发现更新到4.15了\n\n### 开启TCP BBR加速\n\n1.修改系统变量\n\n```bash\necho \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\necho \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n```\n\n如查执行上述命令时显示拒绝访问，则可以尝试使用如下命令：\n\n```bash\nsudo bash -c 'echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf'\nsudo bash -c 'echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf'\n```\n\n2.保存生效\n\n```bash\nsysctl -p\n```\n\n3.查看是否开启成功\n\n```bash\nsysctl net.ipv4.tcp_available_congestion_control\n```\n\n如果返回:`net.ipv4.tcp_available_congestion_control = reno cubic bbr`，那么表示`BBR`开启成功\n\n也可以执行`lsmod | grep bbr`来查看是否开启成功","source":"_posts/study/study-ubuntu-bbr.md","raw":"---\ntitle:  Ubuntu开启BBR\ndate: 2018-03-30 11:02:35\ntags: study\n---\n\n原文地址：[Ubuntu开启BBR加速Shadowsocks](https://www.flyzy2005.com/fan-qiang/shadowsocks/ubuntu-bbr-shadowsocks/)\n\n### 升级内核\n\nubuntu开启BBR加速需要内核高于4.9，先检查内核版本:\n\n```python\nuname -a\n```\n\n如果版本高于4.9，那就可以直接开启BBR，否则需要先升级内核（需要root权限）\n\n1.首先查看系统是32位还是64位\n\n```bash\ngetconf LONG_BIT\n```\n\n2.去[官网](http://kernel.ubuntu.com/~kernel-ppa/mainline/)最新的程序包，这里以`v4.15/`为例\n\n```bash\nwget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.15/linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb\n```\n\n3.执行下面的命令进行升级\n\n```bash\ndpkg -i linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb\n```\n\n4.更新grub引导装入程序\n\n```\nupdate-grub\n```\n\n5.重启机器\n\n```\nreboot\n```\n\n重启后查看自己的内核版本就会发现更新到4.15了\n\n### 开启TCP BBR加速\n\n1.修改系统变量\n\n```bash\necho \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\necho \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n```\n\n如查执行上述命令时显示拒绝访问，则可以尝试使用如下命令：\n\n```bash\nsudo bash -c 'echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf'\nsudo bash -c 'echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf'\n```\n\n2.保存生效\n\n```bash\nsysctl -p\n```\n\n3.查看是否开启成功\n\n```bash\nsysctl net.ipv4.tcp_available_congestion_control\n```\n\n如果返回:`net.ipv4.tcp_available_congestion_control = reno cubic bbr`，那么表示`BBR`开启成功\n\n也可以执行`lsmod | grep bbr`来查看是否开启成功","slug":"study/study-ubuntu-bbr","published":1,"updated":"2018-05-20T13:04:25.690Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61g9004sizcb6oygkh2d","content":"<p>原文地址：<a href=\"https://www.flyzy2005.com/fan-qiang/shadowsocks/ubuntu-bbr-shadowsocks/\" target=\"_blank\" rel=\"noopener\">Ubuntu开启BBR加速Shadowsocks</a></p>\n<h3 id=\"升级内核\"><a href=\"#升级内核\" class=\"headerlink\" title=\"升级内核\"></a>升级内核</h3><p>ubuntu开启BBR加速需要内核高于4.9，先检查内核版本:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname -a</span><br></pre></td></tr></table></figure>\n<p>如果版本高于4.9，那就可以直接开启BBR，否则需要先升级内核（需要root权限）</p>\n<p>1.首先查看系统是32位还是64位</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getconf LONG_BIT</span><br></pre></td></tr></table></figure>\n<p>2.去<a href=\"http://kernel.ubuntu.com/~kernel-ppa/mainline/\" target=\"_blank\" rel=\"noopener\">官网</a>最新的程序包，这里以<code>v4.15/</code>为例</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.15/linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb</span><br></pre></td></tr></table></figure>\n<p>3.执行下面的命令进行升级</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpkg -i linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb</span><br></pre></td></tr></table></figure>\n<p>4.更新grub引导装入程序</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">update-grub</span><br></pre></td></tr></table></figure>\n<p>5.重启机器</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reboot</span><br></pre></td></tr></table></figure>\n<p>重启后查看自己的内核版本就会发现更新到4.15了</p>\n<h3 id=\"开启TCP-BBR加速\"><a href=\"#开启TCP-BBR加速\" class=\"headerlink\" title=\"开启TCP BBR加速\"></a>开启TCP BBR加速</h3><p>1.修改系统变量</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"net.core.default_qdisc=fq\"</span> &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"net.ipv4.tcp_congestion_control=bbr\"</span> &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure>\n<p>如查执行上述命令时显示拒绝访问，则可以尝试使用如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo bash -c <span class=\"string\">'echo \"net.core.default_qdisc=fq\" &gt;&gt; /etc/sysctl.conf'</span></span><br><span class=\"line\">sudo bash -c <span class=\"string\">'echo \"net.ipv4.tcp_congestion_control=bbr\" &gt;&gt; /etc/sysctl.conf'</span></span><br></pre></td></tr></table></figure>\n<p>2.保存生效</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl -p</span><br></pre></td></tr></table></figure>\n<p>3.查看是否开启成功</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl net.ipv4.tcp_available_congestion_control</span><br></pre></td></tr></table></figure>\n<p>如果返回:<code>net.ipv4.tcp_available_congestion_control = reno cubic bbr</code>，那么表示<code>BBR</code>开启成功</p>\n<p>也可以执行<code>lsmod | grep bbr</code>来查看是否开启成功</p>\n","site":{"data":{}},"excerpt":"","more":"<p>原文地址：<a href=\"https://www.flyzy2005.com/fan-qiang/shadowsocks/ubuntu-bbr-shadowsocks/\" target=\"_blank\" rel=\"noopener\">Ubuntu开启BBR加速Shadowsocks</a></p>\n<h3 id=\"升级内核\"><a href=\"#升级内核\" class=\"headerlink\" title=\"升级内核\"></a>升级内核</h3><p>ubuntu开启BBR加速需要内核高于4.9，先检查内核版本:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname -a</span><br></pre></td></tr></table></figure>\n<p>如果版本高于4.9，那就可以直接开启BBR，否则需要先升级内核（需要root权限）</p>\n<p>1.首先查看系统是32位还是64位</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">getconf LONG_BIT</span><br></pre></td></tr></table></figure>\n<p>2.去<a href=\"http://kernel.ubuntu.com/~kernel-ppa/mainline/\" target=\"_blank\" rel=\"noopener\">官网</a>最新的程序包，这里以<code>v4.15/</code>为例</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.15/linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb</span><br></pre></td></tr></table></figure>\n<p>3.执行下面的命令进行升级</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpkg -i linux-image-4.15.0-041500-generic_4.15.0-041500.201802011154_amd64.deb</span><br></pre></td></tr></table></figure>\n<p>4.更新grub引导装入程序</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">update-grub</span><br></pre></td></tr></table></figure>\n<p>5.重启机器</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reboot</span><br></pre></td></tr></table></figure>\n<p>重启后查看自己的内核版本就会发现更新到4.15了</p>\n<h3 id=\"开启TCP-BBR加速\"><a href=\"#开启TCP-BBR加速\" class=\"headerlink\" title=\"开启TCP BBR加速\"></a>开启TCP BBR加速</h3><p>1.修改系统变量</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"net.core.default_qdisc=fq\"</span> &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"net.ipv4.tcp_congestion_control=bbr\"</span> &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure>\n<p>如查执行上述命令时显示拒绝访问，则可以尝试使用如下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo bash -c <span class=\"string\">'echo \"net.core.default_qdisc=fq\" &gt;&gt; /etc/sysctl.conf'</span></span><br><span class=\"line\">sudo bash -c <span class=\"string\">'echo \"net.ipv4.tcp_congestion_control=bbr\" &gt;&gt; /etc/sysctl.conf'</span></span><br></pre></td></tr></table></figure>\n<p>2.保存生效</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl -p</span><br></pre></td></tr></table></figure>\n<p>3.查看是否开启成功</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl net.ipv4.tcp_available_congestion_control</span><br></pre></td></tr></table></figure>\n<p>如果返回:<code>net.ipv4.tcp_available_congestion_control = reno cubic bbr</code>，那么表示<code>BBR</code>开启成功</p>\n<p>也可以执行<code>lsmod | grep bbr</code>来查看是否开启成功</p>\n"},{"title":"study-ubuntu-nextcloud","date":"2018-03-23T03:53:01.000Z","_content":"\n```\nsudo apt-get update\nsudo apt-get install snap\nsudo apt-get install snapd\nsudo snap install nextcloud\n```\n\n加密\n\n```\nsudo nextcloud.enable-https lets-encrypt\n```","source":"_posts/study/study-ubuntu-nextcloud.md","raw":"---\ntitle: study-ubuntu-nextcloud\ndate: 2018-03-23 11:53:01\ntags:\n---\n\n```\nsudo apt-get update\nsudo apt-get install snap\nsudo apt-get install snapd\nsudo snap install nextcloud\n```\n\n加密\n\n```\nsudo nextcloud.enable-https lets-encrypt\n```","slug":"study/study-ubuntu-nextcloud","published":1,"updated":"2018-05-20T13:04:25.690Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjion61ga004uizcb0g9ba33g","content":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install snap</span><br><span class=\"line\">sudo apt-get install snapd</span><br><span class=\"line\">sudo snap install nextcloud</span><br></pre></td></tr></table></figure>\n<p>加密</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nextcloud.enable-https lets-encrypt</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install snap</span><br><span class=\"line\">sudo apt-get install snapd</span><br><span class=\"line\">sudo snap install nextcloud</span><br></pre></td></tr></table></figure>\n<p>加密</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nextcloud.enable-https lets-encrypt</span><br></pre></td></tr></table></figure>"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cjion61d10000izcbw7ftwodv","tag_id":"cjion61d70002izcb7l7zre2z","_id":"cjion61db0006izcbvtn7gxy4"},{"post_id":"cjion61d90004izcb0t1837gc","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61dc0007izcbbxw67l6c"},{"post_id":"cjion61e7000cizcb8hnysgb7","tag_id":"cjion61e5000aizcbsr6a0ato","_id":"cjion61ea000fizcb14l5gcwh"},{"post_id":"cjion61e30008izcbiawgxbl0","tag_id":"cjion61e5000aizcbsr6a0ato","_id":"cjion61eb000hizcbcn3oaw1a"},{"post_id":"cjion61e40009izcbxtslft9m","tag_id":"cjion61e5000aizcbsr6a0ato","_id":"cjion61ec000kizcb9m8y3z08"},{"post_id":"cjion61e5000bizcbbc3783e3","tag_id":"cjion61e5000aizcbsr6a0ato","_id":"cjion61ed000oizcbaw7osh4q"},{"post_id":"cjion61ed000pizcbt426qlkk","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61ef000sizcbink1g4b1"},{"post_id":"cjion61e8000dizcbzvtqaw1u","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61eg000uizcb5rhs9x9y"},{"post_id":"cjion61ee000qizcbnnp18uj1","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61eh000xizcbn1ghxj62"},{"post_id":"cjion61ef000tizcbnt7n9rm9","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61ei000zizcbz0gkcgwx"},{"post_id":"cjion61ea000gizcbxzufp466","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61ek0012izcb56awmv6w"},{"post_id":"cjion61eg000vizcb58n9h0cd","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61el0014izcbx975kj4a"},{"post_id":"cjion61ei000yizcbb0jdj2g8","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61em0017izcbrevrcbfs"},{"post_id":"cjion61eb000iizcb10x03sfp","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61en0019izcbynp30umk"},{"post_id":"cjion61ei0010izcbjn99u0tz","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61eo001bizcbd897y86f"},{"post_id":"cjion61ek0013izcbvkx97bpb","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61eq001eizcbskk9y9uw"},{"post_id":"cjion61ec000lizcb6bn50lna","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61er001gizcb21j0cdrw"},{"post_id":"cjion61en0018izcbr1btnqsi","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61er001iizcbol6yheur"},{"post_id":"cjion61ed000mizcby4cxcgxt","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61et001lizcbs0ud95er"},{"post_id":"cjion61er001hizcbhpr99ohs","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61eu001nizcbg8b77d0m"},{"post_id":"cjion61er001hizcbhpr99ohs","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61ev001qizcbl05kvak4"},{"post_id":"cjion61en001aizcb7vjj7kcv","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61ew001sizcbmvys56ri"},{"post_id":"cjion61en001aizcb7vjj7kcv","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61ex001uizcb64p8m91y"},{"post_id":"cjion61et001mizcbsryh9zjz","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61ey001wizcb4ed3l5cd"},{"post_id":"cjion61et001mizcbsryh9zjz","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61ez001zizcbajdyzd1i"},{"post_id":"cjion61eo001cizcbxcq0kxts","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61f00021izcbvsgqsfzk"},{"post_id":"cjion61eo001cizcbxcq0kxts","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61f00023izcbbv0dpw3e"},{"post_id":"cjion61eu001oizcb3excwnt0","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61f20026izcbwep8do0o"},{"post_id":"cjion61eu001oizcb3excwnt0","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61f30028izcbmor97xfv"},{"post_id":"cjion61ev001rizcb12ww3sza","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61f4002bizcbhhehxh4w"},{"post_id":"cjion61ev001rizcb12ww3sza","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61f5002dizcbjykw2qq9"},{"post_id":"cjion61eq001fizcbwn4ib49p","tag_id":"cjion61ed000nizcbcq7dboez","_id":"cjion61f6002gizcb7vdj48yq"},{"post_id":"cjion61eq001fizcbwn4ib49p","tag_id":"cjion61ep001dizcb2xeo9edc","_id":"cjion61f7002iizcbvhmv7ljc"},{"post_id":"cjion61ex001vizcb4uufqpp8","tag_id":"cjion61ey001yizcbajhifql3","_id":"cjion61f8002lizcb4vm6x8hk"},{"post_id":"cjion61f10024izcb0d8g6qqf","tag_id":"cjion61ey001yizcbajhifql3","_id":"cjion61f9002nizcbnkc4ltk4"},{"post_id":"cjion61ey001xizcb7rkersga","tag_id":"cjion61ey001yizcbajhifql3","_id":"cjion61fa002qizcbn0lhsi27"},{"post_id":"cjion61ez0020izcbtorpuayg","tag_id":"cjion61ey001yizcbajhifql3","_id":"cjion61fb002sizcbh90bj7vn"},{"post_id":"cjion61f6002hizcb11is1mwn","tag_id":"cjion61f5002fizcbbwehblka","_id":"cjion61fc002vizcbpanv9338"},{"post_id":"cjion61f00022izcb0sqgzoko","tag_id":"cjion61f5002fizcbbwehblka","_id":"cjion61fd002xizcb11u7mbr8"},{"post_id":"cjion61f20027izcbeedlehr0","tag_id":"cjion61f5002fizcbbwehblka","_id":"cjion61fe0030izcbbabks94k"},{"post_id":"cjion61f30029izcbihbh1boy","tag_id":"cjion61f5002fizcbbwehblka","_id":"cjion61ff0032izcb1a9h3ezo"},{"post_id":"cjion61f4002cizcbir9zp3um","tag_id":"cjion61f5002fizcbbwehblka","_id":"cjion61fg0035izcb9rn61650"},{"post_id":"cjion61f5002eizcbha4suxg7","tag_id":"cjion61f5002fizcbbwehblka","_id":"cjion61fi0037izcbgquy6za9"},{"post_id":"cjion61f8002mizcbc11te4ck","tag_id":"cjion61fg0034izcbcuzde7wc","_id":"cjion61fk003bizcb7o3ud0pn"},{"post_id":"cjion61f9002oizcb9zudaxgf","tag_id":"cjion61fg0034izcbcuzde7wc","_id":"cjion61fm003fizcbeqzqjnzg"},{"post_id":"cjion61fa002rizcb93e95qo6","tag_id":"cjion61fg0034izcbcuzde7wc","_id":"cjion61fp003jizcb2v1fi8is"},{"post_id":"cjion61fb002tizcbpg0lec06","tag_id":"cjion61fg0034izcbcuzde7wc","_id":"cjion61fq003nizcbi1iqammr"},{"post_id":"cjion61fc002wizcbk3wgtuel","tag_id":"cjion61e5000aizcbsr6a0ato","_id":"cjion61fs003rizcb0bn2p1cr"},{"post_id":"cjion61fc002wizcbk3wgtuel","tag_id":"cjion61fp003lizcbtzvy8lq2","_id":"cjion61ft003tizcbr91j2qwl"},{"post_id":"cjion61fd002yizcbg20fims8","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61fw0040izcb00j7h0xc"},{"post_id":"cjion61fd002yizcbg20fims8","tag_id":"cjion61fu003vizcbu0yfwymo","_id":"cjion61fx0042izcbdskkijhu"},{"post_id":"cjion61fx0041izcb6nlj3mv1","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61fy0045izcb7quqnasq"},{"post_id":"cjion61fe0031izcbwjd3de3w","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61g00049izcbpy9j2h2d"},{"post_id":"cjion61fe0031izcbwjd3de3w","tag_id":"cjion61fu003vizcbu0yfwymo","_id":"cjion61g1004bizcbqqsadepf"},{"post_id":"cjion61fy0046izcb4bih661s","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61g2004eizcbq99na35m"},{"post_id":"cjion61g00048izcbkmzs5t58","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61g3004gizcbkuhey4tz"},{"post_id":"cjion61g0004aizcbklx5jaiz","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61g4004jizcbl4437ylv"},{"post_id":"cjion61g2004dizcbajb043lk","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61g6004lizcb6piyuiic"},{"post_id":"cjion61ff0033izcb0gekz7hd","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61g7004oizcbdr62bhje"},{"post_id":"cjion61ff0033izcb0gekz7hd","tag_id":"cjion61fu003vizcbu0yfwymo","_id":"cjion61g8004qizcbtk4a5wan"},{"post_id":"cjion61g2004fizcbq03b79nq","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61g9004tizcbfcxtruye"},{"post_id":"cjion61g4004iizcbi6xcqph6","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61gd004vizcbrq1zjsjp"},{"post_id":"cjion61g5004kizcbqqszgh1t","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61gd004xizcbgq19iry0"},{"post_id":"cjion61g7004nizcbiauxy5o9","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61gd004yizcb19a4z8f8"},{"post_id":"cjion61fh0036izcb4sp7yzz9","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61ge0050izcbdum527nt"},{"post_id":"cjion61fh0036izcb4sp7yzz9","tag_id":"cjion61fu003vizcbu0yfwymo","_id":"cjion61ge0051izcb8aenni5j"},{"post_id":"cjion61g7004pizcbov0vb78v","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61ge0053izcbn71fqk07"},{"post_id":"cjion61g9004sizcb6oygkh2d","tag_id":"cjion61db0005izcb4wqwx0wv","_id":"cjion61ge0054izcbwevpn9oa"},{"post_id":"cjion61fi0038izcbgyefxi49","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61gf0056izcbkq0p8iu6"},{"post_id":"cjion61fi0038izcbgyefxi49","tag_id":"cjion61fu003vizcbu0yfwymo","_id":"cjion61gf0057izcbppje3ch9"},{"post_id":"cjion61fk003aizcbofyk0sl4","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61gf0059izcbvgk1zh01"},{"post_id":"cjion61fk003cizcbpol2meqc","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61gf005aizcbcqp1025b"},{"post_id":"cjion61fk003cizcbpol2meqc","tag_id":"cjion61gf0055izcbj8kyne8v","_id":"cjion61gg005cizcbwss31mdp"},{"post_id":"cjion61fl003eizcbl37f47mq","tag_id":"cjion61fs003pizcb8x0xp670","_id":"cjion61gg005eizcbot4pcwev"},{"post_id":"cjion61fl003eizcbl37f47mq","tag_id":"cjion61gf005bizcbmv6yqywu","_id":"cjion61gg005fizcbj74ox884"},{"post_id":"cjion61fm003gizcbl7l6vx42","tag_id":"cjion61gg005dizcbyl5lar7y","_id":"cjion61gg005hizcbaz0he0q8"},{"post_id":"cjion61fo003iizcb55rgctwh","tag_id":"cjion61gg005dizcbyl5lar7y","_id":"cjion61gh005jizcb9alfpb2s"},{"post_id":"cjion61fp003kizcb0od876m1","tag_id":"cjion61gg005dizcbyl5lar7y","_id":"cjion61gh005lizcbdsocex3s"},{"post_id":"cjion61fq003mizcbszm7qqa5","tag_id":"cjion61gh005kizcbdyear3zl","_id":"cjion61gh005nizcbrlxc6cgu"},{"post_id":"cjion61fr003oizcbcyxf64wq","tag_id":"cjion61gh005kizcbdyear3zl","_id":"cjion61gi005pizcbtdh10958"},{"post_id":"cjion61ft003sizcbbdiv4ky0","tag_id":"cjion61gh005kizcbdyear3zl","_id":"cjion61gi005rizcbv2ye2zax"},{"post_id":"cjion61ft003uizcbi00glxe9","tag_id":"cjion61gi005qizcbn8a3wvv8","_id":"cjion61gj005tizcb0fkhg0ri"},{"post_id":"cjion61fu003wizcbanoa4je6","tag_id":"cjion61gi005qizcbn8a3wvv8","_id":"cjion61gj005vizcbpa1aiwmy"},{"post_id":"cjion61fv003xizcb56bbdprl","tag_id":"cjion61gj005uizcb68tr08aj","_id":"cjion61gj005xizcblolbfxyt"},{"post_id":"cjion61fw003zizcbfrt8zsu2","tag_id":"cjion61gj005uizcb68tr08aj","_id":"cjion61gk005yizcbpaskr6r1"}],"Tag":[{"name":"me","_id":"cjion61d70002izcb7l7zre2z"},{"name":"study","_id":"cjion61db0005izcb4wqwx0wv"},{"name":"ios","_id":"cjion61e5000aizcbsr6a0ato"},{"name":"android","_id":"cjion61ed000nizcbcq7dboez"},{"name":"kotlin","_id":"cjion61ep001dizcb2xeo9edc"},{"name":"blog","_id":"cjion61ey001yizcbajhifql3"},{"name":"fe","_id":"cjion61f5002fizcbbwehblka"},{"name":"hole","_id":"cjion61fg0034izcbcuzde7wc"},{"name":"stanford","_id":"cjion61fp003lizcbtzvy8lq2"},{"name":"java","_id":"cjion61fs003pizcb8x0xp670"},{"name":"Annotation","_id":"cjion61fu003vizcbu0yfwymo"},{"name":"lambda","_id":"cjion61gf0055izcbj8kyne8v"},{"name":"stream","_id":"cjion61gf005bizcbmv6yqywu"},{"name":"life","_id":"cjion61gg005dizcbyl5lar7y"},{"name":"poetry","_id":"cjion61gh005kizcbdyear3zl"},{"name":"read","_id":"cjion61gi005qizcbn8a3wvv8"},{"name":"smile","_id":"cjion61gj005uizcb68tr08aj"}]}}